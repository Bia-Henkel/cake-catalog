(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[172,156,159,177,180,258,272],{1579:function(e,t,n){"use strict";n.r(t);var a=n(60),i=n(12),r=(n(1823),n(22)),o=n(1077),s=Object(o.e)("ms-details-list","./react/detailsList/ReactDetailsList",function(){return a.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(193)]).then(n.bind(null,2211)))},{isFixedLayout:!i.t.isActivated("e0ae1ef9-3c14-4ca1-8930-17f962eb869c","10/15/2021","Bug fix for ODB Recycle Bin list header not showing up in mobile view")});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s),t.default=s},1580:function(e,t,n){"use strict";n.r(t);var a=n(60),i=n(12),r=(n(1823),n(22)),o=n(1077),s=Object(o.e)("ms-compact-details-list","./react/detailsList/ReactDetailsList",function(){return a.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(193)]).then(n.bind(null,2211)))},{isCompact:!0,isFixedLayout:!i.t.isActivated("e0ae1ef9-3c14-4ca1-8930-17f962eb869c","10/15/2021","Bug fix for ODB Recycle Bin list header not showing up in mobile view")});r.components.isRegistered(s.tagName)||r.components.register(s.tagName,s),t.default=s},1581:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(1837),n(22)),r=n(0),o=n(1873),s=n(1987),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.initialize(new(a.managed(s.e))(t)),a}return Object(r.__extends)(t,e),t}(o.e),d={tagName:"ms-grid-list",template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(c))(e,t)}},synchronous:!0};i.components.isRegistered(d.tagName)||i.components.register(d.tagName,d),t.default=d},1582:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(1837),n(22)),r=n(0),o=n(1873),s=n(1935),c=n(17);Object(c.n)([{rawString:".od-AllPhotosHeader{width:100%;height:100%}.md .od-AllPhotosHeader,.sm .od-AllPhotosHeader{height:40px;line-height:40px}.od-AllPhotosHeader:hover .od-AllPhotosHeader-check{opacity:1}.lg .od-AllPhotosHeader::before,.xlg .od-AllPhotosHeader::before,.xxlg .od-AllPhotosHeader::before,.xxxlg .od-AllPhotosHeader::before,.xxxxlg .od-AllPhotosHeader::before{content:'';position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(0,0,0,.06)}.md .od-AllPhotosHeader-eventName,.sm .od-AllPhotosHeader-eventName{display:inline-block}[dir=ltr] .md .od-AllPhotosHeader-eventName,[dir=ltr] .sm .od-AllPhotosHeader-eventName{padding-left:10px}[dir=rtl] .md .od-AllPhotosHeader-eventName,[dir=rtl] .sm .od-AllPhotosHeader-eventName{padding-right:10px}.lg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-eventName{position:absolute;left:16px;right:16px;top:120px}html[dir=ltr] .lg .od-AllPhotosHeader-eventName,html[dir=ltr] .xlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-eventName{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-eventName,html[dir=rtl] .xlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-eventName{text-align:left}.od-AllPhotosHeader-month{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.md .od-AllPhotosHeader-month,.sm .od-AllPhotosHeader-month{font-size:17px;font-weight:300}.lg .od-AllPhotosHeader-month,.xlg .od-AllPhotosHeader-month,.xxlg .od-AllPhotosHeader-month,.xxxlg .od-AllPhotosHeader-month,.xxxxlg .od-AllPhotosHeader-month{font-size:15px;font-weight:400;font-weight:100}.lg .od-AllPhotosHeader-month::after,.xlg .od-AllPhotosHeader-month::after,.xxlg .od-AllPhotosHeader-month::after,.xxxlg .od-AllPhotosHeader-month::after,.xxxxlg .od-AllPhotosHeader-month::after{content:'\\A';white-space:pre}.lg .od-AllPhotosHeader-eventName,.lg .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-share{font-size:14px;font-weight:400}.md .od-AllPhotosHeader-check,.sm .od-AllPhotosHeader-check{top:10px;position:absolute}[dir=ltr] .md .od-AllPhotosHeader-check,[dir=ltr] .sm .od-AllPhotosHeader-check{right:0}[dir=rtl] .md .od-AllPhotosHeader-check,[dir=rtl] .sm .od-AllPhotosHeader-check{left:0}.md .od-AllPhotosHeader-check .ItemCheck,.sm .od-AllPhotosHeader-check .ItemCheck{display:inline-block}.lg .od-AllPhotosHeader-check,.xlg .od-AllPhotosHeader-check,.xxlg .od-AllPhotosHeader-check,.xxxlg .od-AllPhotosHeader-check,.xxxxlg .od-AllPhotosHeader-check{top:8px;position:absolute;opacity:0}[dir=ltr] .lg .od-AllPhotosHeader-check,[dir=ltr] .xlg .od-AllPhotosHeader-check,[dir=ltr] .xxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxxlg .od-AllPhotosHeader-check{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-check,[dir=rtl] .xlg .od-AllPhotosHeader-check,[dir=rtl] .xxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxxlg .od-AllPhotosHeader-check{left:16px}.od-AllPhotosHeader-check.is-selected{opacity:1}.od-AllPhotosHeader .od-AllPhotosHeader-share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader .od-AllPhotosHeader-share,.sm .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;top:0}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-right:15px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-left:15px}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{right:18px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{left:18px}.lg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;bottom:16px}[dir=ltr] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{right:16px}[dir=rtl] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{left:16px}.od-AllPhotosHeader .od-AllPhotosHeader-share:focus,.od-AllPhotosHeader .od-AllPhotosHeader-share:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-AllPhotosHeader .od-AllPhotosHeader-share:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader-date,.sm .od-AllPhotosHeader-date{display:inline-block}.lg .od-AllPhotosHeader-date,.xlg .od-AllPhotosHeader-date,.xxlg .od-AllPhotosHeader-date,.xxxlg .od-AllPhotosHeader-date,.xxxxlg .od-AllPhotosHeader-date{position:absolute;top:40px}[dir=ltr] .lg .od-AllPhotosHeader-date,[dir=ltr] .xlg .od-AllPhotosHeader-date,[dir=ltr] .xxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-date,[dir=rtl] .xlg .od-AllPhotosHeader-date,[dir=rtl] .xxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{left:16px}html[dir=ltr] .lg .od-AllPhotosHeader-date,html[dir=ltr] .xlg .od-AllPhotosHeader-date,html[dir=ltr] .xxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-date,html[dir=rtl] .xlg .od-AllPhotosHeader-date,html[dir=rtl] .xxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{text-align:left}[dir=ltr] .md .od-AllPhotosHeader-day,[dir=ltr] .sm .od-AllPhotosHeader-day{margin-left:5px}[dir=rtl] .md .od-AllPhotosHeader-day,[dir=rtl] .sm .od-AllPhotosHeader-day{margin-right:5px}.lg .od-AllPhotosHeader-day,.xlg .od-AllPhotosHeader-day,.xxlg .od-AllPhotosHeader-day,.xxxlg .od-AllPhotosHeader-day,.xxxxlg .od-AllPhotosHeader-day{font-size:42px}"}]);var d=n(388),l=n(183),u=n(25),f=n(23),p=n(1870),m=n(1852),_=n(2148),h=function(e){function t(t){var n=e.call(this,t)||this,a=t.mode,i=void 0===a?0:a;n.itemCheckTagName=p.e.tagName,n._itemSetSelectionModel=n.resources.consume(u.C),n._itemCommandHelper=new(n.managed(m.e)),n._startIndex=t.startIndex,n._mode=i,n.displayMonth=0===n._mode?t.group.latestPhotoTime.monthName:"",n.displayDay=0===n._mode?t.group.latestPhotoTime.day:"",n.displayDate=0===n._mode?t.group.latestPhotoTime.longDate:"",n.displayYear=1===n._mode?t.group.latestPhotoTime.year:"",n.group=t.group,n.eventName=n.group&&n.group.location||"",n.shareText=f.Share,n._range=n.createPureComputed(n._computeRange,{deferEvaluation:!0}),n._selectedCount=n.createPureComputed(n._computeSelectedCount,{deferEvaluation:!0}),n.areAllPhotosSelected=n.createPureComputed(n._computeAreAllPhotosSelected,{deferEvaluation:!0}),n.isSelectAllAvailable=n.createPureComputed(n._computeIsSelectAllAvailable,{deferEvaluation:!0}),n.isCheckVisible=n.createPureComputed(n._computeIsCheckVisible,{deferEvaluation:!0}),n._isShareSupported=n.createPureComputed(n._computeIsShareSupported,{deferEvaluation:!0}),n.isShareAvailable=n.createPureComputed(n._computeIsShareAvailable,{deferEvaluation:!0});var r=n.resources.consume(u.e);return n._shareAction=new(n.managed(r.ShareByLinkAction)),n}return Object(r.__extends)(t,e),t.prototype.onClickSelectAll=function(e,t){for(var n=this.areAllPhotosSelected.peek(),a=this._range.peek(),i=a.start;i<a.end;i++)this._itemSetSelectionModel.setIndexSelected(i,!n);return t.stopPropagation(),t.preventDefault(),!1},t.prototype.onClickShare=function(e,t){this._itemSetSelectionModel.clear();for(var n=this._range.peek(),a=n.start;a<n.end;a++)this._itemSetSelectionModel.setIndexSelected(a,!0);return this._shareAction.isAvailable.peek()&&this._shareAction.execute(t),t.stopPropagation(),t.preventDefault(),!1},t.prototype.onClickDate=function(e,t){return!1},t.prototype._computeRange=function(){var e,t,n=this._itemSetSelectionModel.itemSet.peek().content.peek().groupings||[],a=0===this._mode?0:2;if(n&&n.length)for(var i=0,r=n;i<r.length;i++){var o=r[i];if(o.groupType===a){t=o.groups;break}}if(t)for(var s=0,c=t;s<c.length;s++){var d=c[s];if(d.startIndex===this._startIndex){e=d;break}}return e&&e.keys?{start:e.startIndex,end:e.keys.length+e.startIndex}:{start:-1,end:0}},t.prototype._computeSelectedCount=function(){this._itemSetSelectionModel.selection();for(var e=this._range.peek(),t=0,n=e.start;n<e.end;n++)this._itemSetSelectionModel.isIndexSelected(n)&&t++;return t},t.prototype._computeAreAllPhotosSelected=function(){var e=this._selectedCount(),t=this._range.peek();return 0===this._itemSetSelectionModel.mode?e===t.end-t.start:e>0},t.prototype._computeIsShareAvailable=function(){var e=this._range.peek();return this._isShareSupported()&&(0===this._itemSetSelectionModel.mode||e.end-e.start==1)},t.prototype._computeIsCheckVisible=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0},t.prototype._computeIsSelectAllAvailable=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0},t.prototype._computeIsShareSupported=function(){var e=this._itemSetSelectionModel.itemSet().content().items,t=this._range.peek(),n=this.unwrapObservable(e[t.start]);return this._itemCommandHelper.isCommandSupported(n,_.c)},t}(l.t),b=d.e({tagName:"od-all-photos-header",template:'<div class="od-AllPhotosHeader" tabindex="0"><div class="od-AllPhotosHeader-date"><span class="od-AllPhotosHeader-month" data-bind="text:displayMonth,click:onClickDate"></span>\x3c!--ko if:displayDay--\x3e<span class="od-AllPhotosHeader-day ms-font-xxl" data-bind="text:displayDay,click:onClickDate"></span>\x3c!--/ko--\x3e\x3c!--ko if:displayYear--\x3e<span class="od-AllPhotosHeader-year ms-font-xxl" data-bind="text:displayYear"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:eventName--\x3e<div class="od-AllPhotosHeader-eventName ms-font-l ms-fontColor-neutralPrimary" data-bind="text:eventName"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShareAvailable--\x3e<a href="#" class="od-AllPhotosHeader-share od-Link ms-font-l" data-bind="text:shareText,click:onClickShare"></a>\x3c!--/ko--\x3e\x3c!--ko if:isCheckVisible--\x3e<span class="od-AllPhotosHeader-check" data-bind="click:onClickSelectAll,css:{\'is-selected\':areAllPhotosSelected,\'can-select\':isSelectAllAvailable},component:{name:itemCheckTagName}"></span>\x3c!--/ko--\x3e</div>',viewModel:h,synchronous:!0}),g=n(2311),v=function(e){function t(t){var n=e.call(this,t)||this,a=t.mode,i=void 0===a?0:a;return n._mode=n.wrapObservable(i),n}return Object(r.__extends)(t,e),t.prototype.getInnerMargin=function(){return 2},t.prototype.getMinRowHeight=function(){switch(this.responsiveHelper.formFactorSize.peek()){case"Small":case"Medium":return 120;default:return 220}},t.prototype.getGroup=function(e){var t,n=this._itemSet.peek().content.peek(),a=n.groupings||[],i=n.items,r=0===this._mode.peek()?0:2;if(a&&a.length){for(var o=void 0,s=void 0,c=i[e].peek(),d=0,l=a;d<l.length;d++){var u=l[d];if(u.groupType===r){s=(o=u).groups;break}}return o&&s.length?o.groupMap[o.itemToGroupMap[c.key]]:t}return t},t.prototype.getHeader=function(e,t,n){var a=null;if(t&&t.peek&&t.peek()){var i=this.getGroup(n);if(i&&this.currentGroup!==i){if((!this.currentGroup||this.currentGroup.latestPhotoTime.monthName!==i.latestPhotoTime.monthName||this.currentGroup.latestPhotoTime.year!==i.latestPhotoTime.year)&&1!==this._mode.peek()){var r=new Date(i.latestPhotoTime.isoDate).getFullYear(),o=g.e.tagName,s={resources:this.resources,headerText:"".concat(i.latestPhotoTime.monthName," ").concat(r)},c=this._shouldInlineHeadersLineBreak()?64:80;a={key:n+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:c,viewType:o,viewData:s,shouldLineBreak:!0,isHeader:!0},this.addToCurrentRow(a,!0)}var d,l,u,f=void 0;this.currentGroup=i,l=b.tagName,u={group:i,resources:this.resources,startIndex:n,mode:this._mode.peek()},d=this._shouldInlineHeadersLineBreak(),f=40,0!==n||l||(f=0),a={key:n+"_header",cellIndex:this.cells.length,left:0,top:0,width:d?0:124,height:f,viewType:l,viewData:u,shouldLineBreak:d,aspectRatio:d?void 0:.55,isHeader:!0,shouldNotBeLastInRow:!0,isFixedWidth:!d},this.nextGroup=i}}return a},t.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);for(var t=this.getRowRangeForViewport(e),n=t.start,a=t.end,i=0,r=0,o=0;o<a;o++){var s=this.rows[o],c=s.cells.length-s.itemCellCount;o<=n&&(i+=c),o<a&&(r+=c)}this._shouldInlineHeadersLineBreak()&&(i=0,r=0);var d=this.rows[n],l=this.rows[a-1];return{start:n>=0?d.cells[0].cellIndex-i:-1,end:a>=0?l.cells[l.cells.length-1].cellIndex-r:-1}},t.prototype._shouldInlineHeadersLineBreak=function(){var e=this.responsiveHelper;return e.compareSize(e.formFactorSize.peek(),"Medium")<=0},t}(s.t),y=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.initialize(new(a.managed(v))(t)),a}return Object(r.__extends)(t,e),t}(o.e),S={tagName:"ms-all-photos-list",template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(y))(e,t)}},synchronous:!0};i.components.isRegistered(S.tagName)||i.components.register(S.tagName,S),t.default=S},1583:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(1837),n(22)),r=n(0),o=n(1873),s=n(1935),c={Small:130,Medium:130,Large:210,XLarge:300,XXLarge:300,XXXLarge:300,XXXXLarge:300},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getInnerMargin=function(){return 12},t.prototype.getHeader=function(e,t,n){var a=null,i=t&&t.peek&&t.peek(),r=this.getGroup(n,i);if(r&&this.currentGroup!==r){this.nextGroup=r;var o=this.getHeaderDetails(r,n);0!==n||o.viewType||(o.headerHeight=0);var s=o.key?o.key:i?i.key+"_header":null;s&&(a={key:s,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:o.headerHeight,viewType:o.viewType,viewData:o.viewData})}return a},t.prototype.getGroup=function(e,t){var n,a=this._itemSet().content.peek().groupings||[];if(a&&a.length&&a[0].itemGroups)for(var i=0,r=a[0].itemGroups;i<r.length;i++){var o=r[i];if(o){var s=o.startIndex+o.count-1;if(o.startIndex<=e&&s>=e){n=o;break}}}return n},t.prototype.getMinRowHeight=function(){var e=this.responsiveHelper.formFactorSize();return this.currentGroup&&"folder"===this.currentGroup.groupingId?s.e.folder[e]:this.currentGroup&&"document"===this.currentGroup.groupingId?s.e.documents[e]:c[e]},t.prototype.getHeaderDetails=function(e,t){return{viewType:"",viewData:{},headerHeight:20}},t}(s.t),l=d,u=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.initialize(new(a.managed(l))(t)),a}return Object(r.__extends)(t,e),t}(o.e),f={tagName:n(977).l,template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(u))(e,t)}},synchronous:!0};i.components.isRegistered(f.tagName)||i.components.register(f.tagName,f),t.default=f},1588:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(2072),n(2249),n(22)),r=n(0),o=n(1873),s=n(2169),c=n(25),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:24}},t.prototype.isCheckSupported=function(){return!1},t.prototype.getHeaderCell=function(){return null},t.prototype.onRowInvoke=function(e){var t=this.resources.consume(c.C);return t.clear(!0),t.setItemSelected(i.dataFor(e.target).item,!0),e.stopPropagation(),e.preventDefault(),!1},t}(s.e),l=d,u=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=new(a.managed(l))(t);return a.initialize(i),a}return Object(r.__extends)(t,e),t}(o.e),f={tagName:n(977).p,template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(u))(e,t)}},synchronous:!0};i.components.isRegistered(f.tagName)||i.components.register(f.tagName,f),t.default=f},1591:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(1837),n(22)),r=n(0),o=n(1873),s=n(1987),c=n(17);Object(c.n)([{rawString:".od-autoAlbumHeader-textWrapper{position:absolute;cursor:pointer}.xlg .od-autoAlbumHeader-textWrapper,.xxlg .od-autoAlbumHeader-textWrapper,.xxxlg .od-autoAlbumHeader-textWrapper,.xxxxlg .od-autoAlbumHeader-textWrapper{top:38px;font-size:14px;font-weight:400}.lg .od-autoAlbumHeader-textWrapper,.md .od-autoAlbumHeader-textWrapper,.sm .od-autoAlbumHeader-textWrapper{top:18px;font-size:14px;font-weight:400}.sm .od-autoAlbumHeader-textWrapper{top:20px;font-size:12px;font-weight:400}.od-autoAlbumHeader-text{display:inline-block}.xlg .od-autoAlbumHeader,.xxlg .od-autoAlbumHeader,.xxxlg .od-autoAlbumHeader,.xxxxlg .od-autoAlbumHeader{height:74px}.lg .od-autoAlbumHeader,.md .od-autoAlbumHeader,.sm .od-autoAlbumHeader{height:49px}.sm .od-autoAlbumHeader{height:46px}.od-autoAlbumHeader .ms-Icon{padding-bottom:2px;vertical-align:middle}"}]);var d=n(388),l=n(2980),u=n(183),f=n(31),p=function(e){function t(t){var n=e.call(this,t)||this;return n.group=t.group,n._onToggle=t.onToggle,n.text=n.createPureComputed(n._computeText),n.chevronClass=n.createPureComputed(n._computeChevron),n}return Object(r.__extends)(t,e),t.prototype.onClickHeader=function(e,t){var n=this.group.state.peek().isCollapsed;return this.group.state({isCollapsed:!n}),this._onToggle(),!1},t.prototype._computeText=function(){return this.group.state().isCollapsed?l.t:l.e},t.prototype._computeChevron=function(){return Object(f.O)(this.group.state().isCollapsed?"ChevronDown":"ChevronUp")},t}(u.t),m=d.e({tagName:"od-auto-album-header",template:'<div class="od-autoAlbumHeader"><div class="od-autoAlbumHeader-textWrapper" data-bind="click:onClickHeader"><div class="od-autoAlbumHeader-text ms-fontColor-neutralSecondary" data-bind="text:text"></div><div class="ms-Icon" data-bind="class:chevronClass"></div></div></div>',viewModel:p,synchronous:!0}),_=n(2311),h=n(11),b=function(e){function t(t){return t.isGrouped=!0,e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.getMinRowHeight=function(){return Object(h.isFeatureEnabled)(h.EnableEvokeAlignments)?240:e.prototype.getMinRowHeight.call(this)},t.prototype.getItemAspectRatio=function(t){return Object(h.isFeatureEnabled)(h.EnableEvokeAlignments)?4/3:e.prototype.getItemAspectRatio.call(this,t)},t.prototype.getInnerMargin=function(){return 4},t.prototype.getGroup=function(e,t){if(!Object(h.isFeatureEnabled)(h.EnableEvokeAlignments)){var n=this._itemSet().content.peek().groupings||[];if(n&&n.length&&n[1]&&n[1].itemGroups)for(var a=0,i=n[1].itemGroups;a<i.length;a++){var r=i[a];if(r){var o=r.startIndex+r.count-1;if(r.startIndex<=e&&o>=e)return r}}}},t.prototype.getHeader=function(t,n,a){if(!Object(h.isFeatureEnabled)(h.EnableEvokeAlignments))return e.prototype.getHeader.call(this,t,n,a);var i=t&&t.peek&&t.peek(),r=n&&n.peek&&n.peek();if(i&&i.dateCreatedTime&&r&&r.dateCreatedTime&&i.dateCreatedTime.getFullYear()!==r.dateCreatedTime.getFullYear()){var o=r.dateCreatedTime.getFullYear(),s=_.e.tagName,c={resources:this.resources,headerText:"".concat(o)},d=this.isSmallWidthLayout?64:80;return{key:a+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:d,viewType:s,viewData:c,shouldLineBreak:!0,isHeader:!0}}},t.prototype.finalizeRow=function(t,n){var a=this._itemSet().content.peek().groupings;if(!Object(h.isFeatureEnabled)(h.EnableEvokeAlignments)&&a&&a.length){var i=this.currentRow,r=!1;if(i&&this.currentGroup&&this.currentGroup.state){var o=this.currentGroup.state.peek();o&&(r=o.isCollapsed&&!i.isHeader)}r?this.currentRow=null:e.prototype.finalizeRow.call(this,t,n)}else e.prototype.finalizeRow.call(this,t,n)},t.prototype.getHeaderDetails=function(e,t){var n=this,a="",i={group:null,cellsInGroup:null},r=20,o=this.responsiveHelper,s=o.formFactorSize.peek();return e&&(a=m.tagName,i={startIndex:t,group:e,cellsInGroup:0,resources:this.resources,onToggle:function(){n.evaluateLayout(!0)}},r=o.compareSize(s,"XLarge")>=0?74:o.compareSize(s,"Small")>0?49:46),{viewType:a,viewData:i,headerHeight:r}},t}(s.e),g=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.initialize(new(a.managed(b))(t)),a}return Object(r.__extends)(t,e),t}(o.e),v={tagName:n(977).e,template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(g))(e,t)}},synchronous:!0};i.components.isRegistered(v.tagName)||i.components.register(v.tagName,v),t.default=v},1596:function(e,t,n){"use strict";n.r(t);var a=n(1878),i=(n(1823),n(1837),n(22)),r=n(0),o=n(1873),s=n(1987),c=n(17);Object(c.n)([{rawString:".AllTagsHeader{position:relative;font-weight:100;white-space:nowrap;text-overflow:ellipsis}.xxlg .AllTagsHeader,.xxxlg .AllTagsHeader,.xxxxlg .AllTagsHeader{padding-top:22px;padding-bottom:12px;height:37px}.lg .AllTagsHeader,.md .AllTagsHeader,.sm .AllTagsHeader,.xlg .AllTagsHeader{padding-top:14px;height:28px}.AllTagsHeader-title,a.AllTagsHeader-regionLink{font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html[dir=ltr] .AllTagsHeader-title,html[dir=ltr] a.AllTagsHeader-regionLink{float:left}html[dir=rtl] .AllTagsHeader-title,html[dir=rtl] a.AllTagsHeader-regionLink{float:right}[dir=ltr] .AllTagsHeader-title,[dir=ltr] a.AllTagsHeader-regionLink{margin-right:8px}[dir=rtl] .AllTagsHeader-title,[dir=rtl] a.AllTagsHeader-regionLink{margin-left:8px}.xxlg .AllTagsHeader-title,.xxlg a.AllTagsHeader-regionLink,.xxxlg .AllTagsHeader-title,.xxxlg a.AllTagsHeader-regionLink,.xxxxlg .AllTagsHeader-title,.xxxxlg a.AllTagsHeader-regionLink{font-size:28px;font-weight:100}.lg .AllTagsHeader-title,.lg a.AllTagsHeader-regionLink,.md .AllTagsHeader-title,.md a.AllTagsHeader-regionLink,.sm .AllTagsHeader-title,.sm a.AllTagsHeader-regionLink,.xlg .AllTagsHeader-title,.xlg a.AllTagsHeader-regionLink{font-size:21px;font-weight:100}.AllTagsHeader-subText{position:absolute;display:inline;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.xxlg .AllTagsHeader-subText,.xxxlg .AllTagsHeader-subText,.xxxxlg .AllTagsHeader-subText{bottom:16px}.lg .AllTagsHeader-subText,.md .AllTagsHeader-subText,.sm .AllTagsHeader-subText,.xlg .AllTagsHeader-subText{bottom:2px}"}]);var d=n(388),l=function(e){function t(t){var n=e.call(this,t)||this;return n.header=t.group.tagHeader.title,n.subtext=t.group.tagHeader.countSubtitle,n.regionUrl=t.group.tagHeader.regionUrl,n}return Object(r.__extends)(t,e),t}(n(183).t),u=d.e({tagName:"ms-allTags-header",template:'<div class="AllTagsHeader"><div class="AllTagsHeader-title">\x3c!--ko if:regionUrl--\x3e<a class="AllTagsHeader-regionLink" data-bind="text:header,attr:{href:regionUrl}"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:regionUrl--\x3e<span data-bind="text:header"></span>\x3c!--/ko--\x3e</div><div class="AllTagsHeader-subText" data-bind="text:subtext"></div></div>',viewModel:l,synchronous:!0}),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getHeaderDetails=function(e){var t="",n={},a=20;if(e){var i=this.responsiveHelper,r=i.compareSize(i.formFactorSize.peek(),"XXLarge")>=0,o=r?37:28,s=r?22:14,c=r?12:0;t=u.tagName,n={group:e,cellsInGroup:0,resources:this.resources},a=o+s+c}return{viewType:t,viewData:n,headerHeight:a}},t}(s.e),p=f,m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.initialize(new(a.managed(p))(t)),a}return Object(r.__extends)(t,e),t}(o.e),_={tagName:n(977).f,template:a.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(m))(e,t)}},synchronous:!0};i.components.isRegistered(_.tagName)||i.components.register(_.tagName,_),t.default=_},1738:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true"),n}return Object(a.__extends)(t,e),t}(n(165).t);function r(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}return t&&t!==document.body||(t=window),t}t.e=i},1741:function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c});var a="MoveItemsOperation",i="CopyItemsOperation",r="MoveItemsOperationAsync",o="CopyItemsOperationAsync",s="CopyItems",c="MoveItems"},1759:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(165),o=n(1082),s=n(1086),c=n(1738),d=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a._focusTracker=a.resources.consume(s.e),a._hasFocus=a.createObservable(!1),a._hasChildFocus=a.createObservable(!1),a._isBodyActive=a.createObservable(!1),a._value=a.createPureComputed(a._computeValue),a._isEnabled=a.createPureComputed(a._computeIsEnabled),a._onlyRecoverFromBody=a.createPureComputed(a._computeOnlyRecoverFromBody),a._shouldRecoverFocus=a.createPureComputed(a._computeShouldRecoverFocus);var r=n.ChildFocusBinding,d=void 0===r?o.e:r,l=n.applyBindingsToNode,u=void 0===l?i.applyBindingsToNode:l,f=n.recoverFocusExtenders,p=void 0===f?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:f;return new(a.managed(d))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:a._hasChildFocus,isBodyActive:a._isBodyActive}}}),u(a.element,{hasFocus:a._hasFocus},a.bindingContext),a._scrollContainer=Object(c.t)(a.element),a.createBackgroundComputed(a._computeRecoverFocus).extend(p),a}return Object(a.__extends)(t,e),t.prototype._computeValue=function(){return this.valueAccessor()||{}},t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)},t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)},t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()},t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()},t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0),e.scrollTop!==t&&(e.scrollTop=t),e.scrollLeft!==n&&(e.scrollLeft=n)},t}(r.t);t.e=d},1766:function(e,t,n){"use strict";var a=n(1749);t.e=a.a},1772:function(e,t,n){"use strict";var a=n(0),i=(n(1784),n(22)),r=n(249),o=n(146),s=n(25),c=n(980),d=n(155),l=n(340),u=n(678),f=n(165),p=n(336),m=n(1068),_=n(1703),h=n(154),b=n(1079),g=function(e){function t(t){var n=e.call(this,t)||this;return n.events.on(n.element,"contextmenu",n._onContextMenu),new(n.managed(m.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{ShiftF10:function(e,t){return n._onContextMenu(t),!0}},preventDefault:!0,context:n.bindingContext.$data}}}),n}return Object(a.__extends)(t,e),t.createContextMenu=function(e,t,n,a){var r=null,s=t.anchorElement||Object(b.e)(e.target,t.rootElementClass);if(s&&t.items&&t.items.length>0){var c=void 0;if(t.anchorElement||e.clientX<=0&&e.clientY<=0||!e.clientX&&!e.clientY){var f=(t.anchorElement?t.anchorElement:e.target).getBoundingClientRect();c=new l.e(f.left,f.bottom)}else c=new l.e(e.clientX,e.clientY);var p=i.observable(c.x+"px"),m=i.observable(c.y+"px"),h=t.alignment||o.e.Left|o.e.Top;d.e.isRightToLeft&&(h|=o.e.Right);var g=null;if(t.boundingElementClass){var v=Object(b.e)(e.target,t.boundingElementClass);g=new u.e(v.getBoundingClientRect())}var y=document.createElement("div");y.style.position="absolute",y.style.top="0px",y.style.left="0px",r=y,document.body.appendChild(y),Object(_.e)(y,s),a||(a=function(){r&&(i.removeNode(r),r=null)});var S={component:{name:"ms-contextual-menu",params:{items:t.items,left:p,top:m,alignment:i.observable(h),offset:i.observable(t.point||l.e.ORIGIN),launchEvent:e,target:e.target,bounds:g,hideIcons:t.shouldHideIcons,fromKeyboardEvent:0===e.pointerId,anchorElement:t.anchorElement,close:t.dismissOnClick?a:null,isOpen:t.isMenuOpen}}};i.applyBindingsToNode(y,S,n)}return r},t.prototype._onContextMenu=function(e){var n=this,a=i.utils.unwrapObservable(this.valueAccessor()),o=(a&&a.resources||c.e(this.bindingContext)).consume(s.C.optional),d=function(){t._contextMenu&&(i.removeNode(t._contextMenu),t._contextMenu=null)};d();var l=e.target,u=null,f=null,p=null;if(r.e.hasClass(l,"noContextMenu")||e.shiftKey&&e instanceof MouseEvent||!a)return!0;for(var m=a.anchorElement||Object(b.e)(l,a.rootElementClass);u!==m;){var _=i.dataFor(l);if(_&&(!p&&_.item&&(p=_.item),p))break;if((f=l?l.getAttribute("data-selection-index"):null)&&(p=o&&o.getItemByIndex(f)))break;u=l,l=Object(h.e)(l)}var g=!1,v=i.dataFor(l);if(o&&v){var y=null===o.maximumSelectedCount||void 0===o.maximumSelectedCount||o.maximumSelectedCount>0;if(!p||!o.isItemSelected(p)&&y){if(o.selectedCount()>0?(o.clear(),g=!0):p&&(v.isSelected||f)&&(g=!0),g)var S=o.selection.subscribe(function(){S.dispose(),m&&n._openMenu(e,a,d)});p&&(v.isSelected||f)&&(o.toggleItemSelected(p),o.setItemFocus(p))}else p&&o.maximumSelectedCount<=0&&o.setItemFocus(p)}return!a||(m&&!g&&this._openMenu(e,a,d),e.preventDefault(),e.stopPropagation(),!1)},t.prototype._openMenu=function(e,n,a){n.engagementSource&&this.resources.consume(p.e).logData({name:"RightClick.".concat(n.engagementSource,".Click"),isIntentional:!0}),t._contextMenu&&(i.removeNode(t._contextMenu),t._contextMenu=null),t._contextMenu=t.createContextMenu(e,n,this.bindingContext,a)},t}(f.t);t.e=g},1775:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"o",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"s",function(){return y}),n.d(t,"c",function(){return S});var a=n(0),i=n(2),r=n(30),o=n(209),s=n(566),c=n(201),d=n(72),l=new r.e("photosConfigurationKeyFacet",{}),u=l.serialize({}),f=new i.e("PhotosAddonSource"),p=new i.e("photosEnableLastWeekPreviousYearsFacet"),m=new i.e("photosEnableNewDesignCarouselExpFacet"),_=new i.e("photosEnableGroupHeaderFacet"),h=new i.e("PhotosMaxPageSize"),b=new i.e("PhotosWidthsMaxPageSize"),g=new i.e("PhotosInitialBurstSize"),v=new i.e("usePhotoPaging"),y=new i.e("PhotosTargetHeight");function S(e){return function(t){var n,i,r;t(Object(o.t)({keyFacet:l,facets:[]}));var p=e.initialBurstSize||0,m=e.widthsPageSize||1e3,_=e.targetHeight||1e3;t(Object(o.e)({items:(n={},n[u]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f.pack(e.addonSource)),h.pack(e.pageSize)),g.pack(p)),b.pack(m)),y.pack(_)),n)})),t(Object(o.e)({items:(i={},i[c.e]=Object(a.__assign)({},d.r.pack({reportRUMOnePerfData:!1,logRenderEndTime:e.logRumOneData,scenarioId:"ODC.AllPhotos-Photos"})),i)})),t(Object(s.t)({items:(r={},r[u]={},r)}))}}},1778:function(e,t,n){"use strict";n.d(t,"n",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"a",function(){return v});var a=n(1085),i=n(362),r=n(42),o=n(1780),s=n(1951),c=n(1982),d=n(36),l=n(94),u=n(251),f=n(1840),p=n(1819),m=n(1766);function _(e,t){switch(e.queryType){case d.e.Recent:return function(e){var t=[],n=b(e)||e.name;n&&t.push(n);var a=e.displayPath;if(a){var i=a.segments.join(" ".concat(s.s," "));t.push("".concat(s.o,": ").concat(i))}var r=e.dateAccessed;return r&&t.push("".concat(c.n," ").concat(r)),t.join(", ")||void 0}(e);case d.e.Files:default:return function(e,t){var n=[],a=b(e)||e.name,c=function(e){return!e.dateDeleted||e.queryType!==d.e.RecycleBin&&e.queryType!==d.e.SecondStageRecycleBin?e.dateModified?r.format(u.dateModifiedLabelFormat,e.dateModified):void 0:r.format(u.dateDeletedLabelFormat,e.dateDeleted)}(e)||e.dateModified,l=e.defaultSubText,m=e.size,_=Object(f.e)(e.lifeCycleStatus);if(a&&n.push(a),_>0&&n.push(function(e){var t;return((t={})[3]=s.d,t[2]=s.i,t[4]=s.a,t[1]=s.n,t)[e]||""}(_)),c&&n.push(c),l&&n.push(l),e.queryType===d.e.RecycleBin||e.queryType===d.e.SecondStageRecycleBin){var h=function(e){return e.recycleBinProperties?r.format(u.deletedByLabelFormat,e.recycleBinProperties.deletedByName):void 0}(e),g=function(e){return e.creatorName?r.format(u.createdByLabelFormat,e.creatorName):void 0}(e),v=function(e){return e.recycleBinProperties?r.format(u.originalLocationLabelFormat,e.recycleBinProperties.directory):void 0}(e);h&&n.push(h),g&&n.push(g),v&&n.push(v)}if(m&&n.push(i.e.getDisplayString(m,{ignoreZero:!0})),e.folder){var y=e.folder.totalCount,S=void 0===y?e.childCount:y;n.push(r.format(r.getLocalizedCountValue(u.itemCountFormat,u.itemCountIntervals,S),S))}if(e.sharingType===p.e.Shared?n.push(s.c):e.sharingType!==p.e.Unknown&&n.push(s.r),o.i(e)){var D=o.s();n.push(D)}return n.join(", ")||void 0}(e)}}function h(e){var t=e.extension,n=[];if(e.type===l.e.Folder)n.push(a.n(e.sharingType)?u.fileTypeSharedFolder:u.fileTypeFolder);else{var i=e.appMap;if(i){var o=i.toLowerCase();-1!==o.indexOf("ms-word")?n.push(u.fileTypeDoc):-1!==o.indexOf("ms-excel")?n.push(u.fileTypeXls):-1!==o.indexOf("ms-powerpoint")?n.push(u.fileTypePpt):-1!==o.indexOf("onenote")&&n.push(u.fileTypeOneNotebook)}else if(e.type===l.e.Media&&e.photo)n.push(r.format(u.fileTypeImage,t||"").trim());else if(t){var s="."===t[0]?t.substring(1):t;n.push(r.format(u.fileTypeUnknown,s))}else e.type===l.e.App&&e.properties&&e.properties.appTypeString?n.push(r.format(c.t,e.properties.appTypeString)):e.type===l.e.Subsite&&e.name&&n.push(r.format(c.t,e.name));var d=g(e);d&&n.push(d)}return n.join(", ")}function b(e){var t=[],n=h(e);return t.push(e.name),n&&t.push(n),t.join(", ")}function g(e){var t=[];if(e.itemStatus?t.push(u.sharedViolationWarningViewer):e.isViolation&&t.push(u.sharedViolationWarning),e.policyTip&&(e.policyTip&m.e.block?t.push(u.policyTipBlockText):e.policyTip===m.e.notify&&t.push(u.policyTipNotifyText)),e.hasMissingMetadata&&t.push(u.missingMetadataText),o.i(e)){var n=o.s();t.push(n)}var a=e.properties.CheckoutUser,i=(void 0===a?[]:a)[0],s=(void 0===i?{}:i).title,c=void 0===s?void 0:s;return c&&t.push(r.format(u.checkedOutTo,c)),t.join(" ")}function v(){return u.toggleSelection}},1780:function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"l",function(){return u}),n.d(t,"u",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"s",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return v});var a=n(1980),i=n(42),r=n(1981),o=n(11),s="_ComplianceTag",c="ComplianceAssetId",d="_ComplianceFlags",l=200;function u(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}function f(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(256&e)}function m(e){return h(e)?a.t:a.e}function _(e){return!!(e.properties.hasOwnProperty("_ComplianceFlags")&&4&+e.properties._ComplianceFlags)}function h(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(Object(o.isFeatureEnabled)(o.IPRecordVersioningClient)){if(4&t||256&t)return!0}else if(4&t&&1&t)return!0}return!1}function b(){return r.RecordLabelHoverText}function g(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?r.RetainForeverText:" ";var t=y(e.TagDuration);return e.BlockDelete?i.format(r.PreserveTagText,t):e.AutoDelete?i.format(r.DeleteTagText,t):" "}function v(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return r.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?r.PreserveForeverTooltip:r.NoRetentionTooltip;var t=y(e.TagDuration),n="",a="";e.BlockDelete?(n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip",e.BlockEdit&&(a=r.PreserveIsRecordTooltipModifier),e.ReviewerEmail?a+=r.ReviewTooltip:a+=e.AutoDelete?r.PreserveAutoDeleteTooltipModifier:r.PreserveNoDeleteTooltipModifier):e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=r[n];return o?i.format(o,t)+a:null}function y(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var a=n>1?r.RetentionPeriodYears:r.RetentionPeriodYear;t=i.format(a,n)}else{var o=Math.floor(e/30);if(o>0){var s=o>1?r.RetentionPeriodMonths:r.RetentionPeriodMonth;t=i.format(s,o)}else{var c=e>1?r.RetentionPeriodDays:r.RetentionPeriodDay;t=i.format(c,e)}}}return t}},1784:function(e,t,n){"use strict";var a=n(60),i=n(22),r=n(1077),o=Object(r.e)("ms-contextual-menu","./react/ReactContextualMenu",function(){return a.n.resolve(n.e(144).then(n.bind(null,4315)))});o.template='\x3c!--ko component:{name:\'od-overlay\',params:{alignToParent:false}}--\x3e<div role="application" data-bind="react:reactBindingParams"></div>\x3c!--/ko--\x3e',i.components.isRegistered(o.tagName)||i.components.register(o.tagName,o)},1785:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(56),r=n(104),o=n(64),s=n(128),c=n(61),d=n(62),l=n(1765),u=n(11),f=n(1271),p=n(12),m=n(60);function _(e,t){return e.preferences[(t||"").toLowerCase()]}function h(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function b(e,t,n,i){var r=_(e,t);if(r)for(var o=0,s=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.preview,!0),r.open,!0).filter(g);o<s.length;o++){var c=s[o],d=n&&c[n]||i&&c.handler[i];if(d)return d}}function g(e){return!e.handler.isPromoted}function v(e){return e.filter(g)[0]}var y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,s=Object(u.isFeatureEnabled)(u.FileHandlersV2),l="data",_=new r.e("FileHandlers",o.e.session);if(s)try{var h=_.getValue(l);a=h&&JSON.parse(h)}catch(e){}var b=i.observables,g=i.data=b.create(a);return g.equalityComparer=f.e,a&&4===a.version&&s||(g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4}),_.setValue(l,JSON.stringify(g.peek()))),s&&b.backgroundCompute(function(){i.trackPromise(m.n.resolve(i.resources.consumeAsync(c._.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(c.m.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){e&&(_.setValue(l,JSON.stringify(e)),g(e))},function(e){d.e.logError(e)}))}),i}return Object(a.__extends)(t,e),t.prototype.getFileTypeIconUrl=function(e,t){return h(e)?this.getIconUrl(b(this._getData(t),e||"","icon","fileTypeIcon")):void 0},t.prototype.getFileTypeName=function(e,t){return h(e)?b(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0},t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)},t.prototype.getDefaultOpenHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.open)},t.prototype.getDefaultPreviewHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.preview)},t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,a=n&&n.extensions;return!!n&&(!a||a.indexOf(t.toLowerCase())>=0||a.indexOf(".*")>=0)},t.prototype._getData=function(e){return e?this.data.peek():this.data()},t}(i.n),S=Object(s.r)("FileHandlerProvider",y)},1793:function(e,t,n){"use strict";n.d(t,"t",function(){return m});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(17);Object(i.n)([{rawString:".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:nth-child(1){animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(1){margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(1){margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"}]);var r=n(0),o=n(183),s=n(61),c=n(1895),d=n(211),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(d.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=c.e,a}return Object(r.__extends)(t,e),t.resources=Object(r.__assign)(Object(r.__assign)({},o.t.dependencies),{platformDetection:d.e,settingsDataSource:s.se}),t}(o.t),u=n(388),f=n(166),p=Object(u.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:l,synchronous:!0}),m=Object(f.t)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:l});t.e=p},1801:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}]);var i=n(388),r=n(1863),o=Object(i.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:r.t,synchronous:!0});t.e=o},1813:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative;overflow:hidden}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])},1816:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s});var a=n(2),i=new a.e("allGroupToCountsFacet"),r=new a.e("allGroupToCountsPointerFacet"),o=new a.e("AllPhotosTotalCount"),s=new a.e("allGroupToStartFacet")},1821:function(e,t,n){"use strict";var a=n(0),i=n(165),r=n(156),o=n(101),s=new r.e,c=new o.t(window),d=0,l=[],u={};function f(){for(var e in u)m(u[e])}function p(){for(;l.length;){var e=l.pop();e.isDisposed||(u[e.id]=e,m(e))}}function m(e){if(void 0!==e.element.getBoundingClientRect){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width}),e.isOnScreen&&e.isOnScreen(n)}}c.onAll(window,{resize:s.debounce(f,50),scroll:s.throttle(f,50,{leading:!1})}),c.on(document,"transitionend",s.debounce(f,300),!0);var _=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i={id:d++,element:n.element,isDisposed:!1,size:a.size,isOnScreen:a.isOnScreen,allowHiddenSizeUpdates:a.allowHiddenSizeUpdates,includePosition:!!a.includePosition};return a.trigger&&n.createComputed(function(){a.trigger(),m(i)}),l.push(i),s.setTimeout(p,0),n.addDisposable({dispose:function(){i.isDisposed=!0,delete u[i.id]}}),n}return Object(a.__extends)(t,e),t}(i.t);t.e=_},1823:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".List{position:relative;display:block}.List .List-surface{position:relative;min-height:1px}.List .List-surface:focus{outline:0}.List .List-page{position:relative}.List .List-cell{position:absolute;display:inline-block}.List .List-placeHolder{width:1px;position:absolute;visibility:hidden}"}])},1824:function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(1803),o=n(1785),s=function(e){function t(t){var n=e.call(this,t)||this,a=t.iconFieldAriaLabel,i=void 0===a?"":a,s=t.iconName,c=t.extension,d=t.item,l=t.desiredSize||16;n.hoverText=t.hoverText,n.onClick=t.onClick;var u=n,f=u.observables,p=u.resources,m=f.create(""),_=f.create(i);if(t.iconUrl)m(t.iconUrl);else if(s){var h=t.iconSize||l,b=r.e(p,s,h);if(m(b),c){var g=p.consume(o.e.optional);g&&f.backgroundCompute(function(){m(g.getFileTypeIconUrl(c)||b),_(g.getFileTypeName(c)||i)})}var v=r.a(p,h,d);v&&m(v)}var y=t.desiredSizeRem?"rem":"px",S=t.desiredSizeRem?t.desiredSizeRem:l;return n.size="".concat(m.peek()?S:0).concat(y),n.iconUrl=m,n.iconFieldAriaLabel=_,t.overlayType?n.overlayUrl=window.require.toUrl("odsp-media/images/overlays/".concat(t.overlayType.toLowerCase())):n.overlayUrl="",n}return Object(a.__extends)(t,e),t}(i.t);t.e=s},1825:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(56),i=new(n(8).t)({name:"".concat("Selection.key",".hasSelection"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.createCallback({defaultValue:!1,reducer:function(e,t){return e||t}}),disposable:t}}}})},1829:function(e,t,n){"use strict";var a=n(0),i=n(165),r=n(1738),o=function(e){function t(t){var n,a,i=e.call(this,t)||this,r=i.valueAccessor();return a=(n=i.isObservable(r)?{hasFocus:r}:r).focusState?n.focusState:n.hasFocus?i.createComputed({read:function(){return n.hasFocus()?2:0},write:function(e){return n.hasFocus(!!e)},pure:!0}):i.createObservable(0),i._focusState=a,i._asyncUpdateFocus=i.async.debounce(i._updateFocus,30),i.events.on(i.element,"focus",i._onFocus),i.events.on(i.element,"blur",i._onBlur),i.subscribe(i._focusState,i._onFocusStateChanged),n.timeout?i.async.setTimeout(i._startUpdateFocus,n.timeout):i._startUpdateFocus(),i}return Object(a.__extends)(t,e),t.prototype._onFocus=function(){this._focusState(2),this._startUpdateFocus()},t.prototype._onBlur=function(){this._focusState(0),this._startUpdateFocus()},t.prototype._onFocusStateChanged=function(){this._startUpdateFocus()},t.prototype._startUpdateFocus=function(){this._focusAttempts=0,this._updateFocus()},t.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=Object(r.t)(this.element),n=void 0,a=void 0;t&&(n=t.scrollTop,a=t.scrollLeft),this.element.focus(),t&&1===e&&(t.scrollTop!==n&&(t.scrollTop=n),t.scrollLeft!==a&&(t.scrollLeft=a)),!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()},t.prototype._checkIfFocused=function(){var e,t=this.element.ownerDocument;try{e=t.activeElement}catch(n){e=t.body}return e===this.element},t}(i.t);t.e=o},1830:function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(0),i=n(56),r=n(60),o=n(94),s=n(52),c=n(29),d=n(36),l=n(1089),u=n(61),f=n(1903),p=n(1865),m=n(62),_=n(1382),h=n(116),b=n(1871),g=n(76),v=n(336),y=n(25),S=n(1740),D=n(128),I=function(){function e(e,t){this._itemProvider=t.itemProvider}return e.prototype.updateItemSetPostUpload=function(e,t,n){if(e&&t&&t.length>0){var a=e.item.peek().key,i=this._itemProvider.computeProjectedItemSet(a+"&state=postUpload",e,{parentKey:a,itemSetProjections:{PostUpload:{uploadedItems:t,group:n}}},!0);i&&e.content({groupings:i.content.peek().groupings,items:i.content.peek().items})}},e}(),x=Object(D.r)("PostUploadProjectionHelper",I,{itemProvider:S.resourceKey}),C=n(8),O=n(1747),w=n(1504),E=!n(12).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),A=new C.t({name:"".concat("DropHelper",".updateItemMetadataOperator"),loader:new D.t(function(){return r.n.resolve(n.e(279).then(n.bind(null,4069))).then(function(e){return e.typeResourceKey})})}),L=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,a._shortcutProvider=n.shortcutProvider,a._currentItemSet=n.currentItemSet,a._engagement=n.engagement,a._postUploadProjectionHelper=n.postUploadProjectionHelper,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._wip=n.wip,a._quotaBlockAction=new(a.managed(n.actionMap.QuotaBlockAction))({isDragAndDrop:!0}),a}return Object(a.__extends)(t,e),t.prototype.processDrop=function(e,t,n,a){var i=this;if(void 0===n&&(n=!1),void 0===a&&(a=!1),!t||!t.isDropEnabled||t===e.item||this._wip&&this._wip.isWIPEnabled())return!1;var b=this._engagement;if(0===e.type){if(b.logData({name:"DragAndDropEvent",isIntentional:!0}),this._quotaBlockAction.isAvailable.peek())return this._quotaBlockAction.execute(null),!1;var v=this._currentItemSet.peek();return r.n.resolve(this.resources.consumeAsync(f.e)).then(function(a){var r=new a({files:e.files,parentItem:t,itemSet:v,wasDragAndDropped:!0,type:e.uploadType,metadata:e.metadata,skipInvalidation:!!n});return i.trackPromise(r.start()),r.wait()}).done(null,function(e){m.e.log(e)}),!0}if(1===e.type){var y=e.metadata&&e.metadata.group;return y?(this._resolveSelection(e).then(function(f){var p=new l.e({name:"DragChangeGroup",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]}),b=[];n&&f.forEach(function(e){var t=_.e(e);if(!a){var n=h.e(t.key);n.group=y.groupingId,t.key=h.n(n)}t.state.upload.status=1,t.properties[y.fieldSchema.Name]=y.groupingId,b.push(i.createObservable(t)),e.state.removing=!0}),r.n.resolve(i.resources.consumeAsync(A)).then(function(a){var o=new a({items:f,metadata:e.metadata,parentItem:t,skipInvalidation:n,onComplete:function(t){t?(n&&i._postUploadProjectionHelper.updateItemSetPostUpload(e.itemSet,b,y),i._isItemsScopeEnabled()&&y.itemKey&&r.n.resolve(i.resources.consumeAsync(u.k)).then(function(e){e.invalidateGroups([y.itemKey])})):alert("failure updating metadata")}});return i.trackPromise(o.start()),o.wait()}).done(void 0,function(e){return m.e.log(e)});var g={},v={count:f.length};if(1===f.length){g.fileType=o.e[f[0].type];var S=E&&f[0].extension?Object(w.e)(f[0].extension):f[0].extension||"";g.extension=S}p.end({resultType:s.e.Success,extraData:g,extraMetrics:v})}).done(null,function(e){return m.e.log(e)}),!0):e.itemSet.item.peek().key!==t.key&&(this._resolveSelection(e).then(function(n){n=n.filter(function(e){return e!==t});var a=new l.e({name:"DragMove",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]});return i.resources.consumeAsync(p.e).then(function(a){return a.copyItems({items:n,parentKey:e.item.parentKey,targetId:t.id,targetKey:t.key,cid:i._urlDataSource.getOwnerId(),group:t.isGroup?1:0,isAsync:!1,isMove:!0})}).then(function(){var e={},r={count:n.length};if(i._isItemsScopeEnabled()&&i.resources.consumeAsync(u.k).then(function(e){e.invalidateItems(t.key)}),1===n.length){e.fileType=o.e[n[0].type];var c=E&&n[0].extension?Object(w.e)(n[0].extension):n[0].extension||"";e.extension=c}a.end({resultType:s.e.Success,extraData:e,extraMetrics:r})},function(){a.end({resultType:s.e.Failure})})}).done(null,function(e){return m.e.log(e)}),!0)}if(3===e.type&&this._shortcutProvider){b.logData({name:"Link.DragAndDrop.Drop",isIntentional:!0});var S=e.links.split("\n");return(S=S.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var n=new g.t(e).getHost()+".url";i._shortcutProvider.createShortcut(t.key,n,e)}),!0}},t.prototype._resolveSelection=function(e){return e.selection?e.selection.resolve().then(function(t){return t&&0!==t.length||(t=[e.item]),t}):r.n.wrap([e.item])},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{shortcutProvider:b.e.optional,urlDataSource:u.ye,wip:u.Ee.optional,actionMap:y.e,currentItemSet:y.o,postUploadProjectionHelper:x,engagement:v.e,isItemsScopeEnabled:O.u.lazy}),t}(i.n),k=Object(D.r)("DropHelper",L)},1836:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor();n._isDragging=a.isDragging,n._mayReceiveDrop=a.mayReceiveDrop,n._receiveDrop=a.receiveDrop;var i=n.observables;return n._state=i.create({isWithinElement:!1,data:void 0}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),n._isDragging&&i.compute(function(){n._isDragging.call(n.bindingContext.$data,n._state().isWithinElement,n._state().data)}),n.events.onAll(n.element,{"od-dragEnter":n._onDragEnter,"od-dragLeave":n._onDragLeave,"od-processDrop":n._onProcessDrop,"od-dragOutWindow":n._onDragOutWindow}),n}return Object(a.__extends)(t,e),t.prototype._onDragEnter=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(this._state({isWithinElement:!0,data:{dragData:t.dragData,dropTargetData:t.dropTargetData}}),!t.dropTargetData&&this._mayReceiveDrop&&(t.dropTargetData=this._mayReceiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)),0))},t.prototype._onDragLeave=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t.prototype._onProcessDrop=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(!t.isHandled&&this._receiveDrop&&this._receiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)?(t.isHandled=!0,1):(this._state({isWithinElement:!1,data:void 0}),0)))},t.prototype._onDragOutWindow=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t}(n(165).t);t.e=i},1837:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'@charset "UTF-8";@keyframes fadeAndScale{0%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0;animation-timing-function:ease-out}25%{transform:translate(-50%,-50%) scale(1,1);opacity:1}75%{transform:translate(-50%,-50%) scale(1,1);opacity:1;animation-timing-function:ease-in}100%{transform:translate(-50%,-50%) scale(.85,.85);opacity:0}}@keyframes ItemScope-NewTile{0%{transform:scale(.85);opacity:0}100%{transform:scale(1);opacity:100%}}.ItemTile{position:absolute;left:0;right:0;top:0;bottom:0;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;animation-duration:267ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-iteration-count:1;animation-name:ItemScope-NewTile}@media screen and (-ms-high-contrast:active){.ItemTile{border:1px solid '},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.ItemTile .ItemTile-link{top:0;left:0;bottom:0;right:0;position:absolute}.ItemTile:focus{outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile:focus{outline:0}}.od--isNonMobile .ItemTile{transition:transform .1s linear}.od--isNonMobile .ItemTile:active{transform:scale(.96)}.ItemTile-entity-container{display:inline}.ItemTile-entity{border-radius:50%;overflow:hidden;height:34px;width:34px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;max-width:20%}html[dir=ltr] .ItemTile-entity{float:left}html[dir=rtl] .ItemTile-entity{float:right}.ItemTile-longText{margin-left:10px;max-width:60%;display:inline-flex;white-space:pre-wrap}.ItemTile-image{position:absolute;top:0;left:0;right:0;bottom:0}.ItemTile-dragDropIcon{position:absolute;top:8px;right:2px;bottom:0;left:2px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";opacity:0;transform:translateY(100%)}.ItemTile-folderOverlay{position:absolute;display:inline-block;top:50%;left:50%;transform:translate(-50%,-50%);width:92px;height:92px}.ItemTile-photo{position:absolute;top:0;left:0;bottom:0;right:0}.ItemTile.is-file,.ItemTile.is-media{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.ItemTile.is-file .od-ImageStack-tile,.ItemTile.is-folder .od-ImageStack-tile,.ItemTile.is-media .od-ImageStack-tile{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.ItemTile.is-file .ItemTile-fileContainer{border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.ItemTile.is-file .ItemTile-fileContainer{border:0}}.ItemTile.is-file .od-ImageStack-tile img{box-shadow:0 0 8px 0 rgba(0,0,0,.06)}.ItemTile.is-media .od-ImageFrame::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.ItemTile-fileContainer{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";position:absolute;left:0;right:0;top:0;bottom:0}.ItemTile-fileIconContainer{position:absolute;top:0;bottom:50px;left:0;right:0}.ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{margin:0;top:auto;bottom:0;padding:4px}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:auto}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:auto}[dir=ltr] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{left:0}[dir=rtl] .ItemTile.is-file.has-thumbnail .ItemTile-fileIcon{right:0}.ItemTile-fileIcon{text-align:center}.ItemTile-fileIcon--thumbnail{position:absolute;top:50%;left:0;right:0;margin:-48px}.ItemTile-fileIcon--noThumbnail{position:relative;text-align:center;margin-top:14px}.ItemTile-rowCheck{display:none;position:absolute;top:0;width:100%;height:100%;opacity:0}[dir=ltr] .ItemTile-rowCheck{right:0}[dir=rtl] .ItemTile-rowCheck{left:0}.od-ItemTile--isInvokable .ItemTile-rowCheck{width:40px;height:40px}.is-checkVisible .ItemTile-rowCheck{opacity:1}.ItemTile.is-folder .ItemTile-rowCheck{top:6px}[dir=ltr] .ItemTile.is-folder .ItemTile-rowCheck{right:-1px}[dir=rtl] .ItemTile.is-folder .ItemTile-rowCheck{left:-1px}.ItemTile.is-folder.is-dropping .ItemTile-rowCheck,.ItemTile.is-folder.is-receivingDrop .ItemTile-rowCheck{opacity:0}.can-select .ItemTile-rowCheck{display:block}.od--isNonMobile .ItemTile.can-select:hover,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover{opacity:1}.ItemTile.is-selected .ItemTile-rowCheck,.od--isNonMobile .ItemTile:hover .ItemTile-rowCheck{opacity:1}.od-ItemTile-selector{display:none}.od-ItemTile--isInteractable .od-ItemTile-selector{display:block}.ItemTile-frame{position:absolute;display:none;left:2px;top:2px;right:2px;bottom:2px;box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.ItemTile-frame{outline:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ItemTile-frame{outline:2px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-ItemTile--hasImageStack .ItemTile-frame{top:8px}@media screen and (-ms-high-contrast:active){.od-ItemTile--hasImageStack .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-tag .ItemTile-frame{top:2px}.od--isNonMobile .ItemTile.can-select:hover .ItemTile-frame,.od--isNonMobile .ItemTile.od-ItemTile--isInvokable:hover .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{display:block}.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{display:block;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 0 2px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-focus--enabled .ItemTile.is-focused .ItemTile-frame{top:2px}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{transform:translateY(0);animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-dropping .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";top:50%;left:50%;transform:translate(-50%,-50%)}.ItemTile .ItemCheck{position:absolute;top:8px}[dir=ltr] .ItemTile .ItemCheck{right:8px}[dir=rtl] .ItemTile .ItemCheck{left:8px}.ItemTile-namePlate{position:absolute;bottom:0;left:0;right:0;min-height:20px;padding:4px 8px 8px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:nowrap;text-overflow:ellipsis}.ItemTile.is-file .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:35px}.ItemTile.is-media .ItemTile-namePlate{opacity:.95;border-top:1px solid rgba(255,255,255,.2);min-height:17px}.ItemTile.is-folder .ItemTile-namePlate{background-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid rgba(255,255,255,.2);transition:transform 367ms cubic-bezier(.1,.9,.2,1)}.ItemTile.is-folder .ItemTile-namePlate::before{content:'';position:absolute;width:32%;height:16px;border-top:1px solid rgba(255,255,255,.2);top:-16px;background-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';overflow:hidden}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{padding-left:1px}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{padding-right:1px}[dir=ltr] .ItemTile.is-folder .ItemTile-namePlate::before{right:0}[dir=rtl] .ItemTile.is-folder .ItemTile-namePlate::before{left:0}.ItemTile.is-folder.is-dropping .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-namePlate{transform:translate3d(0,28px,0)}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{transform:translateY(0);opacity:1;animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:1.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:28px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:';top:50%;left:50%;transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:after{animation:none}}.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{position:absolute;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FabricMDL2Icons;display:inline-block;content:"";font-size:42px;color:'},{theme:"green",defaultValue:"#107c10"},{rawString:";top:50%;left:50%;transform:translate(-50%,-50%);opacity:1;animation-name:fadeAndScale;animation-duration:.85s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.25s}@media (prefers-reduced-motion:reduce){.ItemTile.is-folder.is-receivingDrop .ItemTile-dragDropIcon:before{animation:none}}.ItemTile-nameCover{background-color:rgba(0,0,0,.25);position:absolute;font-weight:600;text-shadow:0 0 8px #000;top:0;width:100%;height:100%}[dir=ltr] .ItemTile-nameCover{left:0}[dir=rtl] .ItemTile-nameCover{right:0}.ItemTile-tagText{position:relative;text-align:center;color:#fff;top:50%;left:50%;transform:translate(-50%,-50%);padding:0 8px}.ItemTile-folderBeak,.ItemTile-folderBeakHighlight{position:absolute;top:-16px;overflow:hidden}[dir=ltr] .ItemTile-folderBeak,[dir=ltr] .ItemTile-folderBeakHighlight{right:32%}[dir=rtl] .ItemTile-folderBeak,[dir=rtl] .ItemTile-folderBeakHighlight{left:32%}.ItemTile-folderBeak::before{content:'';position:absolute;top:1px;width:20px;height:30px;background-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";transform-origin:top left;transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeak::before{right:-19px}[dir=rtl] .ItemTile-folderBeak::before{left:-19px}.ItemTile-folderBeak{width:18px;height:18px}.ItemTile-folderBeakHighlight{width:16px;height:16px}.ItemTile-folderBeakHighlight::before{content:'';position:absolute;top:0;width:1px;height:30px;background-color:rgba(255,255,255,.2);transform-origin:top left;transform:rotate(40deg)}[dir=ltr] .ItemTile-folderBeakHighlight::before{right:0}[dir=rtl] .ItemTile-folderBeakHighlight::before{left:0}html[dir=rtl] .ItemTile-folderBeak::before,html[dir=rtl] .ItemTile-folderBeakHighlight::before{transform-origin:top right;transform:rotate(-40deg)}.ItemTile-childCount,.ItemTile-name,.ItemTile-subText{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ItemTile-name{font-size:15px;line-height:20px}.ItemTile.is-tag .ItemTile-name{max-height:4.1em;font-weight:400;font-size:17px;white-space:normal;text-overflow:normal;word-wrap:break-word;line-height:23px;padding-bottom:4px}.ItemTile-tagCount{font-weight:600;font-size:12px;line-height:10px;opacity:.85}.ItemTile-sharingIcon{font-size:15px}.ItemTile.is-folder .ItemTile-sharingIcon{line-height:20px}html[dir=ltr] .ItemTile.is-folder .ItemTile-sharingIcon{float:right}html[dir=rtl] .ItemTile.is-folder .ItemTile-sharingIcon{float:left}.ItemTile.is-folder .ItemTile-subText .ItemTile-sharingIcon{float:inherit!important;line-height:1}.ItemTile-childCount{position:absolute;top:-14px;padding:0 3px;font-size:11px}[dir=ltr] .ItemTile-childCount{left:68%}[dir=rtl] .ItemTile-childCount{right:68%}.ItemTile.is-file .ItemTile-subText{font-size:11px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.ItemTile.is-folder .ItemTile-subText{font-size:11px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.7}.ItemTile-subTextImage{width:14px;height:14px}[dir=ltr] .ItemTile-subTextImage{margin-right:4px}[dir=rtl] .ItemTile-subTextImage{margin-left:4px}.ItemTile-subTextImageShort{width:12px;height:12px}[dir=ltr] .ItemTile-subTextImageShort{margin-right:4px}[dir=rtl] .ItemTile-subTextImageShort{margin-left:4px}.ItemTile-subTextIcon{font-size:14px;position:relative;top:2px}[dir=ltr] .ItemTile-subTextIcon{margin-right:4px}[dir=rtl] .ItemTile-subTextIcon{margin-left:4px}.ItemTile-subTextIcon.ms-Icon.ms-Icon--IncidentTriangle{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}.ItemTile-blockIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeak,.ItemTile.od-ItemTile--isAlbum .ItemTile-folderBeakHighlight{display:none}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{font-size:12px;position:absolute;bottom:24px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate{height:50%;background:linear-gradient(0deg,rgba(0,0,0,.58),rgba(0,0,0,0));color:#fff;left:2px;right:2px}.ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{top:auto;bottom:10px;padding:0;font-size:10px;color:rgba(255,255,255,.8)}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:10px;right:10px}.ItemTile.od-ItemTile--isAlbum .ItemTile-frame{top:8px}.ItemTile.od-ItemTile--isAlbum .ItemTile-rowCheck{top:6px}.ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,.ItemTile.od-ItemTile--isAlbum .ItemTile-subText{position:absolute;bottom:10px}[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=ltr] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{right:10px}[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-namePlate>.ItemTile-sharingIcon,[dir=rtl] .ItemTile.od-ItemTile--isAlbum .ItemTile-subText{left:10px}.ItemTile.od-ItemTile--isStory .ItemTile-name{font-size:21px;font-weight:100;text-shadow:0 0 8px #000;bottom:28px;line-height:31px;left:12px;right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-name{left:20px;right:20px;bottom:40px}.ItemTile.od-ItemTile--isStory .ItemTile-date{display:block;position:absolute;top:auto;bottom:12px;font-size:14px;text-shadow:0 0 8px #000}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-date{left:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-date{right:12px}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{left:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-date{right:20px}.ItemTile.od-ItemTile--isStory .ItemTile-childCount{font-size:14px;text-shadow:0 0 8px #000;bottom:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:12px}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:12px}[dir=ltr] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:auto}[dir=rtl] .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:auto}.xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,.xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{bottom:20px}[dir=ltr] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=ltr] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{right:20px}[dir=rtl] .xlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount,[dir=rtl] .xxxxlg .ItemTile.od-ItemTile--isStory .ItemTile-childCount{left:20px}.ItemTile-newBadge{position:absolute;bottom:45px}[dir=ltr] .ItemTile-newBadge{left:1px}[dir=rtl] .ItemTile-newBadge{right:1px}.ItemTile-newBadge .od-newBadge{position:relative}[dir=ltr] .ItemTile-newBadge .od-newBadge{left:10px}[dir=rtl] .ItemTile-newBadge .od-newBadge{right:10px}.od-ItemTile--isVideo .ItemTile-fileIconContainer{bottom:0}.od-ItemTile--isVideo .ItemTile-namePlate{display:none}.ItemTile-playButton{position:absolute;color:#fff;bottom:8px;font-size:1.3em}[dir=ltr] .ItemTile-playButton{left:4px}[dir=rtl] .ItemTile-playButton{right:4px}html[dir=ltr] .ItemTile-viewerCount{float:right}html[dir=rtl] .ItemTile-viewerCount{float:left}.od-ItemTile-card{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ItemTile-date{display:none}.od-ItemTile--color-oneDrive.ItemTile.is-folder.is-dropping .ItemTile-frame{box-shadow:0 0 0 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive.is-folder .ItemTile-namePlate:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile--color-oneDrive .ItemTile-folderBeak:before{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemTile-button{position:absolute;top:15px;z-index:1;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8;text-shadow:0 1px 1px #000;border:0;padding:4px;visibility:hidden;background-color:transparent}[dir=ltr] .od-ItemTile-button{right:10px}[dir=rtl] .od-ItemTile-button{left:10px}.od-ItemTile-button:hover{cursor:pointer;background-color:#000;opacity:.3}.ItemTile:hover .od-ItemTile-button{visibility:visible}.od-ItemTile-button .od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:block}"}]),n(1916),n(1843);var i=n(0),r=n(183),o=n(94),s=n(1783),c=n(25),d=n(1744),l=n(1830),u=n(1271),f=n(1085),p=n(61),m=n(362),_=n(1766),h=n(36),b=n(1794),g=n(95),v=n(60),y=n(1829),S=n(1836),D=n(11),I=n(1801),x=n(1945),C=n(1778),O=n(211),w=n(1079),E=n(981),A=n(570),L=n(1845),k=n(155),M=n(52),P=n(1070),T=n(31),U=n(1870),F=n(810),H=n(1874),R=new L.e("ItemTile",L.t.component),N=function(e){function t(t){var n=e.call(this,t)||this;n.imageFrameTagName=I.e.tagName,n.newBadgeTagName=x.e.tagName,n.itemCheckTagName=U.e.tagName,n.addBindingHandlers({delayedHasFocus:y.e,element:P.e,react:A.t,dragAndDrop:S.e});var a=t.item,i=t.customTemplateName,r=void 0===i?"":i,o=t.cellSize,s=void 0===o?n.createObservable({width:100,height:100}):o,f=t.engagementSource,m=void 0===f?"ItemTile":f,_=t.isInteractable,h=void 0===_||_,v=t.button,C=t.group;n._selectionHelper=n.resources.consume(E.t),n.inputElement=n.createObservable(),n._urlDataSource=n.resources.consume(p.ye),n._displayImageTileNames=!!n.resources.isExposed(c.p)&&n.resources.consume(c.p),n.parentItem=n.resources.consume(c.r),n.resources.consume(d.e.isSPLightSpeed.optional)?n.item=n.wrapObservable(a):n.item=n.resources.expose(c.r,n.wrapObservable(a)),n.resources.expose(L.n,n.resources.consume(L.n).withPart(R).withPart(H.e,{item:n.item})),n._instrumentationProvider=n.resources.consume(g.d),n._platform=n.resources.consume(O.e),n._isSelectionModal=n.resources.consume(b.n);var w=n.resources.consume(c.e);return n._customTemplateName=r,n.selectionModel=n.resources.consume(c.C),n.draggable=h,n.isInteractable=h,n.isDroppingTarget=n.createObservable(!1),n.isReceivingDrop=n.createObservable(!1),n.isSelected=n.createObservable(!1),n.focusState=n.createObservable(0),n.isFocused=n.createPureComputed(function(){return!!n.focusState()}),n.ignoreClickTime=n.createObservable(0),n.thumbnailError=n.createObservable(),n.isThumbnailLoaded=n.createObservable(!1),n.pulseTarget=n.createObservable(),n._folderChildCount=n.createObservable(""),n.showPerson=n.createObservable(!1),n.button=v,n.imageRect=s,n.imageRect.equalityComparer=u.e,n.thumbnail=n.createPureComputed(n._computeThumbnail),n.thumbnail.equalityComparer=u.e,n._hasThumbnailError=n.createPureComputed(n._computeHasThumbnailError),n.hasThumbnail=n.createPureComputed(n._computeHasThumbnail),n.templateName=n.createPureComputed(n._computeTemplateName),n._action=new(n.child(w.DefaultClickAction))({item:n.item,userInvokedItem:!0,sourceEngagement:m+".Click"}),n.isInvokable=n.createPureComputed(n._computeIsInvokable),n.rotation=n.createPureComputed(n._computeRotation),n.linkUrl=n.createPureComputed(n._computeLinkUrl),n.subText=n.createPureComputed(n._computeSubText),n.childCount=n.createComputed(n._computeChildCount),n.tagCount=n.createPureComputed(n._computeTagCount),n.longTagTooltip=n.createPureComputed(n._computeLongTagTooltip),n.isShared=n.createPureComputed(n._computeIsShared),n.isBundle=n.createPureComputed(n._computeIsBundle),n._subTextIconType=n.createPureComputed(n._computeSubTextIconType),n.subTextIconUrl=n.createPureComputed(n._computeSubTextIconUrl),n.subTextIconClass=n.createPureComputed(n._computeSubTextIconClass),n.isSubTextVisible=n.createPureComputed(n._computeIsSubTextVisible),n.isSelectable=n.createPureComputed(n._computeIsSelectable),n.dateText=n.createPureComputed(n._computeDateText),n.isDateVisible=n.createPureComputed(n._computeIsDateVisible),n.showTagCount=Object(D.isFeatureEnabled)(D.ShowTagCountInPhotos),n.newBadgeParams={desiredSize:n.createObservable("Small")},n.isCheckVisible=n.createPureComputed(function(){return n._platform.isMobile&&(n._isSelectionModal()||n.selectionModel.selection().length>0)}),n._dropHelper=n.resources.consume(l.e),n.iconSize=n.createPureComputed(n._computeIconSize),n.desiredSize=n.createPureComputed(n._computeDesiredIconSize),n.isDroppable=n.createPureComputed(n._computeIsDroppable),n._isFirstCellInGroup=n.createPureComputed(function(){return!!C&&void 0!==C.startIndex&&n.selectionModel.getItemByIndex(C.startIndex)===n.item}),n.tabindex=n.createPureComputed(function(){return n.selectionModel.focusedItem()===n.item||n._isFirstCellInGroup()?0:-1}),n.isNamePlateVisible=n.createPureComputed(n._computeIsNamePlateVisible),n.colorName=n.createPureComputed(n._computeColorName),n.hasImageStack=n.createPureComputed(n._computeHasImageStack),n.itemAutomationId=n.createPureComputed(function(){var e=n.item();if(e)return e.displayName}),n.createBackgroundComputed(function(){n.isReceivingDrop()&&n.isReceivingDrop(!1)}).extend({rateLimit:{timeout:1450,method:"notifyWhenChangesStop"}}),n.createBackgroundComputed(function(){var e=n.item();e&&!e.isPlaceholder&&n._instrumentationProvider.userSeeItem(e)}),n.createBackgroundComputed(function(){n._updateSelectionSubscription(n.item)}),n._deferredLoadedTemplateName=n.createObservable(void 0),n.createBackgroundComputed(n._computeDeferredLoadedTemplateName),n}return Object(i.__extends)(t,e),t.prototype.dispose=function(){this._updateSelectionSubscription(null),e.prototype.dispose.call(this)},t.prototype.onItemCheckClick=function(e,t){return t.shiftKey?this.selectionModel.selectToItem(this.item):this.selectionModel.toggleItemSelected(this.item),this.selectionModel.setItemFocus(this.item,{preventAnchor:!!t.shiftKey}),t.preventDefault(),t.stopPropagation(),!1},t.prototype.onFocus=function(e,t){this.selectionModel.setItemFocus(this.item,{})},t.prototype.onClick=function(e,t){var n=this.ignoreClickTime(),a=(new Date).getTime();return n&&a-n<=50?(t.stopPropagation(),t.preventDefault(),!1):!!(t.shiftKey||t.ctrlKey||t.metaKey)||(this.onInvoke(t),t.stopPropagation(),t.preventDefault(),!1)},t.prototype.onMouseDown=function(e,t){if(!this.isInteractable||2===t.button)return!0;var n=!!Object(w.e)(t.target,"ItemTile-rowCheck"),a=this.selectionModel.isItemSelected(this.item);t.shiftKey||t.ctrlKey||t.metaKey||(a||n||this.selectionModel.clear(),n||this.selectionModel.setItemSelected(this.item,!0))},t.prototype.onInvoke=function(e){if(!Object(w.e)(e.target,"ItemTile-rowCheck")&&this._action.isAvailable.peek())return this._action.execute(e).done(),e.stopPropagation(),e.preventDefault(),!1},t.prototype.getRowAriaLabel=function(){return C.n(this.item())},t.prototype.getDragData=function(){var e=this,t=this.item.peek(),n=null,a=this.selectionModel;return t.isDraggable&&a.isItemSelected(this.item)&&(n={type:1,item:t,itemSet:a.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:a.selectedCount.peek(),resources:a.resources}}),n},t.prototype.onMayReceiveDrop=function(e){var t=this.item&&this.item.peek&&this.item.peek();return t&&t.isDropEnabled&&e.item!==t&&(1===e.type||0===e.type)?{targetName:t.name}:null},t.prototype.onReceiveDrop=function(e){var t=this._dropHelper.processDrop(e,this.item.peek());return t&&this.isReceivingDrop(!0),t},t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1),this.pulseTarget().enablePulsing(!0)},t.prototype.getItem=function(){return this.item},t.prototype.isTag=function(){return!!this.item().tagInfo},t.prototype.isFolder=function(){return this.item().type===o.e.Folder},t.prototype.isFile=function(){return this.item().type!==o.e.Folder&&!this.isMedia()},t.prototype.isMedia=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames},t.prototype.isAlbum=function(){return this.item().isAlbum},t.prototype.isStory=function(){return Object(D.isFeatureEnabled)(D.EnableEvokeAlignments)&&this.isAlbum()},t.prototype.isVideo=function(){return!!this.item().video&&this.hasThumbnail()&&!this._displayImageTileNames},t.prototype.isPhoto=function(){return!!this.item().photo&&this.hasThumbnail()&&!this._displayImageTileNames},t.prototype.hasNewBadge=function(){var e=this.item();return!Object(D.isFeatureEnabled)(D.EnableEvokeAlignments)&&!(!e.properties.newTag||!e.properties.autoAlbumTag)},t.prototype.onButtonClick=function(e,t){return this.button&&this.button.action?(t.stopPropagation(),this.button.action.execute(t)):v.n.wrap({resultType:M.e.ExpectedFailure})},t.prototype._computeSubTextIconType=function(){var e=this.item();return e.isViolation||e.policyTip&&e.policyTip>=_.e.block?4:e.properties.CheckedOutUserId?2:e.policyTip===_.e.notify?3:this.isVideo()?5:this.isShared()?1:0},t.prototype._computeHasImageStack=function(){return"ms-item-tile-folder"===this.templateName()},t.prototype._computeSubTextIconUrl=function(){return 2!==this._subTextIconType()?"":window.require.toUrl("odsp-media/images/overlays/checkoutoverlaygrid.svg")},t.prototype._computeDateText=function(){var e=this.item();if(this.isAlbum()){if(Object(D.isFeatureEnabled)(D.EnableEvokeAlignments)&&e.dateCreatedTime){var t={month:"long",day:"numeric",year:void 0};return e.dateCreatedTime.getFullYear()!==(new Date).getFullYear()&&(t.year="numeric"),e.dateCreatedTime.toLocaleDateString(k.e.language,t)}return e.dateCreated}return""},t.prototype._computeIsDateVisible=function(){var e=this.dateText();return!(!e||!e.length)},t.prototype._computeIsNamePlateVisible=function(){var e=this.item();return!this.isMedia()||e.isViolation},t.prototype._computeSubTextIconClass=function(){switch(this._subTextIconType()){case 1:return"ItemTile-sharingIcon ItemTile-subTextIcon ".concat(Object(T.O)("People"));case 2:return"ItemTile-subTextImageShort";case 4:return"ItemTile-blockIcon ItemTile-subTextIcon ".concat(Object(T.O)("DRM"));case 3:return" ItemTile-subTextIcon ".concat(Object(T.O)("IncidentTriangle"));case 5:return"ItemTile-playButton ".concat(Object(T.O)("Play"));case 6:return"ItemTile-badPhotoIcon ".concat(Object(T.O)("IncidentTriangle"));default:return""}},t.prototype._computeTemplateName=function(){var e=this._deferredLoadedTemplateName();return this._customTemplateName?this._customTemplateName:this._isUsingDeferredLoadedTemplate()?e:this.isFolder()?"ms-item-tile-folder":this.isPhoto()?"ms-item-tile-photo":this.isVideo()?"ms-item-tile-video":"ms-item-tile-file"},t.prototype._isUsingDeferredLoadedTemplate=function(){return this.isStory()||this.isTag()},t.prototype._computeDeferredLoadedTemplateName=function(){var e,t=this;this.isStory()?e="ms-item-tile-album":this.isTag()&&(e="ms-item-tile-tag"),e&&v.n.resolve(n.e(162).then(n.bind(null,4314))).then(F.e).then(function(n){t._deferredLoadedTemplateName(e)})},t.prototype._computeIsSelectable=function(){var e=this.item();return this.isInteractable&&this.selectionModel.canSelectItem(this.item)&&!e.tagInfo},t.prototype._computeThumbnail=function(){var e=this.item();return(e.orientedThumbnail||e).thumbnail},t.prototype._computeRotation=function(){var e=this.item().orientedThumbnail;return e?e.rotation:s.e.none},t.prototype._computeIconSize=function(){return this.hasThumbnail()?32:96},t.prototype._computeDesiredIconSize=function(){var e=.77*(this.imageRect().height-48);return this.hasThumbnail()?32:Math.min(96,Math.ceil(e))},t.prototype._computeIsSubTextVisible=function(){var e=this.item(),t=this.parentItem?this.parentItem():null;return e.type!==o.e.Folder||t&&t.queryType===h.e.SharedWithMe},t.prototype._computeLinkUrl=function(){var e=this.item(),t=this.resources.consume(c.o);return this._urlDataSource.getDefaultClickUrl(e,{urlType:"existing",itemSet:t()})},t.prototype._computeSubText=function(){var e="",t=this.item(),n=this.resources.consume(c.o);switch(n?n().sortField:"name"){case"size":e=m.e.getDisplayString(t.size,{ignoreZero:!0});break;case"dateTaken":e=t.dateTaken;break;case"dateModified":e=t.dateModified;break;default:e=t.defaultSubText||""}return e},t.prototype._computeChildCount=function(){var e=this,t=this.item(),n="",a=this.resources.consume(p.ye).getQueryType(),i="number"==typeof t.childCount&&!isNaN(t.childCount);if(t.type===o.e.Folder&&(t.queryType!==h.e.SharedWithMe||!t.isRootFolder)&&(!this._urlDataSource.isRecycleBin(t.queryType)||i||t.folder&&t.folder.totalCount>0))if(i)n=String(t.childCount);else if(a===h.e.Files){var r=this.resources.consume(p.b.optional);r&&r.getFolderItemCountInfo(t).then(function(n){n&&(t.childCount=n.itemCount,e._folderChildCount(String(t.childCount)))},function(e){})}return this._folderChildCount(n),this._folderChildCount()},t.prototype._computeHasThumbnailError=function(){var e=this._hasThumbnailError.peek();return e||(e=!!this.thumbnailError()),e},t.prototype._computeTagCount=function(){var e=this.item();return e.tagInfo&&e.folder?String(e.folder.childCount):""},t.prototype._computeLongTagTooltip=function(){var e=this.item();return e.tagInfo&&e.name&&e.name.length>50?e.name:""},t.prototype._computeIsShared=function(){var e=this.item().sharingType;return f.e(e)},t.prototype._computeIsBundle=function(){return this.item().isBundle},t.prototype._computeIsDroppable=function(){return this.item().isDropEnabled&&this.isInteractable},t.prototype._computeIsInvokable=function(){return!this._isSelectionModal()&&this._action.isAvailable()},t.prototype._updateSelectionSubscription=function(e){var t=this;this._selectionSubscription&&(this._selectionSubscription.dispose(),this._selectionSubscription=null),this.selectionModel&&e&&this.isInteractable&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{isSelected:this.isSelected,isFocused:this.createObservable(!1),focusState:this.focusState,onInvoke:function(e){return t.onInvoke(e)}}))},t.prototype._computeHasThumbnail=function(){var e=this.item().video;return!(Object(D.isFeatureEnabled)(D.ListThumbnailThrottling)||e&&Object(D.isFeatureEnabled)(D.ListThumbnailVideoThrottling))&&!!this.thumbnail()&&(this.isThumbnailLoaded()||!this._hasThumbnailError())},t.prototype._computeColorName=function(){return""},t}(r.t),B=n(388),j=B.e({tagName:"ms-item-tile",template:"<div class=\"ItemTile od--hasContextMenu\" role=\"option\" data-automationid=\"ms-item-tile\" data-bind=\"event:{focus:onFocus},delayedHasFocus:{focusState:focusState},class:colorName()?'od-ItemTile--color-'+colorName():'',css:{'is-tag':isTag(),'is-folder':isFolder()&&!isAlbum(),'is-file':isFile(),'is-media':isMedia(),'is-receivingDrop':isReceivingDrop,'is-dropping':isDroppingTarget,'is-checkVisible':isCheckVisible,'can-select':isSelectable,'has-thumbnail':hasThumbnail,'is-selected':isSelectable()&&isSelected(),'is-focused':isInteractable&&isFocused(),'od-ItemTile--isAlbum':isAlbum(),'od-ItemTile--isStory':isStory(),'od-ItemTile--isVideo':isVideo(),'od-ItemTile--noDate':!isDateVisible(),'od-ItemTile--isInteractable':isInteractable,'od-ItemTile--isInvokable':isInvokable,'od-ItemTile--hasImageStack':hasImageStack},attr:{tabindex:tabindex,'aria-label':getRowAriaLabel(),'aria-selected':isSelectable()&&isSelected()},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop},automation:itemAutomationId\"><a data-is-focusable=\"false\" class=\"ItemTile-link\" tabindex=\"-1\" data-bind=\"event:{click:onClick,mousedown:onMouseDown},element:inputElement,attr:{href:linkUrl,title:longTagTooltip},automation:'link'\"><div class=\"ItemTile-content\" data-bind=\"template:{name:templateName,if:templateName}\"></div><div class=\"ItemTile-selector\"><div class=\"ItemTile-frame\" data-bind=\"attr:{title:item().tooltipText}\"></div><div class=\"ItemTile-rowCheck\" data-bind=\"component:{name:itemCheckTagName,params:{}},automation:'select-link',event:{click:onItemCheckClick}\"></div></div></a></div>",viewModel:N,synchronous:!0});B.t("ms-item-tile-folder",'<div class="ItemTile-image" data-bind="component:{name:\'od-folder-cover-tile\',params:{item:item,imageRect:imageRect,pulseTarget:pulseTarget}}"></div><div class="ItemTile-dragDropIcon"></div><div class="ItemTile-namePlate"><div class="ItemTile-folderBeak"></div><div class="ItemTile-folderBeakHighlight"></div>\x3c!--ko if:!isSubTextVisible()&&isShared()&&!isAlbum()--\x3e<i class="ItemTile-sharingIcon ms-Icon ms-Icon--People" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:hasNewBadge()--\x3e<div class="ItemTile-newBadge">\x3c!--ko component:{name:newBadgeTagName,params:newBadgeParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="ItemTile-name" data-bind="text:item().name"></div><div class="ItemTile-childCount" data-bind="text:childCount"></div><div class="ItemTile-date" data-bind="text:dateText"></div><div class="ItemTile-subText" data-bind="if:isSubTextVisible()&&!isAlbum()"><i class="ms-Icon" data-bind="icon:true,css:{\'ItemTile-sharingIcon ms-Icon--People\':isShared()&&!isBundle(),\'ms-Icon--AppIconDefault\':isBundle()}"></i><span data-bind="text:subText"></span></div></div>'),B.t("ms-item-tile-file",'<div class="ItemTile-fileContainer">\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,desiredSize:imageRect,alignment:[\'fitWidth\',\'top\'],isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class="ItemTile-fileIconContainer"><div class="ItemTile-fileIcon" data-bind="css:{\'ItemTile-fileIcon--thumbnail\':hasThumbnail(),\'ItemTile-fileIcon--noThumbnail\':!hasThumbnail()},component:{name:\'ms-file-type-icon\',params:{iconName:item().iconName,extension:item().extension,iconSize:iconSize(),desiredSize:desiredSize()}}"></div></div><div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().displayName"></div><div class="ItemTile-subText"><img class="ItemTile-subTextImage" data-bind="attr:{src:subTextIconUrl},visible:subTextIconUrl"><i data-bind="css:subTextIconClass,visible:!subTextIconUrl()"></i><span data-bind="text:subText"></span></div></div></div>'),B.t("ms-item-tile-photo",'\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,rotation:rotation,desiredSize:imageRect,alignment:\'cover\',isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isNamePlateVisible--\x3e<div class="ItemTile-namePlate"><div class="ItemTile-name" data-bind="text:item().displayName"></div><div class="ItemTile-subText"><img class="ItemTile-subTextImage" data-bind="attr:{src:subTextIconUrl},visible:subTextIconUrl"><i data-bind="css:subTextIconClass,visible:!subTextIconUrl()"></i></div></div>\x3c!--/ko--\x3e'),B.t("ms-item-tile-video",'\x3c!--ko if:hasThumbnail--\x3e\x3c!--ko component:{name:imageFrameTagName,params:{image:thumbnail,desiredSize:imageRect,alignment:\'cover\',isLoaded:isThumbnailLoaded,error:thumbnailError}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<span class="ItemTile-playButton"><i data-bind="css:subTextIconClass"></i></span>'),t.e=j},1840:function(e,t,n){"use strict";function a(e){if(e&&Object.keys(e).length>0){if(e.isMalwareDetected)return 4;if(e.isExternal)return 1;if(e.isTrending)return 3;if(e.isNew)return 2}return 0}n.d(t,"e",function(){return a})},1843:function(e,t,n){"use strict";n(1813);var a=n(1824),i=n(388),r={tagName:"ms-file-type-icon",template:'<span class="FileTypeIcon" data-bind="attr:{title:hoverText},click:onClick,css:{\'FileTypeIcon--clickable\':!!onClick}" tabindex="-1"><img class="FileTypeIcon-icon" data-bind="attr:{src:iconUrl,alt:iconFieldAriaLabel},style:{width:size,height:size,\'font-size\':size}">\x3c!--ko if:overlayUrl--\x3e<img class="FileTypeIcon-overlay" data-bind="attr:{src:overlayUrl}">\x3c!--/ko--\x3e</span>',viewModel:a.e,synchronous:!0};i.e(r),t.e=r},1863:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a=n(0),i=n(183),r=n(1783),o=n(42),s=n(1764),c=n(1779),d=n(1271);function l(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}var u=n(17);Object(u.n)([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}]);var f=n(388),p=(n(796),n(56)),m=n(1888),_=function(e){function t(t){var n=e.call(this,t)||this,a=t.hasAnimated,i=t.fadeIn,r=t.image,o=t.referenceImage,s=t.referenceRotation;return n._fadeIn=i,n._image=r,n._referenceImage=o,n._referenceRotation=s,n.isLoaded=n.createObservable(!1),n._hasAnimated=n._getHasAnimated(),n.rotation=n.createPureComputed(n._computeRotation),n.createBackgroundComputed(function(){return a(n._hasAnimated())}),n}return Object(a.__extends)(t,e),t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;return e.isLoaded.peek()?(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50):(e.isLoaded(),n=!1),n})},t.prototype._computeRotation=function(){var e=this.rotation.peek();return(l(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation()),e},t}(p.n),h=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageTileTagName=m.e.tagName;var i=t.image,r=t.rotation,o=t.desiredSize,s=t.scale,c=void 0===s?1:s,u=t.fadeIn,f=void 0===u||u,p=t.allowLoading,h=void 0===p||p,b=t.isLoaded,g=t.isCurrent,v=t.alignment,y=t.position,S=t.loadedImage,D=t.error,I=t.loadImageScenarioName,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x,O=n.AnimationTracker,w=void 0===O?_:O;return a._animationTrackerType=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(r),a._desiredSize=o,a._scale=c,a.fadeIn=a.wrapObservable(f),a._allowLoading=a.wrapObservable(h),a._alignment=v,a._scenarioName=I,a._tileDefinitions=a.createPureComputed(a._computeTileDefinitions),a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=d.e,a._loadedImage=a.createPureComputed(a._computeLoadedImage),a._loadedImage.equalityComparer=l,a._error=a.createPureComputed(a._computeError),a._error.equalityComparer=d.e,a.tiles=a._getTiles(),y&&a.createBackgroundComputed(function(){return y(a._position())}).extend(C),S&&a.createBackgroundComputed(function(){return S(a._loadedImage())}).extend(C),b&&a.createBackgroundComputed(function(){return b(!!a._loadedImage())}).extend(C),g&&a.createBackgroundComputed(function(){return g(l(a._loadedImage(),a._image()))}).extend(C),D&&a.createBackgroundComputed(function(){return D(a._error())}).extend(C),a}return Object(a.__extends)(t,e),t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.error;if(i())break;if(r()){e=r();break}}return e},t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.position;if(i()){e=r();break}}return e},t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.image;if(i()){e=this.unwrapObservable(r);break}}return e},t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var i=void 0,r=void 0,o=void 0,s=n[n.length-1];s?(i=l(s.image,e),r=s.hasAnimated.peek(),o=!!s.error.peek()):(i=!1,r=!1),i?r?n=[s]:s.hasAnimated():((!s||r||o)&&(s={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)},n=Object(a.__spreadArray)(Object(a.__spreadArray)([],n,!0),[s],!1)),s.hasAnimated(),s.error())}}else n=[];return n},t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,a=t.error,i=t.hasAnimated,r=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:r.rotation,isLoaded:r.isLoaded,error:a,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){r.dispose()}}}}));return this.createBackgroundComputed(function(){t.splice.apply(t,Object(a.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))}),n},t}(i.t),b=Object(f.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:h,synchronous:!0}),g=n(12),v=300,y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageStackTagName=b.tagName;var i=t.image,o=t.rotation,u=void 0===o?r.e.none:o,f=t.alignment,p=t.desiredSize,m=t.isLoaded,_=t.isCurrent,h=t.error,v=t.coverage,y=void 0===v?{minimum:1,maximum:1}:v,S=t.scale,D=t.fadeIn,I=t.allowLoading,x=t.position,C=t.loadImageScenarioName,O=n.thumbnailCache,w=void 0===O?a.resources.consume(s.e):O,E=n.outputExtenders,A=void 0===E?{deferred:!0}:E;return a._thumbnailCache=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(u),a._alignment=c.t(f),a._desiredSize=a.wrapObservable(p),a._isLoaded=m,a._coverage=a.wrapObservable(y),a._loadedImage=a.createObservable(),a._blobImage=a.createObservable(),a._isNoCacheTriggered=!1,a._effectiveDesiredSize=a.createPureComputed(a._computeEffectiveDesiredSize),a._effectiveDesiredSize.equalityComparer=d.e,a._idealSize=a.createPureComputed(a._computeIdealSize),a._idealSize.equalityComparer=d.e,a._idealImage=a.createPureComputed(a._computeIdealImage),a._idealImage.equalityComparer=l,a._fallbackImage=a.createPureComputed(a._computeFallbackImage),a._fallbackImage.equalityComparer=l,a._cachedImage=a.createPureComputed(a._computeCachedImage),a._cachedImage.equalityComparer=l,a._currentImage=a.createPureComputed(a._computeCurrentImage),a._currentImage.equalityComparer=l,a._isCurrent=a.createPureComputed(a._computeIsCurrent),a.imageStackParams={image:a._currentImage,rotation:a._rotation,desiredSize:a._desiredSize,loadedImage:a._loadedImage,isLoaded:a._isLoaded,error:h,scale:S,alignment:a._alignment,fadeIn:D,allowLoading:I,position:x,loadImageScenarioName:C},_&&a.createBackgroundComputed(function(){return _(a._isCurrent())}).extend(A),g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||a.addDisposable({dispose:function(){a._blobImage.peek()&&a._blobImage.peek().url&&URL.revokeObjectURL(a._blobImage.peek().url)}}),a}return Object(a.__extends)(t,e),t.prototype._computeIsCurrent=function(){return l(this._loadedImage(),this._idealImage())},t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),a=this._fallbackImage();return e?l(e,t)?this._currentImage.peek():t:n||a||t},t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;return t&&(e={width:t.width*n,height:t.height*n}),e},t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,a=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&a){var r=this._alignment.getTransform(t,i);e={width:r.scale*t.width,height:r.scale*t.height}}}else e={width:n,height:a}}return e},t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();return!g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")&&this._blobImage()?this._blobImage.peek():(t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t,g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||this._convertImageUrlToBlobUrlViaXhttp(e)),e)},t.prototype._convertImageUrlToBlobUrlViaXhttp=function(e){var t=this;if(e&&e.url&&-1!==e.url.indexOf("access_token")){var n=new XMLHttpRequest;n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var i=URL.createObjectURL(n.response);t._blobImage(Object(a.__assign)(Object(a.__assign)({},e),{url:i})),t._isNoCacheTriggered=!1}},n.onerror=function(){t._isNoCacheTriggered||(t._isNoCacheTriggered=!0,t._convertImageUrlToBlobUrlViaXhttp(e))},n.open("GET",e.url,!0),n.responseType="blob",this._isNoCacheTriggered&&(n.setRequestHeader("cache-control","no-cache"),n.setRequestHeader("pragma","no-cache")),n.send()}},t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=(this._coverage()||{}).fallback,i=void 0===a?0:a;if(i){var r={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,r))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,r,!1)}}return e},t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},r=i.minimum,o=void 0===r?1:r,s=i.maximum,c=o*a,d=(void 0===s?1:s)*a;e=this._thumbnailCache.retrieve(t,d,c)}return e},t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:o.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}},t}(i.t);t.t=y},1864:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(137),r=new a.e("allGroupToCountsItemKeyFacet",{photosRootItemSetKeyPart:i.e.subKeyPart})},1865:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(128),r=(n(1741),new a.t({name:"MoveCopyProvider.key",loader:new i.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e(274)]).then(n.bind(null,1985)).then(function(e){return e.resourceKey})})}))},1869:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(183),o=n(25),s=n(1744),c=n(509),d=n(1792),l=n(29),u=n(95),f=n(211),p=n(1825),m=n(123),_=n(61),h=n(1889),b=n(1883),g=n(36),v=n(573),y=n(1096),S=n(1747),D=n(35),I=n(5),x=n(90),C=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=a.resources;return a.actionMap=r.consume(o.e),a.addPaddingBottom=a._exposeIfNeeded(s.e.addPaddingBottom,i.observable(!0)),a.isScrollbarHidden=a._exposeIfNeeded(s.e.isScrollbarHidden,i.observable(!1)),a.makeFlexBox=a._exposeIfNeeded(s.e.makeFlexBox,i.observable(!1)),a.isTopBarHamburgerVisible=a._exposeIfNeeded(s.e.suiteNav.isTopBarHamburgerVisible,i.observable(!1)),a.isTopBarVisible=a._exposeIfNeeded(s.e.suiteNav.isTopBarVisible,i.observable(!0)),a.isTopBarVisible(!0),a.isLeftNavUserExpanded=a._exposeIfNeeded(s.e.leftNav.isLeftNavUserExpanded,i.observable(!1)),a.isSuiteNavHamburgerVisible=a._exposeIfNeeded(s.e.suiteNav.isSuiteNavHamburgerVisible,i.observable(!1)),a.supportHamburgerInSuiteNav=a._exposeIfNeeded(s.e.suiteNav.supportHamburgerInSuiteNav,!1),a.toggleIsLeftNavUserExpanded=a._exposeIfNeeded(s.e.leftNav.toggleIsLeftNavUserExpanded,function(){return null}),a.hideLeftNav=a._exposeIfNeeded(s.e.leftNav.hideLeftNav,i.observable(!1)),a.hideLeftNav(!1),a.isLeftNavVisible=a._exposeIfNeeded(s.e.leftNav.isLeftNavVisible,i.observable(!1)),a.hasSelectionState=r.consume(p.e),a.pageType=r.consume(o.s),a.isInfoPaneExpanded=r.consume(d.resourceKey),a.isRetrievingData=a._exposeIfNeeded(s.e.isRetrievingData,i.observable(!1)),a.responsiveUI=r.consume(c.t),a.platform=r.consume(f.e),a.isCommandBarDarkTheme=a._exposeIfNeeded(s.e.commandBar.isDarkTheme,i.observable(!1)),a.isOneUpForPhotosOnly=a._exposeIfNeeded(s.e.oneUpOverlay.isPhotosOnly,i.observable(!1)),a.isSuiteNavHidden=a._exposeIfNeeded(s.e.suiteNav.isSuiteNavHidden,i.observable(!0)),a.isSuiteNavHidden(Object(m.a)()||Object(m.e)()),a.contextMenuHelper=a._exposeIfNeeded(s.e.contextMenuHelper,i.observable(null)),a.viewParams=r.consume(o.T),a.isSearchHidden=a._exposeIfNeeded(s.e.commandBar.isSearchHidden,i.observable(!1)),a.isSearchHidden(Object(m.e)()),a.instrumentationProvider=r.consume(u.d),a.useItemsScope=r.expose(h.e,a.observables.pureCompute(a._computeUseItemsScope)),a.useItemCacheData=r.expose(b.e,a.observables.pureCompute(a._computeUseItemCacheData)),a.commandBar=a._exposeIfNeeded(s.e.commandBar.transclusionProvider,null),a.urlDataSource=r.consume(_.ye),a._isItemsScopeEnabledInFilesPivot=r.consume(S.r.lazy),a._isItemsScopeEnabledInRecentPivot=r.consume(S.o.lazy),a._isItemsScopeEnabledInSharedPivot=r.consume(S.s.lazy),a._isItemsScopeEnabledInAllPhotosPivot=r.consume(S.n.lazy),a._isItemsScopeEnabledInAllAlbumsPivot=r.consume(S.e.lazy),a._isItemsScopeEnabledInAllTagsPivot=r.consume(S.i.lazy),a._isItemsScopeEnabledInAllPhotosFilePicker=r.consume(S.t.lazy),a._isItemsScopeEnabledInAllPlacesPivot=r.consume(S.a.lazy),a._isItemsScopeEnabledInSingleAlbumView=r.consume(S.c.lazy),a._isItemsScopeEnabledInSinglePlaceView=r.consume(S.d.lazy),a._isItemsScopeEnabledInSingleTagView=r.consume(S.l.lazy),a._isVroomEnabledInItemsScopeAllPhotos=a.resources.consume(S.f.lazy),a._isVroomEnabledInItemsScopeSingleTag=a.resources.consume(S.m.lazy),a._isVroomEnabledInItemsScopeSinglePlace=a.resources.consume(S.p.lazy),a.observables.backgroundCompute(a.computeReportPageView).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}),a.commandBarTransclusionContentParams={provider:a.commandBar},a._initializeItemsScopeManager(),a._initializeItemCacheToKOStoreDataSource(),a}return Object(a.__extends)(t,e),t.prototype.computeReportPageView=function(){this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),name:this.computeCurrentPageName()})},t.prototype.computeCurrentPageName=function(){return l.e[this.pageType.peek()]},t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)},t.prototype._computeUseItemsScope=function(){var e=this.viewParams();return this.urlDataSource.isCurrentQuery(g.e.Files,e)?this._isItemsScopeEnabledInFilesPivot():this.urlDataSource.isCurrentQuery(g.e.Recent,e)?this._isItemsScopeEnabledInRecentPivot():this.urlDataSource.isCurrentQuery(g.e.SharedWithMe,e)||this.urlDataSource.isCurrentQuery(g.e.SharedByMe,e)?this._isItemsScopeEnabledInSharedPivot():!((!Object(D.w)(e)||!this._isItemsScopeEnabledInSingleAlbumView()||this.urlDataSource.isCurrentQuery(g.e.Search))&&(!Object(D.A)(e)||!this._isItemsScopeEnabledInSingleTagView())&&(!Object(D.E)(e)||!this._isItemsScopeEnabledInSinglePlaceView())&&(!Object(D.v)(e)||!this._isItemsScopeEnabledInAllPhotosFilePicker())&&(!Object(D.m)(e)||!this._isItemsScopeEnabledInAllPlacesPivot())&&(!Object(D.f)(e)||!this._isItemsScopeEnabledInAllAlbumsPivot())&&(!Object(D._)(e)||!this._isItemsScopeEnabledInAllTagsPivot())&&(!Object(D.p)(e)||!this._isItemsScopeEnabledInAllPhotosPivot()))},t.prototype._computeUseItemCacheData=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return Object(D.v)(e)?this._isItemsScopeEnabledInAllPhotosFilePicker()&&this._isVroomEnabledInItemsScopeAllPhotos():Object(D.A)(e)?this._isVroomEnabledInItemsScopeSingleTag()||Object(I.Hr)(I.Li)&&Object(x.e)(D.M):Object(D.E)(e)?this._isVroomEnabledInItemsScopeSinglePlace():Object(D.p)(e)?this._isVroomEnabledInItemsScopeAllPhotos():t!==l.e.Photos&&this.useItemsScope()},t.prototype._initializeItemsScopeManager=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemsScope.peek()?e.resources.consumeAsync(v.e):e.useItemsScope()})},t.prototype._initializeItemCacheToKOStoreDataSource=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemCacheData.peek()&&e.resources.consumeAsync(y.e.bypass)})},t}(r.t);t.e=C},1870:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".ItemCheck{display:none;position:relative;width:18px;height:18px;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.can-select .ItemCheck{display:block}.ItemCheck:before{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";content:'';width:16px;height:16px;position:absolute;border-radius:50%;left:1px;top:1px}.ItemCheck-circle{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;line-height:18px;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ItemCheck-check{font-size:16px;position:absolute;left:1.5px;top:0;color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";opacity:0;width:16px;height:16px;line-height:16px}.od--isNonMobile .ItemCheck:hover .ItemCheck-check{opacity:1}.is-selected .ItemCheck:before{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.is-selected .ItemCheck .ItemCheck-circle{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.is-selected .ItemCheck .ItemCheck-check{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:1}"}]);var i=n(388),r=n(0),o=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.isSelectable,i=void 0!==a&&a,r=t.isSelected,o=void 0!==r&&r;return n.isSelectable=n.wrapObservable(i),n.isSelected=n.wrapObservable(o),n}return Object(r.__extends)(t,e),t}(n(183).t),s=Object(i.e)({tagName:"ms-item-check",template:'<span class="ItemCheck"><i class="ItemCheck-circle ms-Icon ms-Icon--CircleRing" data-bind="icon:true"></i><i class="ItemCheck-check ms-Icon ms-Icon--StatusCircleCheckmark" data-bind="icon:true"></i></span>',viewModel:o,synchronous:!0});t.e=s},1871:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(0),i=n(60),r=n(56),o=n(61),s=n(1740),c=n(36),d=n(8),l=n(128),u=n(1071),f=!n(12).e.isActivated("8485CDCB-7021-4116-8F71-B4B0E64E13EB","6/21/2022","Blocks KOToItemCacheItemsStore from being used in the ShortcutProvider, which is fully KO"),p=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,f?(a.legacyStoreResourceScope=a.addDisposable(new d.n(a.resources)),a.legacyStoreResourceScope.block(u.e),a._itemProvider=a.legacyStoreResourceScope.consume(s.resourceKey)):a._itemProvider=n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.createShortcut=function(e,t,n){var a=this;return this._getShortcutDataSource().then(function(a){return a.createShortcut(e,t,n)}).then(function(t){return a._itemProvider.invalidateItem(e),t})},t.prototype.getShortcutTargetData=function(e,t,n,a){return this._getShortcutDataSource().then(function(i){return i.getShortcutTargetData({url:e,avoidGetFileByUrlCall:t,parentKey:n,targetSiteUrl:a})})},t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})},t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(c.e.Recent),startIndex:0,endIndex:5,queryType:c.e.Recent};return this._itemProvider.getItem(e)},t.prototype._getShortcutDataSource=function(){return i.n.resolve(this.resources.consumeAsync(o.le))},t}(r.n),m=Object(l.r)("ShortcutProvider",p,Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{urlDataSource:o.ye,itemProvider:s.resourceKey}))},1873:function(e,t,n){"use strict";var a=n(0),i=(n(1489),n(183)),r=n(22),o=n(165),s=n(102),c=n(988),d=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor(),i=a.layout,r=a.selectionModel,o=a.isSelectionOnKeyInputEnabled,s=void 0===o||o,c=a.shouldRespectInputKeyboardEvent,d=void 0!==c&&c,l=a.cancelBubbleOnArrowKey,u=void 0!==l&&l;return n._isSelectionOnKeyInputEnabled=s,n._layout=i,n._selectionModel=r,n._shouldRespectInputKeyboardEvent=d,n._cancelBubbleOnArrowKey=u,n.events.on(n.element,"click",n._onClick),n.events.on(n.element,"keydown",n._onKeyDown),n}return Object(a.__extends)(t,e),t.prototype._onKeyDown=function(e){var t=e.target,n=c.t(t);if(!this._shouldRespectInputKeyboardEvent&&n)return!0;if(e.altKey)return!0;var a=this._selectionModel,i=this._layout(),r=a.getFocusIndex(),o=-1,d=!!e.shiftKey,l=!!e.metaKey,u=!!e.ctrlKey,f=!0;switch(e.which){case s.e.up:f=(o=i.getItemIndexAbove(r))!==r;break;case s.e.down:f=(o=i.getItemIndexBelow(r))!==r;break;case s.e.left:f=(o=i.getItemIndexLeft(r))!==r;break;case s.e.right:f=(o=i.getItemIndexRight(r))!==r;break;case s.e.home:o=0;break;case s.e.end:o=a.getItems().length-1;break;case s.e.space:if(c.e(t))return!0;a.toggleIndexSelected(r);break;case s.e.enter:return!(!c.e(t)&&this.element.contains(t))||a.invokeFocusedItem(e);default:return}return o>=0&&(d?(u||l||a.clear(),a.selectToIndex(o),a.setIndexFocus(o,{preventAnchor:!0})):(u||l||(a.clear(),this._isSelectionOnKeyInputEnabled&&a.setIndexSelected(o,!0)),a.setIndexFocus(o))),!this._cancelBubbleOnArrowKey&&!f},t.prototype._onClick=function(e){var t=this._getItemFromElement(e.target);if(t){var n=this._selectionModel,a=!!e.shiftKey,i=!!e.metaKey,r=!!e.ctrlKey;a?(r||n.clear(),n.selectToItem(t),n.setItemFocus(t,{preventAnchor:!0})):r||i?(n.setItemSelected(t,!0),n.setItemFocus(t)):((!n.isItemSelected(t)||n.selection().length>1)&&(n.clear(),n.setItemSelected(t,!0)),n.setItemFocus(t)),e.stopPropagation(),e.preventDefault()}},t.prototype._getItemFromElement=function(e){for(var t,n=r.contextFor(e);n&&!t;)t=n&&n.$data&&"function"==typeof n.$data.getItem?n.$data.getItem():null,n=n.$parentContext;return t},t}(o.t),l=n(156),u=n(101),f=function(){function e(){}return e.init=function(t,n,a,i,o){var s=new l.e(this),c=new u.t(null),d=n(),f=d.scrollElement||document.body,p=d.viewport||d;function m(){s.setTimeout(function(){var n=e.getViewport(t);p(n)},0)}m(),c.on(f,"scroll",m),c.on(window,"resize",m),r.utils.domNodeDisposal.addDisposeCallback(t,function(){c.dispose()})},e.getViewport=function(e){var t=e.getBoundingClientRect(),n=window.innerHeight;return{width:t.width,height:n,visibleTop:-t.top,visibleBottom:n-t.top}},e}(),p=n(1900),m=n(1068),_=n(792),h=n(1759),b=n(1738),g=n(1772),v=function(e){function t(t){var n=e.call(this,t)||this;return n._pulseTargets=[],n._throttledPulse=n.async.debounce(n.pulse,5e3),n.createComputed(function(){var e=t.valueAccessor()();if(e&&e.length){var a=e.length;n._pulseTargets=[];for(var i=0;i<a;i++){var r=e[i];if(r&&r.pulseTarget){var o=r.pulseTarget();o&&o.canPulse()&&n._pulseTargets.splice(Math.floor(Math.random()*(1+n._pulseTargets.length)),0,o)}}n._throttledPulse()}else n._pulseTargets=[]}),n}return Object(a.__extends)(t,e),t.prototype.pulse=function(){var e=this,t=2,n=function(){if(t=Math.min(e._pulseTargets.length,t)){var a=e._pulseTargets.shift();a&&(a.pulse(),e._pulseTargets.push(a),t--)}t?e.async.setTimeout(n,150):e._throttledPulse()};n()},t}(o.t),y=n(155),S=n(248),D=n(1271),I=n(148),x=n(17);Object(x.n)([{rawString:".od-MarqueeSelection{position:absolute;z-index:650;top:0;left:0;width:100%;min-height:100%;background:rgba(255,0,0,0);cursor:default}.od-MarqueeSelection-box{position:absolute;box-sizing:border-box;border:1px solid "},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";background-color:"},{theme:"themeAccentTranslucent10",defaultValue:"rgba(58,150,221,.1)"},{rawString:"}"}]);var C=n(678),O=n(340),w=n(249),E=n(25),A=n(1912),L=n(211),k=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor(),i=a.selectionModel,o=a.layout,s=void 0===o?r.observable():o,c=a.isEnabled,d=void 0===c||c;n._selectionModel=i,n._layout=s,n._throttledEvaluateSelection=n.async.throttle(n._evaluateSelection,40),n._isSelecting=r.observable(!1),n._yOffset=r.observable(0),n._offsetElement=r.observable(n.element),n._isEnabled=r.isObservable(d)?d:r.observable(d),n._canUserSelect=n.resources.consume(E.a.optional)||n.observables.create(!1);var l=n.resources.consume(L.e.optional);return n._isMobile=!!l&&l.isMobile,n._container=Object(b.t)(n.element),n.events.on(n._container,"mousedown",n._onMouseDown),n.events.on(window,"click",n._onClick,!0),new(n.managed(A.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{enabled:n._isSelecting,y:n._yOffset}}}),n}return Object(a.__extends)(t,e),t.prototype._getRegion=function(e,t){var n=this._container,a=n.getBoundingClientRect(),i=n.scrollTop,r=n.scrollLeft,o=Math.max(a.left,t.clientX),s=Math.max(a.top,t.clientY),c=new C.e(Math.min(e.x,o+r)-a.left,Math.min(e.y,Math.max(0,s)+i)-a.top,Math.abs(o+r-e.x),Math.abs(s+i-e.y));return c.x=Math.max(0,c.x),c.y=Math.max(0,c.y),c.width=Math.min(n.scrollWidth-c.x,c.width),c.height=Math.min(n.scrollHeight-c.y,c.height),c},t.prototype._getOffsetRegion=function(e){var t=this._container,n=this._offsetElement.peek(),a=new C.e(e);if(n){var i=t.getBoundingClientRect(),r=n.getBoundingClientRect();a.x-=r.left-i.left+t.scrollLeft,a.y-=r.top-i.top+t.scrollTop,y.e.isRightToLeft&&(a.x=r.width-a.x-a.width)}return a},t.prototype._canSelect=function(e){var t=this._layout();return this._isEnabled.peek()&&!!t&&!this._isMobile&&0===this._selectionModel.mode&&!this._selectionModel.isIndexSelected(t.getItemIndicesInRegion(e)[0])&&this._canUserSelect.peek()},t.prototype._onScroll=function(){this._marqueeBox&&(this._onMouseMove(this._lastMouseEvent),this._throttledEvaluateSelection())},t.prototype._onMouseDown=function(e){if(0===e.button){var t=this._container,n=new O.e(e.clientX,e.clientY+t.scrollTop),a=this._getRegion(n,e),i=this._getOffsetRegion(a);this._suppressNextClick=!1,!this._marqueeBox&&this._canSelect(i)&&e.target!==this._container&&(this._downPoint=n,this._lastMouseEvent=e,this._downPoint=new O.e(e.clientX,e.clientY+t.scrollTop),this._shouldClearSelection=!e.shiftKey,this.events.on(window,"mousemove",this._onMouseMove,!0),this.events.on(window,"mouseup",this._onMouseUp,!0),this.events.on(t,"scroll",this._onScroll))}},t.prototype._initializeDrag=function(e){this._marqueeArea=w.e.ce("div",{class:"od-MarqueeSelection"}),this._marqueeBox=w.e.ce("div",{class:"od-MarqueeSelection-box"}),this._shouldClearSelection&&this._selectionModel.clear(),this._isSelecting(!0),this._onMouseMove(e),this._marqueeArea.appendChild(this._marqueeBox),this._container.appendChild(this._marqueeArea),this._canUserSelect(!1),this._suppressNextClick=!0},t.prototype._onMouseMove=function(e){var t=e.buttons;if(1===(void 0===t?1:t)){var n=this._container;if(this._downPoint&&!this._marqueeBox){var a=Math.abs(e.clientX-this._downPoint.x),i=Math.abs(e.clientY+n.scrollTop-this._downPoint.y);(a>5||i>5)&&this._initializeDrag(e)}if(this._marqueeBox){this._marqueeArea.style.height=n.scrollHeight+"px",this._lastMouseEvent=e;var r=this._getRegion(this._downPoint,e),o=this._marqueeBox.style;return this._yOffset(e.clientY),o.left=r.x+"px",o.top=r.y+"px",o.width=r.width+"px",o.height=r.height+"px",this._lastRegion=r,this._throttledEvaluateSelection(),!1}}else this._onMouseUp(e)},t.prototype._evaluateSelection=function(){var e,t=this._lastRegion,n=this._getOffsetRegion(t),a=this._layout();if(a){e=a.getItemIndicesInRegion(n);for(var i=this._lastIndicesInRegion||[],r=0;r<e.length;r++){for(var o=e[r];i.length&&i[0]!==o;)this._selectionModel.setIndexSelected(i[0],!1),i.shift();i.length?i.shift():this._selectionModel.setIndexSelected(e[r],!0)}for(;i.length;)this._selectionModel.setIndexSelected(i[0],!1),i.shift()}this._lastIndicesInRegion=e},t.prototype._onMouseUp=function(e){var t=this;if(0===e.button){var n=!!this._marqueeBox,a=this._container;return n?(this._container.removeChild(this._marqueeArea),this.async.setTimeout(function(){t._suppressNextClick=!1},0)):this._lastRegion=null,this._isSelecting(!1),this._lastIndicesInRegion=this._downPoint=this._marqueeArea=this._marqueeBox=null,this.events.off(window,"mousemove",this._onMouseMove,!0),this.events.off(window,"mouseup",this._onMouseUp,!0),this.events.off(a,"scroll",this._onScroll),this._canUserSelect(!0),!n}},t.prototype._onClick=function(e){return!this._suppressNextClick||0!==e.button||(this._suppressNextClick=!1,e.stopImmediatePropagation(),!1)},t}(o.t),M=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a.valueAccessor(),o=i.selectionModel,s=i.isEnabled,c=void 0===s||s;a._selectionModel=o,a._isEnabled=r.isObservable(c)?c:r.observable(c);var d=n.getScrollContainer,l=void 0===d?b.t:d;return a._container=l(a.element),a.events.on(a._container,"click",a._onClick),a}return Object(a.__extends)(t,e),t.prototype._onClick=function(e){return!this._isEnabled.peek()||!this._selectionModel.selectedCount.peek()||e.target===this._container||(this._selectionModel.clear(!0),!1)},t}(o.t),P=n(1070),T=n(1949),U=n(336),F=n(95),H=n(133),R=1e6,N=function(e){function t(t,n){var a=e.call(this,t)||this;a.headerParams={};var i=n.element;a.addBindingHandlers({selection:d,marqueeSelection:k,clearSelection:M,viewport:f,contextMenu:g.e,customRender:p.e,keyboard:m.e,pulse:v,element:P.e,interactionScope:_.t,recoverFocus:h.e}),a._renderedCellsByKey={},a._renderedCellsByIndex={},a._visibleCells=[],a.surfaceElement=a.createObservable(),a.placeHolderHeight=a.createObservable(0),a.pages=[],a.viewport={viewport:a.createObservable({width:0,height:0,visibleTop:0,visibleBottom:0}),scrollElement:Object(b.t)(i)},a._viewport=a.createPureComputed(function(){return a.viewport.viewport()}).extend({rateLimit:0}),a._asyncEnqueueOffScreenRenders=a.async.debounce(a._enqueueOffScreenRenders,400);var o=t.isSelectionOnKeyInputEnabled,s=void 0===o||o,c=t.layoutIterationObservable,l=void 0===c?a.createObservable(0):c,u=t.enableMarqueeSelection,y=void 0!==u&&u,I=t.enableClearSelection,x=void 0===I||I;a.isSelectionOnKeyInputEnabled=s,a.visibleModels=r.observable(),a.itemSet=t.itemSet,a._itemHistoryProvider=a.resources.isExposed(F.l)?a.resources.consume(F.l):null,a.items=a.createComputed(a._computeItems),a.selectionModel=t.selectionModel,a.enableMarqueeSelection=y,a.enableClearSelection=x,a.requiredRange=r.observable({start:0,end:0}),a.requiredRange.equalityComparer=D.e,a.headerType=r.observable(""),a.headerStyle=r.observable(""),a._findElements(i,t),a.contextMenuHelper=t.contextMenuHelper,a.tooltip=t.tooltip,a._layoutIteration=l,a.requiredGroup=t.requiredGroup,a._isItemSetRendered=a.resources.consume(E.S),a.activeLayout=r.observable(),a.activeLayout.equalityComparer=S.n,a._isLoading=t.isLoading||r.observable(!0),a._isLoading(!0),a._headerVisibleObservable=r.observable(r.observable(!0)),a.headerVisible=a.createPureComputed(a._computeHeaderVisible),a.isActive=a.createObservable(!0),a.tabIndex=a.createObservable(0),a.resources.consume(U.e).logData({name:"ListView.AppLoad"}),a._change=a.async.debounce(function(){a.isDisposed||a._onLayoutChanged()},50,{maxWait:200}),a._updateVisibles=a.async.debounce(function(){if(!a.isDisposed&&a.activeLayout().supportsLazyBinding()){for(var e=0,t=a._visibleCells;e<t.length;e++){var n=t[e].element.firstChild,i=n&&r.dataFor(n);i&&i.activateBindings&&i.activateBindings()}a.bindingsActivated=!0}},500),a._updateAnchor=a.async.debounce(a._handleUpdateAnchor,501),a.subscribe(a._viewport,function(){a.activeLayout()&&a.activeLayout().updateViewport(a._viewport())});var C=a.createComputed(function(){t.requiredRange&&t.requiredRange(a.requiredRange())}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});return a._itemHistoryProvider&&a.createBackgroundComputed(function(){a._itemHistoryProvider.currentItem()}),a.subscribe(a.itemSet,function(){a._isLoading(!0);var e=a.surfaceElement.peek();e&&a.placeHolderHeight.peek()<e.scrollHeight&&a.placeHolderHeight(e.scrollHeight),a._isItemSetRendered(!1),a._removeAll(),a.requiredRange({start:0,end:0}),C(),T.e.logData()}),a.subscribe(a.selectionModel.focusedItem,function(){a.makePages(a.activeLayout.peek().getSurfaceSize().height),a._renderFocusCell(),a._change()}),a.createBackgroundComputed(function(){var e=a.itemSet();e.content(),e.isExpired&&a._removeCells(a.activeLayout().getVisibleRange())}),t.visibleItemRange&&a.createBackgroundComputed(function(){a._layoutIteration();var e=a.activeLayout();e?t.visibleItemRange(e.getVisibleItemRange(a.viewport.viewport())):t.visibleItemRange({start:0,end:0})}),a}return Object(a.__extends)(t,e),t.prototype.initialize=function(e){var t=this,n=this.activeLayout.peek();this._isItemSetRendered(!1),n&&(this.events.off(n),n.dispose()),this.events.on(e,"change",function(){t._change(),t._updateVisibles(),t._updateAnchor()}),this.activeLayout(e),H.n.mark("EUPL.ListView.Init"),e.updateViewport(this._viewport.peek())},t.prototype.isReadyToBeSelected=function(e){var t=!1;return e&&this._renderedCellsByKey[e().key]&&(t=!0),t},t.prototype.makePages=function(e){for(var t=Math.ceil(e/R),n=0;n<t;n++){var a=this.pages[n],i=R;if(!a){var o=document.createElement("div");o.className="List-page",o.style.height="".concat(i,"px"),this._surfaceElement.appendChild(o),a=this.pages[n]={element:o,start:n*R,index:n}}n===t-1&&(i=e-R*n),a.element.style.height="".concat(i,"px")}this.pages.length>t&&this.pages.splice(t).map(function(e){r.removeNode(e.element)});var s=this.selectionModel.focusedItem.peek();this._firstGroupHeader&&!s&&this._focusFirstHeader()},t.prototype.setCellWidth=function(e,t){e.width=t.width},t.prototype._handleUpdateAnchor=function(){if(!this.isDisposed&&this._itemHistoryProvider){var e=this.activeLayout().getVisibleRange().start,t=this.itemSet.peek(),n=t.content.peek().items;if(e>=0&&e<n.length){var a=n[e],i=this._itemHistoryProvider.getHistoryItemByKey(t.key);i&&a&&i.anchorItem(a.peek())}}},t.prototype._findElements=function(e,t){var n=this;this._surfaceElement=e.getElementsByClassName("List-surface")[0],this.events.on(this._surfaceElement,"focus",function(){if(n._firstGroupHeader||n._layoutIteration.peek()<1)n.selectionModel.clear(!0),n._focusFirstHeader();else{var e=n.selectionModel.focusedItem.peek();e||(e=n.selectionModel.getItems()[0]),e&&n.selectionModel.setItemFocus(e,{isFocusInput:!1})}})},t.prototype._onLayoutChanged=function(){H.n.mark("EUPL.ListViewModel.LayoutChanged");var e=this.activeLayout();if(e){for(var t=e.getSurfaceSize().height;t!==this._lastHeight;)return this._lastHeight=t,t=e.getSurfaceSize().height,void this._change();this.makePages(t);var n=e.supportsGrouping(),a=e.getVisibleRange(),i=e.getVisibleItemRange(),o=e.getMaterializedRange(),s=n?e.getRequiredGroup():null,c=e.getHeaderCell();c&&(this.headerParams=c.viewData,this.headerStyle("margin-"+y.e.safeLeft+": "+c.left+"px; width: "+c.width+"px; height: "+c.height+"px;"),this.headerType(c.viewType),this._headerVisibleObservable(c.headerVisible?c.headerVisible:r.observable(!0)));var d=e.getAllFocusableItems();d&&this.selectionModel.setAllFocusableItems(d),H.n.mark("EUPL.ListView.RenderCell.Start"),this._visibleCells=this._renderRange(a),H.n.mark("EUPL.ListView.RenderCell.End"),this.placeHolderHeight(0===this._visibleCells.length?t:0),this._isLoading(!1);var l=this._viewport.peek().width,u=this.items().length,f=this._lastItemsLength,p=void 0===f?u:f,m=this._lastWidth,_=void 0===m?l:m,h=this.items().length!==p;if(this._lastItemsLength=u,n){var b=e.getVisibleItemCount(),g=this._lastVisibleItemsLength;h=h||b!==(void 0===g?b:g),this._lastVisibleItemsLength=b}if((l!==_||h)&&(a.start<0||a.end<0?this._removeAll():this._removeCells(a)),this._lastWidth=l,this._rangesToUpdate=[],this._asyncEnqueueOffScreenRenders(o,a),this._renderFocusCell(),s&&this.requiredGroup?this.requiredGroup(s):i.end>0&&this.requiredRange(i),this._layoutIteration){var v=this._layoutIteration.peek();this._layoutIteration(v+1)}}},t.prototype._renderFocusCell=function(){var e=this,t=this._getFocusedKey(),n=0;if(t){var a=this.activeLayout().getCellByKey(t),i=this._renderedCellsByKey[t];a?(i?this._updateCell(a):this._createCell(a),n=-1):i&&this._removeCell(t)}else document.activeElement===this._surfaceElement&&this.async.setTimeout(function(){if(e._firstGroupHeader)e._focusFirstHeader();else{var t=e.selectionModel.getItems()[0];t&&document.activeElement===e._surfaceElement&&e.selectionModel.setItemFocus(t,{isFocusInput:!1})}},0);this.tabIndex(n)},t.prototype._renderRange=function(e){var t=this,n=this.activeLayout(),a={},i={},r=[];this.bindingsActivated=!1;for(var o=function(e){if(e&&e.viewType){var n=t._renderedCellsByKey[e.key];n?i[e.key]=e:n=t._createCell(e),r.push(n),a[e.key]=!1}},s=e.start;s>=0&&s<=e.end;s++){var c=n.getCellAt(s),d=this._renderedCellsByIndex[s];o(c),!d||c&&d.key===c.key||void 0!==a[d.key]||(a[d.key]=!0)}for(var l in a)a[l]&&this._removeCell(l);for(var u in i)c=i[u],this._updateCell(c);return this._isItemSetRendered(!0),r},t.prototype._updateCell=function(e){var t=e.cellIndex,n=this._renderedCellsByKey[e.key],a=n.element.style;n.cellIndex!==t&&n===this._renderedCellsByIndex[n.cellIndex]&&delete this._renderedCellsByIndex[n.cellIndex];var i=this.pages[Math.floor(e.top/R)];n.cellIndex=t,n.top=e.top-i.start,n.left=e.left,this.setCellWidth(n,e),n.height=e.height,n.element.setAttribute("data-index","".concat(n.index)),n.element.setAttribute("data-key",n.key),n.viewData&&n.viewData.cellSize({width:n.width,height:n.height}),a[y.e.safeLeft]=n.left+"px",a.top=n.top+"px",a.width=n.width+"px",a.height=n.height+"px",this._renderedCellsByIndex[t]=n},t.prototype._createCell=function(e){var t=e.key,n=e.index,a=e.cellIndex,i=e.width,o=e.height,s=e.left,c=e.top,d=e.viewType,l=e.viewData,u=document.createElement("div");u.className="List-cell",0===a&&l.group&&(this._firstGroupHeader=u);var f=I.e({cellSize:this.createObservable({width:i,height:o})},l),p=this._renderedCellsByKey[e.key]={key:t,index:n,cellIndex:a,width:i,height:o,left:s,top:c,viewType:d,viewData:f,element:u};return this._updateCell(e),d&&r.applyBindingsToNode(u,{component:{name:d,params:f}},r.contextFor(this._surfaceElement)),this.pages[Math.floor(e.top/R)].element.appendChild(u),p},t.prototype._processRanges=function(){var e=this;this._processRangeEnqueued||(this._processRangeEnqueued=!0,this.async.setTimeout(function(){e._processRangeEnqueued=!1;var t=e._rangesToUpdate.shift();t&&(t.remove?e._removeCells(t):(e.makePages(e.activeLayout.peek().getSurfaceSize().height),e._renderRange(t))),e._rangesToUpdate.length&&e._processRanges()},4))},t.prototype._enqueueOffScreenRenders=function(e,t){if(t.start>-1&&t.end>-1){for(var n=t.end+1;n<=e.end;n+=4)this._rangesToUpdate.push({start:n,end:n+4-1});for(this._rangesToUpdate.push({start:e.start,end:e.end,remove:!0}),n=t.start-1-4;n>=e.start;n-=4)this._rangesToUpdate.push({start:n,end:n+4-1});this._processRanges()}},t.prototype._removeAll=function(){for(var e in this._renderedCellsByKey){var t=this._renderedCellsByKey[e];r.cleanNode(t.element)}for(var n in this.pages)if(this.pages.hasOwnProperty(n)){var a=this.pages[n];a.element.innerHTML="",a.element.style.height="0px"}this._renderedCellsByIndex={},this._renderedCellsByKey={}},t.prototype._removeCells=function(e){for(var t=r.utils.extend({},this._renderedCellsByKey),n=this.activeLayout(),a=e.start;e.start>=0&&a<=e.end;a++){var i=n.getCellAt(a);i&&delete t[i.key]}var o=this._getFocusedKey();for(var s in o&&delete t[o],t)this._removeCell(s)},t.prototype._removeCell=function(e){var t=this._renderedCellsByKey[e];r.removeNode(t.element),delete this._renderedCellsByKey[e],this._renderedCellsByIndex[t.cellIndex]===t&&delete this._renderedCellsByIndex[t.cellIndex]},t.prototype._computeItems=function(){return this.itemSet().content().items},t.prototype._computeHeaderVisible=function(){return this._headerVisibleObservable()()},t.prototype._getFocusedKey=function(){var e=this.peekUnwrapObservable(this.peekUnwrapObservable(this.selectionModel.focusedItem));return e&&e.key},t.prototype._focusFirstHeader=function(){if(this._firstGroupHeader){var e=this._firstGroupHeader.children[0];if(e){var t=this._getScrollPosition(),n=t.scrollTop,a=t.scrollLeft;e.focus(),this._setScrollPosition(n,a)}}},t.prototype._getScrollPosition=function(){var e=this.viewport.scrollElement;return{scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}},t.prototype._setScrollPosition=function(e,t){var n=this.viewport.scrollElement;n.scrollTop!==e&&(n.scrollTop=e),n.scrollLeft!==t&&(n.scrollLeft=t)},t}(i.t);t.e=N},1876:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;n.items=t.items.filter(r),n.rootElementClass=t.rootElementClass||null,n.boundingElementClass=t.boundingElementClass||null,n.shouldHideIcons=!!t.shouldHideIcons,n.engagementSource=t.engagementSource||null,n.alignment=t.alignment,n.point=t.point,n.anchorElement=t.anchorElement,n.isMenuOpen=t.isMenuOpen;var a=t.dismissOnClick,i=void 0===a||a;return n.dismissOnClick=i,n}return Object(a.__extends)(t,e),t}(n(56).n);function r(e){return 8==(8&e.location)}t.e=i},1878:function(e,t,n){"use strict";t.e='<div class="List" role="listbox" aria-multiselectable="true" data-bind="pulse:visibleModels">\x3c!--ko if:headerVisible()--\x3e<div class="List-header" data-bind="if:headerType(),attr:{style:headerStyle}">\x3c!--ko component:{name:headerType,params:headerParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="List-placeHolder" data-bind="style:{height:placeHolderHeight()+\'px\'}"></div><div class="List-surface" role="presentation" data-bind="viewport:viewport,marqueeSelection:{selectionModel:selectionModel,layout:activeLayout,isEnabled:enableMarqueeSelection},clearSelection:{selectionModel:selectionModel,isEnabled:enableClearSelection},selection:{isSelectionOnKeyInputEnabled:isSelectionOnKeyInputEnabled,items:items,layout:activeLayout,selectionModel:selectionModel,isReadyToBeSelected:$component.isReadyToBeSelected.bind($component)},interactionScope:{isActive:isActive},recoverFocus:{isEnabled:isActive,onlyRecoverFromBody:true},customRender:true,contextMenu:contextMenuHelper,attr:{\'aria-label\':tooltip,tabindex:tabIndex},element:surfaceElement"></div></div>'},1884:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isNewAlbum")},1885:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("dateRange")},1900:function(e,t,n){"use strict";var a=function(){function e(){}return e.init=function(){return{controlsDescendantBindings:!0}},e}();t.e=a},1905:function(e,t,n){"use strict";var a=n(0),i=n(56),r=n(430),o=n(23),s=n(509),c=n(283),d=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.responsiveUI=n.resources.consume(s.t),n.commands=n.observables.createArray(),t.disableOverflowHost||(n.overflowHostCommand=new(n.managed(r.e))({text:o.OverflowCommandLabel,tooltip:o.OverflowCommandTooltip,accessibleLabel:o.OverflowCommandTooltip,renderLabel:0,requiredChildren:1,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:new c.e("More"),hasIconOnly:!0,children:n.observables.createArray(),location:3})),n}return Object(a.__extends)(t,e),t}(i.n);t.e=d},1912:function(e,t,n){"use strict";var a=n(0),i=n(165),r=n(1738),o=n(22),s=100,c=function(e){function t(t){var n=e.call(this,t)||this;n._container=Object(r.t)(n.element);var a=o.unwrap(n.valueAccessor()),i=a.enabled,s=void 0===i?o.observable(!1):i,c=a.y,d=void 0===c?o.observable(0):c;return n._enabled=s,n._y=d,n.createComputed(n._computeScrollOnYPosition),n}return Object(a.__extends)(t,e),t.prototype._computeScrollOnYPosition=function(){var e=this._enabled(),t=this._container;if(this.async.clearTimeout(this._timeoutId),this._timeoutId=null,e){var n=t.getBoundingClientRect(),a=this._y(),i=n.top,r=i+n.height,o=0;a<=i+s?o=-(1-(a-n.top)/s):a>=r-s&&(o=1-(n.top+n.height-a)/s)}o&&(t.scrollTop=Math.min(t.scrollHeight-n.height,Math.max(0,t.scrollTop+15*o)),this._timeoutId=this.async.setTimeout(this._computeScrollOnYPosition,30))},t}(i.t);t.e=c},1913:function(e,t,n){"use strict";var a=n(0),i=n(56),r=n(101),o=n(22),s=n(509),c=function(e){function t(t){var n=e.call(this)||this;return n.viewport={width:0,height:0,visibleTop:0,visibleBottom:0},n._itemCanary=o.observable().extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),n._itemSet=t.itemSet,n._scrollBarWidth=s.e.getScrollbarWidth(),n.subscribe(n._itemSet,n.onItemSetChanged),n._subscribeForContentChange(),n._isGrouped=t.isGrouped,n._isGrouped&&n._refreshGroupSubscriptions(),n.subscribe(n._itemCanary,n._onItemCanaryChanged),n}return Object(a.__extends)(t,e),t.prototype.onContentChanged=function(){var e=this;this._disposeItemSubscriptions(),this._itemSubscriptions=[];for(var t=this._itemSet.peek().content.peek().items,n=t.length,a=0;a<n;a++){var i=t[a];i&&i.subscribe&&this._itemSubscriptions.push(i.subscribe(function(){return e._itemCanary({})}))}this._isGrouped&&this._refreshGroupSubscriptions(),this.evaluateLayout(!0)&&this.change()},t.prototype.onItemSetChanged=function(){this._contentSubscription.dispose(),this._subscribeForContentChange(),this.onContentChanged()},t.prototype.getHeaderCell=function(){return null},t.prototype.getItemAspectRatio=function(e){return 1},t.prototype.updateViewport=function(e){this.viewport=e,this.evaluateLayout(Math.round(e.width)!==Math.round(this._lastWidth))&&this.change(),this._lastWidth=e.width},t.prototype.evaluateLayout=function(e){return!0},t.prototype.change=function(){r.t.raise(this,"change")},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._disposeItemSubscriptions(),this._disposeGroupSubscriptions(),this._contentSubscription.dispose()},t.prototype.supportsLazyBinding=function(){return!1},t.prototype.supportsGrouping=function(){return!1},t.prototype.getVisibleRange=function(e){return void 0===e&&(e=this.viewport),{start:0,end:0}},t.prototype.getVisibleItemRange=function(e){return void 0===e&&(e=this.viewport),this.getVisibleRange(e)},t.prototype.getRequiredGroup=function(){return null},t.prototype.getAllFocusableItems=function(){return null},t.prototype.getVisibleItemCount=function(){return 0},t.prototype.onGroupStateChange=function(){this.evaluateLayout(!1)&&this.change()},t.prototype._subscribeForContentChange=function(){this._contentSubscription=this._itemSet.peek().content.subscribe(this.onContentChanged,this)},t.prototype._onItemCanaryChanged=function(){this.evaluateLayout(!0)&&this.change()},t.prototype._disposeItemSubscriptions=function(){if(this._itemSubscriptions)for(var e=0;e<this._itemSubscriptions.length;e++)this._itemSubscriptions[e].dispose();this._itemSubscriptions=null},t.prototype._disposeGroupSubscriptions=function(){if(this._groupSubscriptions&&this._groupSubscriptions.length>0)for(var e=0,t=this._groupSubscriptions;e<t.length;e++)t[e].dispose();this._groupSubscriptions=null},t.prototype._refreshGroupSubscriptions=function(){var e=this;this._disposeGroupSubscriptions(),this._groupSubscriptions=[];var t=this._itemSet.peek().content.peek().groupings;if(t&&t.length)for(var n=0,a=t;n<a.length;n++){var i=a[n].itemGroups;i&&i.length&&i.forEach(function(t){t.state&&e._groupSubscriptions.push(e.subscribe(t.state,e.onGroupStateChange))})}},t}(i.n);t.e=c},1916:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transition:transform .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}"}]);var i,r=n(0),o=n(183),s=n(1801),c=n(1779),d=n(211),l=function(e){function t(t){var n=e.call(this,t)||this;n.thumbnailTagName=s.e.tagName;var a=n.observables,r=n.resources;i||(i=r.consume(d.e).isRetinaSupported?"64_2x":"64"),n.imageRect=t.imageRect,n._item=t.item,n._lastThumbnails=-1,n._thumbnailIndex=-1,n._isPulsingEnabled=!0,n.pulseRecords=a.createArray(),a.compute(n._computeRecords);var o=t.pulseTarget;return o&&o(n),n}return Object(r.__extends)(t,e),t.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&e.folder.covers.length>1)},t.prototype.enablePulsing=function(e){this._isPulsingEnabled=e},t.prototype.pulse=function(){this.canPulse()&&this._isPulsingEnabled&&(this._pushNextRecord(),this.pulseRecords.shift(),this._updatePulseClasses())},t.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:c.e.cover}},t.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",n=e.folder&&e.folder.covers?e.folder.covers.length:-1;t===this._lastKey&&n===this._lastThumbnails||(this._lastKey=t,this._lastThumbnails=n,this.pulseRecords.removeAll(),this._thumbnailIndex=-1,0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord(),this._updatePulseClasses())}},t.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})},t.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()},t.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})},t.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var n=e[t],a=e.length-t-1;n.isEmpty||n.className("od-FolderCoverTile-item"+a),n.isThumbnailVisible(!(!n.thumbnail()||!(n.isThumbnailVisible()||a<2)));var i=this.unwrapObservable(this._item),r=!i.tagInfo&&!n.isThumbnailVisible()&&(1===a||i.isAlbum||i.isDocSet);n.isWatermarkVisible(r),n.watermarkUrl(r?this._getFolderWatermarkUrl():null)}},t.prototype._getFolderWatermarkUrl=function(){var e=this._item(),t="genericfolder";switch(e.isAlbum&&(t="photofolder"),e.isSpecialFolder&&e.specialFolderCanonicalName){case"Music":t="musicfolder";break;case"Documents":t="documentfolder";break;case"Photos":t="photofolder"}return e.isDocSet&&(t="Docset"),window.require.toUrl("odsp-media/images/watermarks/".concat(i,"/").concat(t.toLowerCase(),".png"))},t.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,n=t&&t.length;if(n)return t[this._thumbnailIndex=(this._thumbnailIndex+1)%n]},t}(o.t),u=n(388).e({tagName:"od-folder-cover-tile",template:'<div class="od-FolderCoverTile" data-bind="foreach:pulseRecords"><div data-bind="attr:{class:className}">\x3c!--ko if:isThumbnailVisible--\x3e<div class="od-FolderCoverTile-image" data-bind="component:{name:$component.thumbnailTagName,params:$component.getThumbnailParams($data)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isWatermarkVisible--\x3e<img class="od-FolderCoverTile-watermark" role="presentation" data-bind="attr:{src:watermarkUrl}">\x3c!--/ko--\x3e</div></div>',viewModel:l,synchronous:!0});t.e=u},1924:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(128),r=new a.t({name:"CommandBar.key",loader:new i.t(function(){return n.e(443).then(n.bind(null,2087)).then(function(e){return e.resourceKey.local})})})},1935:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(0),r=n(1913),o=n(155),s=n(1837),c=n(509),d="folder",l="photo";!function(e){e.folder={Small:110,Medium:110,Large:120,XLarge:120,XXLarge:120,XXXLarge:120,XXXXLarge:120},e.documents={Small:130,Medium:130,Large:160,XLarge:160,XXLarge:160,XXXLarge:160,XXXXLarge:160},e.photos={Small:90,Medium:90,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170},e.other={Small:120,Medium:120,Large:170,XLarge:170,XXLarge:170,XXXLarge:170,XXXXLarge:170}}(a||(a={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.visibleRange=null,n.currentGroup=null,n.nextGroup=null,n._headerIndices=[],n.rows=[],n.responsiveHelper=n.resources.consume(c.t),n.canSelectHeaders=!1,n._footerItem=t.footerItem,n._footerItem&&n.subscribe(n._footerItem,function(){n.evaluateLayout(!0)&&n.change()}),n}return Object(i.__extends)(t,e),t.prototype.getOuterMargin=function(){return{top:0,left:0,bottom:0,right:0}},t.prototype.getMinCellWidth=function(){return 40},t.prototype.getInnerMargin=function(){return this.isSmallWidthLayout?3:8},t.prototype.getMinRowHeight=function(){var e,t=this._getGroupName(this.currentGroup),n=this.responsiveHelper.formFactorSize.peek();switch(t){case d:e=a.folder[n];break;case"document":e=a.documents[n];break;case l:e=a.photos[n];break;default:e=a.other[n]}return e},t.prototype.getItemAspectRatio=function(e){var t,n=this._getGroupName(this.currentGroup),a=this.unwrapObservable(e);if(n===d)t=a&&a.isAlbum?1:this.isSmallWidthLayout?4/3:1.6;else if(a&&a.subsite)t=5.5;else if(a&&(a.photo||a.video)&&a.thumbnail&&a.thumbnail.width){var i=a.orientedThumbnail,r=!!i&&i.rotation%2==1,o=(i||a).thumbnail,s=r?o.height:o.width,c=r?o.width:o.height,l=Math.max(s,this.getMinCellWidth()),u=Math.max(c,this.getMinRowHeight());t=Math.max(.5,Math.min(3,l/u))}else t=1;return t},t.prototype.getIsFixed=function(){return this._getGroupName(this.currentGroup)!==l},t.prototype.getCellByKey=function(e){var t;if(this.cells)for(var n=0,a=this.cells;n<a.length;n++){var i=a[n];if(i.key===e){t=i;break}}return t},t.prototype.getItemViewType=function(e){return e?s.e.tagName:null},t.prototype.getItemViewData=function(e){return{item:e,resources:this.resources,group:this.currentGroup,engagementSource:"GridViewTile"}},t.prototype.getVisibleRange=function(e){void 0===e&&(e=this.viewport);var t=this.getRowRangeForViewport(e),n=t.start,a=t.end,i=this.rows[n],r=this.rows[a-1];return this.visibleRange={start:n>=0?i.cells[0].cellIndex:-1,end:a>=0?r.cells[r.cells.length-1].cellIndex+1:-1},this.visibleRange},t.prototype.getMaterializedRange=function(){var e={start:this.visibleRange.start,end:this.visibleRange.end};if(e.start>=0){var t=this.cells[e.end-1].rowIndex-this.cells[e.start].rowIndex+1,n=this.cells[this.visibleRange.start].rowIndex,a=this.cells[this.visibleRange.end-1].rowIndex,i=Math.max(3*t,30),r=Math.max(3*t,30);n=Math.max(0,n-i),a=Math.min(this.rows.length-1,a+r),e.start=this.rows[n].cells[0].cellIndex;var o=this.rows[a];e.end=o.cells[o.cells.length-1].cellIndex+1}return e},t.prototype.getSurfaceSize=function(){var e=this.lastRow,t=this.getOuterMargin();return{width:this.viewport.width,height:e?e.top+e.height+t.bottom:0}},t.prototype.getCellCount=function(){return this.cells.length},t.prototype.getCellAt=function(e){return this.cells&&this.cells[e]},t.prototype.getItemIndexAbove=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),n=t?t.index:-1;return t&&(n=this._findNearestCellInRow(t,-1).index),n},t.prototype.getItemIndexBelow=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e)),n=t?t.index:0;return t&&(n=this._findNearestCellInRow(t,1).index),n},t.prototype.getItemIndexLeft=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));return t&&(t=this._findNextCell(t,o.e.isRightToLeft?1:-1)),t?t.index:-1},t.prototype.getItemIndexRight=function(e){var t=this.getCellAt(this.getCellIndexFromItemIndex(e));return t&&(t=this._findNextCell(t,o.e.isRightToLeft?-1:1)),t?t.index:-1},t.prototype.getItemIndicesInRegion=function(e){for(var t=[],n=0;n<this.rows.length;n++){var a=this.rows[n];if(a.top>e.y+e.height)break;if(a.top<=e.y+e.height&&a.top+a.height>=e.y)for(var i=0;i<a.cells.length;i++){var r=a.cells[i];r.item&&r.left<=e.x+e.width&&r.left+r.width>=e.x&&t.push(r.index)}}return t},t.prototype.getToggleClass=function(){return"ItemTile-rowCheck"},t.prototype.evaluateLayout=function(e){var t=this._itemSet.peek(),n=t&&t.content.peek().items;if(!n||!this.viewport||this.viewport.width<100)return!1;if(e){var a=!0,i=this.responsiveHelper;this.isSmallWidthLayout=i.compareSize(i.formFactorSize(),"Medium")<=0,this.cells=[],this._itemIndexToCell={},this.rows=[],this._headerIndices=[],this.lastRow=null,this._lastRowInGroup=null,this.currentGroup=null,this.nextGroup=null,this.currentRow=null;for(var r=0;r<n.length;r++){var o=n[r];o||(a=!1),this.addToCurrentRow(this.getHeader(n[r-1],o,r),!0),this.addToCurrentRow(this.getCell(o,r))}this._footerItem&&this._footerItem.peek()&&a&&this.addToCurrentRow(this.getFooterCell(this._footerItem)),this.finalizeRow(!0)}return!0},t.prototype.addToCurrentRow=function(e,t){this.addToRow(this.getCurrentRow(),e,t)},t.prototype.addToRow=function(e,t,n){t&&((void 0===t.shouldLineBreak?n:t.shouldLineBreak)?(this.finalizeRow(!0,e.isHeader),(e=this.getCurrentRow()).isHeader=!0,e.cells.push(t),this.finalizeRow(!1,!0)):(this.canAddCell(t)||(this.finalizeRow(!0,!1),e=this.getCurrentRow()),e.aspectRatio+=t.aspectRatio,e.cells.push(t),t.isHeader||t.shouldLineBreak||e.itemCellCount++))},t.prototype.getFooterCell=function(e){var t=e.peek(),n=null;return t.component&&(n={key:"footer",item:t.component,index:-1,cellIndex:this.cells.length,viewType:t.component.name,viewData:t.component.params,aspectRatio:t.aspectRatio?t.aspectRatio:1}),n},t.prototype.getCell=function(e,t){var n=e&&e.peek&&e.peek();return{key:n?n.key:"item-"+t,item:e,index:t,cellIndex:this.cells.length,viewType:this.getItemViewType(n),viewData:this.getItemViewData(e),aspectRatio:this.getItemAspectRatio(e)}},t.prototype.getCellIndexFromItemIndex=function(e){var t=this._itemIndexToCell&&this._itemIndexToCell[e];return t?t.cellIndex:-1},t.prototype.getAvailableWidth=function(){var e=this.getOuterMargin(),t=this.getInnerMargin(),n=this.currentRow?(this.currentRow.cells.length-1)*t:0;return this.viewport.width-(e.left+e.right)-n},t.prototype.finalizeRow=function(e,t){var n=this.currentRow;if(this.currentRow&&this.currentRow.cells.length){var a=this.getOuterMargin(),i=this.getInnerMargin(),r=this.lastRow,o=Math.ceil(this._getRowHeight(n,t)),s=0,c=null,d=null,l=null,u=void 0,f=!1;for(n.top=Math.round(r?r.top+r.height+i:a.top),n.height=o,u=0;u<n.cells.length;u++){var p=(l=n.cells[u]).aspectRatio||0,m=this._determineCellLeft(a,s,o,i,u),_=this._determineCellWidthWithAspectRatio(p,o,a,m);if(f=this._shouldCreateNewRow(l,n,u,_)){c&&(c.width+=_+i);break}l.isFixedWidth&&(p=l.width/o),t&&this._headerIndices.push(this.cells.length),l.cellIndex=this.cells.length,void 0!==l.index&&-1!==l.index&&(this._itemIndexToCell[l.index]=l),this.cells.push(l),l.left=this._determineCellLeft(a,s,o,i,u),l.top=n.top,l.isFixedWidth||(l.aspectRatio?l.width=this._determineCellWidthWithAspectRatio(p,o,a,l.left):l.width=this.viewport.width-a.right-l.left),l.height=o,l.rowIndex=this.rows.length,s+=p,c=l}f&&n.cells.pop(),this.rows.push(n),t?this.currentHeaderCell=n.cells[0]:this.currentHeaderCell&&this.updateHeader(this.currentHeaderCell,n.cells.length),this.lastRow=n,this._lastRowInGroup=t?null:n,this.currentGroup=this.nextGroup,this.currentRow=null,f&&(d=this.makeNewRow(),this.addToRow(d,l,l.isHeader),this.currentRow=d,l.cellIndex===this.cells.length-1&&this.finalizeRow())}},t.prototype.canAddCell=function(e){var t=!1,n=this.getCurrentRow(),a=this.getInnerMargin(),i=this.getMinRowHeight(),r=this.getOuterMargin(),o=this.getRowMaxAspectRatio(r,a,i,n);return this._processCell(e),e&&n.aspectRatio+e.aspectRatio<=o?t=!0:n.isFull=!0,t},t.prototype.getRowMaxAspectRatio=function(e,t,n,a){return(this.viewport.width-(e.left+e.right)-a.cells.length*t)/n},t.prototype.getCurrentRow=function(){return this.currentRow||(this.currentRow=this.makeNewRow()),this.currentRow},t.prototype.makeNewRow=function(){return{cells:[],top:0,height:0,aspectRatio:0,itemCellCount:0}},t.prototype.updateHeader=function(e,t){},t.prototype.getRowRangeForViewport=function(e){var t=-1,n=-1;if(this.rows.length&&e.width>0&&e.height>0){var a=this.rows.length-1,i=this.rows[0],r=this.rows[a],o=i.top,s=r.top+r.height,c=Math.max(o,Math.min(e.visibleTop,s-e.height)),d=Math.min(s,Math.max(e.visibleBottom,o+e.height)),l=i;for(t=0;l&&l.top+l.height<c;)l=this.rows[++t];for(n=t;l&&n<a&&l.top<d;)l=this.rows[++n];n=Math.min(n,a)+1}return{start:t,end:n}},t.prototype._determineCellLeft=function(e,t,n,a,i){return Math.ceil(e.left+t*n+a*i)},t.prototype._determineCellWidthWithAspectRatio=function(e,t,n,a){return Math.min(Math.ceil(e*t),this.viewport.width-n.right-a)},t.prototype._shouldCreateNewRow=function(e,t,n,a){var i=e.shouldNotBeLastInRow&&t.cells.length>1&&n===t.cells.length-1,r=a>0&&a<=30&&n===t.cells.length-1;return i||r},t.prototype._processCell=function(e){var t=this.getOuterMargin();e.width||(e.width=this.viewport.width-t.left-t.right)},t.prototype._getRowHeight=function(e,t){var n=this.getMinRowHeight(),a=0,i=this.getAvailableWidth(),r=this.getOuterMargin(),o=this.getInnerMargin(),s=e.cells[0],c=this.getIsFixed();if(s.width)if(!e.isFull&&c){var d=s.aspectRatio,l=1,u=void 0,f=void 0;do{u=this.viewport.width-(r.left+r.right)-l++*o,d+=s.aspectRatio,f=u/n}while(d<=f);a=(u+=o)/(d-=s.aspectRatio)}else e.isFull?a=i/e.aspectRatio:this._lastRowInGroup&&(a=i/this._lastRowInGroup.aspectRatio);else a=s.height;return Math.max(t?a:n,a)},t.prototype._findNextCell=function(e,t){for(var n=e.cellIndex+t,a=this.cells[n];n>=0&&n<this.cells.length&&void 0===a.index;)n+=t,a=this.cells[n];return a},t.prototype._findNearestCellInRow=function(e,t){var n=-1,a=null,i=e.rowIndex+t,r=this.rows[i],o=this.rows[e.rowIndex];if(r&&r.isHeader&&!this.canSelectHeaders)return e;for(;e&&!a&&r;){for(var s=0;s<r.cells.length;s++){var c=r.cells[s],d=Math.abs(this._getPosition(e,o.isHeader)-this._getPosition(c));void 0!==c.index&&(-1===n||d<n)&&(n=d,a=c)}a||(i+=t,r=this.rows[i])}return a||e},t.prototype._getPosition=function(e,t){var n=t&&this.canSelectHeaders?0:e.width;return e.left+n/2},t.prototype._getGroupName=function(e){var t="";return e&&e.groupingId?t=e.groupingId:!e||void 0===e.closedFuture&&void 0===e.closedPast||(t=l),t},t}(r.e);t.t=u},1942:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(91),i=n(591);function r(e){return function(t){var n=t(i.e);a.e.withManager(n).logData(e)}}},1945:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-newBadge{font-size:11px;font-weight:600}.od-newBadge .od-newBadge-icon{transform:translate(0,-.6em)}[dir=ltr] .od-newBadge .od-newBadge-icon{margin-right:-.46em}[dir=rtl] .od-newBadge .od-newBadge-icon{margin-left:-.46em}html[dir=rtl] .od-newBadge .od-newBadge-icon{transform:translate(0,-.6em) scale(-1,1)}"}]);var i=n(0),r=n(183),o=n(23),s=function(e){function t(t){var n=e.call(this,t)||this;return n.newItemText=o.Create.toUpperCase(),n}return Object(i.__extends)(t,e),t}(r.t),c=n(388).e({tagName:"od-new-badge",template:'<div class="od-newBadge"><span class="od-newBadge-icon ms-Icon ms-Icon--Glimmer" data-bind="icon:true"></span><span class="od-newBadge-text" data-bind="text:newItemText"></span></div>',viewModel:s,synchronous:!0});t.e=c},1963:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notStarted=0]="notStarted",e[e.NotStarted=0]="NotStarted",e[e.inProgress=1]="inProgress",e[e.InProgress=1]="InProgress",e[e.completed=2]="completed",e[e.Completed=2]="Completed",e[e.cancelled=3]="cancelled",e[e.Cancelled=3]="Cancelled",e[e.failed=4]="failed",e[e.Failed=4]="Failed",e[e.unknown=5]="unknown",e[e.Unknown=5]="Unknown"}(a||(a={}))},1970:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}},1987:function(e,t,n){"use strict";var a=n(0),i=n(1935),r=n(2027),o=n(17);Object(o.n)([{rawString:".od-HeaderTile{box-sizing:border-box;height:46px;padding:9px 0}.od-HeaderTile:focus{outline:0}.od-focus--enabled .od-HeaderTile:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-HeaderTile-title{font-size:21px;font-weight:600}"}]);var s=n(388),c=n(183),d=n(42),l=n(1974),u=function(e){function t(t){var n=e.call(this,t)||this,a=t.group,i=a.name,r=a.count;return n.title=i,n.ariaLabel=n._getAriaLabel(i,r),n}return Object(a.__extends)(t,e),t.prototype._getAriaLabel=function(e,t){var n=Object(d.pluralSelect)(t,Object(d.format)(l.I,t),Object(d.format)(l.y,t));return Object(d.format)(l.g,e,n,l._)},t}(c.t),f=Object(s.e)({tagName:"od-header-tile",template:'<div class="od-HeaderTile" tabindex="0" data-bind="attr:{\'aria-label\':ariaLabel}"><div class="od-HeaderTile-title" data-bind="text:title"></div></div>',viewModel:u,synchronous:!0}),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getGroup=function(e,t){var n,a=this._itemSet().content.peek().groupings||[];if(a&&a.length&&a[0].itemGroups)for(var i=0,r=a[0].itemGroups;i<r.length;i++){var o=r[i];if(o){var s=o.startIndex+o.count-1;if(o.startIndex<=e&&s>=e){n=o;break}}}return n},t.prototype.getHeader=function(e,t,n){var a=null,i=t&&t.peek&&t.peek(),r=this.getGroup(n,i);if(r&&!r.isPlaceholder&&this.currentGroup!==r){this.nextGroup=r;var o=this.getHeaderDetails(r,n);0!==n||o.viewType||(o.headerHeight=0);var s=o.key?o.key:i?i.key+"_header":null;s&&(a={key:s,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:o.headerHeight,viewType:o.viewType,viewData:o.viewData})}return a},t.prototype.getHeaderDetails=function(e,t){var n,a="",i={},o=20;return e&&("sharer"===e.groupingId?(0===e.startIndex&&(this.callerLongCid=null===(n=e.data)||void 0===n?void 0:n.sharerLongCid),a=r.e.tagName,i={group:e,cellsInGroup:0,resources:this.resources,callerLongCid:this.callerLongCid},o=84):e.name&&(a=f.tagName,i={group:e},o=46)),{viewType:a,viewData:i,headerHeight:o}},t}(i.t);t.e=p},1996:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(317),r=Object(i.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(511).then(n.bind(null,2353))];case 1:return[2,e.sent().default]}})})})},2017:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n._parent=null,n._parent=t.parent,n}return Object(a.__extends)(t,e),t.prototype.getTextValue=function(e){return this._parent.getTextValue(e)},t}(n(183).t);t.e=i},2027:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".SharerHeader{display:block;padding:8px 0;margin:24px 0;text-decoration:none;vertical-align:middle;font-size:12px}.SharerHeader-userTile{width:40px;height:40px;border-radius:50%;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;position:relative;overflow:hidden;text-align:center;background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html[dir=ltr] .SharerHeader-userTile{float:left}html[dir=rtl] .SharerHeader-userTile{float:right}[dir=ltr] .SharerHeader-userTile{margin-right:8px}[dir=rtl] .SharerHeader-userTile{margin-left:8px}.SharerHeader-userTile.SharerHeader-hasProfileImage{background-color:transparent}.SharerHeader-userTile.ms-Icon{line-height:40px}.SharerHeader-userTile img{position:absolute;top:0;left:0}.SharerHeader-title{font-size:17px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.SharerHeader-subText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";display:inline-block}.SharerHeader-showAll{display:inline-block;padding:0 16px}"}]);var i=n(388),r=n(0),o=n(183),s=n(2267),c=n(42),d=n(61),l=function(e){function t(t){var n=e.call(this,t)||this,a=t.group,i=a.data,r=t.callerLongCid;if(n.name=a.name||"",n.showAllText=s.t,i){var o=i.itemsSharedCount;n.subText=1===o?s.n:c.format(s.e,o),n.profileImageUrl=i.sharerProfileImageUrl;var l=n.resources.consume(d.ye);n.sharerUrl=l.getSharedByUrl(i.sharerLongCid||r,i.sharerCid,i.sharerGroupId),n.isShowAllVisible=t.cellsInGroup<o}return n}return Object(r.__extends)(t,e),t}(o.t),u=i.e({tagName:"ms-sharer-header",template:'<a class="SharerHeader" data-bind="attr:{href:sharerUrl}"><div class="SharerHeader-userTile ms-Icon ms-Icon--Contact" data-bind="icon:true,css:{\'SharerHeader-hasProfileImage\':!!profileImageUrl}"><img data-bind="attr:{src:profileImageUrl}" width="40" height="40" role="presentation"></div><div class="SharerHeader-title" data-bind="text:name"></div><div class="SharerHeader-subText" data-bind="text:subText"></div>\x3c!--ko if:isShowAllVisible--\x3e<div class="SharerHeader-showAll" role="link" data-bind="text:showAllText"></div>\x3c!--/ko--\x3e</a>',viewModel:l});t.e=u},2033:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("requestResponseBatchType")},2037:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"a",function(){return l});var a=n(262),i=n(11),r={edog:"ppe",msit:"msit",spdf:"df"},o=300,s=50,c="mousemove";function d(e){window.open(e,"_blank").opener=null}function l(e){if(Object(i.isFeatureEnabled)(i.DebugWindow)){var t=window.location.search;t&&"?"===t.charAt(0)&&(t=t.substr(1));var n=a.e(t);if(n.lokideployment)return n.lokideployment}return function(e){var t=e.farmLabel.toLowerCase().split("_",1)[0],n=r[t];return"msit"===n&&Object(i.isFeatureEnabled)(i.PeopleCardsLokiDogfood)&&(n="df"),n}(e)}},2040:function(e,t,n){"use strict";n.d(t,"t",function(){return C});var a='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=n(17);Object(i.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var r=n(0),o=n(183),s=n(1877),c=n(62),d=n(91),l=n(42),u=n(1792),f=n(69),p=n(128),m=n(61),_=function(){function e(e,t){this._errorDataSource=t.errorDataSource,this._defaultErrorAction={text:s.n,url:t.urlDataSource.getRootUrl()}}return e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction},e}(),h=Object(p.r)("ErrorProvider",_,{errorDataSource:m.f.optional,urlDataSource:m.ye}),b=n(25),g=n(463),v=n(11),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.error;a._navigation=a.resources.consume(f.e),a._actionMap=a.resources.consume(b.e.optional);var r,o,p,m,_,g,y=a.resources.consume(h);return a.errorClassName="od-Error-imageTag",S(i)?(r=i.errorTitle,o=i.errorCode,p=i.errorDetailedText,m=i.errorDetailedHtml,_=i.correlationId,g=y.getAction(i)):i.message&&(p=i.message),r||(r=s.i),a.errorTitle=r,a.errorDetailedText=p,a.errorHtml=m,a.errorCode=o,Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&"403"===o||p||m||(p=s.a),a.errorDetailedText=p,a.showAction=!!g&&!g.hideButton&&!t.hideAction,g&&(a.actionText=g.text,a.actionUrl=g.url),a.showErrorCode=o&&a.errorTitle===s.i,a.showErrorCode?(c.e.log(i,"ServerError","".concat(o)),a.errorCodeText=l.format(s.S,o)):a.errorCodeText="",a.correlationIdText=_?l.format(s.D,_):"","accessremoved"===o?(a.isAccessRemoved=!0,a.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")):(a.isAccessRemoved=!1,a.imageUrl=a._getRandomImage()),S(i)&&i.actionUrl&&161===i.errorCode&&(a.resources.consume(u.resourceKey)(!1),a.actionText=s.g,a.errorDetailedText=s.v,a.errorCodeText="",a.errorTitle=s.y,a.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg"),a.errorClassName="od-Error-vaultImage",d.e.logData({name:"Vault.Bookmarked.Loaded"})),a}return Object(r.__extends)(t,e),t.prototype.onButtonClick=function(){return this.showAction&&(161===this.errorCode&&this._actionMap?(d.e.logData({name:"Vault.Bookmarked.Unlock"}),new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)):Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&self!==top&&this.actionUrl?(d.e.logData({name:"Error.RequesAccess.Click"}),this._popupCenter(this.actionUrl,"",860,500)):this._navigation.navigateTo(this.actionUrl)),!1},t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error".concat(e,".svg"))},t.prototype._popupCenter=function(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.outerWidth?window.outerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,s=(window.outerHeight?window.outerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-a/2+r,c=window.open(e,t,"scrollbars=yes, width="+n+", height="+a+", top="+s+", left="+o);return window.focus&&c&&c.focus(),c},t}(o.t);function S(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var D=n(388),I=n(166),x=D.e({tagName:"ms-error",template:a,viewModel:y,synchronous:!0}),C=Object(I.t)({name:"Error",automationName:"ms-error",template:a,viewModelType:y});t.e=x},2043:function(e,t,n){"use strict";function a(e,t){return{id:e.id||e.labels.join(",")+t.toString(),labels:e.labels,count:e.count,headers:r(e)}}function i(e){return e.labels}function r(e){if(e.headers)return e.headers;var t=i(e);return e.header?[e.header,t[1],t[2]]:t}n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r})},2052:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"n",function(){return f});var a=n(2043),i=n(2365),r=n(2587),o=n(346),s=n(2257);function c(e,t,n,a,c){var d,l=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),u=!1;if("onthismonth"===n&&a){var f=JSON.parse(a).applyUtilityFiltering;u=!f||f&&!0===c}return d="lastweekpreviousyears"===n||"onthisday"===n&&(s.t||o.n.isFeatureEnabled(s.e))?function(e,t){var n=(new Date).getFullYear(),a=t.getFullYear(),i=n-a,o=a.toString(),s=a.toString();switch(i){case 1:s=o=r.n;break;case 2:s=o=r.a;break;case 3:s=o=r.i;break;case 4:s=o=r.r;break;case 5:s=o=r.o}return{labels:[s,s,s],count:e,headers:[o,o,o]}}(t,l):"onthismonth"===n&&u?function(e,t){var n=t.toLocaleDateString("default",{month:"short",day:"numeric"});return{labels:[n,n,n],count:e,headers:[n,n,n]}}(t,l):{labels:[Object(i.n)(l),Object(i.a)(l),e.getUTCFullYear().toString()],count:t,headers:[Object(i.i)(l),Object(i.t)(l),e.getUTCFullYear().toString()]},d}function d(e,t,n,i,r){var o=c(e,t,i,r);return Object(a.e)(o,n)}function l(e,t,n,a){for(var i=[],r=void 0,o=void 0,s=0,c=0;c<e.length;c++){var l=void 0;l=e[c].dateTakenTime?e[c].dateTakenTime:0===c?new Date:e[c-1].dateTakenTime,r=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())),void 0===o&&(o=r),r.getUTCFullYear()===o.getUTCFullYear()&&r.getUTCMonth()===o.getUTCMonth()&&r.getUTCDate()===o.getUTCDate()||(i.push(d(o,s,i.length,t,n)),s=0,o=r),s++}return s>0&&r&&i.push(d(r,s,i.length,t,n)),"lastweekpreviousyears"===t&&f(i),"onthismonth"===t&&n&&JSON.parse(n).applyUtilityFiltering&&!a&&u(i,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),i}function u(e,t,n,a){for(var i=0,r=0;r<e.length;r++)i+=e[r].count;e[0]={header:t,headers:n,labels:a,count:i},e.splice(1,e.length-1)}function f(e){for(var t,n,a=0;a<e.length-1;a++)(null===(t=e[a].headers)||void 0===t?void 0:t[0])===(null===(n=e[a+1].headers)||void 0===n?void 0:n[0])&&(e[a].count+=e[a+1].count,e.splice(a+1,1),a--)}},2072:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".DetailsRow{overflow:hidden;height:100%;line-height:34px;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.DetailsRow.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsRow.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.DetailsRow.is-selected{background:#00c0ff}}.DetailsRow:focus{outline:1px solid transparent}.od--isNonMobile .DetailsRow.dropping,.od--isNonMobile .DetailsRow:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";outline:1px solid transparent}.od--isNonMobile .DetailsRow:hover.can-select .DetailsRow-check,.od--isNonMobile .DetailsRow:hover.is-selected .DetailsRow-check{opacity:1}.od--isNonMobile .DetailsRow:hover.can-select{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od--isNonMobile .DetailsRow:hover.is-selected{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od--isNonMobile .DetailsRow:active.can-select{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-focus--enabled .DetailsRow.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.DetailsRow-check{display:inline-block;vertical-align:top;padding:7px 8px;opacity:0}.od-Browser--edge .DetailsRow-check,.od-Browser--ie .DetailsRow-check{padding:8px}.DetailsRow.is-checkVisible .DetailsRow-check,.DetailsRow.is-selected .DetailsRow-check{opacity:1}.DetailsRow.dropping .DetailsRow-cell.type .FileTypeIcon-icon{transform:scale(1.5,1.5)}.DetailsRow.is-receivingDrop .DetailsRow-cell.type .FileTypeIcon-icon{transform:scale(1.6,1.6);transition-duration:.1s;transition-timing-function:cubic-bezier(.075,.82,.165,1)}.od-DetailsRow--isMobile .DetailsRow-check{padding:14px 0 17px 8px}html[dir=rtl] .od-DetailsRow--isMobile .DetailsRow-check{padding:14px 8px 17px 0}.od-DetailsRow--isMobile .DetailsRow-check .ItemCheck{vertical-align:baseline}.DetailsRow-cell.type .FileTypeIcon-icon{transition:transform 267ms cubic-bezier(.075,.82,.165,1)}.DetailsRow-cell{cursor:default;padding:0 8px;display:inline-block;vertical-align:top;position:absolute;height:auto;top:50%;transform:translateY(-50%);outline:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12px;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsRow-cell.type{line-height:30px;overflow:visible}.DetailsRow-cell.type .FileTypeIcon{line-height:16px}.DetailsRow-cell>a,.DetailsRow-cell>a:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell>a:hover,.DetailsRow-cell>a:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.DetailsRow-cell:focus{outline:1px solid transparent}.DetailsRow-cell.custom a{font-size:17px;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.DetailsRow-cell.custom .ms-Icon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.DetailsRow-cell.custom .DetailsRow-cellItem{font-size:12px;line-height:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{float:left}html[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{float:right}[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-right:10px}[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-left:10px}.DetailsRow-cell.custom .DetailsRow-cellItem.DetailsRow-cellItem--isLastRowItem{clear:both}.od-focus--enabled .DetailsRow-cell:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.DetailsRow.is-checkVisible .DetailsRow-cell{padding:0}"}]);var i=n(22),r=n(0),o=n(183),s=n(1757),c=n(247),d=function(){function e(e,t){this._column=e,this._parentViewModel=t,this._key=this._column.key,this._isAutoHyperLink=e.isAutoHyperLink,this._parentViewModel&&this._parentViewModel.registerFieldRenderer&&this._parentViewModel.registerFieldRenderer(this._key,this)}return e.prototype.isCacheable=function(){return!this._parentViewModel},e.prototype.renderField=function(e){var t;return this._column.getValue&&(t=this._column.getValue(e)),void 0===t&&(t=e[this._column.key]),void 0===t&&(t=e.properties[this._column.key]),void 0===t&&(t=e.recycleBinProperties[this._column.key]),t=void 0===t?"":Array.isArray(t)?t.join(", "):t,this._isAutoHyperLink||this._column.isAppendOnly||!t||(t=c.e.encodeText(t),this._column.isNote&&t&&(t=t.replace(/\n/g,"<br>"))),t},e.prototype._getThis=function(){return"$data.getFieldRenderer('".concat(this._key,"')")},e.prototype._getOnClick=function(){return"function(data, evt) { ".concat(this._getThis(),".onClick(evt); }")},e}(),l=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.fieldRenderer=function(){return new d(this._column)},t}(d),u=n(224),f=function(e){function t(t,n,a){var i=e.call(this,t,n)||this;return i._jsCode=a,i}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t={};t.CurrentItem=e.properties;var n=this._parentViewModel.resources.consume(u.n);if(n.rawListSchema&&n.rawListSchema.Field)for(var a=0;a<n.rawListSchema.Field.length;a++){var i=n.rawListSchema.Field[a];if(i.Name===this._column.internalName){t.CurrentFieldSchema=i;break}}try{return("string"==typeof this._jsCode?new Function("ctx",this._jsCode):this._jsCode)(t)}catch(e){}},t}(d),p=n(362),m=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){return p.e.getDisplayString(e.size,{ignoreZero:!0})},t}(d),_=n(61),h=n(25),b=n(211),g=n(1778),v=function(e){function t(t,n){var a=e.call(this,t,void 0)||this;a._urlDataSource=n.resources.consume(_.ye);var i=n.resources.consume(b.e);return a._useCustomColumn=i.isMobile&&n.resources.isExposed(h.M)&&n.resources.consume(h.M),a}return Object(r.__extends)(t,e),t.prototype.renderField=function(t){var n=e.prototype.renderField.call(this,t),a=c.e.encodeText(g.t(t)),i=this._urlDataSource.getDefaultClickUrl(t,{urlType:"existing"});return'<a tabindex="-1" aria-label="'.concat(a,'" title="').concat(n,'" href="').concat(i?c.e.encodeText(i):"#",'" data-bind="')+"event: {"+"".concat(this._useCustomColumn?"":"click: function(obj, ev) { return $data.onClick(null, ev); },mousedown: function(obj, ev) { return $data.onMouseDown(null, ev); }")+"}"+'">'.concat(n,"</a>")},t}(d),y=function(e){function t(t,n,a){return e.call(this,t,n)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(t){var n=e.prototype.renderField.call(this,t);return'<a tabindex="-1" href="javascript: " title="'.concat(n,'" data-bind="')+"click: function(obj, ev) { return $data.onClick(null, ev); }"+'">'.concat(n,"</a>")},t}(d);Object(a.n)([{rawString:".od-DateField--newItem{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";margin-right:3px}"}]);var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(t){var n="<span>".concat(e.prototype.renderField.call(this,t),"</span>"),a=null;if(t.dateModifiedValue?a=t.dateModifiedValue:t.dateDeleted&&(a=t.dateDeleted),a&&"dateModified"===this._key){var i=new Date(a).getTime();i&&Math.abs(Date.now()-i)<=36e5&&(n='<span class="od-DateField--newItem">&#10033;<span>'.concat(n))}return n},t}(d),D=S;Object(a.n)([{rawString:".od-FieldRender{text-decoration:none;text-overflow:ellipsis;overflow:hidden}.od-FieldRender-display{cursor:pointer;white-space:nowrap}.od-FieldRender-icon{display:inline-block}[dir=ltr] .od-FieldRender-icon{margin-right:6px}[dir=rtl] .od-FieldRender-icon{margin-left:6px}.od-FieldRender-location:hover,.od-FieldRender-person:hover,.od-FieldRender-sharedWith:hover{cursor:pointer;text-decoration:underline}.od-DetailsRow-cell--Shared .od-FieldRender:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od--isNonMobile .DetailsRow .od-FieldRender-dot{visibility:hidden;padding:0 10px}[dir=ltr] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-left:-10px}[dir=rtl] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-right:-10px}.od--isNonMobile .DetailsRow .od-FieldRender-dot:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od--isNonMobile .DetailsRow .od-FieldRender-dot .ms-Icon--More{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od--isNonMobile .DetailsRow .DetailsRow-cell:focus .od-FieldRender-dot,.od--isNonMobile .DetailsRow:hover .od-FieldRender-dot{visibility:visible}"}]),Object(a.n)([{rawString:"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"}]);var I=n(31),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=this._column,n=e[t.key];return n||(n=e.properties[t.key]),n?'<i class="od-SharedField--shared '.concat(Object(I.O)("People"),'"></i><span>').concat(n,"</span>"):""},t}(d),C=x,O=n(60),w=n(1975),E=n(810),A=function(e){function t(t){var n,a=e.call(this,t)||this;return a._item=t.item,Number(a._item.properties.PrincipalCount)<1?(a.imageClass=Object(I.O)("Lock"),a.imageAlt=w.c,n=w.d):(a.imageClass=Object(I.O)("People"),a.imageAlt=w.l,n=w.u),a.sharingString=c.e.encodeText(n),a}return Object(r.__extends)(t,e),t.prototype.onClick=function(e){var t=this;this.trackPromise(O.n.resolve(n.e(399).then(n.bind(null,3212))).then(E.e)).done(function(n){new(t.resources.injected(n))({useToggleBehavior:!1,isSharingSectionExpanded:!0}).execute(e)})},t}(o.t),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=this.sharedWithViewModel=new(this._parentViewModel.resources.injected(A))({item:e}),n=t.sharingString,a=t.imageClass,i=c.e.encodeText(t.imageAlt);return'<div class="od-FieldRender" href="javascript: " title="'.concat(i,'" data-bind="click: ').concat(this._getOnClick(),'">')+'<span class="od-FieldRender-icon">'+'<i class="'.concat(a,'" alt="').concat(i,'"></i>')+"</span>"+'<span class="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock">'.concat(n,"</span>")+"</div>"},t.prototype.onClick=function(e){this.sharedWithViewModel.onClick(e)},t}(d),k=L;Object(a.n)([{rawString:".ms-callout{display:inline-block;cursor:pointer}.ms-callout-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var M=n(2017),P=n(336),T=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.onDotDotDotClicked=function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("contextmenu",!0,!0,t),t.currentTarget.dispatchEvent(n),this.resources.consume(P.e).logData({name:"Ellipsis.Callout.Click",isIntentional:!0})},t}(M.e),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){return this.dotDotDotViewModel=new(this._parentViewModel.resources.injected(T))({item:i.observable(e)}),'<div class="od-FieldRender-dot" data-bind="'+"click: ".concat(this._getOnClick())+'">'+'<i class="'.concat(Object(I.O)("More"),'"></i>')+"</div>"},t.prototype.onClick=function(e){this.dotDotDotViewModel.onDotDotDotClicked(null,e)},t}(d),F=U,H=n(95),R=n(2037),N=n(11),B=function(e){function t(t){var a=e.call(this,t)||this,r=a.observables,o=t.item();a.item=r.create(o),a._column=t.column,a._peopleCardTimeoutId=-1,a._peopleCardDataTimeoutId=-1,a._profileProvider=a.resources.consume(H.g.optional),a.fieldElement=r.create(null),a.users=r.createArray();var s=o.properties[a._column.key];if(s&&s.length&&(a.users(s),a._profileProvider)){var c=s.map(function(e){return e.sip});a._profileProvider.personRendered(c)}if(Object(N.isFeatureEnabled)(N.PeopleCardsReactComponent)){var d=a.users.peek()[0];if(d){var l=a.resources.consume(u.s);a.createBackgroundComputed(function(){var e=a.fieldElement();e&&a.trackPromise(O.n.resolve(Promise.all([n.e("deferred.resx-deferred"),n.e(212)]).then(n.bind(null,4248))).then(E.e).then(function(t){t.personaRendered(e,d.sip||d.email,l),i.utils.domNodeDisposal.addDisposeCallback(e,function(){t.personaRemoved(e,d.sip||d.email,l)})}))})}}return a}return Object(r.__extends)(t,e),t.prototype.getAriaLabel=function(e){return this._column.name+", "+e},t.prototype.launchPersonaCardAfterDelay=function(e,t){var n=this;void 0===t&&(t=0);var a=this.users.peek()[t];a&&(this._lastMouseMove=e,this._profileProvider&&-1===this._peopleCardDataTimeoutId&&(this._peopleCardDataTimeoutId=this.async.setTimeout(function(){return n._profileProvider.getPeopleCardData(a.email||a.userId||a.sip)},R.e)),-1===this._peopleCardTimeoutId&&(this._peopleCardTimeoutId=this.async.setTimeout(function(){return n.launchPersonaCard(null,t,!0)},R.t)))},t.prototype.cancelDelayedPersonaCardLaunch=function(){this._lastMouseMove=null,this.async.clearTimeout(this._peopleCardTimeoutId),this.async.clearTimeout(this._peopleCardDataTimeoutId),this._peopleCardTimeoutId=-1,this._peopleCardDataTimeoutId=-1},t.prototype.launchPersonaCard=function(e,t,a){var i=this;void 0===e&&(e=null),void 0===t&&(t=0),void 0===a&&(a=!1),e=e||this._lastMouseMove,this.cancelDelayedPersonaCardLaunch();var r=this.users.peek()[t];r&&r.sip&&O.n.resolve(Promise.all([n.e("deferred.resx-deferred"),n.e(212)]).then(n.bind(null,4248))).then(function(e){return O.n.resolve(e.default)}).then(function(t){var n={name:r.title,email:r.email,image:r.picture,sip:r.sip,userId:r.sip};new(i.managed(t))(n).show(e,a)})},t}(o.t),j=B,V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){this.userFieldViewModel=new(this._parentViewModel.resources.injected(j))({item:i.observable(e),column:this._column});var t=this.userFieldViewModel.users.peek();if(!t)return"";for(var n="",a=0,r=0,o=t;r<o.length;r++){var s=o[r],d=c.e.encodeText(s.title),l=c.e.encodeText(this.userFieldViewModel.getAriaLabel(d));n+=""+'<div class="od-FieldRender" aria-label="'.concat(l,'">')+'<span class="'.concat(this._getUserFieldClassNames(),'" data-bind="')+"event: {"+"click: ".concat(this._getOnClickHandler(a),",")+"clickBubble: false,"+"mousemove: ".concat(this._getOnMouseMovedHandler(a),",")+"mouseout: ".concat(this._getOnHoverEndedHandler())+"},"+"element: ".concat(this._getElementBinding())+'">'.concat(d,"</span>")+"</div>",a++}return n},t.prototype.onClick=function(e,t){t="number"==typeof t?t:0,this.userFieldViewModel.launchPersonaCard(e,t)},t.prototype.mouseMoved=function(e,t){this.userFieldViewModel.launchPersonaCardAfterDelay(e,t)},t.prototype.hoverEnded=function(){this.userFieldViewModel.cancelDelayedPersonaCardLaunch()},t.prototype._getOnClickHandler=function(e){return"function(data, evt) { "+this._getThis()+".onClick(evt, "+e+"); }"},t.prototype._getOnMouseMovedHandler=function(e){return"function(data, evt) { "+this._getThis()+".mouseMoved(evt, "+e+"); }"},t.prototype._getOnHoverEndedHandler=function(){return"function(data, evt) { "+this._getThis()+".hoverEnded(); }"},t.prototype._getElementBinding=function(){return this._getThis()+".userFieldViewModel.fieldElement"},t.prototype._getUserFieldClassNames=function(){var e="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock";return(Object(N.isFeatureEnabled)(N.PeopleCardsOnLoki)||Object(N.isFeatureEnabled)(N.PeopleCardsReactComponent))&&(e+=" od-FieldRender-person"),e},t}(d),z=V,G=(n(1813),n(1824)),K=n(2140),W=n(512),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=this._parentViewModel.resources,n=i.observable(e),a=t.consume(b.e).isMobile&&t.consume(h.M.optional),r={iconName:this._getIconName(e),iconUrl:this._getIconUrl(e,a),extension:e.extension,desiredSize:a?48:16,overlayType:K.e.getOverlayType(n),iconFieldAriaLabel:g.e(e),hoverText:K.e.getHoverText(n),onClick:K.e.getOnClick(n,t)};this.fileTypeIconViewModel=new(t.injected(G.e))(r);var o=this.fileTypeIconViewModel.onClick?"FileTypeIcon FileTypeIcon--clickable":"FileTypeIcon",s=this.fileTypeIconViewModel.overlayUrl,d=this.fileTypeIconViewModel.iconFieldAriaLabel.peek(),l=c.e.encodeText(d),u=this.fileTypeIconViewModel.size;return""+'<span class="'.concat(o,'" title="').concat(c.e.encodeText(this.fileTypeIconViewModel.hoverText),'"').concat(d?' aria-label="'.concat(l,'"'):"",' data-bind="click: ').concat(this._getOnClick(),'" tabindex="-1">')+'<img class="FileTypeIcon-icon" src="'.concat(c.e.encodeText(this.fileTypeIconViewModel.iconUrl.peek()||""),'"').concat(d?' alt="'.concat(l,'"'):"",' style="width: ').concat(u,"; height: ").concat(u,"; font-size: ").concat(u,'" data-bind="')+"attr: {"+"src: ".concat(this._getThis(),".fileTypeIconViewModel.iconUrl")+'}" />'+"".concat(s?'<img class="FileTypeIcon-overlay" src="'.concat(c.e.encodeText(s),'" />'):"")+"</span>"},t.prototype.onClick=function(e){"function"==typeof this.fileTypeIconViewModel.onClick&&this.fileTypeIconViewModel.onClick(e)},t.prototype._getIconName=function(e){return e.state&&4===e.state.upload.status?W.t:e.iconName},t.prototype._getIconUrl=function(e,t){var n=window.require.toUrl("odsp-media/images/loading/loadingSpinner.gif");return e.state&&1===e.state.upload.status?n:e.iconUrl},t}(d),Q=q;Object(a.n)([{rawString:".od-TagField{box-sizing:border-box;cursor:pointer;height:56px;display:flex;align-items:center}.od-TagField .od-TagField-image{background-color:rgba(0,0,0,.25);height:32px;width:32px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";overflow:hidden}html[dir=ltr] .od-TagField .od-TagField-image{float:left}html[dir=rtl] .od-TagField .od-TagField-image{float:right}.od-TagField .od-TagField-name{max-width:150px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle;height:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html[dir=ltr] .od-TagField .od-TagField-name{float:left}html[dir=rtl] .od-TagField .od-TagField-name{float:right}[dir=ltr] .od-TagField .od-TagField-name{margin-right:5px}[dir=rtl] .od-TagField .od-TagField-name{margin-left:5px}[dir=ltr] .od-TagField .od-TagField-name{margin-left:12px}[dir=rtl] .od-TagField .od-TagField-name{margin-right:12px}.od-TagField .od-TagField-count{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";font-weight:400;font-size:11px;line-height:56px}"}]);var Y=n(42),J=n(677),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=e.childCount,n=Object(Y.format)(Object(Y.pluralSelect)(t,J.c,J.s),t),a=e.folder,i=a&&a.covers[0];return'<div class="od-TagField">'+'<div class="od-TagField-image">'.concat(i?'<img src="'.concat(Object(Y.format)(i.url,32,32),'" alt="" />'):"","</div>")+'<div class="od-TagField-name ms-font-m">'.concat(c.e.encodeText(e.name),"</div>")+'<div class="od-TagField-count"'.concat(c.e.encodeText(n),"</div>")+"</div>"},t}(d),Z=X;Object(a.n)([{rawString:".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}.DetailsRow-cell a.od-FieldRender-display,.DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell a.od-FieldRender-display:hover,.DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}]);var $=function(e){function t(t,n,a){var i=e.call(this,t,n)||this;return i._isPicture=!!a,i._url="",i}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var n=e.properties[this._column.key+".desc"];n||(n=t),this._url=t;var a=c.e.encodeText(t),i=c.e.encodeText(n);return this._isPicture?'<div class="od-FieldRender-image">'+'<img src="'.concat(a,'" title="').concat(i,'" class="od-FieldRender-imageDisplay" data-bind="')+"click: ".concat(this._getOnClick(),",")+'clickBubble: false"></a></div>':'<div class="od-FieldRender">'+'<a class="od-FieldRender-display od-FieldRender-display--link" href="'.concat(a,'" tabindex="-1" title="').concat(a,'" target="_blank" data-bind="')+"click: ".concat(this._getOnClick(),",")+'clickBubble: false">'+"".concat(i)+"</a></div>"},t.prototype.onClick=function(e){e&&e.target&&this._url&&window.open(this._url,"_blank")},t}(d),ee=n(1074),te=n(52),ne=n(2130),ae=n(166),ie=function(e){function t(t){var n=e.call(this,t)||this;n._column=t.column;var a=t.item.properties[n._column.key];return(a&&"string"==typeof a||Array.isArray(a)&&a.length)&&(n.lookups=a),n}return Object(r.__extends)(t,e),t.prototype.launchLookupDisplayForm=function(e,t){var n=this._column.dispFormUrl;return n+="&ID=",n+=t,n+="&RootFolder=*&IsDlg=1",this.resources.consume(ee.e).requestDialog({title:"",size:"Large",control:Object(ae.a)(ne.e,{componentUrl:n,showInDialog:!0,heightOffset:.5})}).wait().then(function(){return{resultType:te.e.Success}})},t}(o.t),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){this._lookupFieldViewModel=new(this._parentViewModel.resources.injected(ie))({item:e,column:this._column});var t=this._lookupFieldViewModel.lookups,n="";if("string"==typeof t)n=c.e.encodeText(t);else if(t)for(var a=0;a<t.length;a++){var i=t[a],r=c.e.encodeText(i.lookupValue);n+='<div class="od-FieldRender" aria-label="'.concat(r,'">')+'<span class="od-FieldRender-display od-FieldRender-display--link" data-bind="'+"click: function (data, evt) { ".concat(this._getThis(),".onClick(evt, ").concat(a,"); },")+"clickBubble: false"+'">'.concat(r,"</span>")+"</div>"}return n},t.prototype.onClick=function(e,t){this._lookupFieldViewModel.launchLookupDisplayForm(e,this._lookupFieldViewModel.lookups[t].lookupId)},t}(d),oe=re,se=function(e){function t(t){var n=e.call(this,t)||this,a=t.item();n.item=i.observable(a),n._column=t.column,n.terms=i.observableArray(null);var r=a.properties[n._column.key];return!r||r instanceof Array||""===r||(r=[{Label:r.Label,TermID:r.TermID}]),r&&r.length>0&&n.terms(r),n}return Object(r.__extends)(t,e),t}(o.t),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){this._taxonomyFieldViewModel=new(this._parentViewModel.resources.injected(se))({item:i.observable(e),column:this._column});for(var t="",n=0,a=this._taxonomyFieldViewModel.terms();n<a.length;n++){var r=a[n],o=c.e.encodeText(r.Label);t+=""+'<div class="od-UserField" aria-label="'.concat(o,'">')+'<span class="ms-noWrap ms-imnSpan ms-displayInlineBlock">'.concat(o,"</span>")+"</div>"}return t},t}(d),de=ce;Object(a.n)([{rawString:".ms-Attachment-icon{font-size:16px;vertical-align:bottom;padding:0;border:0;width:30px;height:30px}"}]);var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(t){var n=e.prototype.renderField.call(this,t);return'<div class="ms-Attachment-icon">'+"".concat("1"===n?'<span class="'.concat(Object(I.O)("Attach"),'"></span>'):"")+"</div>"},t}(d),ue=le,fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=e[this._column.key];return void 0===t&&(t=e.properties[this._column.key]),void 0===t&&(t=e.recycleBinProperties[this._column.key]),void 0===t?"":Array.isArray(t)?t.join(", "):t},t}(d),pe=fe,me=(n(2083),n(2084)),_e=n(2528),he=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){if(!e.properties||!e.properties.progress)return"";this.viewModel=new(this._parentViewModel.resources.injected(me.e))({progress:e.properties.progress});var t=this._getThis(),n="".concat(t,".getTitle()");return'<div class="ProgressBar-listview-track" data-bind="attr: {'+"'aria-label': ".concat(n,",")+"'title': ".concat(n)+'}"><div class="ProgressBar-listview-value" data-bind="style: {'+"width: ".concat(t,".viewModel.percentage() + '%'")+'}"></div></div>'},t.prototype.getTitle=function(){return Object(Y.format)(Object(Y.getLocalizedCountValue)(_e.e,_e.t,this.viewModel.current()),this.viewModel.current())},t}(d);Object(a.n)([{rawString:".DetailsRow-cell.AverageRating{overflow:visible}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{width:16px;text-align:center;vertical-align:top;height:36px;position:relative;top:1px;cursor:pointer}.od-Rating-starEmpty:after,.od-Rating-starEmpty:before,.od-Rating-starFull:after,.od-Rating-starFull:before,.od-Rating-starHalf:after,.od-Rating-starHalf:before,.od-Rating-starHover:after,.od-Rating-starHover:before{vertical-align:top;position:relative;top:10px}.od-Rating-enabled.od-Rating-starHalf:focus,.od-Rating-starEmpty.od-Rating-enabled:focus,.od-Rating-starFull.od-Rating-enabled:focus,.od-Rating-starHalf.od-Rating-enabled:focus,.od-Rating-starHover.od-Rating-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Rating-enabled.od-Rating-starHalf:active,.od-Rating-starEmpty.od-Rating-enabled:active,.od-Rating-starFull.od-Rating-enabled:active,.od-Rating-starHalf.od-Rating-enabled:active,.od-Rating-starHover.od-Rating-enabled:active{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Rating-starFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-Rating-starEmpty,.od-Rating-starHalf{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";position:relative}@media screen and (-ms-high-contrast:active){.ms-Icon.ms-Icon--FavoriteStarFill.od-Rating-starHalf:before,.od-Rating-starEmpty.ms-Icon.ms-Icon--FavoriteStarFill:before{content:'\\E734'}}.od-Rating-starHalf:after{font-family:FabricMDL2Icons;content:'\\E735';width:40%;overflow:hidden;position:absolute;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-Rating-starHalf:after{left:2px}[dir=rtl] .od-Rating-starHalf:after{right:2px}.od-Rating-starHover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Rating-count{display:inline-block;vertical-align:top;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;line-height:36px}[dir=ltr] .od-Rating-count{margin-left:8px}[dir=rtl] .od-Rating-count{margin-right:8px}"}]);var be=n(1740),ge=n(1992),ve=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._ratingDataSource=a._parentViewModel.resources.consume(_.Z),a._itemProvider=a._parentViewModel.resources.consume(be.resourceKey),a._pageContext=a._parentViewModel.resources.consume(u.s),a.onMouseover=function(e){return a._highlightStars(e,!1)},a.onMouseout=function(e){return a._highlightStars(e,!0)},a}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){this._listItem=e;var t=!Object(ge.t)(e,this._pageContext.userId);this._rateBylength=e.reputationProperties.RatedBy?e.reputationProperties.RatedBy.length:0,this._averageRating=parseFloat(e.reputationProperties.AverageRating);for(var n='<a tabindex="0">',a=0;a<5;a++){var i=this._averageRating>=a+1?"Full":this._averageRating>a?"Half":"Empty",r="od-Rating-star".concat(i," ").concat(Object(I.O)("FavoriteStarFill"));r+=t?" od-Rating-enabled":"",n+='<div tabindex="0" id="'.concat(a,'" title="" class="').concat(r,'" '),n+=t?'data-bind="\nclick: '.concat(this._getOnClick(),",\nevent: {\n    mouseover: function(data, evt){").concat(this._getThis(),".onMouseover(evt)},\n    mouseout: function(data, evt){").concat(this._getThis(),'.onMouseout(evt)}\n}"'):"",n+="></div>"}return n+'</a><span tabindex="0" title="'.concat(w.o,'" class="od-Rating-count">').concat(this._rateBylength,"</span>")},t.prototype.onClick=function(e){if(e&&e.target){var t=e.target;this._averageRating=this.computeAverageRating(Number(this._selectedStarid)+1),this._highlightStars(e,!0),this.setRating(e,Number(t.id)+1)}e.cancelBubble=!0,e.preventDefault()},t.prototype._highlightStars=function(e,t){if(e&&e.target){var n=e.target,a=n.parentElement.children,i=t?"od-Rating-starFull":"od-Rating-starHover";this._selectedStarid=Number(n.id);var r=this._averageRating,o=t?r-1:this._selectedStarid;a[this._selectedStarid].setAttribute("title",this.getElementTitle()),a[this._selectedStarid].setAttribute("aria-label",this.getAriaLabel());for(var s=0;s<5;s++)a[s].className="".concat(s<=o?i:"od-Rating-starEmpty"," ").concat(Object(I.O)("FavoriteStarFill"));var c=a[Math.floor(r)];t&&r&&r%1&&c&&(c.className="od-Rating-starHalf ".concat(Object(I.O)("FavoriteStarFill")))}},t.prototype.setRating=function(e,t){var n=this,a={item:this._listItem,rating:t};return this._ratingDataSource.setRating(a).then(function(e){return isNaN(e)||(n._averageRating=e),n._itemProvider.invalidateItem(n._listItem.parentKey,{triggerFetch:!0})})},t.prototype.rated=function(){for(var e=this._listItem.reputationProperties,t=e.Ratings.split(","),n=e.RatedBy||[],a=0;a<n.length;a++)if(Number(n[a].id)===this._pageContext.userId)return Number(t[a]);return-1},t.prototype.getElementTitle=function(){var e=this.rated();return-1!==e?Y.format(w.r,e):Y.format(w.e,Number(this._selectedStarid)+1)},t.prototype.getAriaLabel=function(){var e=this.rated(),t=this._averageRating>0?Y.format(Y.pluralSelect(this._averageRating,w.t,w.n),this._averageRating):"";return(t+=-1!==e?Y.format(w.r,e):"")+Y.format(w.e,Number(this._selectedStarid)+1)},t.prototype.computeAverageRating=function(e){var t=this._averageRating||0,n=this._rateBylength;return-1!==this.rated()&&0!==n?(t*n-this.rated()+e)/n:(t*n+e)/(n+1)},t}(d);Object(a.n)([{rawString:".ms-workflowStatus--linkText>span{font-size:12px}"}]);var ye=n(69),Se=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._navigation=n.resources.consume(ye.e),a}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var n=this._getWorkflowStatusUrlAndDisplay(t),a=c.e.encodeText(n.url),i=c.e.encodeText(n.display);return""+'<a class="ms-workflowStatus--linkText" href="'.concat(a,'" title="').concat(a,'" target="_blank" data-bind="click: ').concat(this._getOnClick(),', clickBubble: false">')+"".concat(i)+"</a>"},t.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,n=null;"A"===t.tagName?n=t.href:"IMG"===t.tagName&&(n=t.src),this._navigation.navigateTo(n)}},t.prototype._getWorkflowStatusUrlAndDisplay=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("a");return{url:n.href,display:n.innerHTML}},t}(d);Object(a.n)([{rawString:".od-Like{height:34px;line-height:34px;padding:0 8px;display:inline-block;position:relative;top:1px}.od-Like.od-Like-enabled:hover{cursor:pointer}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty,.od-Like.od-Like-enabled:hover .od-Like-heartFull{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty:before{content:'\\e16a'}.od-Like.od-Like-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Like.is-disabled .od-Like-heartEmpty,.od-Like.is-disabled .od-Like-heartFull{color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Like.is-disabled .od-Like-count,.od-Like.is-disabled .od-Like-text{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Like-heartEmpty,.od-Like-heartFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:16px}[dir=ltr] .od-Like-count{margin-left:8px}[dir=rtl] .od-Like-count{margin-right:8px}[dir=ltr] .od-Like-count{margin-right:4px}[dir=rtl] .od-Like-count{margin-left:4px}"}]);var De=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._ratingDataSource=a._parentViewModel.resources.consume(_.Z),a._itemProvider=a._parentViewModel.resources.consume(be.resourceKey),a._pageContext=a._parentViewModel.resources.consume(u.s),a}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){return this._listItem=e,this._likeCount=Number(this._listItem.properties.LikesCount)||0,this._isEnabled=!Object(ge.t)(e,this._pageContext.userId),'\n<div class="od-Like" '.concat(this._isEnabled?'data-bind="click: '.concat(this._getOnClick(),'"'):"",'>\n  <div class="').concat(this.getHeartClass(),'"></div>\n  <span class="od-Like-count">').concat(this._likeCount,'</span>\n  <span class="od-Like-text">').concat(w.i,"</span>\n</div>")},t.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,n=!this.isLiked();t.firstElementChild.className=this.getHeartClass(),this.setLike(n),t.getElementsByClassName("od-Like-count")[0].innerHTML=String(this._likeCount+(n?1:-1))}e.cancelBubble=!0,e.preventDefault()},t.prototype.setLike=function(e){var t=this,n={item:this._listItem,like:e};return this._ratingDataSource.setLike(n).then(function(e){return isNaN(e)||(t._likeCount=e),t._itemProvider.invalidateItem(t._listItem.parentKey,{triggerFetch:!0})})},t.prototype.isLiked=function(){var e=this,t=this._listItem.reputationProperties.LikedBy;return t&&t.some(function(t){return Number(t.id)===e._pageContext.userId})},t.prototype.getHeartClass=function(){return(this.isLiked()?"od-Like-heartFull ".concat(Object(I.O)("HeartFill")):"od-Like-heartEmpty ".concat(Object(I.O)("Heart")))+(this._isEnabled?" od-Like-enabled":"")},t}(d),Ie=n(1780),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.renderField=function(e){return Ie.r(e)},t}(d),Ce=xe,Oe=function(){function e(){}return e.RenderFieldByType=function(t,n,a){return e.GetFieldRenderer(t,a,n).renderField(n)},e.GetFieldRenderer=function(e,t,n){var a=null;if(null!=t.fieldRenderer&&t.fieldRenderer.isCacheable())return t.fieldRenderer;var i=window.SPClientTemplates;if(i){var r=i.TemplateManager;if(r){var o=r.c_templateOverrides;if(o&&o[t.internalName]&&o[t.internalName].View)return new f(t,e,o[t.internalName].View)}}switch(t.fieldType){case s.e.Computed:a=new l(t).fieldRenderer();break;case s.e.ComplianceRecordFlag:a=new Ce(t);break;case s.e.FileSize:a=new m(t);break;case s.e.Name:a=new v(t,e);break;case s.e.Title:a=new y(t,e,n);break;case s.e.Shared:a=new C(t,e);break;case s.e.SharedWith:a=new k(t,e);break;case s.e.DotDotDot:a=new F(t,e);break;case s.e.User:a=new z(t,e);break;case s.e.FileIcon:a=new Q(t,e);break;case s.e.DateTime:a=new D(t);break;case s.e.Tag:a=new Z(t,e);break;case s.e.Hyperlink:a=new $(t,e);break;case s.e.Image:a=new $(t,e,!0);break;case s.e.Lookup:a=new oe(t,e);break;case s.e.Taxonomy:a=new de(t,e);break;case s.e.Activity:a=new pe(t,e);break;case s.e.Attachments:a=new ue(t,e);break;case s.e.AverageRating:a=new ve(t,e);break;case s.e.WorkflowStatus:a=new Se(t,e);break;case s.e.ProgressBar:a=new he(t,e);break;case s.e.RatedBy:case s.e.Ratings:a=new ve(t,e);break;case s.e.Likes:case s.e.LikedBy:a=new De(t,e);break;default:a=new d(t)}return a},e}(),we=n(1830),Ee=n(155),Ae=n(1794),Le=n(1068),ke=n(1900),Me=n(1836),Pe=function(){function e(e){this._detailsRowViewModel=e.rowViewModel,this._rootElement=e.rootElement.getElementsByClassName("DetailsRow")[0],this._bindingsActive=!1}return e.prototype.activateBindings=function(){this._bindingsActive||(i.applyBindingsToDescendants(this._detailsRowViewModel,this._rootElement),this._bindingsActive=!0)},e.prototype.refreshRow=function(){this.renderRow(),this.activateBindings()},e.prototype.renderRow=function(){this._rootElement.innerHTML=this._getRowHtml(),this._bindingsActive=!1},e.prototype._getCustomColumnHtmlValue=function(e){for(var t="",n=0,a=0,i=e;a<i.length;a++){var r=i[a],o=n!==r.customRowNumber;t+='<span class="DetailsRow-cellItem '.concat(o?"DetailsRow-cellItem--isLastRowItem":"",'">').concat(this._detailsRowViewModel.getHtmlValue(r),"</span>"),n=r.customRowNumber}return t},e.prototype._getRowHtml=function(){for(var e=this._detailsRowViewModel.columns.peek(),t=!1,n=0,a=e;n<a.length;n++)if((l=a[n]).customFields){t=!0;break}for(var r='<span role="{6}" class="{0}" {5} style="{1}" {2}data-bind="'+(t?"click: $data.onSelectableItemClick.bind($data, {3}), longTap: { callback: $data.onLongTap.bind($data) },":"")+'attr: { tabindex: $data.getCellTabindex({3}) }, hasFocus: $data.getCellFocusObservable({3}),keyboard: { mappings: { Enter: $data.onEnter.bind($data, {3}), Left: $data.onLeft.bind($data), Right: $data.onRight.bind($data) }}">{4}</span>',o=!this._detailsRowViewModel.isMobile||this._detailsRowViewModel.isCheckVisible?'<div class="DetailsRow-check" data-bind="click: onItemCheckClick"><div class="ItemCheck"><div class="ItemCheck-background"></div><div class="ItemCheck-check"></div></div></div>':"",s="",d=0;d<e.length;d++){var l=e[d],u=i.observable(d),f=this._detailsRowViewModel.getCellAriaLabel(u),p=this._detailsRowViewModel.getTextValue(l),m=this._detailsRowViewModel.getHtmlValue(l);if(l.canAutoResize&&this._detailsRowViewModel.longestRenderedCells&&p){var _=this._detailsRowViewModel.longestRenderedCells[l.internalName];(!_||_.text.length<p.length)&&(this._detailsRowViewModel.longestRenderedCells[l.internalName]={text:p,html:m})}s+=Y.format(r,this._detailsRowViewModel.getClass(l),this._detailsRowViewModel.getStyle(l,u),f?'aria-label="'+c.e.encodeText(f)+'"':"",d,l.customFields?this._getCustomColumnHtmlValue(l.customFields):m,l.showTooltip?'title="'+c.e.encodeText(p)+'"':"",l.isRowHeader?"rowheader":"gridcell")}return"".concat(o,'<span class="DetailsRow-columns">').concat(s,"<span>")},e}(),Te=n(1829),Ue=n(1070),Fe=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor();return n._callback=a.callback,n._delay=a.delay||1e3,n.events.on(n.element,"mousedown",n._onTouchStart),n.events.on(n.element,"touchstart",n._onTouchStart),n.events.on(n.element,"mouseup",n._onTouchEnd),n.events.on(n.element,"touchend",n._onTouchEnd),n}return Object(r.__extends)(t,e),t.prototype._clearTimer=function(){this._timerID&&(this.async.clearTimeout(this._timerID),this._timerID=null)},t.prototype._onTouchStart=function(e){this._clearTimer(),this._timerID=this.async.setTimeout(this._onLongTap.bind(this,e),this._delay)},t.prototype._onTouchEnd=function(e){this._clearTimer()},t.prototype._onLongTap=function(e){this._timerID=null,this._callback&&this._callback(e)},t}(n(165).t),He=n(981),Re=function(e){function t(t,n){var a=e.call(this,t)||this;a.draggable=!0,a.isBasePage=!1,a.isSelected=i.observable(!1),a.focusState=a.createObservable(0),a.isFocused=a.createPureComputed(function(){return!!a.focusState()}),a.isDroppingTarget=i.observable(!1),a.targetDropped=i.observable(!1),a.selectionModel=a.resources.consume(h.C),a._selectionHelper=a.resources.consume(He.t),a.ignoreClickTime=i.observable(0),a.isReceivingDrop=i.observable(!1),a._isSelectionModal=a.resources.consume(Ae.n),a._platform=a.resources.consume(b.e),a._fieldRenderers={},a.item=a.resources.expose(h.r,t.item),a._instrumentationProvider=a.resources.consume(H.d);var r=t.itemSet.peek().schema;a.columns=a.createComputed(function(){return r().filter(function(e){return e.isVisible&&!a._platform.isMobile||a._platform.isMobile&&e.isVisibleMobile})}),a._cellLocations=t.cellLocations,a._onInvoke=t.onInvoke,a._dropHelper=a.resources.consume(we.e),a.longestRenderedCells=t.longestRenderedCells;var o=a.resources.consume(h.e);a._action=new(a.child(o.DefaultClickAction))({item:a.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"}),a.isDroppable=a.createComputed(function(){return a.item().isDropEnabled&&!a.isSelected()}),a.isMobile=a._platform.isMobile,a.isCheckVisible=a.createComputed(function(){return a._isSelectionModal()||a.selectionModel.selection().length>0}),a._currentFocusColumnIndex=i.observable(-1),a._createFocusObservables(),a.subscribe(a._currentFocusColumnIndex,function(e){e>=0&&a.columns.peek().length>0&&a.focusedObservables[e](!1)},!0),a.subscribe(a._currentFocusColumnIndex,function(e){e>=0&&a.columns.peek().length>0&&a.focusedObservables[e](!0)}),a._itemKey=a.createComputed(function(){return a.item().key}),a.subscribe(a._itemKey,function(){a._updateSelectionSubscription(a.item)}),a._updateSelectionSubscription(a.item),a.tabindex=a.createPureComputed(function(){return a.selectionModel.focusedItem()===a.item?0:-1}),a._rowRenderer=new Pe({rowViewModel:a,rootElement:n.element}),a._rowRenderer.renderRow(),a.subscribe(a.item,function(){a._rowRenderer.refreshRow()}),a.subscribe(a._cellLocations,function(){a._rowRenderer.refreshRow()}),a.subscribe(a.columns,function(){a._createFocusObservables(),a._rowRenderer.refreshRow()}),a.createComputed(function(){a.isReceivingDrop()&&a.isReceivingDrop(!1)}).extend({rateLimit:{timeout:167,method:"notifyWhenChangesStop"}}),a.isSelectable=a.createComputed(a._computeIsSelectable),a.isInvokable=a.createComputed(a._computeIsInvokable),a.isMobileRow=a._platform.isMobile&&a.resources.isExposed(h.M)&&a.resources.consume(h.M),a.createBackgroundComputed(function(){var e=a.item();e&&!e.isPlaceholder&&a._instrumentationProvider.userSeeItem(e)});var s={dragAndDrop:Me.e,keyboard:Le.e,customRender:ke.e,delayedHasFocus:Te.e,longTap:Fe,element:Ue.e};return a.addBindingHandlers(s),a}return Object(r.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._updateSelectionSubscription(null)},t.prototype.activateBindings=function(){this._rowRenderer.activateBindings()},t.prototype.getCellFocusObservable=function(e){return this.focusedObservables[e]},t.prototype.getCellTabindex=function(e){var t=-1;return this.focusedObservables[e]()&&(t=0),t},t.prototype.getCellAriaLabel=function(e){return null},t.prototype.getDragData=function(){var e=this,t=this.item.peek(),n=null,a=this.selectionModel;return t.isDraggable&&a.isItemSelected(this.item)&&(n={type:1,item:t,itemSet:a.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:a.selectedCount.peek(),resources:a.resources}}),n},t.prototype.onMayReceiveDrop=function(e){if(!this.isDroppable.peek())return null;var t=this.item&&this.item.peek&&this.item.peek();return!t||1!==e.type&&0!==e.type?null:{targetName:t.name}},t.prototype.onReceiveDrop=function(e){if(!this.isDroppable.peek())return!1;var t=this._dropHelper.processDrop(e,this.item.peek());return t&&this.targetDropped(!0),t},t.prototype.onSelectableItemClick=function(e,t,n){var a=this.ignoreClickTime(),i=(new Date).getTime();if(a&&i-a<=1e3)return n.stopPropagation(),n.preventDefault(),!1;var r=t.columns.peek()[e];if(!this.isCheckVisible()&&"type"!==r.key)return t.onClick(r,n,!0);this.onItemCheckClick(t,n)},t.prototype.onItemCheckClick=function(e,t){var n=this.resources.consume(h.C);return t.shiftKey?n.selectToItem(this.item):(n.toggleItemSelected(this.item),n.setItemFocus(this.item)),t.cancelBubble=!0,t.preventDefault(),!1},t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)},t.prototype.getClass=function(e){return"DetailsRow-cell "+e.key},t.prototype.getStyle=function(e,t){var n=this._cellLocations()[t()];return n&&n.width?"width: "+n.width+"px; "+Ee.e.safeLeft+": "+n.left+"px;":"display: none"},t.prototype.getTextValue=function(e){var t=this.item(),n="";if(t&&e&&!e.isIcon)if(void 0===(n=t[e.key])&&(n=t.properties[e.key]),n&&e.fieldType===s.e.User){for(var a="",i=0,r=Array.isArray(n)?n:[n];i<r.length;i++)a&&(a+=", "),a+=r[i].title;n=a}else n=void 0===n?"":Array.isArray(n)?n.join(", "):n;return n},t.prototype.getHtmlValue=function(e){return Oe.RenderFieldByType(this,this.item.peek(),e)},t.prototype.getEmptyAriaLabel=function(e){return e.isRequired?w.s:w.a},t.prototype.registerFieldRenderer=function(e,t){this._fieldRenderers[e]=t},t.prototype.getFieldRenderer=function(e){return this._fieldRenderers[e]},t.prototype.getItem=function(){return this.item},t.prototype.getRowAriaLabel=function(){return g.n(this.item())},t.prototype.getRowAriaSelected=function(){return this.isSelected().toString()},t.prototype.onClick=function(e,t,n){var a=this.ignoreClickTime.peek(),i=(new Date).getTime();if(a&&i-a<=50)return t.stopPropagation(),t.preventDefault(),!1;var r=e;if(!e||e===this&&this._platform.isMobile||"displayName"===r.key||"name"===r.key||r.fieldType===s.e.Custom){if(this._action.isAvailable.peek())return this.onInvoke(t),t.stopPropagation(),t.preventDefault(),!1}else if(n){var o=this.getFieldRenderer(r.key);return o&&"function"==typeof o.onClick&&o.onClick(t,this.item,this.resources),t.stopPropagation(),t.preventDefault(),!1}},t.prototype.onLongTap=function(e){this.isCheckVisible()||(this.ignoreClickTime((new Date).getTime()),this.onItemCheckClick(this,e))},t.prototype.onMouseDown=function(e,t){t.shiftKey||t.ctrlKey||t.metaKey||(this.selectionModel.isItemSelected(this.item)||this.selectionModel.clear(),this.selectionModel.setItemSelected(this.item,!0),this.selectionModel.setItemFocus(this.item))},t.prototype.onInvoke=function(e){if(!1!==this._onInvoke.call(this,e)&&this._action.isAvailable.peek())return this._action.execute(e),e.stopPropagation(),e.preventDefault(),!1},t.prototype.onEnter=function(e,t,n){return t.onClick(t.columns.peek()[e],n,!0)},t.prototype.onLeft=function(e){var t=Math.max(e._currentFocusColumnIndex()-1,0);return e._currentFocusColumnIndex(t),!1},t.prototype.onRight=function(e){var t=Math.min(e._currentFocusColumnIndex()+1,e.columns.peek().length-1);return e._currentFocusColumnIndex(t),!1},t.prototype.detailsRowOnRight=function(e){return e._currentFocusColumnIndex(-1),e._currentFocusColumnIndex(0),!1},t.prototype._computeIsSelectable=function(){return this.item()&&this.selectionModel.canSelectItem(this.item)},t.prototype._computeIsInvokable=function(){return this._action.isAvailable()},t.prototype._updateSelectionSubscription=function(e){var t=this;this._selectionSubscription&&(this._selectionSubscription.dispose(),this._selectionSubscription=null),this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{focusState:this.focusState,isSelected:this.isSelected,isFocused:this.createObservable(!1),onInvoke:function(e){return t.onInvoke(e)}}))},t.prototype._createFocusObservables=function(){this.focusedObservables=[];for(var e=0;e<this.columns.peek().length;e++)this.focusedObservables.push(i.observable(!1))},t}(o.t),Ne={tagName:"ms-details-row",template:"<div class=\"DetailsRow\" role=\"row\" data-bind=\"click:onClick,delayedHasFocus:{focusState:focusState},css:{dropping:isDroppingTarget,'is-selected':isSelected,'is-focused':isFocused,'is-checkVisible':isMobile&&isCheckVisible,'is-receivingDrop':isReceivingDrop,'can-select':isSelectable,'od-DetailsRow--isInvokable':isInvokable,'od-DetailsRow--isMobile':isMobileRow},attr:{tabindex:tabindex,'aria-label':getRowAriaLabel(),'aria-selected':getRowAriaSelected()},keyboard:{mappings:{Right:detailsRowOnRight},context:$data},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop},customRender:true\"></div>",viewModel:{createViewModel:function(e,t){return new(e.resources.injected(Re))(e,t)}},synchronous:!0};i.components.isRegistered(Ne.tagName)||i.components.register(Ne.tagName,Ne),t.e=Ne},2074:function(e,t,n){"use strict";n.d(t,"e",function(){return D});var a=n(17);Object(a.n)([{rawString:".EmptyFolder{text-align:center}.EmptyFolder.EmptyFolder-content-vault{padding-top:95px}.EmptyFolder-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.EmptyFolder-image .EmptyFolder-imageTag{height:208px;width:auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;max-width:400px;margin:0 auto;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:";font-weight:600}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-size:17px;font-weight:300;padding-top:64px}.EmptyFolder-subText{font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto;padding:8px 16px 0}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}.EmptyFolder-subTextPart2Link-metadataSearch{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.EmptyFolder-subTextPart2Link-metadataSearch:focus,.EmptyFolder-subTextPart2Link-metadataSearch:hover{color:"},{theme:"themeDarker",defaultValue:"#052a65"},{rawString:"}"}]);var i=n(0),r=n(31),o=n(42),s=n(183),c=n(1802),d=n(25),l=n(61),u=n(95),f=n(1841),p=n(2547),m=n(29),_=n(292),h=n(36),b=n(27),g=n(123),v='<i class="EmptyFolder-icon '.concat(Object(r.O)("Add"),'" ></i>'),y=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a.addBindingHandlers({bindableHtml:f.e});var i=a.observables;return a.isDocLib=!0,a._urlDataSource=n.urlDataSource,a._content=i.pureCompute(a._computeContent),a._currentPage=a._urlDataSource.getPageType(),a._isViewOnly=t.isViewOnly,a._item=n.item,a._itemParentHelper=n.itemParentHelper,a._storageOptionsProvider=n.storageOptionsProvider,a._userInfoProvider=n.userInfoProvider,a._viewParams=n.viewParams,a._isOneDriveXboxApp=Object(g.t)(),a._recentDocsNavigationAction=new(a.managed(n.actionMap.NavigationAction))({target:"blank",url:i.pureCompute(function(){return a._urlDataSource.getRecentQueryUrl()})}),a.altText=i.pureCompute(function(){return a._content().altText||""}),a.subText=i.pureCompute(function(){return a._content().subText}),a.subLink=i.pureCompute(function(){return a._content().subLink}),a.subTextMobile=i.pureCompute(function(){return a._content().subTextMobile||a._content().subText}),a.subLinkMobile=i.pureCompute(function(){return a._content().subLinkMobile||a._content().subLink}),a.subTextPostIcon=i.pureCompute(function(){return a._content().subTextPostIcon}),a.title=i.pureCompute(function(){return a._content().title}),a.url=i.pureCompute(function(){return a._content().url}),a.additionalContentCss=i.pureCompute(function(){return a._computeContentCss()}),a}return Object(i.__extends)(t,e),t.prototype.navigateToRecentDocs=function(){return this._recentDocsNavigationAction.execute(null),!1},t.prototype.hasInsertPermission=function(){return!this.observables.unwrap(this._isViewOnly)},t.prototype.emptyFolderSubText=function(){return this._isOneDriveXboxApp?"":p.p},t.prototype.hasSmartFiltersApplied=function(){return!1},t.prototype.onComputeContent=function(){var e,t=this._item(),n=t.queryType,a=this.hasInsertPermission();switch(n){case h.e.Recent:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recent_v2.svg"),title:p.A,subText:p.E};break;case h.e.RecycleBin:case h.e.SecondStageRecycleBin:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recyclebin_v2.svg"),title:p.k,subText:p.L};break;case h.e.Search:var r=void 0,s=void 0;this._currentPage===m.e.Photos?r=p.x:this.isDocLib?(r="",s=o.format(p.M,'<a class="EmptyFolder-subTextPart2 EmptyFolder-subTextPart2Link" href="#" data-bind="click: navigateToRecentDocs">',"</a>")):r=p.b,e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search_v2.svg"),title:p.P,subText:r,subLink:s};break;case h.e.SharedWithMe:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared_v2.svg"),title:p.U,subText:p.T};break;case h.e.DocsInCommon:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared_v2.svg"),title:p.o,subText:p.r};break;case h.e.Subsites:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_sites.svg"),title:p.F,subText:""};break;case h.e.Apps:e=this._getSearchContentOrDefault(p.i);break;case h.e.Popular:e=this._getSearchContentOrDefault(p.w);break;case h.e.ExternallyShared:e=this._getSearchContentOrDefault(p.s);break;case h.e.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:var c=!1;if(this._itemParentHelper.getAncestorOrSelf(t,function(e){return"Music"===e.specialFolderCanonicalName})&&(c=!0),c){if(e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_folder_v2.svg"),title:p.D,subText:a&&p.S||"",subTextMobile:a&&o.format(p.y,v)||""},this._userInfoProvider){var d=this._userInfoProvider.getMarket();d=d&&d.toLowerCase()}break}if(this.hasSmartFiltersApplied()){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_filter.svg"),title:p.l,subText:p.d,altText:p.c};break}if(t.vault&&t.vault.root){var l=this._computeIsPremium()?p.H:p.e;e={title:p.R,subText:l,url:""};break}if(this._item().isRootFolder&&!this.isDocLib)e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_list.svg"),title:p.v,subText:p.g,altText:p.h};else{var u=window.require.toUrl("odsp-media/images/emptyfolder/empty_documents.svg"),f=window.require.toUrl("odsp-media/images/emptyfolder/empty_folder_v2.svg");e={url:this._item().isRootFolder?u:f,title:this._item().isRootFolder?p._:p.m,subText:a&&this.emptyFolderSubText()||"",subTextMobile:a?o.format(p.f,v):void 0}}}return Object(i.__assign)({altText:p.u},e)},t.prototype._computeContent=function(){return this.onComputeContent()},t.prototype._getSearchContentOrDefault=function(e){return this._viewParams()[b.t.queryParamKey]?{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search_v2.svg"),title:p.P,subText:""}:{title:e,url:"",subText:""}},t.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case _.e.singleAlbum:case _.e.Albums:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_album_albumsview.svg"),title:p.n,subText:p.t};break;case _.e.allTags:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"),title:p.O,subText:"",subLink:o.format(p.C,'<a href="'.concat(this._urlDataSource.getTaggingOptionsUrl(),'">'),"</a>")};break;case _.e.allPlaces:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_places.svg"),title:p.a,subText:""};break;case _.e.onThisDay:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_onthisday.svg"),title:p.I,subText:""};break;default:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_allphotosview.svg"),title:p.a,subText:""}}return e},t.prototype._computeIsPremium=function(){return!(!this._storageOptionsProvider||!this._storageOptionsProvider.isReady())&&this._storageOptionsProvider.hasOffice.peek()},t.prototype._computeContentCss=function(){var e=this._item();return e.vault&&e.vault.root?"EmptyFolder-content-vault":""},t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.t.dependencies),{actionMap:d.e,item:d.r,itemParentHelper:c.e,urlDataSource:l.ye,userInfoProvider:u.M.optional,viewParams:d.T,storageOptionsProvider:u.C.optional}),t}(s.t),S=n(166),D=Object(S.t)({automationName:"ms-empty-folder",name:"EmptyFolder",template:'<div class="EmptyFolder" data-bind="class:additionalContentCss">\x3c!--ko if:url--\x3e<div class="EmptyFolder-image"><img id="emptyFolderImg" class="EmptyFolder-imageTag" data-bind="attr:{src:url,alt:altText}"></div>\x3c!--/ko--\x3e<div role="alert"><div class="EmptyFolder-title" data-bind="text:title"></div>\x3c!--ko if:subText||subTextMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subText"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subTextMobile"></span></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:subLink||subLinkMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subLink"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subLinkMobile"></span></div>\x3c!--/ko--\x3e</div>',viewModelType:y})},2083:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".ProgressBar-track{height:2px;position:relative;border-radius:1px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ProgressBar-track .ProgressBar-value--under{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .ProgressBar-track .ProgressBar-value--under{left:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--under{right:0}.ProgressBar-track .ProgressBar-value--exceeded{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{border-left:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{border-right:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{float:right}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{float:left}[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{right:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{left:0}.ProgressBar-listview-track{height:100%}.ProgressBar-listview-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";transition:width 267ms cubic-bezier(.1,.9,.2,1)}.ProgressBar-value{position:absolute;top:0;bottom:0;transition:width 267ms cubic-bezier(.1,.9,.2,1);border-radius:1px}"}])},2084:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this,a=t.progress,i=a.minimum,r=void 0===i?n.createObservable(0):i,o=a.maximum,s=void 0===o?n.createObservable(0):o,c=a.current,d=void 0===c?n.createObservable(0):c,l=t.description,u=void 0===l?n.createObservable(""):l;return n.minimum=r,n.maximum=s,n.current=d,n.description=u,n.size=n.createPureComputed(n._computeSize),n.value=n.createPureComputed(n._computeValue),n.percentage=n.createPureComputed(n._computePercentage),n.normalizedPercentage=n.createPureComputed(n._computeNormalizedPercentage),n}return Object(a.__extends)(t,e),t.prototype._computeSize=function(){return this.maximum()-this.minimum()},t.prototype._computeValue=function(){return this.current()-this.minimum()},t.prototype._computePercentage=function(){return 0===this.size()?0:this.value()/this.size()*100},t.prototype._computeNormalizedPercentage=function(){var e=this.percentage();return e>100?1e4/e:e},t}(n(183).t);t.e=i},2085:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1875),r=new a.t({name:"RightPaneTransclusionProvider.key",factory:i.e})},2091:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".BreadcrumbBar-list{margin:0;padding:0;display:block;white-space:nowrap;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;align-items:center;margin:0;padding:0;display:inline-flex;line-height:37px;height:37px}.BreadcrumbBar-list li:last-child .BreadcrumbBar-item{font-weight:600}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;padding:8px 4px;cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:5px 8px}.BreadcrumbBar-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.BreadcrumbBar-navItem:active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}a.BreadcrumbBar-item{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;line-height:37px;height:37px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-size:17px;font-weight:300}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:21px;font-weight:100;padding-bottom:1px}.lg .BreadcrumbBar-item,.md .BreadcrumbBar-item,.sm .BreadcrumbBar-item,.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:"}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0 2px;margin-top:4px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{padding:0 4px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:"},{theme:"smallFontWeight",defaultValue:"400"},{rawString:"}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76c'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76b'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:21px;font-weight:100}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:28px;font-weight:100;line-height:1}"}]);var i=n(0),r=n(22),o=n(434),s=n(793),c=n(1836),d=n(1830),l=n(340),u=n(509),f=n(183),p=n(811),m=n(69),_=n(283),h=n(1068),b=n(1802),g=n(25),v=n(464),y=n(2543),S=n(42),D=n(12),I=function(e){function t(t){var n=e.call(this,t)||this;n._currentDroppingCrumb=null,n.addBindingHandlers({dismiss:s.e,dragAndDrop:c.e,keyboard:h.e});var a=t.iconClass,i=void 0===a?new _.e("More").getClass():a,o=t.canShowTooltipOverflow,f=void 0!==o&&o;return n._responsiveUI=n.resources.consume(u.t),n._navigation=n.resources.consume(m.e),n._itemParentHelper=n.resources.consume(b.e),n.overflowMenuAriaLabel=y.n,n.iconClass=i,n._item=t.item,n._maxFoldersVisibleLgUp=t.maxFoldersVisibleLgUp,n._maxFoldersVisibleMdDown=t.maxFoldersVisibleMdDown,n.isDroppable=r.observable(!0),n.isDroppingTarget=r.observable(!1),n.isOverflowOpen=r.observable(!1),n.overflowMenuOffset=r.observable(new l.e(-24,24)),n.ariaLabelForBreadCrumbBar=r.observable(""),n._openActionItem=r.observable(null),n.overflowCrumbs=r.observableArray(),n.mouseOverTrigger=n.createObservable(!1),n._canShowTooltipOverflow=f,n._crumbs=t.crumbs,n._actionMap=n.resources.consume(g.e),n._openAction=new(n.managed(n._actionMap.OpenAction))({item:n._openActionItem,openRelation:2}),n.overflowDismissParams={isOpen:n.isOverflowOpen,isAutomatic:n._canShowTooltipOverflow,timeout:100},n._dropHelper=n.resources.consume(d.e),n.crumbs=n.createComputed(function(){return n._computeCrumbs(t.getCrumbs)}),n}return Object(i.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.crumbs.dispose()},t.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)},t.prototype.onMayReceiveDrop=function(e,t){var n=t?r.dataFor(t):null;return n&&n.item&&n.showNextChevron?(this.onRemoveDropLocation(),this._currentDroppingCrumb=n,this._currentDroppingCrumb.isDroppingTarget(!0),{targetName:n.item.name}):(this.onRemoveDropLocation(),null)},t.prototype.onReceiveDrop=function(e,t){var n=t?r.dataFor(t):null,a=this._dropHelper.processDrop(e,n.item);return a&&this.onRemoveDropLocation(),a},t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)},t.prototype.onEnter=function(e,t){t.stopPropagation()},t.prototype.onClick=function(e,t){e.onClick?e.onClick(e,t):e.isOverflow?this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen()):e.item&&!e.isFiltered?(this._openActionItem(e.item),this._openAction.execute(t)):this._navigation.navigateTo(e.url),e&&this.ariaLabelForBreadCrumbBar(S.format(y.t,e.ariaLabel?e.ariaLabel:e.name))},t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,n=[],a=[],i=this._responsiveUI;t=i.compareSize(i.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var r=this._item(),o=[];this._crumbs?o=this._crumbs():r&&r.key&&(e?o=e(r):this._getParentItem(r)&&(o=this._getCrumbsForNonRoots(r)));for(var s=0;s<o.length;s++)n.length<t?n.unshift(o[s]):a.unshift(this._commandForCrumb(o[s]));return a.length&&n.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""}),this.overflowCrumbs().forEach(function(e){e.dispose()}),this.overflowCrumbs(a),n&&n.length>0?n[n.length-1].ariaLabel?this.ariaLabelForBreadCrumbBar(S.format(y.t,n[n.length-1].ariaLabel)):this.ariaLabelForBreadCrumbBar(S.format(y.t,r&&r.key?r.name:n[n.length-1].name)):r&&r.key&&this.ariaLabelForBreadCrumbBar(S.format(y.t,r.name)),n},t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],n=!1,a=this._getAriaLabelsForBreadCrumbs(e);e;){var i=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),o=i.isAvailable.peek();i.dispose();var s=n,c=!n;o||(s=!1,c=!0),e.isStub&&(s=!1,c=!0);var d=e.name,l={key:e.key,url:"#"+e.key,name:d&&"root"!==d?e.name:v.e,showNextChevron:n,isDroppingTarget:r.observable(!1),item:e,isOverflow:!1,isNavItem:s,isStaticItem:c,ariaLabel:a.pop()};t.push(l),n=!0,e=this._getParentItem(e)}return t},t.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],n=void 0;e;){if(n)n=S.format(y.e,n,e.name||v.e),t.push(n);else if(n=e.name||v.e,this._getParentItem(e)){var a=this._getParentItem(e);t.push(a.name)}e=this._getParentItem(e)}return t},t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(o.e))({text:e.name,action:new(this.managed(p.e))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})},t.prototype._getParentItem=function(e){if(!D.e.isActivated("D99057A9-4CBD-49C0-8721-0C2D2A23ADC7","06/23/2021","Use item.parentKey and itemParentHelper to get parent of item")){var t=this._itemParentHelper.getParent(e);return t&&t()}return e.UNSAFE_parent},t}(f.t),x=n(388).e({tagName:"ms-breadcrumb-bar",template:'<nav class="BreadcrumbBar" data-bind="attr:{\'aria-label\':ariaLabelForBreadCrumbBar}"><ul class="BreadcrumbBar-list" data-bind="foreach:crumbs,dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}"><li>\x3c!--ko if:isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href="javascript:;" aria-haspopup="true" data-bind="click:$component.onClick.bind($component),dismiss:$component.overflowDismissParams,attr:{\'aria-expanded\':$component.isOverflowOpen(),\'aria-label\':$component.overflowMenuAriaLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},class:$component.iconClass,event:{mouseover:$component.onOverflowMouseover.bind($parent)}">\x3c!--ko if:$parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if:isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" data-bind="text:name,click:$component.onClick.bind($component),keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},attr:{href:url,title:name},css:{dropping:isDroppingTarget}"></a>\x3c!--/ko--\x3e\x3c!--ko if:isStaticItem--\x3e<span class="BreadcrumbBar-item" data-bind="text:name,attr:{title:name}"></span>\x3c!--/ko--\x3e\x3c!--ko if:showNextChevron--\x3e<i class="BreadcrumbBar-item-chevron" role="presentation"></i>\x3c!--/ko--\x3e</li></ul></nav>',viewModel:I,synchronous:!0});t.e=x},2097:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(14),r=new a.e("recentPlacesKey",{driveId:i.e,endpoint:i.e})},2098:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return D});var a=n(0),i=n(56),r=n(61),o=n(60),s=n(1078),c=n(1740),d=n(95),l=n(132),u=n(798),f=n(457),p=n(1763),m=n(1970),_=n(1963),h=n(1877),b=n(128),g=n(2110),v=n(1087),y=n(1747),S=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._albumDataSource=n.albumDataSource,a._operationProvider=n.operationProvider,a._itemProvider=n.itemProvider,a._urlDataSource=n.urlDataSource,a._tagProvider=n.tagProvider,a._isSingleAlbumItemsScopeEnabled=a.resources.consume(y.c),a}return Object(a.__extends)(t,e),t.prototype.addToAlbum=function(e){for(var t=this,n=new u.e,a=this.observables.createArray(e.items).map(function(a){var i=t._operationProvider.register({name:a.name,type:f.e.addItemsToAlbum,payloads:{addItemsToAlbum:{item:a,album:e.album}},iconName:a.iconName,batch:n});return i.progress.maximum(1),i.progress.current(0),i}),i=0,r=a();i<r.length;i++)r[i].state(l.e.started);return this._albumDataSource.addToAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){t._isSingleAlbumItemsScopeEnabled||(t._itemProvider.invalidateItem(e.album.key),t._itemProvider.invalidateItem(t.getAlbumsParentKey()));for(var i=0,r=a();i<r.length;i++){var o=r[i];o.progress.current(1),o.state(l.e.completed)}return n},function(e){for(var t=0,n=a();t<n.length;t++)n[t].state(l.e.failed);return o.n.wrapError(e)})},t.prototype.createAlbum=function(e,t){var n=this,a=[new p.e("createAlbum="+e.name,e.name)],i=e.keys;return this._albumDataSource.createAlbum(e.name,i).then(function(e){return n._getNewlyCreatedAlbum(e.id)}).then(function(e){a=e?a.map(function(t){return t.succeed(e)}):a.map(function(e){return e.fail(h.i)}),t.update(a)},function(e){return a=a.map(function(t){return t.fail(e.error)}),t.update(a),o.n.wrapError(e)})},t.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],n=0;n<e.length;n++)e[n].photo&&!e[n].video&&t.push(e[n].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)},t.prototype.removeFromAlbum=function(e){var t=this;return this._albumDataSource.removeFromAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){return t._itemProvider.invalidateItem(t.getAlbumsParentKey()),t._itemProvider.invalidateItem(e.album.key),n},function(e){return o.n.wrapError(e)})},t.prototype.createAlbumFromFolder=function(e,n){for(var a=this,i=[new p.e("createAlbumFromFolder="+e.folder.id,e.folder.name)],r=0,s=i;r<s.length;r++)s[r].status=0;return n.update(i),this._albumDataSource.createAlbumFromFolder(e).then(function(e){return a._getNewlyCreatedAlbum(e.id)}).then(function(e){if(!e){var r=h.i;return i=i.map(function(e){return e.fail(r)}),n.update(i),o.n.wrapError(r)}var s=null,c=function(){var r={type:m.e.albumFolderExtraction};s&&(r.workItemIds=s),a._itemProvider.getWorkProgress(r).done(function(r){var o;if(r.progress&&r.progress.length&&(o=r.progress[0]),!o||o.status===_.e[_.e.Completed])return i=i.map(function(t){return t.succeed(e)}),void n.update(i);s||(s=[o.id]),a.async.setTimeout(c,t.ASYNC_DELAY)},function(e){i=i.map(function(e){return e.fail(h.i)}),n.update(i)})};a.async.setTimeout(c,t.ASYNC_DELAY)},function(e){var t=h.i,a=new Error(t);return i=i.map(function(e){return e.fail(a)}),n.update(i),o.n.wrapError(a)})},t.prototype.getAlbumsParentKey=function(e){return void 0===e&&(e={}),this._albumDataSource.getAlbumsParentKey(e)},t.prototype.setCoverPhoto=function(e,t){var n=this,a=this.getAlbumsParentKey(),i=[new p.e(a+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(r){n._itemProvider.invalidateItem(a),n._itemProvider.invalidateItem(e.album.key),i=i.map(function(e){return e.succeed(r.id)}),t.update(i)},function(e){var n=new Error(e);return i=i.map(function(e){return e.fail(n)}),t.update(i),o.n.wrapError(n)})},t.prototype.saveAutoAlbum=function(e,t,n){var a=this,i=e.album,r=i.properties.newTag,s=new p.e(i.key,i);return v.r(i)?(n.update([s]),this._tagProvider.updateTags({items:[i],tagsToDelete:[r],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){s=s.succeed(),n.update([s]),a._itemProvider.invalidateItem(a.getAlbumsParentKey({tagFilter:g.n})),a._itemProvider.invalidateItem(a.getAlbumsParentKey()),a._itemProvider.invalidateItem(i.key)},function(e){var t=new Error(e);return s=s.fail(),n.update([s]),o.n.wrapError(t)})):(s=s.fail(),n.update([s]),o.n.wrap(void 0))},t.prototype.markAutoAlbumAsSeen=function(e,t){var n=e.properties.newTag,a=e.properties.autoAlbumTag;return n&&a?this._tagProvider.updateTags({items:[e],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){return e&&!e.error},function(e){return!1}):o.n.wrap(!1)},t.prototype.convertToAutoAlbum=function(e,t,n){var a=this,i=e.properties.newTag,r=e.properties.autoAlbumTag,s=new p.e(e.key,e);return i?(s=s.fail(),n.update([s]),o.n.wrap(void 0)):(i={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"},r||(r={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"}),this._tagProvider.updateTags({items:[e],tagsToDelete:null,tagsToAdd:[r,i],rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(t){s=s.succeed(),n.update([s]),a._itemProvider.invalidateItem(a.getAlbumsParentKey({tagFilter:g.n})),a._itemProvider.invalidateItem(a.getAlbumsParentKey()),a._itemProvider.invalidateItem(e.key)},function(e){var t=new Error(e);return s=s.fail(),n.update([s]),o.n.wrapError(t)}))},t.prototype._getNewlyCreatedAlbum=function(e){var t=this.getAlbumsParentKey();this._itemProvider.invalidateItem(t);var n={parentKey:t,ownerId:this._urlDataSource.getOwnerId(t),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(n).then(function(t){for(var n=t.content.peek().items,a=n.length,i=0;i<a;i++){var r=n[i].peek();if(r.id===e)return r}})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:s.resourceKey,itemProvider:c.resourceKey,albumDataSource:r.e,urlDataSource:r.ye,tagProvider:d.E}),t.ASYNC_DELAY=5e3,t.ASYNC_RETRY_LIMIT=5,t.ASYNC_RETRY_DELAY=15e3,t}(i.n);t.default=S;var D=Object(b.r)("AlbumProvider",S)},2105:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(8),i=n(128),r=new a.t({name:"OneUp.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(314)]).then(n.bind(null,2400)).then(function(e){return e.resourceKey.local})})});t.e=r},2119:function(e,t,n){"use strict";function a(e){return e.length>0?function(e){return e.large||e.medium||e.small||void 0}(e[0]):void 0}n.d(t,"e",function(){return a})},2130:function(e,t,n){"use strict";var a=n(8),i=n(128),r=new a.t({name:"IFrameDialog.key",loader:new i.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e(149)]).then(n.bind(null,2408)).then(function(e){return e.resourceKey.local})})});t.e=r},2131:function(e,t,n){"use strict";var a=n(0),i=n(22),r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.activeCount=i.observable(0),n}return Object(a.__extends)(t,e),t.prototype.registerPromise=function(e){var t=this;this._incrementCount(),e.done(function(){t._decrementCount()},function(){t._decrementCount()})},t.prototype._incrementCount=function(){var e=this.activeCount.peek();this.activeCount(++e)},t.prototype._decrementCount=function(){var e=this.activeCount.peek();this.activeCount(--e)},t}(n(56).n);t.e=r},2137:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(183),r=n(166),o=n(1792),s=n(2244),c=n(1793),d=n(56),l=n(2085),u=n(1826),f=n(2627),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.infoPaneRegionLabel="",a.transclusionContentTagName=u.e.tagName,a.addBindingHandlers({control:r.n}),a.isInfoPaneExpanded=n.isInfoPaneExpanded,a.infoPaneTransclusionContentParams={provider:n.infoPaneTransclusionProvider},a.infoPaneRegionLabel=f.e,a.infoPaneRole=a.observables.create("complementary"),a.infoPaneControlParams={specification:Object(r.a)(s.e,{}),placeholder:Object(r.a)(c.t,{})},a}return Object(a.__extends)(t,e),t.dependencies=Object(a.__assign)(Object(a.__assign)({},d.n.dependencies),{infoPaneTransclusionProvider:l.e,isInfoPaneExpanded:o.resourceKey}),t}(i.t),m=Object(r.t)({name:"DetailsPaneTransclusionContent",template:"\x3c!--ko if:isInfoPaneExpanded()--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:infoPaneTransclusionContentParams}--\x3e<div data-bind=\"control:infoPaneControlParams,attr:{'aria-label':infoPaneRegionLabel,role:infoPaneRole}\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e",automationName:"ms-details-pane-transclusion-component",viewModelType:p});t.default=m},2138:function(e,t,n){"use strict";var a=n(0),i=n(56),r=n(248),o=function(e){function t(n){var a=e.call(this,n)||this;return a._clearFocusIsUserInput=function(){a.isDisposed||(a._focusIsUserInput=!1)},a._keyForItem=new Map,a._focusIsUserInput=!1,a.mode=n.mode||0,a.maximumSelectedCount=n.maximumSelectedCount,a.getItemKey=n.getItemKey,a._canSelectItem=n.canSelectItem||c,a._selectionModelGroup=n.selectionModelGroup,a._allSelectables={},a._items=[],a.selectedCount=a.createObservable(),a.selection=a.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.isAllSelected=a.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.focusedItem=a.createObservable(),a.focusedItem.equalityComparer=r.n,a.isActive=a.createObservable(!0),a.clear(!0),a._clearFocusIsUserInput=a.async.throttle(a._clearFocusIsUserInput,0,{trailing:!0}),a._selectionModelId="".concat(++t._nextSelectionModelId),a._selectionModelGroup&&a._selectionModelGroup.registerSelectionModel(a,a._selectionModelId),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear(),this._getItemKey=function(n){var a=t.get(n);return a||(a=e(n),t.set(n,a)),a}},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId),this._allSelectables={},this._keyForItem.clear()},t.prototype.clear=function(e){this.isSelectedDefaultState=!1,this._keysExempt={},this._exemptCount=0,e&&(this._focusIndex=-1,this._anchorIndex=-1,this._anchorKey=null,this._focusIsUserInput=!1,this.focusedItem(null)),this.selection.removeAll(),this.isAllSelected(!1),this._updateAllSelectables(),this._updateSelectedCount()},t.prototype.setItems=function(e,t){this._items=e,this._selectableItems=this._items,t&&this.clear(!0),this._onItemsChanged(!0)},t.prototype.setAllFocusableItems=function(e){this._items=e,this._focusIndex=-1,this._onItemsChanged(!1)},t.prototype.getItems=function(){return this._items},t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)},t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)},t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,a=e;n<a.length;n++){var i=a[n],r=this._keyToIndex[i];if(r>=0){var o=this._items[r];this.canSelectItem(o)&&(this._keysExempt[i]=o,t.push(o))}}this._exemptCount=t.length,this.isSelectedDefaultState=!1,this.selection(t),this._updateIsAllSelected(),this._updateSelectedCount(),this._updateAllSelectables(),this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)},t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null},t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)},t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)},t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)},t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))},t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])},t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,a=void 0!==n&&n,i=t.isFocusInput,r=void 0===i||i,o=this.focusedItem.peek(),s=this.getItemKey(e),c=this._keyToIndex[s];if(this._focusIsUserInput=r,e!==o){var d=this.getItemKey(o);this._updateSelectable(d,{focusState:0,isFocused:!1})}c>=0?(d=this.getItemKey(e),this._focusIndex=c,this.focusedItem(e||null),d&&this._updateSelectable(d,{focusState:r?2:1,isFocused:!0})):this.focusedItem(null),a||(this._anchorIndex=c||-1,this._anchorKey=s),this._clearFocusIsUserInput()},t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={}),this.setItemFocus(this._items[e],t)},t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),a=this._allSelectables[n];if(a&&a.length)for(var i=0;i<a.length;i++){var r=a[i];if(r.onInvoke)return r.onInvoke(e)}return!0},t.prototype.setIsActive=function(e){this.isActive(e)},t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var a=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),r=Math.max(a,i),o=[];if(t.length&&r>=0)for(var s=Math.min(a,i);s<=r;s++)o.push(t[s]);this._setItemsSelected(o,!0)}}},t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])},t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var a=n[t];this._canSelectItem(a)&&e.push(a)}this.selection(e),this._keysExempt={},this._exemptCount=0,this._updateIsAllSelected(),this._updateAllSelectables(),this._updateSelectedCount(),this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()},t.prototype.registerSelectable=function(e,t){var n,a=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e),this._allSelectables[n]||(this._allSelectables[n]=[]),this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],r=this.focusedItem.peek()===i,o=r?this._focusIsUserInput?2:1:0,s=this.isItemSelected(i);return this._updateSelectable(n,{focusState:o,isFocused:r,isSelected:s}),{dispose:function(){if(a._allSelectables&&a._allSelectables[n]){var e=a._allSelectables[n];if(1===e.length)delete a._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}},t.prototype.getFocusIndex=function(){return this._focusIndex},t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var a=t[n];this.isItemSelected(a)&&!this.getItemKey(a)&&e.push(n)}return e},t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup},t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)},t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null},t.prototype._setItemSelectedCore=function(e,t,n){var a=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return a.canSelectItem(e)}))return;1===this.mode&&t&&this.clear(),this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var r,o=this.selection.peek();r=t?o.concat([e]):o.filter(function(e){return a.getItemKey(e)!==i}),this.selection(r),this._updateSelectable(i,{isSelected:this.isItemSelected(e)}),this._exemptCount+=t?1:-1,this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype._setItemsSelected=function(e,t){var n,a=this,i=this.selection.peek(),r=[],o=[];e.forEach(function(e){var n=a.getItemKey(e);n&&n in a._keyToIndex&&t!==a.isItemSelected(e)&&a.canSelectItem(e)&&(r.push(n),t&&o.push(e),a._keysExempt[n]?delete a._keysExempt[n]:a._keysExempt[n]=e)}),n=t?i.concat(o):i.filter(function(e){return-1===r.indexOf(a.getItemKey(e))}),this.selection(n),r.forEach(function(e){a._updateSelectable(e,{isSelected:t}),a._exemptCount+=t?1:-1}),this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)},t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];for(var o in t){var s=t[o],c=r[o];this.isObservable(c)&&c(s)}}},t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})},t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={},this._keyForItem.clear(),e&&(this._selectableItemsMap={});var n=this._items,a=[],i=this.getItemKey(this.focusedItem.peek()),r=this._anchorKey;if(n){for(var o=0,s=function(s){var d=n[s],l=c.observables.ignore(function(){return t.getItemKey(d)});if(l&&(c._keyToIndex[l]=s,e&&(c._selectableItemsMap[l]=!0),i&&i===l&&(c._focusIndex=s),r&&r===l&&(c._anchorIndex=s)),c.isItemSelected(d)){if(c.onAddItem&&!1===c.onAddItem(d))return o++,c._keysExempt[l]=d,"continue";a.push(d)}},c=this,d=0;d<n.length;d++)s(d);this._exemptCount+=o,this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1,this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1}),this.selection(a),this._updateIsAllSelected(),this._updateSelectedCount()}},t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)},t._nextSelectionModelId=1,t}(i.n),s=o;function c(e){return!0}var d=n(1740),l=n(60),u=n(25),f=n(210),p=n(52),m=n(22),_=function(e){function t(t){var n=e.call(this,t)||this,a=t.itemSet,i=void 0===a?n.resources.consume(u.o):a,r=t.indexResolver;return n._itemSet=i,n._indexResolver=r,n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):l.n.wrap()},t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)},t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)},t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=t[r];this._isItemResolved(o)||n.push(r)}return n},t}(i.n),h=n(1802),b=n(2129),g=n(1883),v=n(1071),y=n(1132),S=function(e){function t(t){void 0===t&&(t={});var n=this,a={getItemKey:I};m.utils.extend(a,t||{}),n=e.call(this,a)||this;var i=t.itemSet,r=void 0===i?n.resources.consume(u.o):i,o=t.indexResolver,s=t.enableSelectionResolution,c=void 0===s||s;return n.itemSet=r,n.itemProvider=n.resources.consume(d.resourceKey),n._enableSelectionResolution=c,n._itemParentHelper=n.resources.consume(h.e),n._refreshMessageHelper=n.resources.consume(b.e),n._currentItems=n.createPureComputed(n.computeCurrentItems),n._itemKey=n.createPureComputed(n._computeItemKey),n._useItemCacheData=n.resources.consume(g.e),n._itemsStore=n.resources.consume(v.e),n.createComputed(function(){n._onItemSetChanged(n._currentItems())}),n.createComputed(n._computeResetSelectionOnKeyChange),o&&(n._selectionResolver=new(n.managed(_))({itemSet:n.itemSet,indexResolver:o})),n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource(),n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate),n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return l.n.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],a=this.getItems(),i=0;i<a.length;i++)(this.isIndexSelected(i)||!a[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var r={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new f.e,getItemPromises:[]};return this.validateResolvedSelection(r),r.signal.getPromise()}return l.n.wrap(this._unwrapSelection(this.selection.peek(),!0))},t.prototype.validateResolvedSelection=function(e){if(e.resolveAttempt++,e.resolveAttempt>4)e.signal.error({resultType:p.e.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();if(e.getItemPromises=[],e.missingRanges=t,e.pendingCount=t.length,0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}},t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),a=m.utils.extend({},e.itemSet.context);a.avoidSeamSnapping=!0,a.startIndex=n.start,a.endIndex=n.end,a.pageSize=n.end-n.start+1,e.getItemPromises.push(this.itemProvider.getItem(a).then(function(){e.pendingCount--,e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}},t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()},t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,a=this.getMissingIndicies();if(a.length)for(t=a[0],n=a[a.length-1];t>-1;){var i=Math.min(n,t+1e3-1),r={start:t,end:i};e.push(r),t=i===n?-1:i+1}return e},t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]},t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),a=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));a&&a.list?this.getItemKey=D.bind(void 0,a.list.isDocumentLibrary):this.getItemKey=I;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,r=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=r?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0,this.setItems(e,!1),this._refreshMessageHelper.clearRecentlyRefreshedItems()},t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey(),this.clear(!0)},t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);!o&&t||n.push(o)}return n},t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key},t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,a=e.selectedKOItemKeys();n<a.length;n++){var i=a[n];if(i){var r=this._itemsStore.getItem(i);t.push(this.getItemKey(r))}}0===t.length?this.clear():this.setSelectedKeys(t)}},t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();return this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(y.e.optional).then(function(e){e&&t(e)}):e._useItemCacheData()}),this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})},t}(s);function D(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function I(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.e=S},2140:function(e,t,n){"use strict";var a,i=n(0),r=n(2017);!function(e){e[e.none=0]="none",e.checkOut="checkOutOverlay.svg",e.notify="notifyOverlay.svg",e.block="blockOverlay.svg",e.record="recordOverlay.svg"}(a||(a={}));var o=a,s=n(1766),c=n(91),d=n(1778),l=n(1780),u=n(810),f=function(e){function t(n){var a=e.call(this,n)||this;return a.item=n.item,a.iconFieldViewModelType=t,a}return Object(i.__extends)(t,e),t.getOverlayType=function(e){var t=e(),n=o.none,a=t.policyTip;if(a){var i=(a&s.e.block)===s.e.block,r=(a&s.e.notify)===s.e.notify;i?n=o.block:r&&(n=o.notify)}else t.isViolation?n=o.block:t.properties&&t.properties.CheckedOutUserId?n=o.checkOut:t.state&&t.state.upload&&4===t.state.upload.status?n=o.notify:l.o(t)&&(n=o.record);return n},t.getHoverText=function(e){var t=e();return d.i(t)},t.getOnClick=function(e,t){var a=e();return a.policyTip&&a.policyTip&s.e.notify?function(a){return c.e.logData({name:"PolicyTip.LaunchFromListView"}),Promise.all([n.e("deferred.resx-deferred"),n.e(328)]).then(n.bind(null,3121)).then(u.e).then(function(n){new(t.injected(n))({item:e}).execute(a)}),!1}:null},t}(r.e);t.e=f},2169:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(1913),o=n(1794),s=n(25),c=n(2072),d=n(211),l=function(e){function t(t){var n=e.call(this,t)||this;return n._platform=n.resources.consume(d.e),n._selectionModel=n.resources.consume(s.C),n._isSelectionModal=n.resources.consume(o.n),n.cellLocations=i.observable([]),n._checkShown=n.createComputed(function(){return n.isCheckSupported()&&(!n._platform.isMobile||n._isSelectionModal()||n._selectionModel.selection().length>0)}),n.rowCheckWidth=n.createComputed(function(){return n._checkShown()?40:0}),n.createComputed(function(){n._checksOld!==n._checkShown()&&n.evaluateLayout(!0),n._checksOld=n._checkShown()}),n}return Object(a.__extends)(t,e),t.prototype.isCheckSupported=function(){return!0},t.prototype.getSettings=function(){return{headerHeight:32,rowHeight:36,outerPadding:0,innerPadding:8}},t.prototype.getHeaderCell=function(){var e=this.getSettings();return{key:"details-header",index:0,cellIndex:-1,left:e.outerPadding,top:0,width:this.viewport.width-2*e.outerPadding,height:e.headerHeight,viewType:"ms-details-header",viewData:{itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations}}},t.prototype.getSurfaceSize=function(){return{width:this.viewport.width,height:this.getSettings().rowHeight*this._itemSet.peek().content.peek().items.length}},t.prototype.getVisibleRange=function(){var e=this.viewport,t=this.getSettings();return{start:Math.max(0,Math.floor(e.visibleTop/t.rowHeight)),end:Math.min(this._itemSet.peek().content.peek().items.length-1,Math.floor(e.visibleBottom/t.rowHeight))}},t.prototype.getMaterializedRange=function(){var e=this.getVisibleRange(),t=this.viewport,n=this.getSettings(),a=Math.ceil(t.height/n.rowHeight),i=Math.max(3*a,4),r=Math.max(5*a,4);return{start:Math.max(0,e.start-i),end:Math.min(this._itemSet.peek().content.peek().items.length-1,e.end+r)}},t.prototype.evaluateLayout=function(e){var t=this,n=this._itemSet.peek().schema.peek();return(e||Math.round(this.viewport.width)!==Math.round(this._lastViewportWidth)||this._lastColumnCount!==n.length)&&(this._lastColumnCount=n.length,this._lastViewportWidth=this.viewport.width,this.cellLocations(this.calculateCellLocations(n.filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})))),!0},t.prototype.calculateCellLocations=function(e){var t,n,a,i=[],r=0,o=this.viewport,s=this.getSettings(),c=o.width-2*s.outerPadding-this.rowCheckWidth.peek();for(n=0;n<e.length;n++){t=e[n];var d=n>0?s.innerPadding:0,l=t.minWidth||t.width;t.isCollapsable&&r+d+l>c?(l=0,d=0):a=n,r+=l+d,i.push({left:0,width:l})}for(;r<c&&a>=0;){if(void 0!==(t=e[a]).minWidth){var u=c-r,f=Math.min(u,t.width-t.minWidth);i[a].width+=f,r+=f}a--}var p=this.rowCheckWidth.peek();for(n=0;n<e.length;n++)i[n].left=p,p+=i[n].width+s.innerPadding;return i},t.prototype.getCellCount=function(){return this._itemSet.peek().content.peek().items.length},t.prototype.getCellAt=function(e){var t=this._itemSet.peek().content.peek().items[e],n=t?c.e.tagName:null,a=this.getSettings();return{key:t?t.peek().key:"item-"+e,item:t,index:e,cellIndex:e,viewType:n,viewData:{item:t,itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations,onInvoke:this.onRowInvoke},left:a.outerPadding,top:a.rowHeight*e,width:this.viewport.width-2*a.outerPadding,height:a.rowHeight}},t.prototype.onRowInvoke=function(e){return!0},t.prototype.getCellByKey=function(e){for(var t,n=this._itemSet.peek().content.peek().items,a=0;a<n.length;a++){var r=i.utils.unwrapObservable(n[a]);if(r&&r.key===e){t=this.getCellAt(a);break}}return t},t.prototype.getItemIndexAbove=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e-1))},t.prototype.getItemIndexBelow=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e+1))},t.prototype.getItemIndexLeft=function(e){return e},t.prototype.getItemIndexRight=function(e){return e},t.prototype.getItemIndicesInRegion=function(e){var t=[],n=this.getSurfaceSize();if(e.x+e.width>this.getSettings().outerPadding&&e.x<n.width-this.getSettings().outerPadding&&e.y+e.height>0&&e.y<n.height)for(var a=this.getSettings(),i=Math.max(0,Math.floor(e.y/a.rowHeight)),r=Math.min(this._itemSet().content().items.length-1,Math.floor((e.y+e.height)/a.rowHeight)),o=i;o<=r;o++)t.push(o);return t},t.prototype.getToggleClass=function(){return"DetailsRow-check"},t.prototype.supportsLazyBinding=function(){return!0},t}(r.e);t.e=l},2183:function(e,t,n){"use strict";n.d(t,"i",function(){return C}),n.d(t,"n",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"t",function(){return E}),n.d(t,"e",function(){return A});var a=n(571),i=n(515),r=n(226),o=n(411),s=n(687),c=n(30),d=n(14),l=new c.e("playlistPlaybackItem",{currentItemKey:d.e,playbackItemKey:d.e}),u=n(263),f=n(803),p=n(685),m=new c.e("spItemSet",{parentItemKey:f.e.subKeyPart,sortFieldKey:d.e,sortAscending:u.e,filterParams:d.e,groupByFieldKey:d.e,viewKey:p.e.subKeyPart}),_=n(46),h=n(160),b=n(212),g=n(133),v=n(236),y=n(971),S=n(143),D=n(19),I=n(12),x=Object(h.e)(function(e){return a.e.getRUMOneLogger()});function C(e){return function(t){var n=t(x);if(e&&e.keyChanges&&e.keyChanges.currentItemKey!==e.keyChanges.previousItemKey&&b.r(o.e.render.start),!n.isRunning()){var a=L(n,e);e&&a===r.e.none||n.resetLogger()}}}function O(e,t,n,a){return void 0===a&&(a=!1),function(r){n&&n.keyChanges&&n.keyChanges.currentItemKey!==n.keyChanges.previousItemKey&&(b.r(o.e.render.end),b.o("Items-View.Render",o.e.render.start,o.e.render.end));var c=r(x),d=n||{},l=d.itemsScopeItemKey,u=void 0===l?"":l,f=d.itemsScopeInitTime,m=void 0===f?0:f,h="ItemsViewListView".concat(u);c.writeScenarioId("".concat(t||"Unknown",".ItemsViewListView")),c.addExpectedControl(h),I.e.isActivated("5DFC9288-3AE8-41E0-84E4-7A68B2D2E483","06/10/2022","Add W3CPerf timings to Rumone")&&c.collectW3CPerfTimings();var g=L(c,n);c.writePageTransitionType(g);var v=r(function(e){return function(t){return t(Object(S.e)(function(t){var n=(e&&e.keyChanges||{}).currentItemKey,a=t.demandItemFacet(s.e,n),i=a&&a.viewKey,r=i&&p.e.serialize(i);return t.demandItemFacet(_.On,r)}))}}(n)),C=r(function(e){return function(t){return t(Object(S.e)(function(t){var n,a,i,r,o,s=null===(n=null==e?void 0:e.keyChanges)||void 0===n?void 0:n.currentItemKey,c=t.demandItemFacet(D.e,s),d=0;return(null==c?void 0:c.itemKeys)&&(null===(a=null==c?void 0:c.itemKeys)||void 0===a?void 0:a.length)&&c.itemKeys.forEach(function(e){var n=t.demandItemFacet(_.Et,e);n&&n._activity&&d++}),{activityNumber:d,itemNumber:null===(i=null==c?void 0:c.itemKeys)||void 0===i?void 0:i.length,activityPercent:d&&(null==c?void 0:c.itemKeys)&&(null===(r=null==c?void 0:c.itemKeys)||void 0===r?void 0:r.length)?Math.round(d/(null===(o=null==c?void 0:c.itemKeys)||void 0===o?void 0:o.length)*100):0}}))}}(n)),O=c.getMarkerTime(o.e.itemsView.start)||b.i("OnePageNavigation.Start")||m,w=c.getMarkerTime(o.e.authToken.start),E=c.getMarkerTime(o.e.authToken.end),A=c.getMarkerTime(o.e.dataFetch.start),k=c.getMarkerTime(o.e.dataFetch.end),M=c.getMarkerTime(o.e.appStart.start),P=c.getMarkerTime(o.e.processData.start),T=c.getMarkerTime(o.e.processData.end),U=c.getMarkerTime(o.e.resolveData.start),F=c.getMarkerTime(o.e.resolveData.end),H=0;A&&k&&(H=k-A);var R={"itemsView.appStart":{data:M-O>0?M-O:0,needFlatten:!0},"itemsView.render":{data:e-Math.max(m,isNaN(M)?0:M,O)-H,needFlatten:!0}};w&&E&&(R["itemsView.authTokenDuration"]={data:E-w,needFlatten:!0}),A&&k&&(R["itemsView.dataFetch"]={data:H,needFlatten:!0}),P&&T&&(R["itemsView.processData"]={data:T-P,needFlatten:!0}),U&&F&&(R["itemsView.resolveData"]={data:F-U,needFlatten:!0}),v&&(R["listView.viewType"]={data:v,needFlatten:!0}),C&&(R["listView.activityNumber"]={data:JSON.stringify(C),needFlatten:!1});for(var N=Object(y.n)(),B=0,j=Object.keys(N);B<j.length;B++){var V=j[B],z=N[V];z&&(R[V]=z)}a&&Object(y.a)();var G=new i.e({controlId:h,startTime:O,endTime:e});c.writeControlPerformanceData(G),c.writeEUPLBreakdown(JSON.stringify(R))}}function w(e){return void 0===e&&(e=!1),function(t){for(var n=Object(y.n)(),a=t(x),i={},r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],c=n[s];c&&(i[s+".tti"]=c)}e&&Object(y.a)(),a.writeTTIBreakdown(JSON.stringify(i))}}function E(e,t){var n=new v.e(void 0);return function(a){n.setTimeout(function(){var r="Items-View.ContextMenu.Start",o="Items-View.ContextMenu.End";b.r(o);var s=performance.getEntriesByName("".concat(b.t).concat(o),"mark").pop(),c=s?s.startTime:NaN,d="ItemsViewContextMenu",l=0===performance.getEntriesByName("".concat(b.t).concat(d,".FirstRender"),"mark").length,u=performance.getEntriesByName("".concat(b.t).concat(r),"mark").pop(),f=u?u.startTime:NaN;b.o("".concat(d,".").concat(l?"FirstRender":"Render"),r,o);var p=a(x),m=L(p,t);p.writeScenarioId("".concat(e||"Unknown",".").concat(d)),p.addExpectedControl(d),p.writePageTransitionType(m);var _=new i.e({controlId:d,startTime:f,endTime:c});p.writeControlPerformanceData(_),n.dispose()},0)}}function A(e,t,n){return function(a){a(x).addEUPLBreakdown(e,t,n)}}function L(e,t){if(t){if(t.isFullPageLoad)return e.getMarkerTime(g.t)?r.e.onePageAppNavigation:r.e.fullPageLoad;var n=void 0,a=void 0,i=void 0,o=t.keyChanges||{},c=o.previousItemKey,d=void 0===c?void 0:c,u=o.currentItemKey,f=void 0===u?void 0:u;if(s.e.matches(d)&&l.matches(f))return r.e.fullPageLoad;if(d&&s.e.matches(d)&&(n=s.e.deserialize(d)),d&&m.matches(d)&&(a=m.deserialize(d)),f&&s.e.matches(f)&&(i=s.e.deserialize(f)),!n&&!a)return r.e.onePageAppNavigation;if(i){var p=n&&n.listFullUrl||a&&a.parentItemKey&&a.parentItemKey.listFullUrl,_=n&&n.rootFolder||a&&a.parentItemKey&&a.parentItemKey.rootFolder;if(p&&p!==i.listFullUrl)return r.e.onePageAppNavigation;if(_!==i.rootFolder)return r.e.none}}return r.e.none}},2190:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(292),r=((a={})[i.e.AllMyPhotos]="Folder",a[i.e.Albums]="Albums",a[i.e.allTags]="Tags",a[i.e.allPlaces]="Places",a[i.e.allPeople]="People",a[i.e.singleAlbum]="Album",a[i.e.singleTag]="Tag",a[i.e.singlePlace]="Place",a[i.e.singlePerson]="Person",a[i.e.onThisDay]="OnThisDay",a[i.e.onThisMonth]="OnThisMonth",a[i.e.lastWeekPreviousYears]="LastWeekPreviousYears",a.folder="Folder",a.tag="Tag",a.album="Album",a.place="Place",a.onthisday="OnThisDay",a.onthismonth="OnThisMonth",a.lastweekpreviousyears="LastWeekPreviousYears",a);t.t=r},2208:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(25),o=n(95),s=n(1071),c=n(61),d=n(69),l=n(211),u=n(393),f=n(60),p=n(1271),m=n(1382),_=n(62),h=n(977),b=n(36),g=n(460),v=n(29),y=n(64),S=n(1956),D=n(11),I=n(1096),x=n(1883),C=n(1740),O=n(248),w=n(56),E=n(133),A={timeout:0,method:"notifyWhenChangesStop"},L=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.itemResultSetOptions,i=n,f=i.observables,m=i.resources;n.itemProvider=m.consume(C.resourceKey),n._itemsStore=m.consume(s.e),n.viewParams=m.consume(r.T),n.urlDataSource=m.consume(c.ye),n.platform=m.consume(l.e),n.navigation=m.consume(d.e),n.promiseTracker=m.consume(r.A),n._loaderProvider=m.consume(o.e),n.referenceItemSet=n._getReferenceItemSet(),n.defaultLayoutType=S.n,n.itemResultSetOptions=a,n._pageType=m.consume(r.s),n.useItemCacheData=m.consume(x.e),n.itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource(),n._rumOneHelper=m.consume(u.e),n.isActive=f.pureCompute(n._computeIsActive),n.focusItemKey=f.pureCompute(n._computeFocusItemKey),n.currentItemKey=f.pureCompute(n._computeCurrentItemKey),n.itemSet=f.pureCompute(n._computeItemSet),n.itemSet.equalityComparer=O.n,n.item=f.pureCompute(n._computeItem),n.item.equalityComparer=O.n,n.error=f.create(null);var _=t.requiredPageType;return n._requiredPageType=_,n._setupContextualQueryType(),n.queryType=f.pureCompute(n._computeQueryType),n._layoutTypeTrigger=f.create({}),n.layoutType=f.compute({read:n._computeLayoutType,write:n.updateLayoutType,deferEvaluation:!0,pure:!0}),n._initializeRange(),n.focusItemContext=f.pureCompute(n._computeFocusItemContext),n.focusItemContext.equalityComparer=p.e,n.focusItemIndexInItemSet=f.pureCompute(n._computeFocusItemIndexInItemSet),n.focusItemSet=f.pureCompute(n._computeFocusItemSet),n.focusItemSet.equalityComparer=O.n,n.focusItem=f.pureCompute(n._computeFocusItem),n.focusItem.equalityComparer=O.n,n._isFocusItemResolved=f.pureCompute(n._computeIsFocusItemResolved),n._temporarySortConfiguration=f.create(),n._temporarySortConfiguration.equalityComparer=p.e,n.sortConfiguration=f.compute({read:n._computeSortConfiguration,write:n._temporarySortConfiguration,deferEvaluation:!0,pure:!0}),n.sortConfiguration.equalityComparer=p.e,f.backgroundCompute(n._computeClearSortConfiguration),n.currentContext=f.pureCompute(n.computeCurrentContext),n.currentContext.equalityComparer=p.e,f.backgroundCompute(n._computeRefreshItemSet).extend({rateLimit:A}),n.referenceRevision=f.pureCompute(n._computeReferenceRevision),n}return Object(a.__extends)(t,e),t.prototype.updateSort=function(e,t){this.sortConfiguration({field:e,isAscending:t})},t.prototype.getDefaultLayoutForView=function(){var e=this.queryType(),t=this.viewParams.peek(),n=this.urlDataSource.getLayoutContentType(t)||this._contextualQueryTypes[b.e[e]]||this.defaultLayoutType,a=Object(g.e)(e)&&this._pageType.peek()===v.e.Photos;return this.currentItemKey()===this.urlDataSource.getRootItemKey(b.e.SharedWithMe)?h.d:n===S.n||a?h.s:n===S.a?h.r:n===S.t?h.n:n===S.i?h.l:n===S.e?h.t:h.r},t.prototype.isItemResolved=function(e){return e&&e.peek()&&!e.peek().isPlaceholder},t.prototype.resolveIndices=function(e){return f.n.wrap()},t.prototype.getContextualQueryType=function(e){return this._contextualQueryTypes[b.e[e]]},t.prototype.computeFocusContext=function(e){var t=this.urlDataSource.getKeyParams(e);return{parentKey:e,ownerId:this.urlDataSource.getOwnerId(e),queryType:this.urlDataSource.getQueryType(t),resultSetOptions:this.itemResultSetOptions,ignoreChildren:!0}},t.prototype.computeCurrentContext=function(){return null},t.prototype.getFocusItemSetSync=function(e){return this.itemProvider.getItemSync(e)},t.prototype.getCurrentItemSetSync=function(e){return null},t.prototype.getFocusItemSet=function(e){return this.itemProvider.getItem(e)},t.prototype.getCurrentItemSet=function(e){return f.n.wrap(null)},t.prototype.updateLayoutType=function(e,t){var n;switch(e){case h.r:n=S.a;break;case h.n:n=S.t;break;case h.l:n=S.i;break;case h.t:n=S.e;break;default:n=S.n}t=t||this.queryType.peek(),this.currentItemKey.peek()!==this.urlDataSource.getRootItemKey(b.e.SharedWithMe)&&(this._contextualQueryTypes[b.e[t]]=n,this._itemsStore.setValue(this._getSetViewLocalStorageKey(),this._contextualQueryTypes,y.e.local),this._layoutTypeTrigger({}))},t.prototype.amendCurrentContext=function(e){},t.prototype._computeItemSet=function(){var e=this.itemCacheToKOStoreDataSource();if(e)return e.koItemSet();var t=m.e(this.currentContext());return this.isActive.peek()?this.getCurrentItemSetSync(t):this.itemSet.peek()},t.prototype._computeItem=function(){var e=this.itemCacheToKOStoreDataSource();if(e)return e.koItem();var t=this.itemSet();return t&&t.item()},t.prototype._computeRefreshItemSet=function(){var e=this;if(this.useItemCacheData())Object(D.isFeatureEnabled)(D.UseLegacyDataManagerToFirePLT)&&this.async.setTimeout(function(){e._loaderProvider.pageLoaded(d)},0);else{var t,n=this.itemSet(),a=m.e(this.currentContext()),i=n.item.peek();if(a.skipInMemoryCache=i.key!==this._lastRequestKey,this._lastRequestKey=i.key,(a.revision||i.vault&&i.vault.isLocked)&&(a.skipCache=!0),this.amendCurrentContext(a),this.isActive.peek())if(i.isPlaceholder&&!this._isFocusItemResolved()){var r=m.e(this.focusItemContext());t=this.getFocusItemSet(r)}else t=this.getCurrentItemSet(a);else t=null;var o=this.urlDataSource.getKeyParams(i.key),s=this.urlDataSource.getQueryType(o),c=this.urlDataSource.getPageType(this.viewParams.peek()),d=this.focusItem.peek()?v.e[v.e.OneUp]:"".concat(v.e[c]||"Default","-").concat(b.e[s]||"Default");this._getItemPromise=t,this._getItemPromise&&(this.promiseTracker.registerPromise(t),this.error(null),this.trackPromise(t.then(function(n){t===e._getItemPromise&&(e._getItemPromise=null,E.n.mark("DataManager.GetData.Done"))},function(t){t.errorTitle||_.e.log(t),f.n.isCanceled(t)||e.error(t)}).then(function(){e.async.setTimeout(function(){e._loaderProvider.pageLoaded(d),e._rumOneHelper.logRUMOneForListView(E.n.now())},0)})))}},t.prototype._computeFocusItemContext=function(){var e=this.focusItemKey();return e?this.computeFocusContext(e):null},t.prototype._computeLayoutType=function(){return this._layoutTypeTrigger(),this.getDefaultLayoutForView()},t.prototype._computeReferenceRevision=function(){var e=this.referenceItemSet(),t=e&&e.item&&this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t&&t().revision||0},t.prototype._computeSortConfiguration=function(){return this._temporarySortConfiguration()||(this.queryType(),{})},t.prototype._computeClearSortConfiguration=function(){this.currentItemKey(),this._temporarySortConfiguration(void 0)},t.prototype._computeQueryType=function(){var e=this.referenceItemSet(),t=e&&e.item||this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t?t().isPlaceholder?this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(t().key)):t().queryType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(this.currentItemKey()))},t.prototype._getSetViewLocalStorageKey=function(){return"OneDrive.Web.Files.FilesQueryType."+this.urlDataSource.getOwnerId("",this.viewParams.peek())},t.prototype._setupContextualQueryType=function(){var e,t;this._contextualQueryTypes=Object(a.__assign)(Object(a.__assign)(((e={})[b.e[b.e.Photos]]=S.n,e[b.e[b.e.AllMyPhotos]]=S.e,e[b.e[b.e.Files]]=S.n,e[b.e[b.e.Search]]=S.n,e[b.e[b.e.Recent]]=S.a,e[b.e[b.e.RecycleBin]]=S.a,e),this._itemsStore.getValue(this._getSetViewLocalStorageKey(),y.e.local)||{}),((t={})[b.e[b.e.SharedWithMe]]=S.n,t))},t.prototype._computeFocusItemKey=function(){return this.urlDataSource.getFocusItemKey(this.viewParams())},t.prototype._computeCurrentItemKey=function(){return this.urlDataSource.getCurrentItemKey(this.viewParams())},t.prototype._computeFocusItemIndexInItemSet=function(){var e=this.focusItemContext();if(e)for(var t=this.referenceItemSet(),n=t&&t.content(),a=n&&n.items||[],i=0,r=Object.keys(a);i<r.length;i++){var o=r[i],s=Number(o),c=a[s],d=c&&c.peek();if(d&&this.urlDataSource.areKeysEqual(d.key,e.parentKey))return s}return-1},t.prototype._computeFocusItem=function(){if(!this.isActive())return this.focusItem.peek();var e=this.focusItemSet();if(e){var t=this.focusItemIndexInItemSet();if(t>-1){var n=e&&e.content();return(n&&n.items||[])[t]}return e.item}return null},t.prototype._computeFocusItemSet=function(){if(!this.isActive())return this.focusItemSet.peek();var e=this.focusItemContext();return e?this.focusItemIndexInItemSet()>-1?this.referenceItemSet():this.getFocusItemSetSync(e):void 0},t.prototype._computeIsFocusItemResolved=function(){var e=this.focusItem();return!e||!e().isPlaceholder&&!e().error},t.prototype._initializeRange=function(){this.requiredRange=i.observable({start:0,end:0}),this.requiredRange.equalityComparer=p.e},t.prototype._computeIsActive=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return!this._requiredPageType||t===this._requiredPageType},t.prototype._getReferenceItemSet=function(){var e,t=this,n=this.observables,a=n.create();return n.backgroundCompute(function(){t.itemSet(),e&&t.async.clearImmediate(e),e=t.async.setImmediate(function(){a(t.itemSet.peek()),e=void 0})}),n.pureCompute(function(){var e=a();if(!e||e.item().key===t.currentItemKey())return e})},t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();return this.observables.backgroundCompute(function(){e.useItemCacheData.peek()?e.resources.consumeAsync(I.e).then(function(e){t(e)}):e.useItemCacheData()}),this.observables.pureCompute(function(){return e.useItemCacheData()?t():void 0})},t}(w.n);t.e=L},2242:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(283);function r(e){return{icon:new i.e("GlobalNavButton"),text:a.ToggleLeftNavCommandTooltip,tooltip:a.ToggleLeftNavCommandTooltip,automationId:"leftNavToggleLeftNavCommand",accessibleLabel:a.ToggleLeftNavCommandAriaLabel,ariaExpanded:e,ariaHasPopup:!0,isToggleable:!0,renderLabel:0,hasIconOnly:!0,role:"menuitem"}}},2244:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(128),r=new a.t({name:"LegacyDetailsPaneHost.key",loader:new i.t(function(){return n.e(145).then(n.bind(null,2573)).then(function(e){return e.resourceKey.local})})})},2249:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'@charset "UTF-8";.DetailsHeader{overflow:hidden;height:30px;border-bottom:1px solid '},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.DetailsHeader:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check{position:absolute;z-index:1;display:inline-block;height:22px;padding:4px 8px;vertical-align:top}.DetailsHeader-check:hover .ItemCheck-background{display:inline-block}.DetailsHeader-check:hover .ItemCheck-check:after{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.DetailsHeader-check .ItemCheck-background{display:none}.DetailsHeader-check .ItemCheck-check{display:inline-block}.DetailsHeader-check .ItemCheck-check:after{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.DetailsHeader-check:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader-check.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check.can-select.is-selected:hover .ItemCheck-check:after{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.DetailsHeader-check.can-select.is-selected .ItemCheck-background{display:inline-block}.DetailsHeader-columns{position:absolute;left:0;right:0;height:30px;overflow:hidden;white-space:nowrap}.DetailsHeader-cell{display:inline-block;vertical-align:top;position:absolute;overflow:hidden;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";outline:0;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsHeader-cell.isSortable{cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}.DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.DetailsHeader-cell.isSortable:active{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:'}.DetailsHeader-cell .cellContainer{height:30px;display:inline-block;width:100%}.DetailsHeader-cell .cellContainer.isFilterable{width:calc(100% - 21px)}.DetailsHeader-cell .cellBuffer{position:relative;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellBuffer{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellBuffer{padding-right:4px}.DetailsHeader-cell .cellText{display:inline-block;font-size:11px;text-overflow:ellipsis;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellText{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellText{padding-right:4px}.DetailsHeader-cell .cellSort{display:none}[dir=ltr] .DetailsHeader-cell .cellSort{padding-left:2px}[dir=rtl] .DetailsHeader-cell .cellSort{padding-right:2px}.DetailsHeader-cell .cellSort.isSorted{display:inline-block}.DetailsHeader-cell .cellSort:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';font-size:10px}.DetailsHeader-cell .cellSort.isAscending:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.DetailsHeader-cell .cellMenuLink{position:absolute;top:0;height:30px;width:21px}[dir=ltr] .DetailsHeader-cell .cellMenuLink{right:0}[dir=rtl] .DetailsHeader-cell .cellMenuLink{left:0}.DetailsHeader-cell .cellMenuLink:after{position:relative;top:3px}[dir=ltr] .DetailsHeader-cell .cellMenuLink:after{left:2px}[dir=rtl] .DetailsHeader-cell .cellMenuLink:after{right:2px}.DetailsHeader-cell .cellMenuLink.isFiltered:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:900}.DetailsHeader-cell .cellMenuLink.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:' inset;outline:1px solid transparent}.DetailsHeader-cell.DetailsHeader-cell:focus .cellMenuLink:not(.isFiltered):after,.DetailsHeader-cell:hover .cellMenuLink:not(.isFiltered):after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.od-focus--enabled .DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px '},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset;outline:1px solid transparent}"}]),n(1870);var i=n(0),r=n(22),o=n(25),s=n(61),c=n(1744),d=n(183),l=n(155),u=n(1772),f=n(1876),p=n(336),m=n(594),_=n(42),h=n(2529),b=n(1794),g=n(1068),v=n(1089),y=n(52),S=n(29),D=n(36),I=n(116),x=n(60),C=n(69),O=n(211),w=n(393),E=n(810),A=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({keyboard:g.e});var a=t.itemSet,i=t.cellLocations;return n.navigation=n.resources.consume(C.e),n.sortManager=n.resources.consume(c.c),n._selectionModel=n.resources.consume(o.C),n._isSelectionModal=n.resources.consume(b.n),n._platform=n.resources.consume(O.e),n._urlDataSource=n.resources.consume(s.ye),n._currentView=n.resources.isExposed(o.d)?n.resources.consume(o.d):r.observable(null),n._engagement=n.resources.consume(p.e),n._itemSet=a,n._cellLocations=i,n.isAllSelected=n._selectionModel.isAllSelected,n.isSelectionActive=n._selectionModel.isActive,n.isMobile=n._platform.isMobile,n._currentFocusColumnIndex=r.observable(-1),n.isItemCheckFocused=r.observable(!1),n.isFilterMenuFocused=r.observable(!1),n.columns=n.createPureComputed(n._computeColumns),n.isCheckVisible=n.createPureComputed(n._computeIsCheckVisible),n.isSelectAllAvailable=n.createPureComputed(n._computeIsSelectAllAvailable),n.checkBoxAriaLabel=n.createPureComputed(n._computeCheckBoxAriaLabel),n.subscribe(n._currentFocusColumnIndex,function(e){e>=0&&n.columns().length>0&&n.columns()[e].isFocused(!1)},!0),n.subscribe(n._currentFocusColumnIndex,function(e){e>=0&&n.columns().length>0&&n.columns()[e].isFocused(!0)}),n}return Object(i.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.columns.dispose()},t.prototype.getStyle=function(e,t){var n=this._cellLocations()[t()];return n&&n.width?"width: "+n.width+"px; "+l.e.safeLeft+": "+n.left+"px;":"display: none"},t.prototype.getClass=function(e){return"DetailsHeader-cell "+e.key+(e.sortable?" isSortable":"")},t.prototype.getCellClass=function(e){return"cellContainer"+(e.filterable?" isFilterable":"")+(!e.isFocused||!e.isFocused()||e.filterable&&this.isFilterMenuFocused()?"":" is-focused")},t.prototype.getSortClass=function(e){return"cellSort"+(e.isSorted?" isSorted":"")+(e.isAscending?" isAscending":"")},t.prototype.getMenuClass=function(e){return"cellMenuLink"+(e.isFiltered()?" isFiltered":"")+(e.isFocused&&e.isFocused()&&this.isFilterMenuFocused()?" is-focused":"")},t.prototype.onClick=function(e,t){if(e.sortable){if(this.resources.isExposed(w.e)&&this.resources.consume(w.e).logFilterSort("Sort"),e.internalName){var n=[m.t(e.internalName),"Header","Click"].join(".");this._engagement.logData({name:n,isIntentional:!0})}var a=e.internalName||e.key,i=e.isSorted?!e.isAscending:!e.sortDescFirst,r=new v.e({name:"ColumnHeaderSort",pageType:S.e[this._urlDataSource.getPageType()],queryType:D.e[this._urlDataSource.getQueryType()]}),o={sortMode:e.isSorted?"Column":"Order",sortColumn:a,sortAscending:i?"Ascending":"Descending"};return r.end({resultType:y.e.Success,extraData:o}),this.sortManager.updateSort(a,i),t.stopPropagation(),t.preventDefault(),!1}},t.prototype.onMenuClick=function(e,t){var a=this;if(e.filterable){var i=[m.t(e.name),"HeaderGlyph",m.e].join(".");this._engagement.logData({name:i,isIntentional:!0,extraData:{action:m.t(t.type)}});var r=e.internalName||e.key,o=I.n(this.navigation.viewParams),c=this._currentView&&this._currentView.peek(),d=c&&c.id,l=this.resources.consumeAsync(s.T).then(function(e){return e.getFilterData(r,o,d)}),p=x.n.resolve(n.e(290).then(n.bind(null,3294))).then(E.e);return x.n.all({filterData:l,type:p}).then(function(n){var i=n.filterData,s=n.type,c=i?s.getFilterMenuItems(a.resources,e,i,o,r):[],d=new f.e({items:c,rootElementClass:"List",boundingElementClass:"Files-content"});u.e.createContextMenu(t,d,a)}),t.stopPropagation(),t.preventDefault(),!1}},t.prototype.toggleAllSelected=function(e,t){return this._selectionModel.setIsActive(!0),this._selectionModel.toggleSelectAll(),t.stopPropagation(),t.preventDefault(),!1},t.prototype.onLeft=function(e){if(e.filterable&&this.isFilterMenuFocused())this.isFilterMenuFocused(!1);else{var t=this.getLeftFocusColumnIndex();this._currentFocusColumnIndex(t),-1===t&&this.isItemCheckFocused(!0),this.isFilterMenuFocused(!0)}return!1},t.prototype.onRight=function(e){return!e.filterable||this.isFilterMenuFocused()?(this.isFilterMenuFocused(!1),this._currentFocusColumnIndex(this.getRightFocusColumnIndex())):this.isFilterMenuFocused(!0),!1},t.prototype.onDown=function(e,t){if(e.filterable&&this.isFilterMenuFocused())return this.onMenuClick(e,t),!1},t.prototype.onEnter=function(e,t){return e.filterable&&this.isFilterMenuFocused()?this.onMenuClick(e,t):this.onClick(e,t),!1},t.prototype.headerContainerOnRight=function(){return this.isItemCheckFocused(!0),this._currentFocusColumnIndex(-1),!1},t.prototype.getColumnAriaSort=function(e){var n="none";return e.isSorted&&(n=e.isAscending?t._ascendingAriaSort:t._descendingAriaSort),n},t.prototype.getColumnFilterAriaLabel=function(e){var t=null;return e.isFiltered()&&(t=_.format(h.e,e.name,e.filterValues())),t},t.prototype.getRightFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),n=e+1;n<t.length;n++)if(t[n].name){e=n;break}return e},t.prototype.getLeftFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),n=!1,a=e-1;a>=0;a--)if(t[a].name){e=a,n=!0;break}return n||(e=-1),e},t.prototype._computeIsSelectAllAvailable=function(){return 0===this._selectionModel.mode||this._selectionModel.selection().length>0},t.prototype._computeIsCheckVisible=function(){return!this._platform.isMobile||this._isSelectionModal()||this._selectionModel.selection().length>0},t.prototype._computeColumns=function(){var e=this;return this._itemSet().schema().filter(function(t){return t.isVisible&&!e._platform.isMobile||e._platform.isMobile&&t.isVisibleMobile})},t.prototype._computeCheckBoxAriaLabel=function(){return this._selectionModel.isAllSelected()?h.t:h.n},t._ascendingAriaSort="ascending",t._descendingAriaSort="descending",t}(d.t);n(388).e({tagName:"ms-details-header",template:'<div class="DetailsHeaderContainer" data-bind="if:!isMobile"><div class="DetailsHeader" role="row" tabindex="0" data-bind="keyboard:{mappings:{Right:$component.headerContainerOnRight.bind($component)},context:$data}">\x3c!--ko if:isCheckVisible--\x3e<ms-item-check class="DetailsHeader-check" data-bind="click:$component.toggleAllSelected.bind($component),css:{\'can-select\':isSelectAllAvailable,\'is-selected\':isAllSelected,\'is-selection-active\':isSelectionActive,\'is-focused\':$data.isItemCheckFocused},hasFocus:$data.isItemCheckFocused,keyboard:{mappings:{Enter:$component.toggleAllSelected.bind($component),Right:$component.onRight.bind($component)},context:$data},attr:{tabindex:$data.isItemCheckFocused()?0:-1,\'aria-label\':checkBoxAriaLabel}"></ms-item-check>\x3c!--/ko--\x3e<div class="DetailsHeader-columns" data-bind="foreach:columns"><div role="columnheader" data-bind="if:$data.name,class:$component.getClass($data),attr:{style:$component.getStyle($data,$index),\'aria-sort\':$component.getColumnAriaSort($data),tabindex:$data.isFocused()?0:-1},hasFocus:$data.isFocused,keyboard:{mappings:{Enter:$component.onEnter.bind($component),Space:$component.onEnter.bind($component),Left:$component.onLeft.bind($component),Right:$component.onRight.bind($component),Down:$component.onDown.bind($component)},context:$data}"><div data-bind="click:$component.onClick.bind($component),class:$component.getCellClass($data)"><div class="cellBuffer"><div data-bind="class:$component.getSortClass($data)"></div><div class="cellText" data-bind="text:$data.name"></div></div></div>\x3c!--ko if:$data.filterable--\x3e<div data-bind="click:$component.onMenuClick.bind($component),class:$component.getMenuClass($data),attr:{\'aria-label\':$component.getColumnFilterAriaLabel($data),role:$data.isFiltered()?\'button\':null}"></div>\x3c!--/ko--\x3e</div></div></div></div>',viewModel:A,synchronous:!0})},2250:function(e,t,n){"use strict";var a='\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="od-OneUpOverlay" data-overlay-parent="true" role="presentation" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},host"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',i=n(17);Object(i.n)([{rawString:".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;opacity:0;visibility:hidden;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{transform:scale(.8,.8);opacity:0;visibility:hidden}"}]);var r=n(388),o=n(0),s=n(183),c=n(1748),d=n(792),l=n(1786),u=n(1759),f=n(1762),p=n(1760),m=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.overlayTagName=p.e.tagName,a.addBindingHandlers({host:c.e,interactionScope:d.t,preserveFocus:l.e,recoverFocus:u.e,focusTrap:f.e}),a}return Object(o.__extends)(t,e),t}(s.t),_=n(166),h=r.e({tagName:"od-one-up-overlay",template:a,viewModel:m,synchronous:!0});Object(_.t)({automationName:"od-one-up-overlay",name:"OneUpOverlay",template:a,viewModelType:m}),t.e=h},2257:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r});var a,i={ODC:"EnableNewCarouselDesign"},r=function(e){a=!!e}},2284:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return T}),n.d(t,"n",function(){return R});var a=n(0),i=n(2052),r=n(336),o=n(2160),s=n(2190),c=n(323),d=n(11),l=n(35),u=n(812),f=n(818),p=n(819),m=n(1827),_=n(1833),h=n(1834),b=n(143),g=n(90),v=[1e4,1e3,100],y="landing",S="counts",D=function(){function e(){this._groupToCountData={counts:[],dates:[]}}return e.prototype.clearGroupToCountsData=function(){this._groupToCountData={counts:[],dates:[]},this._filter=void 0},e.prototype.updateGroupToCountsData=function(e,t,n,a){if("folder"===e){var i=n.counts,r=n.dates;a?this._groupToCountData.pageToken===a&&this._filter===t&&(this._groupToCountData={counts:this._groupToCountData.counts.concat(i),dates:this._groupToCountData.dates.concat(r),pageToken:a}):(this._groupToCountData=n,this._filter=t)}},e.prototype.calculateDateAndOffsetOfIndex=function(t,n,a){if("folder"!==t)return e.UnknownDateAndOffset;if(n!==this._filter)return e.UnknownDateAndOffset;for(var i=0,r=-1,o=0,s=this._groupToCountData,c=s.counts,d=s.dates,l=0;l<c.length;l++){if((i+=c[l].count)>a){r=l;break}o=i}return r>=0?{date:d[r],index:o}:e.UnknownDateAndOffset},e.UnknownDateAndOffset={date:void 0,index:-1},e}(),I=function(){function e(e,t){this._vroomDataRequestor=e,this._successfullGroupToCountPageSizeIndex=0,this._indexToDateMapper=new D,this._photosNextLinkSkipToken={},this._itemCacheStore=t}return e.prototype.updateResource=function(e){var t=e;this._engagement=t.consume(r.e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(e=new Date,this._photosNextLinkSkipToken={},r){case"album":return[3,1];case"tag":return[3,3];case"folder":return[3,5];case"onthisday":case"lastweekpreviousyears":case"onthismonth":return[3,7]}return[3,9];case 1:return[4,this._getGroupToCountForSingleAlbum(r,t,n)];case 2:case 8:case 10:return o=a.sent(),[3,11];case 3:case 9:return[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 4:return s=a.sent(),o=this._reduceGroupToCount(s,t,[t,t,t],[t,t,t]),[3,11];case 5:return void 0===i&&this._indexToDateMapper.clearGroupToCountsData(),[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 6:return s=a.sent(),this._indexToDateMapper.updateGroupToCountsData(r,t,s,i),o=s,[3,11];case 7:return[4,this._getGroupToCountForMOJ(t,n,i,r)];case 11:return this._sendGroupToCountPerfTelemetry(e,o.counts.length,r),[2,{counts:o.counts,pageToken:o.pageToken}]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=new Date,"album"===s?[3,1]:[3,3];case 1:return[4,this._getPhotoRecordsForSingleAlbum(e,t,n)];case 2:return d=a.sent(),[3,5];case 3:return[4,this._getPhotoRecordsForAllPhotos(e,t,s,n,i,r,o)];case 4:d=a.sent(),a.label=5;case 5:return this._sendPerfPhotoRecordsTelemetry(c,1,d.length,e,s),[2,d]}})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,y,"folder")];case 1:return[2,a.sent()]}})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._makeQuery=function(e,t,n,i,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,c,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return s="allPhotos.".concat(t,".").concat(n,".").concat(i),(null==o?void 0:o.indexOf("/_api/v2.1"))>=0&&(s+=".V2"),c={apiName:s,path:e,useAuthorizationHeaders:!0,endpoint:o},u=[],Object(d.isFeatureEnabled)(d.AllowTestPhotoNotification)&&(f=this._itemCacheStore.dispatch(Object(m.e)()),Object(l.k)(f)&&u.push("testphotonotification")),this._shouldEnableUtilityFiltering(t,r)&&u.push("applyRecommendationHeuristics"),u.length>0&&(c.headers={prefer:u.join(", ")}),[4,this._vroomDataRequestor.send(c).catch(function(t){throw new Error("error loading "+e)})];case 1:return[2,a.sent()]}})})},e.prototype._shouldEnableUtilityFiltering=function(e,t){switch(e){case"onthisday":return!0;case"onthismonth":return!t||Object(f.e)(t).applyUtilityFiltering;case"lastweekpreviousyears":return!t||Object(p.e)(t).applyUtilityFiltering;default:return!1}},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfullGroupToCountPageSizeIndex,a.label=1;case 1:if(!(o<v.length))return[3,6];s=T(v[o],e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(s,e,S,y,t)];case 3:return c=a.sent(),this._successfullGroupToCountPageSizeIndex=o,[2,c];case 4:return d=a.sent(),r=d,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=i?parseInt(i,10):1,[4,this._getGroupCountWithVariablePageSize(e,t,n,o)];case 1:return s=a.sent(),c=s.value.length>0&&s["@odata.nextLink"],d=s.value,l=d.length,u=c?(o+l).toString():void 0,[4,R(d,e,t,u,r)];case 2:return(f=a.sent())&&f.dates&&f.dates.length>0&&(p=f.dates[f.dates.length-1])&&this._sendLastMediaDateTelemetry(p,e),[2,f]}})})},e.prototype._reduceGroupToCount=function(e,t,n,a){return Object(i.a)(e.counts,t,n,a),{counts:e.counts}},e.prototype._getGroupToCountForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._makeQuery(U(t,n),e,S,y,t)];case 1:return i=a.sent(),r=i.bundle.childCount,o=[i.name,i.name,i.name],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[],pageToken:void 0}]}})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,u,f,p,m,_,h,b,v,y;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=e+1,0===e&&(this._photosNextLinkSkipToken={}),u=this._indexToDateMapper.calculateDateAndOffsetOfIndex(n,i,e),f=u.date,p=u.index,m=new Date("01/01/1900"),f&&void 0!==p&&(c-=p),_=this._getServerSkipToken(e,n,i),h=Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M),[4,this._makeQuery(P(c,t-e,n,i,r,o,f,m,_),n,"records",s,i,h?Object(l.l)({apiVersion:"v2.1",driveId:"me"}):void 0)];case 1:if(!(b=a.sent()))throw new Error("Did not receive a response while requesting photos for the CoreApi");if(b.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return v=b["@odata.nextLink"],this._storeServerSkipToken(t,v,n,i),y=[],b.value.map(function(e){y.push(function(e){var t=[];e.thumbnails&&e.thumbnails[0]&&(t=[F(e.thumbnails[0].small),F(e.thumbnails[0].medium),F(e.thumbnails[0].large)]);var n=e.location;return{id:e.id,thumbnails:t,name:e.name||e.id,location:n?n.address:void 0,dateTakenTime:H(e),isVideo:!1,driveItem:e}}(e))}),[2,y]}})})},e.prototype._storeServerSkipToken=function(e,t,n,a){if(t&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)){var i=t.split("$skiptoken=");if(2===i.length){this._photosNextLinkSkipToken[n+a]||(this._photosNextLinkSkipToken[n+a]={});var r=i[1];Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M)&&(r=r.split("&")[0]),this._photosNextLinkSkipToken[n+a][e]=r}}},e.prototype._getServerSkipToken=function(e,t,n){return this._photosNextLinkSkipToken[t+n]&&this._photosNextLinkSkipToken[t+n][e]&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)?this._photosNextLinkSkipToken[t+n][e]:""},e.prototype._getGroupToCountForMOJ=function(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=this._itemCacheStore.dispatch(Object(b.e)(function(e){return e.demandItemFacet(h.e,_.e)})),s=o&&o.isEnableMonthRecapGroupHeaderExpOn(),[4,this._getGroupToCountForAllPhotos(r,e,t,n,s)];case 1:return c=a.sent(),(d=c.counts).forEach(function(e){e.headers&&e.headers.length>=3&&(e.headers=[e.headers[2],e.headers[2],e.headers[2]]),e.labels&&e.labels.length>=3&&(e.labels=[e.labels[2],e.labels[2],e.labels[2]])}),"lastweekpreviousyears"===r&&Object(i.n)(d),"onthismonth"===r&&Object(f.e)(e).applyUtilityFiltering&&!s&&Object(i.a)(d,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),l=d.reduce(function(e,t){return e+t.count},0),this._logTelemetry("AllPhotos.ElementsCount",{count:l},r),[2,{counts:d,pageToken:c.pageToken}]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){throw new Error("Not implemented")})})},e.prototype._logTelemetry=function(e,t,n){this._engagement&&this._engagement.logData({name:(s.e[n]||"unknown")+"."+e,extraData:t})},e.prototype._sendGroupToCountPerfTelemetry=function(e,t,n){var a=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:a,groups:t,requests:1},n)},e.prototype._sendPerfPhotoRecordsTelemetry=function(e,t,n,a,i){var r=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:r,count:n,requests:t,skip:a,api:"vroom"},i)},e.prototype._sendLastMediaDateTelemetry=function(e,t){var n=e.toISOString();this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:n},t)},e}();function x(e,t){var n,a,i,r="/drives/"+t+"/items/root/items?$filter=photo+ne+null",s=e.split(o.e),c=null===(n=s[0])||void 0===n?void 0:n.replace(/'/g,"''"),d=null===(a=s[1])||void 0===a?void 0:a.replace(/'/g,"''"),l=null===(i=s[2])||void 0===i?void 0:i.replace(/'/g,"''");return c&&(r+="+and+location/address/countryOrRegion+eq+'"+c+"'"),d&&(r+="+and+location/address/state+eq+'"+d+"'"),l&&(r+="+and+location/address/city+eq+'"+l+"'"),r}function C(e,t){return"/drives/"+t+"/items/root/items?$filter=photo+ne+null+and+tags/any(tag:tag/name+eq+'"+e+"')"}function O(e,t){var n="",a="";if(e){var i=new Date(e);i.setUTCHours(23,59,59,999),n="+and+photo/takenDateTime+le+"+i.toISOString()}if(t){var r=new Date(t);r.setUTCHours(0,0,0,0),a="+and+photo/takenDateTime+ge+"+r.toISOString()}return n+a}function w(e,t,n,a){return"/drives/"+t+"/items/"+e+"/items?filter=photo+ne+null"+O(n,a)}function E(e,t,n,a){var i=Object(u.e)(e),r=i.date,o=i.resourceId,s=new Date(Date.now()),c=r.getFullYear()%4==0&&r.getFullYear()%100!=0||r.getFullYear()%400==0,d=1===r.getMonth()&&29===r.getDate();if(s.getFullYear()===r.getFullYear()){var l=c&&d?r.getFullYear()-4:r.getFullYear()-1;r.setFullYear(l)}var f=k(r);return"/drives/"+t+"/items/"+o+"/items?filter=photo+ne+null"+O(f,f)+"&interval=R/P1Y"}function A(e,t){var n=Object(f.e)(e),a=n.date,i=n.resourceId,r=new Date(Date.UTC(a.getFullYear(),a.getMonth(),1));return"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(new Date(Date.UTC(a.getFullYear(),a.getMonth()+1,0)),r)+"&interval=R1/P1Y"}function L(e,t){var n=Object(p.e)(e),a=n.date,i=n.resourceId;if(new Date(Date.now()).getFullYear()===a.getFullYear()){var r=a.getFullYear()-1;a.setFullYear(r)}var o=k(a),s=k(a);return s.setDate(s.getDate()+6),"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(s,o)+"&interval=R/P1Y"}function k(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0))}function M(e,t){var n="";return e>1&&(n="&skiptoken="+e+"/"+t),n}function P(e,t,n,a,i,r,o,s,c){var d="";switch(n){case"folder":d=w(a,i,o,s);break;case"place":d=x(a,i);break;case"tag":d=C(a,i);break;case"onthisday":d=E(a,i);break;case"onthismonth":d=A(a,i);break;case"lastweekpreviousyears":d=L(a,i)}return(d+="&orderby=photo/takenDateTime+desc&expand=tags,thumbnails&top="+t)+(c?"&skiptoken="+c:M(e,r))}function T(e,t,n,a,i){var r="";switch(t){case"folder":r=w(n,a);break;case"place":r=x(n,a);break;case"tag":r=C(n,a),r+="&expand=tags";break;case"onthisday":r=E(n,a);break;case"onthismonth":r=A(n,a);break;case"lastweekpreviousyears":r=L(n,a)}return(r+="&orderby=photo/takenDateTime+desc&apply=groupby((photo/takenDateTime),aggregate(id+with+countdistinct+as+totalCount))&top="+e)+M(i,i)}function U(e,t){return"/drives/"+t+"/bundles/"+e}function F(e){return e?{url:e.url,width:e.width,height:e.height}:{url:"",width:0,height:0}}function H(e){var t=new Date;if(e.photo&&e.photo.takenDateTime)t=new Date(e.photo.takenDateTime);else if(e.photo&&e.photo.alternateTakenDateTime)t=new Date(e.photo.alternateTakenDateTime);else{var n=[];e.fileSystemInfo&&e.fileSystemInfo.createdDateTime&&n.push(new Date(e.fileSystemInfo.createdDateTime).getTime()),e.fileSystemInfo&&e.fileSystemInfo.lastModifiedDateTime&&n.push(new Date(e.fileSystemInfo.lastModifiedDateTime).getTime()),e.createdDateTime&&n.push(new Date(e.createdDateTime).getTime()),e.lastModifiedDateTime&&n.push(new Date(e.lastModifiedDateTime).getTime()),n.length>0&&(t=new Date(Math.min.apply(Math,n)))}return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function R(e,t,n,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:s={counts:[],dates:[],pageToken:r},d=0,a.label=1;case 1:return d<e.length?(function(e,t,n,a,r,o,s){for(var c=Math.min(t+25,e.length),d=t;d<c;++d){var l=e[d],u=new Date(l.photo.takenDateTime);a.counts.push(Object(i.e)(u,l.totalCount,r,o,s)),a.dates.push(u)}}(e,d,0,s,t,n,o),[4,Object(c.t)(0)]):[3,4];case 2:a.sent(),a.label=3;case 3:return d+=25,[3,1];case 4:return[2,s]}})})}},2285:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(143),i=n(1833),r=n(1834),o=n(11);function s(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.EnableNewCarouselDesign)||Boolean(t&&t.isEnableNewCarouselDesignExpOn())}}},2302:function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(25),o=n(1744),s=n(23),c=n(977),d=n(42),l=n(1765),u=n(981),f=n(283),p=function(e){function t(t){var n=e.call(this,t)||this;return n.selection=n.resources.consume(r.C),n.showLabels=t.showLabels,n.layoutType=n.resources.consume(o.o.layoutType),n}return Object(a.__extends)(t,e),t.prototype.showSelectionActionText=function(){var e=this.selection&&this.selection.selection().length||0;return this.showLabels()?d.format(s.NumberSelected,e):e.toString()},t.prototype.computeOpenInOfficeOnlineText=function(){return l.s(Object(u.e)(this.selection))||s.Open},t.prototype.computeOpenInOfficeClientText=function(){return l.c(Object(u.e)(this.selection))},t.prototype.computeOfficeIcon=function(){var e,t=Object(u.e)(this.selection);return t&&(e=l.o(t)),e||new f.e("Page")},t.prototype.computeOfficeClass=function(){return l.i(Object(u.e)(this.selection))},t.prototype.computeViewSelectorIcon=function(){return new f.e(this.computeViewSelectorIconName())},t.prototype.computeViewSelectorIconName=function(){var e=this.layoutType();return e===c.l||e===c.t?t.singleAlbumIcon:e===c.n?t.compactDetailsIcon:e===c.s||e===c.a?t.gridIcon:t.detailsIcon},t.compactDetailsIcon="AlignLeft",t.detailsIcon="List",t.gridIcon="ViewAll",t.tilesIcon="Tiles",t.singleAlbumIcon="LargeGrid",t}(i.t);t.e=p},2303:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(14),r=new a.e("requestResponseBatchKey",{driveId:i.e,endpoint:i.e})},2307:function(e,t,n){"use strict";n.d(t,"e",function(){return V});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(1112),c=n(809),d=n(30),l=n(14),u=new d.e("placeSet",{placesRootKeyPart:c.e.subKeyPart,filter:l.e}),f=n(576),p=n(7),m=n(19),_=n(89),h=n(0),b=n(382),g=n(107),v=n(2097),y=n(1007),S=n(137),D=n(286),I=n(983);function x(e){var t=e&&e.address;return[t&&t.countryOrRegion,t&&t.countryOrRegion,t&&t.countryOrRegion].join(I.t)}var C=n(2119),O=n(1942);function w(e,t,n,a,i){var r=[];return e&&r.push(e),t&&r.push(t),n&&r.push(n),a&&r.push(a),r.length>1?r[0]+", "+r[r.length-1]:i||""}var E=n(2791),A=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=c.e.deserialize(n),i=a.driveId,r=a.endpoint,o=v.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,l,v,I,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z,$;return Object(h.__generator)(this,function(ee){switch(ee.label){case 0:return t=Date.now(),s={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/view.listLocations")},[4,e(Object(g.t)(s))];case 1:return c=ee.sent().value,d=Date.now()-t,l=Date.now(),v=function(e){var t=[];if(e&&e.length){for(var n=e[0].location&&e[0].location.address&&e[0].location.address.countryOrRegion||"",a={displayName:n,places:[]},i=0,r=e;i<r.length;i++){var o=r[i],s=o.location&&o.location.address&&o.location.address.countryOrRegion||"";n!==s&&(t.push(a),a={displayName:n=s,places:[]}),a.places.push(o)}t.push(a)}return t}(c),I=new b.e,A=[],[4,e(Object(y.e)(function(e){return e.demandItemFacet(m.e,o)}))];case 2:for((L=ee.sent())&&0===L.itemKeys.length||A.push(o),k=0,M=v;k<M.length;k++){for(P=M[k],T={placesRootKeyPart:{driveId:i,endpoint:r},filter:P.displayName},U=u.serialize(T),F=[],H=0,R=P.places;H<R.length;H++)N=R[H],B=N.location&&N.location.address,j=B&&B.countryOrRegion?B.countryOrRegion:"",V=B&&B.state?B.state:"",z=B&&B.locality?B.locality:"",G=B&&B.city?B.city:"",K=f.e.serialize({placesRootKeyPart:a,countryOrRegion:j,state:V,locality:z,city:G}),W=w(G,z,V,"",null===($=N.location)||void 0===$?void 0:$.displayName),q=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(N.location),filterType:"place"}),Q=N.previewThumbnails&&Object(C.e)(N.previewThumbnails),I.resolveItems({items:(J={},J[K]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(W)),m.t.pack({itemKey:q})),_.h.pack(Q)),J)}),F.push(K);I.resolveItems({items:(X={},X[U]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.displayName)),m.e.pack({itemKeys:F})),X)}),A.push(U)}return I.resolveItems({items:(Z={},Z[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(E.e)),m.e.pack({itemKeys:A})),Z)}),e(I.execute()),Y=Date.now()-l,e(Object(O.e)({name:"Places.GetAllPlaces",extraData:{fetchTimeMs:d,processTimeMs:Y,placesCount:(null==c?void 0:c.length)||0,groupsCount:v.length}})),[2]}})})}}),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=u.deserialize(n).placesRootKeyPart,i=c.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){return Object(h.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(y.e)(function(e){e.demandItemFacet(m.e,i)}))];case 1:return t.sent(),[2]}})})}}),k=n(990),M=Object(a.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,a=f.e.deserialize(n),i=a.placesRootKeyPart,o=a.countryOrRegion,s=a.state,c=a.city,d=i.driveId,l=i.endpoint;return o=null==o?void 0:o.replace(/'/g,"''"),s=null==s?void 0:s.replace(/'/g,"''"),c=null==c?void 0:c.replace(/'/g,"''"),function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,a,i,u,f,p,b,v,y;return Object(h.__generator)(this,function(I){switch(I.label){case 0:return t="photo ne null",t+=o?" and location/address/countryOrRegion eq '".concat(o,"'"):"",t+=s?" and location/address/state eq '".concat(s,"'"):"",t+=c?" and location/address/city eq '".concat(c,"'"):"",a=Object(k.e)({filter:t,orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:1,select:"id,thumbnails,location"}),i={qosName:"allPlaces",endpoint:l,driveId:d,url:"".concat(l,"/drives/").concat(d,"/items/root/items?").concat(a)},[4,e(Object(g.t)(i))];case 1:return u=I.sent().value,f=u&&u.length&&u[0].thumbnails&&u[0].thumbnails[0],p=f&&f.medium?{url:f.medium.url,width:f.medium.width,height:f.medium.height}:void 0,b=u[0]&&u[0].location,v=S.e.serialize({photosRootKeyPart:{driveId:d,endpoint:l},groupBy:D.e.Date,filter:x(b),filterType:"place"}),e(Object(r.e)({items:(y={},y[n]=Object(h.__assign)(Object(h.__assign)({},_.h.pack(p)),m.t.pack({itemKey:v})),y)})),[2]}})})}}),P=n(2792),T=n(440),U=n(55),F=n(369),H=n(1103),R=n(2033),N=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=v.e.deserialize(n),i=a.driveId,r=a.endpoint;return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,l,u,v,y,I,C,O,E,A,L,M,N,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue;return Object(h.__generator)(this,function(fe){switch(fe.label){case 0:return t=Object(k.e)({filter:"photo ne null",orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:100,select:"id,thumbnails,location"}),o={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/items/root/items?").concat(t)},[4,e(Object(g.t)(o))];case 1:if(s=fe.sent().value,c=[],d=new Map,l=new Map,u=new Map,v=0,s&&s.length)for(y=0;v<2&&y<s.length;y++)(I=s[y])&&I.location&&I.location.displayName&&I.location.latitude&&I.location.longitude&&((C=u.get(I.location.displayName))||u.set(I.location.displayName,I),O=l.get(I.location.displayName),E=O?O+1:1,l.set(I.location.displayName,E),3===E&&(v++,C&&d.set(I.location.displayName,C)),d.has(I.location.displayName)||d.set(I.location.displayName,I));if(A=Array.from(d.values()),L=A[0],M=A.slice(1),L){for(N=0,V=M;N<V.length;N++)if(z=V[N],G=L.location,K=null==z?void 0:z.location,z&&B(G)&&B(K)&&j(G,K,50)){c.push(z);break}c.unshift(L)}for(W=new b.e,q=[],Q=0,Y=c;Q<Y.length;Q++)J=Y[Q],X=J.location&&J.location.address,Z=X&&X.countryOrRegion?X.countryOrRegion:"",$=X&&X.state?X.state:"",ee=X&&X.locality?X.locality:"",te=X&&X.city?X.city:"",ne=f.e.serialize({placesRootKeyPart:a,countryOrRegion:Z,state:$,locality:ee,city:te}),ae=w(te,ee,$,Z,null===(ue=J.location)||void 0===ue?void 0:ue.displayName),ie=J.thumbnails&&J.thumbnails.length&&J.thumbnails[0],re=ie&&ie.medium?{url:ie.medium.url,width:ie.medium.width,height:ie.medium.height}:void 0,oe=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(J.location),filterType:"place"}),se=F.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),ce=H.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),W.resolveItems({items:(de={},de[ne]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[se]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[ce]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),R.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de)}),q.push(ne);return W.resolveItems({items:(le={},le[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.e)),m.e.pack({itemKeys:q})),le)}),e(W.execute()),[2]}})})}});function B(e){return Boolean((null==e?void 0:e.latitude)&&e.longitude)}function j(e,t,n){var a=Math.PI/180,i=(t.latitude-e.latitude)*a,r=(t.longitude-e.longitude)*a,o=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(e.latitude*a)*Math.cos(t.latitude*a);return 3959*Math.asin(Math.sqrt(o))*2>=n}var V=Object(a.t)(function(){return function(e){e(s.e),e(Object(r.t)({keyFacet:c.e,facets:[m.e]})),e(Object(r.t)({keyFacet:u,facets:[p.u,m.e]})),e(Object(r.t)({keyFacet:f.e,facets:[p.u,_.h]})),e(Object(i.a)(c.e,o.e)(A)),e(Object(i.a)(f.e,o.e)(M)),e(Object(i.a)(u,o.e)(L)),e(Object(i.a)(v.e,o.e)(N))}})},2308:function(e,t,n){"use strict";var a=n(0),i=n(25),r=n(1744),o=n(61),s=n(693),c=n(211),d=n(60),l=n(253),u=n(2040),f=n(8),p=n(128),m=new f.t({name:"MoveCopyItemsAsyncOperation.key",loader:new p.t(function(){return n.e(276).then(n.bind(null,2854)).then(function(e){return e.resourceKey})})}),_=n(798),h=n(2131),b=n(1788),g=n(42),v=n(435),y=n(94),S=n(1271),D=n(248),I=n(56),x=function(e){function t(t){var n=e.call(this,t)||this,a=t.canSelect,r=t.focusItem;return n._canSelect=a,n._focusItem=r,n._itemSelectionModel=n.resources.consume(i.C),n._initializeSetFocusItemSelection(),n}return Object(a.__extends)(t,e),t.prototype._initializeSetFocusItemSelection=function(){var e,t,n=this,a=this._itemSelectionModel;this.createBackgroundComputed(function(){var i=n._focusItem();if(i){if(n._canSelect()){a.setItemFocus(i);var r=n.observables.ignore(function(){return a.getItemKey(i)});a.setSelectedKeys([r]),e=!0}t||(e=a.selectedCount.peek()>0)}else t&&(a.setItemFocus(t),!0===e?(r=n.observables.ignore(function(){return a.getItemKey(t)}),a.setSelectedKeys([r]),e=void 0):a.clear());t=i}).extend({deferred:!0})},t}(I.n),C='<div class="od-LockedPage"></div>',O=n(210),w=n(183),E=n(95),A=n(810),L=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._bundleLoader=a.resources.consume(E.e);var r=a.resources.consume(i.A);return a._loaded=new O.e,r.registerPromise(a._loaded.getPromise()),a.createComputed(a._compute),a}return Object(a.__extends)(t,e),t.prototype._compute=function(){var e=this;this._bundleLoader.getBundleInfo(2).isLoaded()&&d.n.resolve(Promise.all([n.e("deferred.resx-deferred"),n.e(226)]).then(n.bind(null,3445))).then(A.e).then(function(t){new(e.managed(t)),e._loaded.complete()})},t}(w.t),k=n(388),M=n(166),P=(k.e({tagName:"od-locked-page",template:C,viewModel:L,synchronous:!0}),Object(M.t)({name:"LockedPage",automationName:"od-locked-page",template:C,viewModelType:L})),T=n(1772),U=n(2138),F=n(1740),H=n(1970),R=n(1963),N=n(2105),B=n(1869),j=n(366),V=function(e){function t(t){var n=e.call(this,t)||this;return n.itemSet=t.itemSet,n.mappedItemSet=t.itemSet,n.mappedRequiredRange=t.requiredRange,n.refreshedItemSetFlag=n.createObservable(!1),n}return Object(a.__extends)(t,e),t.prototype.getOriginalItemIndexByMappedIndex=function(e){return e},t.prototype.getNewMappedIndexByOldIndex=function(e){return e},t}(I.n),z=n(1825),G=n(1794),K=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._getCurrentPageName=t.getCurrentPageName,a._getFocusPageName=t.getFocusPageName||W,a._itemSet=t.itemSet,a._focusItem=t.focusItem,a._isOneUp=a.observables.wrap(t.isOneUp),a._instrumentationProvider=n.instrumentationProvider,a._viewParams=n.viewParams,a._initializeReportPageView(),a}return Object(a.__extends)(t,e),t.prototype._initializeReportPageView=function(){var e=this;this.observables.backgroundCompute(function(){if(e._itemSet){var t=e._viewParams.peek();if(e._isOneUp()&&e._focusItem){i=(a=e._itemSet.peek()).item.peek();var n=e._focusItem();n&&(n.peek().isPlaceholder?n():e._instrumentationProvider.userViewPage({viewParams:t,item:n.peek(),name:"".concat(e._getCurrentPageName({currentItem:i,viewParams:t}),"-").concat(e._getFocusPageName({currentItem:i,focusItem:n.peek(),viewParams:t}))}))}else{var a,i;(i=(a=e._itemSet()).item.peek()).isPlaceholder?a.item():a.isPlaceholder?a.content():e._instrumentationProvider.userViewPage({viewParams:t,item:i,name:e._getCurrentPageName({currentItem:i,viewParams:t})})}}else t=e._viewParams.peek(),e._instrumentationProvider.userViewPage({viewParams:t,name:e._getCurrentPageName({viewParams:t})})}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},I.n.dependencies),{instrumentationProvider:E.d,viewParams:i.T}),t}(I.n);function W(){return"OneUp"}var q=Object(p.o)("PageViewReporter",K),Q=n(11),Y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({contextMenu:T.e,control:M.n});var s=a,d=s.resources,l=s.observables;a.loadingPromiseTracker=d.isExposed(i.A)?d.consume(i.A):d.expose(i.A,new(a.managed(h.e))),a.itemProvider=d.consume(F.resourceKey),a.identityDataSource=d.consume(o.D),a.viewParams=d.consume(i.T),a.platform=d.consume(c.e),a.autoScrollEnabled=l.create(!1),a.autoScrollYPosition=l.create(0),a._createDataManager=a.createPureComputed(a._computeCreateDataManager),a._createDataManager.equalityComparer=D.n,a.dataManager=a.createPureComputed(a._computeDataManager),a.dataManager.equalityComparer=D.n,d.expose(r.c,{updateSort:function(e,t){return a.dataManager.peek().updateSort(e,t)}}),a.item=d.expose(i.r,a.createPureComputed(a._computeItem)),a.item.equalityComparer=D.n,a.unmappedItemSet=a.createPureComputed(a._computeUnmappedItemSet),a.unmappedItemSet.equalityComparer=D.n,a.dataManagerMapper=a.createObservable(new(a.managed(V))({itemSet:a.unmappedItemSet,requiredRange:a.createPureComputed(function(){return a.dataManager().requiredRange()})})),a.dataManagerMapper.equalityComparer=D.n,a.createBackgroundComputed(a._computeUpdateDataManagerMapper),d.expose(i.i,a.dataManagerMapper),a.itemSet=a.createPureComputed(a._computeItemSet),a.itemSet.equalityComparer=D.n,d.expose(i.o,a.itemSet),a.focusItem=a.createPureComputed(a._computeFocusItem),a.focusItem.equalityComparer=D.n,a.error=d.expose(r.a,a.createPureComputed(a._computeError)),a.error.equalityComparer=S.e,a.isOneUp=a.createPureComputed(a.computeIsOneUp),a._initializeRange(),a._initializeLayoutType(),d.expose(r.o.layoutType,a.layoutType),a._indexResolver=d.expose(i.L,{isItemResolved:function(e){return a.dataManager.peek().isItemResolved(e)},resolveIndices:function(e){return a.dataManager.peek().resolveIndices(e)}}),a._initializeItemSelectionModel(t),a._initializeRedirectAction(),a._initializeAutoExecuteAction(),a.createBackgroundComputed(a._computeCollapseLeftNavOnViewChange);var u=d.consume(z.e);a.hasSelectionState=u,a.scope.attach(u.register(d.consume(G.t))),a.title=a.createPureComputed(a._computeTitle),a.isTitleVisible=a.createPureComputed(a._computeIsTitleVisible),a.createBackgroundComputed(a._computeSetDocumentTitle);var f=a.identityDataSource.getIdentity();f&&f.type!==j.e.anonymous&&a._checkForPendingOperations(H.e.itemCopy),a._initializeFocusItemHelper(),a.createBackgroundComputed(a._computeOneUpItemViewed).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}}),a.isSmartBannerVisible=d.isExposed(r.e.isSmartBannerVisible)?d.consume(r.e.isSmartBannerVisible):d.expose(r.e.isSmartBannerVisible,l.create(!1)),a._setUpSmartBanner(),a._initializeOneUpParams(),a.contentControl=a.createPureComputed(a._computeContentControl),a.hasContent=a.createPureComputed(function(){return!!a.contentControl()});var p=d.consume(q);return a.scope.attach(new p({getCurrentPageName:a.computeCurrentPageName.bind(a),getFocusPageName:a.computeFocusPageName.bind(a),itemSet:a.itemSet,focusItem:a.focusItem,isOneUp:a.isOneUp})),a}return Object(a.__extends)(t,e),t.prototype.computeShouldSelectFocusItem=function(){return!this.isOneUp()&&this.dataManager().focusItemIndexInItemSet()>-1},t.prototype.computeReportPageView=function(){},t.prototype.computeCurrentPageName=function(){return"Default"},t.prototype.computeFocusPageName=function(){return"OneUp"},t.prototype.computeIsOneUp=function(){var e=this.focusItem(),t=(e||this.itemSet().item)(),n=!!this.error()||t.type===y.e.Error,a=this.viewParams(),i=this.urlDataSource.getAutoActionType(a);return!(!this.urlDataSource.getFocusItemKey(a)||!e||n||i&&i!==l.t.showProperties)},t.prototype.computeContentControl=function(){var e=this.error(),t=this.item();return t&&t.error&&4===t.error.type?Object(M.a)(P,this.getContentControlParams()):t&&t.error&&6===t.error.type?void 0:e?Object(M.a)(u.t,this._getErrorParams()()):void 0},t.prototype.getSelectionOptions=function(e){return void 0===e&&(e={}),{}},t.prototype.computeDataManagerMapper=function(){return new(this.managed(V))({itemSet:this.unmappedItemSet,requiredRange:this.dataManager().requiredRange})},t.prototype.getContentControlParams=function(){var e={};return this.getContentControlParams=function(){return e},e},t.prototype.computeEnableAutoRedirectOrExecute=function(){return!0},t.prototype.getOneUpSpecification=function(){return Object(M.a)(N.t,{requiredRange:this.focusRange,isSlideshow:this.isOneUpSlideshow})},t.prototype._getErrorParams=function(){var e=this,t=this.observables.pureCompute(function(){return{error:e.error()}});return this._getErrorParams=function(){return t},t},t.prototype._computeUpdateDataManagerMapper=function(){this.dataManagerMapper(this.computeDataManagerMapper())},t.prototype._initializeFocusItemHelper=function(){var e=this;return new(this.managed(x))({focusItem:this.focusItem,canSelect:function(){return e.computeShouldSelectFocusItem()}})},t.prototype._setUpSmartBanner=function(){this.isBannerApplicable=!this.platform.isWinPhone&&(this.platform.isIOS||this.platform.isAndroid)},t.prototype._computeContentControl=function(){var e=!this.item().isPlaceholder&&this._redirectAction.isAvailable(),t=this.dataManager().isActive();return this.error()||t&&!e?this.computeContentControl():this.contentControl.peek()},t.prototype._computeCreateDataManager=function(){return this.computeCreateDataManager()||this._createDataManager.peek()},t.prototype._computeDataManager=function(){var e=this._createDataManager(),t=this.dataManager.peek();return t&&t.dispose(),e.call(this)},t.prototype._checkForPendingOperations=function(e){var n=this;this.itemProvider.getWorkProgress({type:e}).then(function(e){if(e.progress){var a=new _.e;e.progress.map(function(e){if(e.status===R.e[R.e.InProgress]||e.status===R.e[R.e.NotStarted]){var i=n._extractCidFromResId(e.sourceResourceId),r=n._extractCidFromResId(e.targetResourceId);t._getWorkProgressQueue.enqueue(function(){var t,o,s={parentKey:n.urlDataSource.getKey((t={},t.id=e.sourceResourceId,t.cid=i,t))},c=n.itemProvider.getItem(s),l={parentKey:n.urlDataSource.getKey((o={},o.id=e.targetResourceId,o.cid=r,o))},u=n.itemProvider.getItem(l);return d.n.all([c,u]).then(function(t){if(t&&!(t&&t.length<2)){var i=t[0].item.peek(),o=t[1].item.peek();if(i&&o)return d.n.resolve(n.resources.consumeAsync(m)).then(function(t){var n={items:[i],parentKey:o.UNSAFE_parent.key,targetId:o.id,targetKey:o.key,cid:r,group:i.isGroup?1:0,isMove:!1},s=t.registerOperation({item:i,context:n,targetItem:o,taskId:e.id,batch:a,moveCopyItems:function(e,a){return t.handleMoveCopyAsyncItems(n,a)}});return t.handleMoveCopyAsyncItems(n,[s],e.id).then(function(){})})}})})}})}}).catch(function(){})},t.prototype._extractCidFromResId=function(e){return e.split("!")[0]},t.prototype._computeTitle=function(){var e=this.itemSet().item();return e.displayName||e.name||""},t.prototype._computeIsTitleVisible=function(){var e=this.itemSet().item(),t=!1;switch(e.virtualItemType){case v.e.AlbumRoot:case v.e.Tag:case v.e.Album:t=!0}return(!!e.displayName||!!e.name)&&(!e.UNSAFE_parent||t)},t.prototype._computeSetDocumentTitle=function(){var e=this.focusItem()&&this.focusItem()()||this.itemSet().item(),t=e.displayName||e.name||"";document.title=t?g.format(s.t,t):s.e},t.prototype._computeItemSet=function(){return this.dataManagerMapper().mappedItemSet()},t.prototype._computeUnmappedItemSet=function(){return this.dataManager().itemSet()},t.prototype._computeItem=function(){return this.dataManager().item()},t.prototype._computeFocusItem=function(){return this.dataManager().focusItem()},t.prototype._computeError=function(){return this.dataManager().error()},t.prototype._computeOneUpItemViewed=function(){if(this.isOneUp()&&this.focusItem()&&!this.focusItem()().isPlaceholder){var e=this.focusItem.peek().peek();if(e.type!==y.e.Media)return;Object(Q.isFeatureEnabled)(Q.DisableOneUpUpdateViewCount)||this.itemProvider.updateViewCount({items:[e]})}},t.prototype._initializeRange=function(){var e=this,t=this.observables;this.listRange=t.create({start:0,end:0}),this.listRange.equalityComparer=S.e,this.resources.expose(r.t,this.listRange),this.focusRange=t.create({start:0,end:0}),this.focusRange.equalityComparer=S.e,this.createBackgroundComputed(function(){var t;e.item().isPlaceholder?t={start:0,end:0}:e.isOneUp()?(t=e.focusRange(),e.focusItem.peek()||(t=e.dataManagerMapper.peek().mappedRequiredRange.peek())):t=e.listRange(),e.dataManagerMapper().mappedRequiredRange(t)})},t.prototype._initializeLayoutType=function(){var e=this;this.layoutType=this.createComputed({read:function(){return e.dataManager().layoutType()},write:function(t){return e.dataManager.peek().layoutType(t)},pure:!0})},t.prototype._computeCollapseLeftNavOnViewChange=function(){this.dataManager().queryType(),this.isLeftNavUserExpanded(!1)},t.prototype._initializeItemSelectionModel=function(e){var t=this;void 0===e&&(e={});var n=this.getSelectionOptions(e),a=this.createObservable();this.createBackgroundComputed(function(){a(t.itemSet())}),this.itemSelectionModel=this.resources.expose(i.C,new(this.managed(U.e))({itemSet:a,mode:n.mode,maximumSelectedCount:n.maximumSelectedCount,canSelectItem:n.canSelectItem,indexResolver:this._indexResolver}))},t.prototype._initializeAutoExecuteAction=function(){this._autoExecuteAction=new(this.managed(this.actionMap.AutoExecuteAction))({focusItem:this.focusItem}),this.createBackgroundComputed(this._computeAutoExecuteAction).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})},t.prototype._initializeRedirectAction=function(){var e=this;this._redirectAction=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.createPureComputed(function(){return(e.focusItem()||e.itemSet().item)()}),itemSet:this.itemSet,preserveAction:!0,urlType:this.createPureComputed(function(){return e.urlDataSource.getAutoActionType(e.viewParams())||e.focusItem()?"focus":"default"}),ignoreHistory:!0,openLocal:!0}),this.createBackgroundComputed(this._computeAttemptRedirectForItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})},t.prototype._computeAutoExecuteAction=function(){if(this.computeEnableAutoRedirectOrExecute()){var e=this.itemSet().item;if(e.peek().isPlaceholder||this._redirectAction.isAvailable())e();else if(!this.focusItem()||this.dataManager().focusItemIndexInItemSet()>-1){var t=this._autoExecuteAction;if(t.isAvailable.peek()){var n=this.urlDataSource.getAutoActionType(this.viewParams.peek());this.viewParams.peek().o&&n===l.t.showProperties||t.execute(null).done(function(){},function(){})}else t.isAvailable()}}},t.prototype._computeAttemptRedirectForItem=function(){if(this.computeEnableAutoRedirectOrExecute()){var e=this.focusItem()||this.itemSet().item;if(e.peek().isPlaceholder||this.itemSet().item.peek().isPlaceholder)e(),e!==this.itemSet().item&&this.itemSet().item();else{var t=this._redirectAction;t.isAvailable.peek()&&(this.viewParams(),this.async.setTimeout(function(){t.isAvailable.peek()&&t.execute(null).done(function(){},function(){})},0))}}},t.prototype._initializeOneUpParams=function(){var e,t=this;e=this.createPureComputed(function(){var n=t.focusItem();return!n&&e?e.peek():n}),this.resources.expose(i.m,e),this.isOneUpSlideshow=this.createObservable(!1),this.oneUpSpecification=this.observables.pureCompute(function(){return t.getOneUpSpecification()})},t.MAX_CONCURRENT_GET_WORK_PROGRESS=4,t._getWorkProgressQueue=new b.e(t.MAX_CONCURRENT_GET_WORK_PROGRESS),t}(B.e);t.e=Y},2311:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".md .od-allPhotosMonthHeader,.sm .od-allPhotosMonthHeader{height:64px;line-height:64px}.lg .od-allPhotosMonthHeader,.xlg .od-allPhotosMonthHeader,.xxlg .od-allPhotosMonthHeader,.xxxlg .od-allPhotosMonthHeader,.xxxxlg .od-allPhotosMonthHeader{height:80px;line-height:80px}.od-allPhotosMonthHeader-text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block;font-size:21px;font-weight:100}[dir=ltr] .od-allPhotosMonthHeader-text{margin-right:15px}[dir=rtl] .od-allPhotosMonthHeader-text{margin-left:15px}.xlg .od-allPhotosMonthHeader-text,.xxlg .od-allPhotosMonthHeader-text,.xxxlg .od-allPhotosMonthHeader-text,.xxxxlg .od-allPhotosMonthHeader-text{font-size:28px;font-weight:100}"}]);var i=n(388),r=n(0),o=function(e){function t(t){var n=e.call(this,t)||this;return n.headerText=t.headerText,n}return Object(r.__extends)(t,e),t}(n(183).t),s=i.e({tagName:"od-all-photos-month-header",template:'<div class="od-allPhotosMonthHeader"><div class="od-allPhotosMonthHeader-text" role="heading" aria-level="2" data-bind="text:headerText"></div></div>',viewModel:o,synchronous:!0});t.e=s},2313:function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1109),_=n(1885),h=n(1884),b=n(286),g=n(1007),v=n(1816),y=n(1864),S=n(137),D=n(1775),I=n(143),x=n(812),C=n(55),O=n(2033),w=n(1103),E=n(2285),A=n(299),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=e.options.demands,i=m.e.deserialize(n),o=new Date(i.date);return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,m,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y;return Object(f.__generator)(this,function(J){switch(J.label){case 0:return M=Object(x.t)(o,i.resourceId),(P=e(Object(I.e)(function(e){return e.demandItemFacet(D.e,D.t)})))?(T=e(Object(I.e)(function(e){return{hasCount:e.isItemFacetResolved(d.e,n),hasThumbnail:e.isItemFacetResolved(l.h,n)}})),U=T.hasCount,F=T.hasThumbnail,H="carousel",F&&U&&(H="carouselDupeCall"),[4,P.getPhotoRecords(0,1,M,i.driveId,1,H,"onthisday")]):[2];case 1:return R=J.sent(),(N=R&&R.length>0?null===(Y=R[0])||void 0===Y?void 0:Y.driveItem:void 0)&&(B=N.thumbnails[0],(j=B.large||B.medium||B.small)&&(t={url:j.url,width:j.width,height:j.height}),m=o.toString(),L=o),void 0!==m&&L?(V=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),z=new p.e,G=i.driveId,K=i.endpoint,W=w.e.serialize({driveId:G,endpoint:K,type:C.e.OnThisDay,resourceId:"root",key:n}),z.resolveItems({items:(q={},q[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:L,maxDate:L})),s.t.pack({itemKey:V})),q[W]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),O.e.pack(C.e.OnThisDay)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:V})),q)}),e(z.execute()),e(Object(E.e)())?[3,3]:a[d.e.id]?[4,e(Object(g.e)(function(e){var t=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),n=y.e.serialize({photosRootItemSetKeyPart:S.e.deserialize(t)});return e.demandItemFacet(v.a,n)}))]:[3,3]):[3,3];case 2:k=J.sent(),e(Object(r.e)({items:(Q={},Q[n]=Object(f.__assign)({},d.e.pack(k)),Q)})),J.label=3;case 3:return[2]}})})}}),k=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(L))}})},2314:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1110),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(818),D=n(42),I=n(299),x=n(55),C=n(2033),O=n(1103),w=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(a.date),o=new Date(Date.UTC(r.getFullYear(),r.getMonth()+1,0));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,r,d,m,w,E,A,L,k,M,P,T,U,F,H,R,N;return Object(f.__generator)(this,function(B){switch(B.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),w=new p.e,E=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"onthismonth"}),(A=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,A.getPhotoRecords(0,3,m,a.driveId,3,"carousel","onthismonth")]:[2];case 1:return L=B.sent(),k=L.find(function(e){return e.isVideo}),L.length<3&&!k||((M=L&&L.length>0?null===(N=L[0])||void 0===N?void 0:N.driveItem:void 0)&&(P=M.thumbnails[0],(T=P.large||P.medium||P.small)&&(t={url:T.url,width:T.width,height:T.height}),r=D.format(I.u,i.toLocaleString("default",{month:"long"})),d=i),U=a.driveId,F=a.endpoint,H=O.e.serialize({driveId:U,endpoint:F,type:x.e.OnThisMonth,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==r&&d&&(w.resolveItems({items:(R={},R[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:o})),s.t.pack({itemKey:E})),R[H]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),C.e.pack(x.e.OnThisMonth)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:E})),R)}),e(w.execute()))),[2]}})})}}),E=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(w))}})},2315:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1111),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(819),D=n(299),I=n(55),x=n(1103),C=n(2033),O=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()+6));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,o,d,m,O,w,E,A,L,k,M,P,T,U,F,H,R;return Object(f.__generator)(this,function(N){switch(N.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),O=new p.e,w=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"lastweekpreviousyears"}),(E=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,E.getPhotoRecords(0,3,m,a.driveId,3,"carousel","lastweekpreviousyears")]:[2];case 1:return A=N.sent(),L=A.find(function(e){return e.isVideo}),A.length<3&&!L||((k=A&&A.length>0?null===(R=A[0])||void 0===R?void 0:R.driveItem:void 0)&&(M=k.thumbnails[0],(P=M.large||M.medium||M.small)&&(t={url:P.url,width:P.width,height:P.height}),o=D.c,d=i),T=a.driveId,U=a.endpoint,F=x.e.serialize({driveId:T,endpoint:U,type:I.e.LastWeekPreviousYears,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==o&&d&&(O.resolveItems({items:(H={},H[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:r})),s.t.pack({itemKey:w})),H[F]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),C.e.pack(I.e.LastWeekPreviousYears)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:w})),H)}),e(O.execute()))),[2]}})})}}),w=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(O))}})},2365:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return c});var a=n(1743);function i(e){return Object(a.i)(e,!1,!1,!1,{displayHoursInDates:!1,displayHoursToOneDay:!1,displayMinutesToOneHour:!1,displayShortenedWeekday:!1})}var r=Object(a.t)({month:"short",day:"numeric",year:"numeric"}),o=Object(a.t)({month:"long",year:"numeric"}),s=Object(a.t)({month:"short",year:"numeric"}),c=Object(a.t)({month:"long",day:"numeric"})},2366:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(56),o=n(2078),s=n(2160),c=n(1799),d=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.extractSharedAlbumsFromItemSet=function(e){for(var t=this,n=[],a=0,i=e.content.peek().items;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);o.isAlbum&&o.ownerId!==c.t.viewerId&&n.push(r)}return n.sort(function(e,n){return t.peekUnwrapObservable(n).dateSharedTime.getTime()-t.peekUnwrapObservable(e).dateSharedTime.getTime()})},t.prototype.getTagsAndPlaces=function(e,t){for(var n=[],a={},i=[],r={},o=0;o<100;o++){var s=e[o];if(!s)break;var c=s.peek(),d=c.tags&&c.tags.length>0,l=c.geoLocation&&c.geoLocation.hierarchyIndex;d&&l?Math.random()<.5?this._makeTagEntry(c,a,n,t):this._makePlaceEntry(c,r,i,t):d?this._makeTagEntry(c,a,n,t):l&&this._makePlaceEntry(c,r,i,t)}return{tags:n,places:i}},t.prototype._makePlaceEntry=function(e,t,n,a){var i=e.geoLocation,r=i&&i.hierarchyIndex;if(r&&e.thumbnail){var o=t[r];if(!o){var s=this._makePlace(i,a);o=t[r]=s,n.push(s)}var c=o.peek();c.folder.covers?c.folder.covers.push(e.thumbnail):c.folder.covers=[e.thumbnail],o(c)}},t.prototype._makeTagEntry=function(e,t,n,a){var i=e.tags[Math.floor(Math.random()*e.tags.length)],r=t[i.tag];if(!r){var o=this._makeTag(i,a);r=t[i.tag]=o,n.push(o)}var s=r.peek();s.folder.covers?s.folder.covers.push(e.thumbnail):s.folder.covers=[e.thumbnail],r(s)},t.prototype._makeTag=function(e,t){var n={count:0,localizedTag:e.localizedTag,tag:e.tag};return i.observable(s.n(o.e.allTags,n,null,t))},t.prototype._makePlace=function(e,t){return i.observable(s.n(o.e.allPlaces,null,e,t))},t}(r.n);t.e=d},2367:function(e,t,n){"use strict";var a=n(0),i=n(60),r=n(56),o=n(61),s=n(95),c=n(2098),d=n(1740),l=n(36),u=n(11),f=n(1087),p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._promotedPhotosDataSource=n.resources.consume(o.Q),n._albumProvider=n.resources.consume(c.resourceKey),n._photoProvider=n.resources.consume(s._),n._itemProvider=n.resources.consume(d.resourceKey),n._urlDataSource=n.resources.consume(o.Se),n}return Object(a.__extends)(t,e),t.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&f.r(t)||!Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})},t.prototype.getTagsAndPlaces=function(e){var t=this,n=this._photoProvider.getAllPhotosSync(e);return this._photoProvider.getAllPhotosForPage(e).then(function(){var a=n.content().items;return t._promotedPhotosDataSource.getTagsAndPlaces(a,e)})},t.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var n={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},a=this._photoProvider.getAllPhotosSync(n),r=a.item,o=r.peek();return a.isPlaceholder||a.isExpired||o.isPlaceholder?this._photoProvider.getOnThisDayPhotos(n).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):o.folder.covers.length?i.n.wrap([r]):i.n.wrap([])},t.prototype.getSharedAlbums=function(){var e=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(l.e.SharedWithMe)}).then(function(t){return e._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(t)})},t}(r.n);t.e=p},2390:function(e,t,n){"use strict";var a=n(0),i=n(1905),r=n(25),o=n(1794),s=function(e){function t(t){var n=e.call(this,t)||this;n.selection=n.resources.consume(r.C),n.actionMap=n.resources.consume(r.e),n._isSelectionModal=n.resources.consume(o.n),n.commandSets=n.createObservable([]),n.selectionModeOn=n.createPureComputed(n._computeSelectionModeOn),n.selectionModeOff=n.createPureComputed(n._computeSelectionModeOff),n.multipleSelected=n.createPureComputed(n._computeMultipleSelected),n.vaultItemSelected=n.createPureComputed(n._computeVaultItemSelected);var i=n.createPureComputed(n._computeCommands);return n.createComputed(function(){var e;(e=n.commands).splice.apply(e,Object(a.__spreadArray)([0,n.commands.peek().length],i(),!1))}),n.createComputed(n._computeSeparators).extend({rateLimit:0}),n}return Object(a.__extends)(t,e),t.prototype._computeCommands=function(){var e=this.commandSets()||[];return[].concat.apply([],e.map(function(e){return e()}))},t.prototype._computeSeparators=function(){this.selection.selection();var e=this.commandSets();if(e.length){for(var t=!1,n=[],a=0,i=e;a<i.length;a++){for(var r=(0,i[a])(),o=!1,s=0,c=r.length-1;c>=0&&s<2;c--)(u=r[c])&&u.isVisible.peek()&&(u.hasLineBreakAfter(!o),o||(o=!0,n.push(u)),s++);s>1&&(t=!0)}if(!t)for(var d=0,l=n;d<l.length;d++){var u;(u=l[d]).hasLineBreakAfter(!1)}}},t.prototype._computeSelectionModeOn=function(){return this.selection&&this.selection.selection().length>0||this._isSelectionModal()},t.prototype._computeSelectionModeOff=function(){return!this.selectionModeOn()},t.prototype._computeMultipleSelected=function(){return this.selection.selection().length>1},t.prototype._computeVaultItemSelected=function(){for(var e=0,t=this.selection.selection();e<t.length;e++)if(t[e].peek().vault)return!0;return!1},t}(i.e);t.e=s},2415:function(e,t,n){"use strict";var a=n(0),i=n(2208),r=n(60),o=n(36),s=n(460),c=n(977),d=n(1788),l=n(2589),u=n(133),f=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._contextHelper=new(n.resources.injected(l.e)),n._groupingType=n.createPureComputed(n._computeGroupingType,{deferEvaluation:!0}),n}return Object(a.__extends)(t,e),t.prototype.resolveIndices=function(e){for(var t=this,n=new d.e(4),a=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n],r={start:i[0],end:i[i.length-1]+1};t.push(r)}return t}(function(e,t){void 0===t&&(t=1e3);for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=n[n.length-1];(!o||r-o[0]>=t)&&(o=[],n.push(o)),o.push(r)}return n}(e,1e3)),i=[],o=function(e){return function(){return t._resolveRange(e)}},s=0,c=a;s<c.length;s++){var l=c[s];i.push(n.enqueue(o(l)))}return r.n.all(i).then(function(){})},t.prototype.amendCurrentContext=function(e){var t=this.itemSet.peek();t.schema.peek()&&t.schema.peek().length||(e.needSchema=!0)},t.prototype.getCurrentItemSetSync=function(e){return this.itemProvider.getItemSync(e)},t.prototype.getFocusItemSet=function(e){return this.getCurrentItemSet(e)},t.prototype.getCurrentItemSet=function(e){return u.n.mark("DataManager.GetData.Started"),this.itemProvider.getItem(e)},t.prototype.computeCurrentContext=function(){var e,t=this.focusItemKey();t&&this.focusItemIndexInItemSet()<0&&(e=t);var n=this.requiredRange();return this._createGetItemContext(n,e)},t.prototype._computeGroupingType=function(){var e,t=this.queryType();if(Object(s.e)(t)||t===o.e.RecycleBin)e=0;else switch(this.layoutType()){case c.s:case c.l:e=1;break;default:e=0}return e},t.prototype._createGetItemContext=function(e,t){var n=this._contextHelper.getDefaultGetItemContext(this.viewParams());return n.sortField=this.sortConfiguration().field,n.isAscending=this.sortConfiguration().isAscending,n.startIndex=e.start,n.endIndex=e.end,n.startKey=t,n.groupingType=this._groupingType(),n.revision=this.referenceRevision(),n.resultSetOptions=this.itemResultSetOptions,n},t.prototype._resolveRange=function(e){var t=this._createGetItemContext(e);return this.getCurrentItemSet(t)},t}(i.e);t.e=f},2470:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return H}),n(1113),n(1580),n(1579),n(1581);var a=n(0),i=n(183),r=n(25),o=n(1744),s=n(2074),c=n(166),d=n(2091),l=n(17);Object(l.n)([{rawString:".lg .od-ItemContent-metadata,.md .od-ItemContent-metadata,.sm .od-ItemContent-metadata{font-size:14px}.xlg .od-ItemContent-metadata,.xxlg .od-ItemContent-metadata,.xxxlg .od-ItemContent-metadata,.xxxxlg .od-ItemContent-metadata{font-size:16px}.od-ItemContent-metadata-button{cursor:pointer;border-width:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-left:0;padding-right:0}.od-ItemContent-metadata-button i{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var u=n(91),f=n(2843),p=n(42),m=n(1095),_=n(1068),h=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({tooltip:m.e,keyboard:_.e}),n.item=t.item,n._actionMap=n.resources.consume(r.e),n._showPermissionsAction=new(n.managed(n._actionMap.ShowPermissionsAction))({item:n.item,engagementSource:"GlyphClick"}),n.sharedTooltip=f.t,n.sharedWithSomeIcon=f.n,n.sharedAriaLabel=n._getSharedGlyphAriaLabel(),n}return Object(a.__extends)(t,e),t.prototype.onSharedIconClick=function(e,t){u.e.logData({name:"folderSharedIndicatorClicked"}),this._showPermissionsAction.execute(t).done()},t.prototype._getSharedGlyphAriaLabel=function(){return p.format(f.e,this.item().name)},t}(i.t),b=n(388).e({tagName:"folder-shared-indicator",template:'<button class="od-ItemContent-metadata od-ItemContent-metadata-button" data-bind="attr:{\'aria-label\':sharedAriaLabel},tooltip:{content:sharedTooltip},click:onSharedIconClick"><i class="ms-Icon ms-Icon--People" data-bind="icon:true,attr:{alt:sharedWithSomeIcon}"></i></button>',viewModel:h,synchronous:!0}),g=n(2079),v=n(1972),y=n(61),S=n(95),D=n(1819),I=n(2432),x=n(11),C=n(2137),O=n(2844),w=n(36),E=n(570),A=n(317),L=n(29),k=n(12),M=n(390),P=n(338),T=n(5),U=n(1996),F=function(e){function t(t,i){var l=e.call(this,t,i)||this;l.addBindingHandlers({control:c.n,react:E.t}),l._urlDataSource=l.resources.consume(y.ye),l.breadcrumbBarTagName=d.e.tagName,l.emptyFolderControl=Object(c.a)(s.e,{isViewOnly:l.createPureComputed(l._computeIsViewOnly,{deferEvaluation:!0})}),l.isQuotaBarVisible=l.createObservable(!1),l.isPhotoStreamStorageManagementVisible=l.createObservable(!1);var u=l.resources.consume(r.e);l._uploadAction=new(l.managed(u.UploadAction))({uploadProcessorType:v.e.Html5file}),l.sharedIndicatorTagName=b.tagName,l.isShowSharedIndicator=l.createPureComputed(l._computeIsShowSharedIndicator),l.isSendTagsFeedbackVisible=l.createPureComputed(l._computeSendTagsFeedback),l._itemSetMonitor=l.resources.consume(g.e),l.footerItem=t.footerItem,l.itemSet=l._itemSetMonitor.itemSet,l.itemSetSelectionModel=l.resources.consume(r.C),l.contentRange=l.resources.consume(o.t),l.layoutType=l.resources.consume(I.t),l.isFixedLayout=l._computeIsFixedLayout(),l.listViewContextMenuHelper=l.resources.isExposed(o.s)?l.resources.consume(o.s):void 0,l.title=l._itemSetMonitor.name,l.showBreadcrumb=l._itemSetMonitor.hasParent,l.showEmpty=l._itemSetMonitor.isEmpty,l.showList=l.observables.pureCompute(l._computeShowList),l.item=l._itemSetMonitor.item,l.storageSummaryString=O.e,l.totalUsedString=O.t,l.showTitle=l.createPureComputed(l._computeShowTitle,{deferEvaluation:!0});var f=l.resources.consume(S.e),p=function(){l.itemSet()&&l._urlDataSource.isSearchPassThrough()?(l.isQuotaBarVisible(!0),l.isPhotoStreamStorageManagementVisible(l._computeIsPhotoStreamEntryEnabled())):(l.isQuotaBarVisible(!1),l.isPhotoStreamStorageManagementVisible(!1))};if(Object(x.isFeatureEnabled)(T.Yn)?n.e(434).then(n.bind(null,3446)).then(function(){p()}):l.createComputed(function(){var e=f&&f.getBundleInfo(2);e&&e.isLoaded()&&p()}),l.detailsPaneSpecification=Object(c.a)(C.resourceKey,{}),l.imageTagFeedbackControlParams={componentType:U.e,props:{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1,isSearchView:!0}},l._computeIsPhotoStreamEntryEnabled()){var m=Object(A.e)(function(){return Object(a.__awaiter)(l,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(502).then(n.bind(null,4101))];case 1:return[2,e.sent().ResourcedStorageManagementItemsScopeItemContent]}})})});l.photoStreamStorageManagementParams={componentType:m,props:{}}}return l}return Object(a.__extends)(t,e),t.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()},t.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()},t.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()},t.prototype._computeSendTagsFeedback=function(){return Object(x.isFeatureEnabled)(x.EnableTagsInODC)&&this.item().queryType===w.e.Search&&this._urlDataSource.getPageType()===L.e.Photos},t.prototype._computeIsShowSharedIndicator=function(){var e=this.item().sharingType;return e===D.e.Shared||e===D.e.Public||e===D.e.PublicUnlisted},t.prototype._computeIsFixedLayout=function(){return!k.e.isActivated("0F3F9AF2-9836-4DCE-B164-F22F3E6AC307","05/14/2021","Allows details list to use fixed columns to enable horizontal scrolling")},t.prototype._computeIsPhotoStreamEntryEnabled=function(){var e=this.resources.consume(M.n);return Object(P.n)()&&(null==e?void 0:e.isLargestFilesView())&&!k.e.isActivated("C8FAAC59-23EE-4276-A91F-B72099C1539B","02/08/2022","Enable Photo story storage management entry point")},t}(i.t),H=Object(c.t)({name:"FolderItemContent",automationName:"od-folder-item-content",template:'<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<h1 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text:title"></h1>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShowSharedIndicator--\x3e<div class="od-ItemContent-header-sharedIndicator" data-bind="component:{name:sharedIndicatorTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isSendTagsFeedbackVisible--\x3e<div class="od-FolderItemContent-tagsFeedback od-ItemContent-tagsFeedback" data-bind="react:imageTagFeedbackControlParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:isQuotaBarVisible--\x3e<div class="StorageInfo-sectionHeading" data-bind="text:storageSummaryString"></div><div class="od-ItemContent-progress-container"><div class="StorageInfo-totalUsed" data-bind="text:totalUsedString"></div><div class="od-ItemContent-progress" data-bind="component:{name:\'od-quota-progress-bar\'}"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:isPhotoStreamStorageManagementVisible--\x3e<div data-bind="react:photoStreamStorageManagementParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:{itemSet:itemSet,selectionModel:itemSetSelectionModel,requiredRange:contentRange,enableMarqueeSelection:true,contextMenuHelper:listViewContextMenuHelper,footerItem:footerItem,isFixedLayout:isFixedLayout}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e</div>\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e',viewModelType:F})},2504:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(118),i=n(11),r=function(){function e(e){this._identityDataSource=e}return e.prototype.isExperimentOn=function(e,t,n){var i=this._identityDataSource.getIdentity().email;a.t.init({userLoginName:i});var r={name:e,startDate:t,version:a.e.v2};return new a.t(r,n).isOn()},e.prototype.isUseVroomInItemsScopeAllPhotosOtdExpOn=function(){return this.isExperimentOn("useVroomInItemsScopeAllPhotosOtdExp","2021/01/11",i.UseVroomInItemsScopeAllPhotosOtdExp)},e.prototype.isEnableLastWeekPreviousYearsExpOn=function(){return this.isExperimentOn("EnableLastWeekPreviousYearsExp","2021/06/04",i.EnableLastWeekPreviousYearsExp)},e.prototype.isEnableMonthRecapGroupHeaderExpOn=function(){return this.isExperimentOn("EnableMonthRecapGroupHeaderExp","2021/06/04",i.EnableMonthRecapGroupHeaderExp)},e.prototype.isEnableNewCarouselDesignExpOn=function(){return this.isExperimentOn("EnableNewCarouselDesignExp","2021/08/24",i.EnableNewCarouselDesignExp)},e}()},2505:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(2284),r=n(11),o=n(35),s=n(90),c=n(1827),d=function(){function e(e,t,n){this._photoProviderAddonSource=n,this._vroomAddonSource=new i.e(e,t),this._itemCacheStore=t}return e.prototype.updateResource=function(e){this._photoProviderAddonSource.updateResource(e),this._vroomAddonSource.updateResource(e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(r).getGroupToCount(e,t,n,i,r)]})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(s).getPhotoRecords(e,t,n,i,r,o,s)]})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource("folder").getPhotoRecordsForBurstMode(e,t,n)]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomAddonSource.getIsSamsungFolderAvailable()]})})},e.prototype.getAddonSource=function(e){switch(e){case"folder":case"onthisday":return this._itemCacheStore.dispatch(Object(c.t)())?this._vroomAddonSource:this._photoProviderAddonSource;case"place":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSinglePlace)?this._vroomAddonSource:this._photoProviderAddonSource;case"tag":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSingleTag)||Object(r.isFeatureEnabled)(r.UpdateOdcPhotoApiForConvergence)&&Object(s.e)(o.M)?this._vroomAddonSource:this._photoProviderAddonSource;case"onthismonth":case"lastweekpreviousyears":return this._vroomAddonSource}return this._photoProviderAddonSource},e}()},2506:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(2),r=n(209),o=n(28),s=n(201),c=n(95),d=n(8),l=new i.e("promotedPhotosDataSource"),u=new i.e("PhotosDataSource"),f=new d.t({name:"PromotedPhotosDataSourceConfig",factory:{dependencies:{photosProvider:c._,promotedPhotosProvider:c.v},create:function(e){return{instance:Object(o.t)(function(){return function(t){var n;t(Object(r.e)({items:(n={},n[s.e]=Object(a.__assign)(Object(a.__assign)({},l.pack(e.promotedPhotosProvider)),u.pack(e.photosProvider)),n)}))}})}}}})},2507:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(2043),r=n(292),o=n(42),s=n(2284),c=n(36),d=n(151),l=n(2190),u=n(812),f=n(10),p=[1e4,1e3,100],m="root",_=function(){function e(e,t,n,a,i){this._groupToCount=[],this._groupToCountDate=[],this._vroomDataRequestor=e,this._successfulPageSizeIndex=0,this._photoProvider=t,this._itemProvider=n,this._urlDataSource=a,this._engagement=i}return e.prototype.updateResource=function(e){},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,"landing","folder")];case 1:return[2,a.sent()]}})})},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(r){case"album":return[3,1];case"tag":return[3,3];case"onthisday":return[3,5]}return[3,7];case 1:return[4,this._getGroupToCountForSingleAlbum(t,n)];case 2:return e=a.sent(),[3,9];case 3:return[4,this._getGroupToCountForSingleTag(t)];case 4:return e=a.sent(),[3,9];case 5:return[4,this._getGroupToCountForOnThisDay(t)];case 6:return e=a.sent(),[3,9];case 7:return[4,this._getGroupToCountForAllPhotos(t,n,i,r)];case 8:e=a.sent(),a.label=9;case 9:return[2,e]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(s){case"album":i=this._getPhotoRecordsForSingleAlbum(e,t,n);break;case"tag":i=this._getPhotoRecordsForSingleTag(e,t,n);break;case"onthisday":i=this._getPhotoRecordsForOnThisDay(e,t,n);break;default:i=this._getPhotoRecordsForAllPhotos(e,t,n,s)}return[2,i]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,u,f,p,m,_,h,b;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=void 0,o=0,0!==e&&(s=this._getStartDate(e,n),c=s.date,d=s.index,void 0!==c&&d>=0?(r=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),24,0,0,-1)),o=d):o=e),l=e-o,u=t-o,f=this._photoProvider.getAllPhotosSettings(),p=r?r.toISOString():void 0,m=new Date,[4,this._getPhotoRecords(o,t,l,p,f.peek().rootId,void 0,void 0)];case 1:return _=a.sent(),h=new Date,b=h.getTime()-m.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:b,count:u,requests:_.requestsCount,skip:e-o,api:"skyapi"},i),[2,_.photos]}})})},e.prototype._getPhotoRecords=function(e,t,n,i,o,s,c){return Object(a.__awaiter)(this,void 0,void 0,function(){var d,l,u,f,p,m,_,h,b,g,v;return Object(a.__generator)(this,function(a){switch(a.label){case 0:d=[],l=200,u=0,f=t-e,p=0,a.label=1;case 1:return f>0?(p++,m=Math.min(l,f),h=(_=e+u)+m,[4,this._photoProvider.getAllPhotosForPage({rootItemId:o,parentKey:null,startIndex:_,endIndex:h-1,jumpToStartDate:i,photoType:r.e.AllMyPhotos,ascending:!1,locationFilter:c,pageSize:l,revision:0,skipInMemoryCache:!1,tagFilter:s})]):[3,5];case 2:return b=a.sent(),g=void 0,Array.isArray(b)?(g=b[0].content(),console.warn("Invalid result from getAllPhotosForPage (array)")):b&&b.content&&(g=b.content()),g&&g.items?(v=Math.min(g.items.length,h),[4,this._transformIOneDriveItemsToIPhotoRecords(g.items,_+n,v,d)]):[3,4];case 3:a.sent(),a.label=4;case 4:return u+=m,n=n>m?n-m:0,f-=m,[3,1];case 5:return[2,{photos:d,requestsCount:p}]}})})},e.prototype._getPhotoRecordsForOnThisDay=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(i=Object(u.e)(n).date).setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),[4,this._urlDataSource.getCurrentItemKey()];case 1:return r=a.sent(),o={parentKey:r,startDate:i.toISOString(),onThisDay:!0,highlights:!1,pageSize:100,ascending:!1,rootItemId:m,startIndex:0,endIndex:0},[4,this._photoProvider.getOnThisDayPhotos(o)];case 2:return s=a.sent(),c=[],d=s.content(),l=d.items,f=t>0?Math.min(t,l.length):l.length,[4,this._transformIOneDriveItemsToIPhotoRecords(d.items,e,f,c)];case 3:return a.sent(),[2,c]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,r=1,[4,this._getItemsForSingleAlbum(e,t,n)];case 1:return o=a.sent(),s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r,api:"skyapi"},"album"),[2,o]}})})},e.prototype._getPhotoRecordsForSingleTag=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,[4,this._getPhotoRecords(e,t,0,void 0,m,n,void 0)];case 1:return r=a.sent(),o=r.photos,s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r.requestsCount,api:"skyapi"},"tag"),[2,o]}})})},e.prototype.getOwnerId=function(e){return this._urlDataSource.getKeyParams(e).cid||f.z},e.prototype._getItemsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=[],[4,this._urlDataSource.getCurrentItemKey()];case 1:r=a.sent(),o=t-e,s=e,a.label=2;case 2:return o>0?[4,this._itemProvider.getItem({parentKey:r,ownerId:this.getOwnerId(r),id:n,startIndex:s,endIndex:t-1,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})]:[3,6];case 3:if(d=a.sent(),Array.isArray(d))throw new Error("Invalid result from getAllPhotosForPage (array)");return d&&d.content&&(l=d.content())&&l.items?[4,this._transformIOneDriveItemsToIPhotoRecords(l.items,e,t,i)]:[3,5];case 4:a.sent(),a.label=5;case 5:return o=t-i.length-e,s=e+i.length,[3,2];case 6:return[2,i]}})})},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfulPageSizeIndex,a.label=1;case 1:if(!(o<p.length))return[3,6];c=p[o],d=Object(s.t)(c,e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(d)];case 3:return l=a.sent(),this._successfulPageSizeIndex=o,[2,l];case 4:return u=a.sent(),r=u,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u,f,p,m,_;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new Date,o=n?parseInt(n,10):1,[4,this._getGroupCountWithVariablePageSize(i,e,t,o)];case 1:return c=a.sent(),d=c.value.length>0&&c["@odata.nextLink"],l=c.value,u=l.length,[4,Object(s.n)(l,i,e)];case 2:return f=a.sent(),n?this._mergeGroupToCounts(f.counts,f.dates):(this._groupToCount=f.counts,this._groupToCountDate=f.dates),this._groupToCountDate.length>0&&(p=this._groupToCountDate[this._groupToCountDate.length-1].toISOString(),this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:p},i)),m=new Date,_=m.getTime()-r.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:_,groups:f.counts.length,requests:1},i),[2,{counts:f.counts,pageToken:d?(o+u).toString():void 0}]}})})},e.prototype._getGroupToCountForSingleAlbum=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._urlDataSource.getCurrentItemKey()];case 1:return t=a.sent(),[4,this._itemProvider.getItem({parentKey:t,ownerId:this.getOwnerId(t),id:e,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})];case 2:return n=a.sent(),i=n.item(),r=i&&i.folder&&i.folder.photoCount?i.folder.photoCount:0,o=[e,e,e],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[]}]}})})},e.prototype._getGroupToCountForSingleTag=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=this._urlDataSource.getKey(((i={}).id=m,i.qt="allmyphotos",i.tagFilter=e,i)),n=this._urlDataSource.getKeyParams(t),[4,this._itemProvider.getItem({avoidSeamSnapping:!0,parentKey:t,ownerId:this.getOwnerId(),skipCache:!0,pageSize:0,filters:{tagFilter:n.tagFilter,locationFilter:n.locationFilter}})];case 1:return[2,{counts:[{count:a.sent().content().items.length,headers:[e,e,e],labels:[e,e,e]}]}]}})})},e.prototype._getGroupToCountForOnThisDay=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._getPhotoRecordsForOnThisDay(0,0,e)];case 1:if(0===(t=a.sent()).length)return[2,{counts:[]}];if(!t[0].dateTakenTime)throw new Error("Invalid date object");for(n=t[0].dateTakenTime.getUTCFullYear(),i=[],r=0,o=0;o<t.length;o++)(s=t[o]).dateTakenTime&&((c=s.dateTakenTime.getUTCFullYear())!==n&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]}),n=c,r=0),r++);return r>0&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]})),[2,{counts:i}]}})})},e.prototype._getStartDate=function(e,t){for(var n=0,a=-1,i=0,r=0;r<this._groupToCount.length;r++){if((n+=this._groupToCount[r].count)>e){a=r;break}i=n}return a>=0?{date:this._groupToCountDate[a],index:i}:{date:void 0,index:-1}},e.prototype._makeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._vroomDataRequestor.send({apiName:"allPhotos",path:e,useAuthorizationHeaders:!0})];case 1:return t=n.sent(),[3,3];case 2:throw n.sent(),new Error("error loading "+e);case 3:return[2,t]}})})},e.prototype._timeStampToDate=function(e){var t=e;return null==t&&(t="0000-00-00 12:00:00 AM"),/[A,P]M/.test(t)&&(t=t.replace(/-/g,"/")),new Date(t)},e.prototype._transformIOneDriveItemsToIPhotoRecords=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:o=t,a.label=1;case 1:return o<n?e[o]?(s=e[o](),[4,this._transformPhoto(s)]):[3,3]:[3,5];case 2:return r=a.sent(),i.push(r),[3,4];case 3:i.push({id:"",thumbnails:[],name:o.toString(),dateTakenTime:r?r.dateTakenTime:new Date,isVideo:!1}),a.label=4;case 4:return++o,[3,1];case 5:return[2]}})})},e.prototype._transformPhoto=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,s,c,d,l,u,f,p,m,_,h;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return".gif"!==t.extension||t.photo&&t.photo.originalUrl?[3,2]:[4,this._itemProvider.getItem({parentKey:t.key})];case 1:n=a.sent(),(i=n.item()).photo&&i.photo.originalUrl?t=i:console.warn("Retrieved getItems for Gif did not have an Open URL"),a.label=2;case 2:return r=t.thumbnail&&t.thumbnail.width?t.thumbnail.width:t.photo&&t.photo.width,s=t.thumbnail&&t.thumbnail.height?t.thumbnail.height:t.photo&&t.photo.height,r&&s||(r=600,s=600,console.warn("Image doesn't have width and height, using default instead")),c=0!==s?r/s:1,d=Math.min(32,s),l=Math.floor(d*c),u=Math.min(352,s),f=Math.floor(u*c),p=void 0,t.dateTakenTime&&!e._platform.isSafari?p=t.dateTakenTime:t.dateTaken?p=this._timeStampToDate(t.dateTaken):t.dateCreatedTime&&(m=t.dateCreatedTime,_=t.dateModifiedTime,p=m&&_&&m>_?t.dateModifiedTime:t.dateCreatedTime),h=t.thumbnail?o.format(t.thumbnail.url,r,s):"",[2,{id:t.id||t.key,thumbnails:r&&s&&t.thumbnail?[{url:o.format(t.thumbnail.url,l,d),width:l,height:d},{url:o.format(t.thumbnail.url,f,u),width:f,height:u},{url:h,width:r,height:s}]:[{url:"",width:0,height:0}],name:t.name||"No Name",dateTakenTime:p,location:t.geoLocation,extension:t.extension,originalUrl:t.photo&&".gif"===t.extension?t.photo.originalUrl:h,isVideo:!!t.video}]}})})},e.prototype._mergeGroupToCounts=function(e,t){if(this._groupToCount.length>0&&e.length>0){var n=this._groupToCount.length-1;Object(i.n)(this._groupToCount[n]).join(";")===Object(i.n)(e[0]).join(";")?(this._groupToCount[n].count+=e[0].count,e.length>1&&(this._groupToCount=this._groupToCount.concat(e.slice(1)),this._groupToCountDate=this._groupToCountDate.concat(t.slice(1)))):(this._groupToCount=this._groupToCount.concat(e),this._groupToCountDate=this._groupToCountDate.concat(t))}else console.warn("Tried to add empty group to count into local groupToCount variables!")},e.prototype._logTelemetry=function(e,t,n){if(this._engagement)try{this._engagement.logData({name:(l.e[n]||"unknown")+"."+e,extraData:t})}catch(e){console.warn("Exception while logging! ResourceScope may have been disposed.")}},e._platform=new d.e,e}()},2535:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(22),i=n(8),r=new i.t({name:"CurrentCommandSet.key",factory:new i.e(a.observable())})},2546:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(128),r=new a.t({name:"CommandBar.key",loader:new i.t(function(){return n.e(385).then(n.bind(null,2914)).then(function(e){return e.knockoutResourceKey.local})})})},2628:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(11),i=n(983);function r(){return Object(a.isFeatureEnabled)(a.HideExploreYourPhotosCarousel)}function o(e){switch(e){case"0":return i.n[i.n.carousel];case"1":return i.n[i.n.syncClient];case"2":return i.n[i.n.email];case"3":return i.n[i.n.cherryHill];case"4":return i.n[i.n.filesCarousel];default:return i.n[i.n.unknown]}}},2715:function(e,t,n){"use strict";var a=n(0),i=n(2208),r=n(2098),o=n(95),s=n(60),c=n(1788),d=n(977),l=n(292),u=n(2078),f=n(36),p=n(435),m=n(11),_=n(1747),h=n(677),b=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._photoProvider=n.resources.consume(o._),n._albumProvider=n.resources.consume(r.resourceKey),n._tagProvider=n.resources.consume(o.E);var a=n.viewParams.peek();return a&&a.noRootId?n._allPhotosUserSettings=n.createObservable({rootId:"",isAscending:!1}):(n._allPhotosUserSettings=n._photoProvider.getAllPhotosSettings(),n.createBackgroundComputed(n._computeAllPhotosSettings).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})),n.createBackgroundComputed(n._markNewAutoAlbumAsSeen),n.createBackgroundComputed(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),n}return Object(a.__extends)(t,e),t.prototype.getDefaultLayoutForView=function(){var t=this.referenceItemSet(),n=this.layoutType.peek()||d.s;if(!t)return n;var a=t.context,i=t.item(),r=this.urlDataSource.getKeyParams(i.key);if(this._isGetItemRequest(a))if(i.isPlaceholder)"albums"===r.id&&(n=d.e);else switch(i.virtualItemType){case p.e.Album:n=d.l;break;case p.e.AlbumRoot:n=d.e}else switch("allmyphotos"===r.qt&&(n=e.prototype.getDefaultLayoutForView.call(this)),r.id){case"tags":case"places":n=d.f}return n},t.prototype.isItemResolved=function(t){return e.prototype.isItemResolved.call(this,t)&&!!t.peek().itemFromServer},t.prototype.resolveIndices=function(e){for(var t=this,n=new c.e(6),a=this.itemSet.peek().content.peek().items,i=[],r=function(e){return function(){return t.itemProvider.getItem(e)}},o=0,d=e;o<d.length;o++){var l=a[d[o]];if(l&&l.peek()&&l.peek().key){var u={parentKey:l.peek().key,resultSetOptions:this.itemResultSetOptions};i.push(n.enqueue(r(u)))}}return s.n.all(i).then(function(){})},t.prototype.getOnThisDayContext=function(){var e=l.e.onThisDay,n=this.requiredRange.peek(),a=this._allPhotosUserSettings.peek().rootId,i=this.referenceRevision.peek(),r=this.currentItemKey.peek(),o=this.urlDataSource.getKeyParams(r),s=this.viewParams.peek(),c={parentKey:void 0,photoType:e,startIndex:n.start,endIndex:n.end,rootItemId:a,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:o.locationFilter,tagFilter:o.tagFilter},d=new Date;d.setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0);var u=d.toISOString(),f=!0,p=!1;try{f=u=new Date(Date.parse(s.onThisDay)).toISOString(),p=!!s.highlights&&!!s.highlights}catch(e){}return c.startDate=u,c.onThisDay=f,c.highlights=p,c},t.prototype.getCurrentItemSetSync=function(e){var t;if(this._isGetItemRequest(e))t=this.itemProvider.getItemSync(e),"albums"===this.urlDataSource.getKeyParams(e.parentKey).id&&(t.item().displayName=h.e);else switch(e.photoType){case l.e.AllMyPhotos:case l.e.singleTag:case l.e.singlePlace:case l.e.singlePerson:case l.e.onThisDay:case l.e.onThisMonth:case l.e.lastWeekPreviousYears:t=this._photoProvider.getAllPhotosSync(e);break;case l.e.allTags:t=this._tagProvider.getAllTagsSync(e,u.e.allTags);break;case l.e.allPlaces:t=this._tagProvider.getAllTagsSync(e,u.e.allPlaces);break;default:t=this.itemSet.peek()}return t},t.prototype.getCurrentItemSet=function(e){var t;if(this._isGetItemRequest(e))this.urlDataSource.getKeyParams(e.parentKey).id,t=this.itemProvider.getItem(e);else switch(e.photoType){case l.e.AllMyPhotos:case l.e.singleTag:case l.e.singlePlace:case l.e.singlePerson:t=this._photoProvider.getAllPhotosForPage(e);break;case l.e.onThisDay:t=this._photoProvider.getOnThisDayPhotos(e);break;case l.e.allTags:t=this._tagProvider.getAllTags(e);break;case l.e.allPlaces:t=this._tagProvider.getAllPlaces(e);break;default:t=null}return t},t.prototype.computeCurrentContext=function(){var e,n=this.requiredRange(),a=this.viewParams(),i=this.referenceRevision(),r=this.urlDataSource.getPhotoType(a),o=this.currentItemKey();if(r===l.e.Albums)e={parentKey:o,queryType:f.e.AllMyPhotos,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,a)};else if(r===l.e.singleAlbum){var s=this.urlDataSource.getFocusItemKey(),c=null;s&&this.focusItemIndexInItemSet()<0&&(c=s),e={parentKey:o,queryType:f.e.AllMyPhotos,startKey:c,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,a),resultSetOptions:this.itemResultSetOptions}}else if(r===l.e.allPeople)e=this._determineFaceContext();else{var d=this.urlDataSource.getKeyParams(o),u=void 0;"allmyphotos"!==d.qt||d.tagFilter||d.locationFilter||(u=this._allPhotosUserSettings().rootId),e=r===l.e.onThisDay?this.getOnThisDayContext():{parentKey:null,photoType:r,startIndex:n.start,endIndex:n.end,rootItemId:u,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:d.locationFilter,tagFilter:d.tagFilter,onThisMonth:d.onThisMonth,lastWeekPreviousYears:d.lastWeekPreviousYears}}return e},t.prototype._markNewAutoAlbumAsSeen=function(){var e=this.item();if(!Object(m.isFeatureEnabled)(m.EnableEvokeAlignments)&&e.properties.newTag&&e.properties.autoAlbumTag){var t=!1,n=this.viewParams();this.resources.consume(_.n)&&void 0===n.tagFilter&&(t=!0),this._albumProvider.markAutoAlbumAsSeen(e,t)}},t.prototype._determineFaceContext=function(){var e=this.requiredRange();return{startIndex:e.start,endIndex:e.end,parentKey:this.currentItemKey(),queryType:f.e.AllMyPhotos,sortField:"size",isAscending:!1,revision:this.referenceRevision()}},t.prototype._computeAllPhotosSettings=function(){var e=this._allPhotosUserSettings(),t=this.currentItemKey(),n=this.urlDataSource.getKeyParams(t),a=n.id,i=this.urlDataSource.getQueryType(n),r=!(n.locationFilter||n.tagFilter||n.onThisDay||n.onThisMonth||n.lastWeekPreviousYears);e&&a!==e.rootId&&i===f.e.AllMyPhotos&&r&&!this.focusItemKey()&&(n.id=e.rootId,this.navigation.navigateTo({url:this.urlDataSource.getItemUrl(this.urlDataSource.getKey(n),{viewParams:this.viewParams.peek()}),ignoreHistory:!0}))},t.prototype._computeRequestFocusItem=function(){var e,t=this.itemCacheToKOStoreDataSource();if(t)e=t.focusedKOItem();else{var n=this.focusItem();if(!n)return;e=n()}if(e&&!e.parentKey&&!e.isPlaceholder){var a=this.focusItemContext();this.trackPromise(this.itemProvider.getItem(a))}},t.prototype._isGetItemRequest=function(e){return!!e.parentKey&&!this.useItemCacheData()},t.REQUEST_PAGE_SIZE=100,t}(i.e);t.e=b},2716:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(60),i=n(1056),r=n(8),o=n(128),s=new r.t({name:"PhotosItemsScopeItemContent.key",loader:new o.t(function(){return Object(i.t)({path:"./PhotosItemsScopeItemContent",getModule:function(){return a.n.resolve(n.e(189).then(n.bind(null,3115)))},getExport:function(e){return e.knockoutResourceKey.local}})})})},2757:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".SmartBannerV2{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:80px;overflow:hidden;cursor:pointer;border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";position:fixed;z-index:298;bottom:0;left:0;right:0;padding:10px;box-shadow:-7px 0 10px rgba(0,0,0,.22)}.SmartBannerV2 .SmartBanner-close{position:absolute;top:0;width:40px;text-align:center;line-height:40px;cursor:pointer;border:none;background-color:transparent;font-size:20px}[dir=ltr] .SmartBannerV2 .SmartBanner-close{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-close{left:0}.lg .SmartBannerV2 .SmartBanner-close,.xlg .SmartBannerV2 .SmartBanner-close,.xxlg .SmartBannerV2 .SmartBanner-close,.xxxlg .SmartBannerV2 .SmartBanner-close,.xxxxlg .SmartBannerV2 .SmartBanner-close{top:-5px;font-size:16px}[dir=ltr] .SmartBannerV2 .SmartBanner-content{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-content{left:0}.lg .SmartBannerV2 .SmartBanner-content,.xlg .SmartBannerV2 .SmartBanner-content,.xxlg .SmartBannerV2 .SmartBanner-content,.xxxlg .SmartBannerV2 .SmartBanner-content,.xxxxlg .SmartBannerV2 .SmartBanner-content{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button{padding-top:17px}.md .SmartBannerV2 .SmartBanner-content .SmartBanner-button,.sm .SmartBannerV2 .SmartBanner-content .SmartBanner-button{clear:both;padding-top:12px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:right}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:left}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:5px;height:40px;width:40px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:right}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon.SmartBanner-useSquareIcon{border-radius:0}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:6px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:42px;margin:10px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{height:64px;width:64px}[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-left:10px}[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-right:10px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:right}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:14px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:17px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text.SmartBanner-noTagline .SmartBanner-lead{margin-top:7px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:12px;height:15px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:14px}"}]);var i,r=n(0),o=n(22),s=n(91),c=n(793),d=n(183),l=n(1071),u=n(64),f=n(61),p=n(3017),m=n(42);!function(e){e[e.SmartBannerV2_Close=0]="SmartBannerV2_Close",e[e.SmartBannerV2_Click=1]="SmartBannerV2_Click"}(i||(i={}));var _=i,h=n(29),b=n(36),g=function(){function e(){}return e.init=function(t,n,a,i,r){var c,d,l=o.utils.unwrapObservable(n());if(l&&(c=l.logClickContext.contextKey,_[c]&&o.utils.registerEventHandler(t,e.BINDING_ACTION,function(){d=m.format(e.ENGAGEMENT_NAME_FORMAT,h.e[l.logClickContext.pageType],b.e[l.logClickContext.queryType],_[c]),s.e.logData({name:d.toLowerCase(),extraData:{action:e.BINDING_ACTION}})}),l.click))return o.bindingHandlers.click.init(t,function(){return l.click},a,i,r)},e.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}",e.BINDING_ACTION="click",e}(),v=n(69),y=n(211),S=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:c.e}),n._platformDetection=n.resources.consume(y.e),n._navigation=n.resources.consume(v.e);var a=n._navigation.viewParams;return n._isTestHookEnabled=!!a.mobileupsell,n.buttonText=p.t,n.taglineText=p.i,n.leadText=p.n,n.useSquareIcon=!1,n._platformDetection.isWinPhone?(n.hideTagline=!0,n.taglineText="",n.leadText=p.a,n.useSquareIcon=!0):(n._platformDetection.isAndroid||(n.buttonText=p.e),n.hideTagline=!1),n._urlDataSource=n.resources.consume(f.ye),n._dataStore=n.resources.consume(l.e),n._iosMobilePathDataSource=n.resources.isExposed(f.C)?n.resources.consume(f.C):null,n._isVisible=t.isVisible,n._updateIsVisibleBinding(),n.isCloseVisible=o.observable(!0),n._storePath=t.useODCAdjustLink?"https://app.adjust.com/k8x1qd_mpo9r5":"https://app.adjust.com/xxf6jd_wkry4s_qxfx79",n}return Object(r.__extends)(t,e),t.prototype.onCloseButtonClick=function(){this._dismiss()},t.prototype.onCloseClick=function(){this.isCloseVisible.peek()||this._dismiss()},t.prototype.onContentClick=function(){var e=this,t=Date.now(),n=m.format(g.ENGAGEMENT_NAME_FORMAT,h.e[this._urlDataSource.getPageType()],b.e[this._urlDataSource.getQueryType()],_[_.SmartBannerV2_Click]);s.e.logData({name:n.toLowerCase()}),this._platformDetection.isIOS?this._navigation.navigateTo(this._storePath):(this.async.setTimeout(function(){Date.now()-t<750&&e._navigation.navigateTo(e._storePath)},250),this._navigation.navigateTo(this._iosMobilePathDataSource.getPath()))},t.prototype._dismiss=function(){this._isVisible(!1),this._dataStore.setValue(t.STORAGE_KEY,Date.now(),u.e.local);var e=m.format(g.ENGAGEMENT_NAME_FORMAT,h.e[this._urlDataSource.getPageType()],b.e[this._urlDataSource.getQueryType()],_[_.SmartBannerV2_Close]);s.e.logData({name:e.toLowerCase(),extraData:{action:g.BINDING_ACTION}})},t.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource&&(e=!0,!this._isTestHookEnabled)){var n=this._dataStore.getValue(t.STORAGE_KEY,u.e.local);n&&n>this._getPromptWaitTimeMilli()&&(e=!1)}e&&s.e.logData({name:"SmartBannerV2_View",currentPage:h.e[this._urlDataSource.getPageType()],extraData:{queryType:b.e[this._urlDataSource.getQueryType()]}}),this._isVisible(e)},t.prototype._getPromptWaitTimeMilli=function(){return Date.now()-864e5},t.STORAGE_KEY="oneDriveSmartBannerVisible",t}(d.t),D=n(388).e({tagName:"ms-smart-bannerv2",template:'<div class="SmartBannerV2" data-bind="dismiss:onCloseClick">\x3c!--ko if:isCloseVisible--\x3e<button class="SmartBanner-close" data-bind="click:onCloseButtonClick"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e<div class="SmartBanner-content"><div class="SmartBanner-icon" data-bind="css:{\'SmartBanner-useSquareIcon\':useSquareIcon}"><span class="ms-Icon ms-Icon--OneDrive" role="img" data-bind="icon:true"></span></div><div class="SmartBanner-text" data-bind="css:{\'SmartBanner-noTagline\':hideTagline}"><div class="SmartBanner-lead" data-bind="text:leadText"></div><div class="SmartBanner-tagline" data-bind="text:taglineText,visible:!hideTagline"></div></div><div class="SmartBanner-button"><button class="od-Button od-Button--primary" data-bind="click:onContentClick"><span class="od-Button-label" data-bind="text:buttonText"></span></button></div><div class="ms-clearfix"></div></div></div>',viewModel:S});t.e=D},2768:function(e,t,n){"use strict";n.d(t,"e",function(){return he});var a=n(0),i=n(28),r=n(2313),o=n(2314),s=n(2315),c=n(2307),d=n(311),l=n(209),u=n(379),f=n(1112),p=n(2303),m=n(19),_=n(382),h=n(137),b=n(286),g=n(7),v=n(89),y=n(392),S=n(990),D=n(107),I=n(55),x=n(1103),C=n(2033),O=n(1743),w=n(576),E=n(346),A=n(1111),L=n(1109),k=n(1110),M=n(2097),P=n(1062),T=n(1007),U=n(1775),F=n(201),H=n(2257),R=n(440),N=n(595),B={ODC:"EnableRecommendationApi"};function j(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n(V(e))];case 1:return t.sent(),[2]}})})}}function V(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:for(t={items:{}},i=0,r=e;i<r.length;i++)o=r[i],t.items[o]={demands:(s={},s[m.e.id]=!0,s[g.u.id]=!0,s)};return[4,n(Object(P.e)(t))];case 1:return[2,a.sent()]}})})}}var z=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=p.e.deserialize(n),r=i.driveId,o=i.endpoint;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,s,c,d,l,u,f,P,V,z,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re;return Object(a.__generator)(this,function(oe){switch(oe.label){case 0:return[4,e(Object(T.e)(function(e){t=e.demandItemFacet(U.i,F.e,{suppressGetItems:!0}),i=e.demandItemFacet(N.t,F.e)}))];case 1:return oe.sent(),E.n.isFeatureEnabled(B)?(s=Object(S.e)({expand:"thumbnails"}),c={qosName:"recommendations",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/view.recommendedItems?").concat(s)},[4,e(Object(D.t)(c))]):[3,3];case 2:return d=oe.sent().value,l=new _.e,u=[],d&&(d.forEach(function(e){u.push(function(e,t,n,i){var r,o,s=e.name,c=e.id,d=e.recommendation,l=d.recommendationType,u=d.startDate,f=Object(O.e)(new Date(u)),p=(e.thumbnails||[])[0];if(p){var _=p.large||p.medium||p.small;_&&(o={url:_.url,width:_.width,height:_.height})}var S=h.e.serialize({photosRootKeyPart:{driveId:n,endpoint:i},groupBy:b.e.Date,filter:c,filterType:l}),D=x.e.serialize({driveId:n,endpoint:i,type:l,resourceId:"root"});return t.resolveItems({items:(r={},r[D]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},g.u.pack(s)),C.e.pack(l)),y.i.pack(f.toISOString())),v.h.pack(o)),g._.pack({})),m.t.pack({itemKey:S})),r)}),D}(e,l,r,o))}),l.resolveItems({items:(ae={},ae[n]=Object(a.__assign)({},m.e.pack({itemKeys:u})),ae)})),e(l.execute()),[3,6];case 3:return t||E.n.isFeatureEnabled(H.e)?(f=[],P=p.e.deserialize(n),(V=new Date).setHours(0,0,0,0),z={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:V.toISOString()},K=L.e.serialize(z),(W=new Date).setHours(0,0,0,0),W.setMonth(W.getMonth()-1),W.setDate(1),q={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:W.toISOString(),applyUtilityFiltering:!0},Q=k.e.serialize(q),(Y=new Date).setHours(0,0,0,0),J=Y.getDay(),(X=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate()-J+(0===J?-6:1))).setDate(X.getDate()-7),Z={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:X.toISOString(),applyUtilityFiltering:!0},$=A.e.serialize(Z),ee=M.e.serialize(P),[4,e(j([K,Q,$,ee]))]):[3,6];case 4:return oe.sent(),[4,e(Object(T.e)(function(e){var t=e.demandItemFacet(m.e,ee),n=t&&t.itemKeys||[];f.push(G(I.e.OnThisDay,r,o,K)),f.push(G(I.e.OnThisMonth,r,o,Q,q.date,q.applyUtilityFiltering)),f.push(G(I.e.LastWeekPreviousYears,r,o,$,Z.date,Z.applyUtilityFiltering)),n.forEach(function(e){var t=w.e.deserialize(e),n=t.countryOrRegion,a=t.city,i=t.state,s=t.locality;f.push(x.e.serialize({driveId:r,endpoint:o,type:I.e.PromotedPlaces,resourceId:"root",key:e,filter:[n,i,a||s].join(String.fromCharCode(9))}))})}))];case 5:oe.sent(),(te=new _.e).resolveItems({items:(ie={},ie[n]=Object(a.__assign)({},m.e.pack({itemKeys:f})),ie)}),i&&(ne=x.e.serialize(Object(a.__assign)(Object(a.__assign)({},P),{type:I.e.PhotoStoryStaticCard,resourceId:"root"})),te.resolveItems({items:(re={},re[ne]=Object(a.__assign)(Object(a.__assign)({},R.e.pack(I.e.PhotoStoryStaticCard)),g._.pack({})),re)})),e(te.execute()),oe.label=6;case 6:return[2]}})})}});function G(e,t,n,a,i,r){return x.e.serialize({driveId:t,endpoint:n,type:e,resourceId:"root",key:a,date:i,applyUtilityFiltering:r})}var K=n(654),W=n(394),q=n(1091),Q=Object(i.t)(function(){return function(e){e(f.e),e(Object(l.t)({keyFacet:p.e,facets:[m.e,g.u]})),e(Object(d.a)(p.e,u.e)(z)),e(Object(K.e)(x.e,W.e)(q.t))}}),Y=n(2505),J=n(2507),X=n(524),Z=n(2183),$=n(1810),ee=n(363),te=n(8),ne=n(2506),ae=n(61),ie=n(2504),re=n(2366),oe=n(95),se=n(2367),ce=n(1834),de=n(1833),le=n(336),ue=n(833),fe=n(338),pe=n(12),me=new te.t({name:"PrefetchCarouselAddon",factory:{dependencies:{identityDataSource:ae.D},create:function(e){var t=e.identityDataSource;return{instance:new ie.e(t)}}}}),_e=!pe.t.isActivated("C8D7C238-3F3E-4A7A-BF73-B6661092EC15","2022-05-24","show dynamic ps cards on photos carousel");function he(e,t,n,d,u){var f=this;return Object(i.t)(function(){return function(i){return Object(a.__awaiter)(f,void 0,void 0,function(){var f,p,m,h,b,g,v,y,S,D,I,x;return Object(a.__generator)(this,function(C){return i(r.e),i(o.e),i(s.e),i(c.e),i(Q),_e&&Object(fe.n)()&&d&&i(d.addon),u.expose(ae.Q,new(u.injected(re.e))),u.expose(oe.v,new(u.injected(se.e))),f=u.consume(me),(p=new _.e).resolveItems({items:(I={},I[de.e]=Object(a.__assign)({},ce.e.pack(f)),I)}),i(Object(l.e)({items:(x={},x[de.e]=Object(a.__assign)({},ce.e.pack(f)),x[F.e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},U.a.pack(f.isEnableLastWeekPreviousYearsExpOn())),U.n.pack(f.isEnableMonthRecapGroupHeaderExpOn())),U.i.pack(f.isEnableNewCarouselDesignExpOn())),ue.e.pack({accessMemoriescardStaticImage:window.require.toUrl("odsp-media/images/staticcards/accessmemoriescard.svg"),psIntroCardStaticImage:window.require.toUrl("odsp-media/images/staticcards/psintrocard.svg")})),N.t.pack(Object(fe.n)())),x)})),i(p.execute()),m=u.consume(le.e),h=new te.t({name:"PrefetchCarouselAddon",factory:{dependencies:{vroomDataRequestor:$.e,store:ee.e},create:function(a){var i=a.vroomDataRequestor,r=a.store,o=new J.e(i,e,t,n,m);return{instance:new Y.e(i,r,o)}}}}),b=u.consume(h),g=u.consume(X.t),v=pe.t.isActivated("882A3AE3-7D25-485F-B28D-658F339604DF")?"browser.pipe.aria.microsoft.com":"/Collector/3.0/",g&&g.rumone&&g.rumone.startAPIMeasurement&&g.rumone.startAPIMeasurement({ignore:function(e){return e.indexOf(v)>=0}}),S={addonSource:b,logRumOneData:function(e,t){g&&g.logRUMOneForItemsScopeListView(e,t,y)},logTTI:y=function(){i(Object(Z.a)())},pageSize:100,initialBurstSize:100,widthsPageSize:250},i(Object(U.c)(S)),D=u.consume(ne.e),i(D),[2]})})}})}},2777:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(0),r=n(56),o=n(1104),s=n(363),c=n(128),d=n(8),l=n(387),u=n(16),f=n(209),p=n(483),m=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=n.itemCacheStore.dispatch,o=n.itemCacheObservablesFactory.pureCompute(function(e){return!!e.demandItemFacet(p.e,u.a)});return a.isExpanded=a.observables.compute({read:function(){return o()},write:function(e){var t;r(Object(f.e)({items:(t={},t[u.a]=Object(i.__assign)({},p.e.pack(e)),t)})),r(Object(l.e)())},pure:!0}),a}return Object(i.__extends)(t,e),t}(r.n),_=(a=Object(c.o)("isReactLeftNavExpandedHelper",m,{itemCacheObservablesFactory:o.e,itemCacheStore:s.e}),new d.t({name:"isReactLeftNavExpanded.key",factory:{dependencies:{isReactLeftNavExpandedType:a},create:function(e){var t=new e.isReactLeftNavExpandedType({});return{instance:t.isExpanded,disposable:t}}}}))},2845:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.allPhotos=1]="allPhotos",e[e.albums=2]="albums",e[e.autoAlbums=3]="autoAlbums",e[e.tags=4]="tags",e[e.places=5]="places",e[e.singleAlbum=6]="singleAlbum",e[e.singleTag=7]="singleTag",e[e.singlePlace=8]="singlePlace",e[e.search=9]="search",e[e.onThisDay=10]="onThisDay",e[e.onThisMonth=11]="onThisMonth",e[e.lastWeekPreviousYears=12]="lastWeekPreviousYears"}(a||(a={}))},2897:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return R}),n(1113);var a=n(17);Object(a.n)([{rawString:"[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:48px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:48px}[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:54px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:54px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}.od-PhotosRootItemContent-tagsFeedback{padding-left:48px}.xlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list{padding-top:0}"}]),n(1582);var i=n(2074),r=n(2091);Object(a.n)([{rawString:".od-ScrollBarTooltip{height:40px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;padding:4px 10px;cursor:default;box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";box-sizing:border-box}.od-ScrollBarTooltip-displayText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:30px}.od-OverlayHost-overlay .od-ScrollBarTooltip{transition:opacity 267ms linear,visibility 0s linear 267ms;opacity:0;visibility:hidden}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ScrollBarTooltip{transition-delay:0s,0s;opacity:1;visibility:inherit}"}]);var o=n(0),s=n(22),c=n(183),d=n(2237),l=n(165),u=n(1738),f=n(340),p=n(1821),m=n(1271),_=function(e){function t(t){var n=e.call(this,t)||this;n._container=Object(u.t)(n.element);var a=n.valueAccessor();return n._position=s.observable(),n._isUpdatingScrollPosition=!1,n.events.on(n._container,"scroll",n._updateScrollPosition),n.events.on(window,"resize",n._updateScrollPosition),n._updateScrollPosition(),n._containerClientRect=s.observable(),n._containerClientRect.equalityComparer=m.e,new(n.managed(p.e))({element:n._container,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{size:n._containerClientRect,includePosition:!0}}}),a.position&&(n.createComputed(function(){return a.position(n._position())}),n.subscribe(a.position,n._position)),a.containerClientRect&&n.createComputed(function(){return a.containerClientRect(n._containerClientRect())}),a.container&&a.container(n._container),n.subscribe(n._position,n._onScrollPositionChanged),n}return Object(o.__extends)(t,e),t.prototype._updateScrollPosition=function(){var e=new f.e(this._container.scrollLeft/this._container.scrollWidth,this._container.scrollTop/this._container.scrollHeight);this._isUpdatingScrollPosition=!0;try{this._position(e)}finally{this._isUpdatingScrollPosition=!1}},t.prototype._onScrollPositionChanged=function(e){if(!this._isUpdatingScrollPosition){var t=this._container.scrollWidth,n=this._container.scrollHeight;this._container.scrollLeft=Math.max(0,Math.min(t,e.x*t)),this._container.scrollTop=Math.max(0,Math.min(n,e.y*n))}},t.supportsVirtualElements=!0,t}(l.t),h=n(1760),b=n(155),g=n(509),v=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor();return n._isDragging=a.isDragging,n._mousePoint=a.mousePoint,n._initEvents(),n}return Object(o.__extends)(t,e),t.prototype._onMouseDown=function(e){this._isDragging(!0)},t.prototype._onMouseUp=function(e){this._isDragging(!1),this._mousePoint(new f.e(e.clientX,e.clientY))},t.prototype._onMouseMove=function(e){this._isDragging.peek()&&this._mousePoint(new f.e(e.clientX,e.clientY))},t.prototype._onTouchStart=function(e){this._isDragging(!0)},t.prototype._onTouchEnd=function(e){this._isDragging(!1),this._mousePoint(new f.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY))},t.prototype._onTouchMove=function(e){this._isDragging.peek()&&(e.preventDefault(),this._mousePoint(new f.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY)))},t.prototype._initEvents=function(){var e=document.body,t=this.element;this.events.on(t,"touchstart",this._onTouchStart,!0),this.events.on(t,"touchend",this._onTouchEnd,!0),this.events.on(document,"touchmove",this._onTouchMove,!0),this.events.on(t,"mousedown",this._onMouseDown),this.events.on(t,"mouseup",this._onMouseUp),this.events.on(e,"dragend",this._onMouseUp),this.events.on(e,"mousemove",this._onMouseMove),this.events.on(document,"mouseup",this._onMouseUp)},t}(l.t),y=n(211),S=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({scrollBarPosition:_,visibility:d.e,drag:v}),n._platformDetection=n.resources.consume(y.e),n._scrollBarWidth=g.e.getScrollbarWidth(),n.overlayTagName=h.e.tagName,n.scrollContainerClientRect=s.observable(),n.scrollContainerClientRect.equalityComparer=m.e,n.scrollPosition=s.observable(),n.scrollPosition.equalityComparer=m.e,n.scrollContainer=s.observable();var a=t.label,i=void 0===a?s.observable(""):a,r=t.isDragging,o=void 0===r?s.observable(!1):r;return n._label=i,n.isDragging=o,n.mousePoint=s.observable(new f.e(0,0)),n.isIdle=s.observable(!0),n.left=n.createComputed(n._computeLeft),n.right=n.createComputed(n._computeRight),n.top=n.createComputed(n._computeTop),n.displayText=n.createComputed(n._computeDisplayText),n.isVisible=n.createPureComputed(n._computeIsVisible),n.createComputed(n._computeUpdateScrollPositionOnDrag),n.createComputed(n._computeSuspendIdleOnScrollPosition),n.createComputed(n._computeGoIdle).extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}}),n}return Object(o.__extends)(t,e),t.prototype._computeLeft=function(){return b.e.isRightToLeft?this._computeMarginOffset():null},t.prototype._computeRight=function(){return b.e.isRightToLeft?null:this._computeMarginOffset()},t.prototype._computeMarginOffset=function(){var e=0;return this._platformDetection.isMac&&(e=g.e.MAC_SCROLL_BAR_WIDTH),this._scrollBarWidth+4+e+"px"},t.prototype._computeDisplayText=function(){return this._label()||""},t.prototype._computeTop=function(){var e=this.scrollPosition(),t=this.scrollContainerClientRect();if(!e||!t)return"0";var n=t.height-40,a=e.y*n;return"".concat(a,"px")},t.prototype._computeUpdateScrollPositionOnDrag=function(){if(this.isDragging()){var e=this.mousePoint(),t=this.scrollContainerClientRect(),n=e.y-t.top,a=t.height-40,i=new f.e(0,Math.max(0,Math.min(1,n/a)));this.scrollPosition(i)}},t.prototype._computeIsVisible=function(){return!!this._label()&&(!this.isIdle()||this.isDragging())},t.prototype._computeSuspendIdleOnScrollPosition=function(){this.scrollPosition(),this.isIdle(!1)},t.prototype._computeGoIdle=function(){this.scrollPosition(),this.isIdle()||this.isDragging()||this.isIdle(!0)},t}(c.t),D=n(388).e({tagName:"od-scroll-bar-tooltip",template:'\x3c!--ko scrollBarPosition:{containerClientRect:scrollContainerClientRect,position:scrollPosition,container:scrollContainer}--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!scrollContainerClientRect()&&!!scrollContainer()&&isVisible()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:true,parentElement:scrollContainer(),animation:{afterAdd:1,beforeRemove:267}}}--\x3e<div class="od-ScrollBarTooltip" data-bind="style:{top:top,left:left,right:right},drag:{isDragging:isDragging,mousePoint:mousePoint}"><span class="od-ScrollBarTooltip-displayText ms-font-m" data-bind="text:displayText"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:S,synchronous:!0}),I=n(570),x=n(25),C=n(1744),O=n(95),w=n(166),E=n(2079),A=n(459),L=n(94),k=n(116),M=n(2078),P=n(2160),T=n(977),U=n(2432),F=n(1996),H=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.addBindingHandlers({control:w.n,react:I.t}),a.breadcrumbBarTagName=r.e.tagName,a.emptyFolderControl=Object(w.a)(i.e,{}),a.scrollBarTooltipTagName=D.tagName,a._itemSetMonitor=a.resources.consume(E.e),a.itemSet=a._itemSetMonitor.itemSet,a.itemSetSelectionModel=a.resources.consume(x.C),a.contentRange=a.resources.consume(C.t),a._photoProvider=a.resources.consume(O._),a.resources.expose(C.o.layoutType,a.createObservable(T.t)),a.layoutType=a.resources.consume(U.t),a._dataManagerMapper=a.resources.consume(x.i),a.listViewContextMenuHelper=a.resources.consume(C.s.optional),a.visibleItemRange=a.createObservable(),a.visibleItemRange.equalityComparer=m.e,a._crumbs=a.createPureComputed(a._computeCrumbs),a.title=a.createPureComputed(function(){return a._getTagFilterString(a._itemSetMonitor.itemSet(),a._itemSetMonitor.name())}),a.item=a._itemSetMonitor.item,a.showList=a.createPureComputed(function(){return!!a.layoutType()&&a._itemSetMonitor.hasItems()}),a.showEmpty=a._itemSetMonitor.isEmpty,a.showBreadcrumb=a.createPureComputed(a._computeShowBreadcrumb),a.showTitle=a.createPureComputed(a._computeShowTitle),a.hasGroupings=a.createPureComputed(a._computeHasGroupings),a.imageTagFeedbackControlParams={componentType:F.e,props:{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1}},a.createBackgroundComputed(a._computeSetDocumentTitle),a.scrollBarTooltipParams={listRange:a.contentRange,label:a.createPureComputed(a._computeScrollBarTooltipLabel)},a.layoutParams={itemSet:a.itemSet,selectionModel:a.itemSetSelectionModel,requiredRange:a.contentRange,visibleItemRange:a.visibleItemRange,enableMarqueeSelection:!0,contextMenuHelper:a.listViewContextMenuHelper,mode:0},a}return Object(o.__extends)(t,e),t.prototype.getCrumbs=function(e){function t(e,t){var n=new A.e(t);return n.id=e,n.isDropEnabled=!1,n.isPlaceholder=!0,n.properties={},n.type=L.e.Folder,n.tagInfo={tagType:M.e.allPlaces},n}var n=k.e(e.key);if(!n.locationFilter)return[];var a=n.locationFilter.split(P.e);delete n.locationFilter;for(var i=k.n(n),r=!1,o=[];a.length>0;){var s=r,c=!r,d=a.join(P.e),l=i+"&locationFilter="+a.join(P.t),u=a.pop();if(0!==u.length){var f=t(d,l);o.push({key:f.key,url:"#"+f.key,name:u,showNextChevron:r,isDroppingTarget:this.createObservable(!1),item:f,isOverflow:!1,isNavItem:s,isStaticItem:c}),r=!0}}return o},t.prototype._computeScrollBarTooltipLabel=function(){var e=this.visibleItemRange();if(e){var t=this._itemSetMonitor.itemSet(),n=Math.floor((e.end-e.start)/2)+e.start,a=this._dataManagerMapper().getOriginalItemIndexByMappedIndex(n),i=this._photoProvider.findMonthGroupingByIndex(t.key,a);return i&&i.name||""}return""},t.prototype._computeShowTitle=function(){var e=this._itemSetMonitor.item();return this._itemSetMonitor.hasName()&&!e.isRootFolder&&!this._crumbs().length},t.prototype._computeShowBreadcrumb=function(){return!!this._crumbs().length},t.prototype._computeCrumbs=function(){return this.getCrumbs(this._itemSetMonitor.item())},t.prototype._computeHasGroupings=function(){return!!(this._itemSetMonitor.itemSet().content().groupings||[]).length},t.prototype._getTagFilterString=function(e,t){var n=e.context;return n&&n.tagFilter?"#"+n.tagFilter:t},t.prototype._computeSetDocumentTitle=function(){var e=this._itemSetMonitor.itemSet(),t=k.e(e.item().key);if(t.locationFilter){var n=t.locationFilter.split(P.e).pop();n&&(document.title=n)}},t}(c.t),R=Object(w.t)({name:"PhotosRootItemContent",automationName:"od-photos-root-item-content",template:'<div class="od-PhotosRootItemContent od-ItemContent" data-bind="css:{\'od-PhotosRootItemContent--hasGroupings\':hasGroupings}">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-PhotosRootItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<div class="od-PhotosRootItemContent-title od-ItemContent-title" data-bind="text:title"></div>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-PhotosRootItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item,getCrumbs:$component.getCrumbs.bind($component)}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showTitle--\x3e<div class="od-PhotosRootItemContent-tagsFeedback od-ItemContent-tagsFeedback" data-bind="react:imageTagFeedbackControlParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-PhotosRootItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:layoutParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-PhotosRootItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e\x3c!--ko component:{name:scrollBarTooltipTagName,params:scrollBarTooltipParams}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:H})},3433:function(e,t,n){"use strict";n.r(t);var a=n(17);Object(a.n)([{rawString:".od-BasePage:not(.od-BasePage--hasSmartBanner) .od-photos-smartBanner{display:none}.od-photos-smartBanner .SmartBannerV2{position:absolute}.od-photos-promoted{position:relative}.md .od-photos-promoted,.sm .od-photos-promoted{margin-left:16px;margin-right:16px}.lg .od-photos-promoted,.xlg .od-photos-promoted,.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:32px;margin-right:32px}.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:48px;margin-right:48px}.od-photos-promoted .od-PromotedPhotos-title{margin-top:23px}.od-photos-promotedWrapper.od-photos-promotedWrapper--loaded{transition:height 467ms cubic-bezier(.1,.25,.75,.9);height:385px}.od-photos-promotedWrapper{overflow:hidden;height:0}"}]);var i=n(2250),r=(n(1582),n(1591),n(1583),n(1588),n(1596),n(0)),o=n(60),s=n(211),c=n(2303),d=n(22),l=n(430),u=n(292),f=n(35),p=n(42),m=n(2390),_=n(1105),h=n(1792),b=n(11),g=n(25),v=n(95),y=n(390),S=n(827),D=n(228),I=n(460),x=n(283),C=n(23),O=n(164),w=n(677),E=n(1131),A=n(3016),L=n(1151),k=n(1060),M=n(1810),P=n(2302),T=n(977),U=n(123),F=n(1744),H=n(2242),R=n(12),N=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources;return n._viewParams=a.consume(g.T),n._urlDataSource=a.consume(y.n),n._currentView=t.currentView,n._photoType=t.photoType,n._isOneUp=t.isOneUp,n._photoProvider=a.consume(v._),n._arePivotsHidden=n.createComputed(n._computeArePivotsHidden),n._hasSamsungSpecialFolder=n.observables.create(void 0),n.hideNewShareCommands=n.createPureComputed(n._computeHideNewShareCommands),n.hideOldShareCommand=n.createPureComputed(n._computeHideOldShareCommand),n._requestor=a.consume(M.e),n._isOneDriveXboxApp=Object(U.t)(),n._fluentVNextStylingEnabled=a.consume(D.e),n._isLeftNavUserExpanded=n.resources.consume(F.e.leftNav.isLeftNavUserExpanded.optional),n.filesCommandSetHelper=new(n.managed(P.e))({showLabels:n.responsiveUI.showLabels}),n._buildCommands(),Object(b.isFeatureEnabled)(b.SamsungGalleryFilter)&&n._checkSamsungFolderExists(),n}return Object(r.__extends)(t,e),t.prototype._checkSamsungFolderExists=function(){var e=this;this.observables.backgroundCompute(function(){var t=e._viewParams(),n=e._urlDataSource.getPhotoType(t),a=e._hasSamsungSpecialFolder.peek();n===u.e.AllMyPhotos&&void 0===a&&e._requestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){e._hasSamsungSpecialFolder(!0)}).catch(function(t){e._hasSamsungSpecialFolder(!1)})})},t.prototype._buildCommands=function(){var e=this,t=new(this.managed(this.actionMap.SaveAutoAlbumAction))({isHidden:!0}),n=[new(this.managed(l.e))({text:C.addToSharedList,renderLabel:2,icon:new x.e("Add"),action:new(this.managed(this.actionMap.AddToSharedListAction))})],a=[new(this.managed(L.e))({renderLabel:2,mode:k.e.share,itemsKey:S.n,text:C.Share,tooltip:C.ShareCommandTooltipV3,icon:new x.e("Share"),keys:["S"],engagementName:"newShareCommand",isHidden:this.hideNewShareCommands}).command,new(this.managed(l.e))({text:C.Share,isHidden:this.hideOldShareCommand,tooltip:C.ShareCommandTooltipV3,renderLabel:2,icon:new x.e("Share"),keys:["S"],action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.ShareByLinkAction)),saveAutoAlbumAction:t})})];n=n.concat(a);var i=R.e.isActivated("CC961357-6EBF-4906-9AA8-44C801F4CF86","10/21/2021","Edit Tags action consistency")?this.actionMap.ShowTagsEditorAction:this.actionMap.EditTagsAction,o=[new(this.managed(l.e))({text:C.selectItems,renderLabel:2,icon:new x.e("CheckboxComposite"),action:new(this.managed(this.actionMap.ToggleSelectionModeAction)),isHidden:this.createPureComputed(function(){if(!e._isOneDriveXboxApp)return!1;var t=e._viewParams();return Object(f._)(t)||Object(f.m)(t)})}),new(this.managed(l.e))({text:A.i,renderLabel:2,icon:new x.e("Add"),action:new(this.managed(this.actionMap.CreateAlbumAction)),isHidden:this.createObservable(Object(b.isFeatureEnabled)(b.EnableEvokeAlignments))}),new(this.managed(l.e))({text:C.AddToAlbum,renderLabel:2,icon:new x.e("Photo2Add"),action:new(this.managed(this.actionMap.AddToAlbumAction))}),new(this.managed(l.e))({text:C.addToBundle,icon:new x.e("Add"),renderLabel:2,action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.AddPhotosToAlbumAction)),saveAutoAlbumAction:t})}),new(this.managed(l.e))({text:C.editTags,renderLabel:2,icon:new x.e("Tag"),keys:["T"],action:new(this.managed(i))}),new(this.managed(l.e))({text:C.Download,renderLabel:2,icon:new x.e("Download"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.DownloadAction)),saveAutoAlbumAction:t})}),new(this.managed(l.e))({text:C.setCoverPhotoTitle,renderLabel:2,icon:new x.e("Picture"),action:new(this.managed(this.actionMap.SetAlbumCoverPhotoAction))}),new(this.managed(l.e))({text:C.rotate,renderLabel:2,icon:new x.e("rotate"),action:new(this.managed(this.actionMap.RotateAction))({})}),new(this.managed(l.e))({text:C.DeleteItem,renderLabel:2,icon:new x.e("Delete"),action:new(this.managed(this.actionMap.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(l.e))({text:C.Remove,renderLabel:2,icon:new x.e("Cancel"),action:new(this.managed(this.actionMap.RemoveFromAlbumAction))}),new(this.managed(l.e))({text:C.Remove,renderLabel:2,icon:new x.e("Cancel"),action:new(this.managed(this.actionMap.RemoveTagFromItemAction))}),new(this.managed(l.e))({text:C.OrderPrints,icon:new x.e("Print"),renderLabel:2,action:new(this.managed(this.actionMap.OrderPrintsAction))}),new(this.managed(l.e))({text:C.viewInFolder,icon:new x.e("Folder"),action:new(this.managed(this.actionMap.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),new(this.managed(l.e))({text:C.Rename,renderLabel:2,icon:new x.e("Edit"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.RenameAction)),saveAutoAlbumAction:t}),keys:["F2"],automationId:"rename"}),new(this.managed(l.e))({text:C.Embed,icon:new x.e("Embed"),renderLabel:2,hasLineBreakAfter:!0,automationId:"embed",action:new(this.managed(this.actionMap.EmbedAction))}),new(this.managed(l.e))({text:C.saveAutoAlbum,icon:new x.e("Add"),renderLabel:2,action:new(this.managed(this.actionMap.SaveAutoAlbumAction))}),new(this.managed(l.e))({text:C.discardAutoAlbum,icon:new x.e("Delete"),renderLabel:2,action:new(this.managed(this.actionMap.DiscardAutoAlbumAction))}),this.overflowHostCommand,new(this.managed(E.e))({renderLabel:2,suppressNotifications:this._isOneUp()}).command],s=this.createPureComputed(function(){var t=e.selection&&e.selection.selection().length||0;return e.responsiveUI.showLabels()?p.format(C.NumberSelected,t):t.toString()}),c=new(this.managed(l.e))({text:s,tooltip:C.showSelection,isHidden:this.selectionModeOff,icon:new x.e("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}),m=this.createPureComputed(function(){var t=e._photoType(),n=e.selectionModeOn();return t!==u.e.singleAlbum||n}),g=new(this.managed(l.e))({icon:new x.e("Cancel"),hasIconOnly:!0,isHidden:m,isDisabled:m,action:new(this.managed(this.actionMap.NavigationAction))({ignoreHistory:!1,url:this._urlDataSource.getAlbumsQueryUrl()}),keys:["AltUp"],location:4,text:C.Close,renderLabel:0}),v=new(this.managed(l.e))({text:C.setRootPhotosIdTitle,icon:new x.e("Settings"),renderLabel:2,requiredChildren:2,location:4,isHidden:this.createPureComputed(function(){var t=e.selectionModeOn();return Object(I.e)(e._urlDataSource.getQueryType(e._viewParams()))||t}),children:d.observableArray([new(this.managed(l.e))({text:C.setRootPhotosValueAll,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ROOT"}),isToggleable:!0}),new(this.managed(l.e))({text:C.setRootPhotosValuePhotos,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ALLPHOTOSFOLDER"}),isToggleable:!0}),new(this.managed(l.e))({text:C.setRootPhotosValueSamsungGallery,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"SAMSUNGFOLDER"}),isToggleable:!0,isHidden:this.observables.pureCompute(function(){return!e._hasSamsungSpecialFolder()})})])}),y=new(this.managed(l.e))({text:C.ViewGrid,tooltip:C.ViewGridCommandTooltip,icon:new x.e(P.e.gridIcon),isToggleable:!0,isHidden:this.createComputed(function(){return e.selectionModeOn()||!Object(b.isFeatureEnabled)(b.UseItemsScopeInAllPhotosEnableGrid)}),action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:T.s}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),D=new(this.managed(l.e))({text:C.ViewPhoto,tooltip:C.ViewPhotoCommandTooltip,icon:new x.e(P.e.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:T.t}),automationId:"switchLayout",location:4}),w=new(this.managed(l.e))({renderLabel:0,icon:this.createComputed(function(){return e.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:d.observableArray([y,D]),automationId:"switchLayoutSwitcher",text:C.Views,tooltip:C.ViewsCommandTooltip}),M=this.resources,U=M.consume(_.e),F=M.consume(h.resourceKey),N=[c,v,w,g,new(this.managed(l.e))({text:this._fluentVNextStylingEnabled?O.n:C.Details,tooltip:O.e,icon:new x.e(this._fluentVNextStylingEnabled?"OpenPane":"Info"),location:12,hasIconOnly:!this._fluentVNextStylingEnabled,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:U,ariaExpanded:F,renderLabel:this._fluentVNextStylingEnabled?1:0,keys:["I"],automationId:"showProperties"})];n=this._makePivots(1).concat(n);var B=[b.isODCLightspeedManifest?[new(this.managed(l.e))(Object(r.__assign)(Object(r.__assign)({},Object(H.e)(this._isLeftNavUserExpanded)),{action:new(this.managed(this.actionMap.ToggleIsLeftNavUserExpandedAction))({toggleReactLeftNav:!0})}))]:[],n,o,N].map(function(t){return e.createObservable(t)});this.commandSets(B)},t.prototype._computeArePivotsHidden=function(){var e=this._photoType(),t=this.selectionModeOn();return e===u.e.singleAlbum||t},t.prototype._makePivots=function(e){var t=this._photoProvider.getAllPhotosSettings()(),n=[];return n.push(new(this.managed(l.e))({text:w.t,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(u.e.AllMyPhotos),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAllMyPhotosQueryUrl(t.rootId)}),location:3})),n.push(new(this.managed(l.e))({text:w.e,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(u.e.Albums),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAlbumsQueryUrl()}),location:3})),Object(b.isFeatureEnabled)(b.EnableTagsInODC)&&n.push(new(this.managed(l.e))({text:w.f,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(u.e.allTags),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getTagsQueryUrl()}),automationId:"showTags",location:3})),n.push(new(this.managed(l.e))({text:w.d,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(u.e.allPlaces),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getPlacesQueryUrl()}),location:3})),n[n.length-1].isLastPivot=!0,n},t.prototype._createComputedIsCurrentViewAndNotSearch=function(e){var t=this;return this.createPureComputed(function(){return t._isCurrentViewAndNotSearch(e)})},t.prototype._isCurrentViewAndNotSearch=function(e){var t=Object(I.e)(this._urlDataSource.getQueryType(this._viewParams()));return this._currentView()===e&&!t},t.prototype._computeHideNewShareCommands=function(){return!Object(b.isFeatureEnabled)(b.UseNewShareDialog)||Object(U.e)()&&!Object(b.isFeatureEnabled)(b.UseNewShareDialogForWinApp)},t.prototype._computeHideOldShareCommand=function(){return Object(b.isFeatureEnabled)(b.UseNewShareDialog)&&(!Object(U.e)()||Object(b.isFeatureEnabled)(b.UseNewShareDialogForWinApp))},t}(m.e),B=n(2308),j=n(1821),V=n(166),z=n(1876),G=n(1070),K=n(1738),W=n(8),q=n(128),Q=new W.t({name:"AlbumItemContent.key",loader:new q.t(function(){return n.e(153).then(n.bind(null,4214)).then(function(e){return e.resourceKey.local})})}),Y=new W.t({name:"AlbumsContent.key",loader:new q.t(function(){return n.e(155).then(n.bind(null,4217)).then(function(e){return e.resourceKey.local})})}),J=new W.t({name:"AlbumsRootItemContent.key",loader:new q.t(function(){return n.e(154).then(n.bind(null,3457)).then(function(e){return e.resourceKey.local})})}),X=n(2470),Z=new W.t({name:"OnThisDayItemContent.key",loader:new q.t(function(){return n.e(158).then(n.bind(null,4227)).then(function(e){return e.resourceKey.local})})}),$=n(2897),ee=new W.t({name:"TagsRootItemContent.key",loader:new q.t(function(){return n.e(160).then(n.bind(null,4285)).then(function(e){return e.resourceKey.local})})}),te=n(1056),ne=new W.t({name:"ItemsScopePlaces.key",loader:new q.t(function(){return Object(te.t)({path:"./ItemsScopePlaces",getModule:function(){return o.n.resolve(n.e(191).then(n.bind(null,4104)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),ae=new W.t({name:"ItemsScopeAlbums.key",loader:new q.t(function(){return Object(te.t)({path:"./ItemsScopeAlbums",getModule:function(){return o.n.resolve(n.e(190).then(n.bind(null,4183)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),ie=n(2137),re=n(2716),oe=new W.t({name:"ItemsScopeTagsGallery.key",loader:new q.t(function(){return Object(te.t)({path:"./ItemsScopeTagsGallery",getModule:function(){return o.n.resolve(n.e(192).then(n.bind(null,4385)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),se=n(2546),ce=n(143),de=n(2757),le=n(1826),ue=n(1924),fe=n(336),pe=n(2110),me=n(2366),_e=n(29),he=n(36),be=n(1087),ge=n(2415),ve=n(56),ye=n(248),Se=n(1815),De=function(e){function t(t){var n=e.call(this,t)||this;return n.itemSet=t.itemSet,n._requiredRange=t.requiredRange,n.mappedRequiredRange=n.createObservable({start:0,end:0}),n.mappedItemSet=n.createPureComputed(n._computeMappedItemSet,{deferEvaluation:!0}),n.mappedItemSet.equalityComparer=ye.n,n.createBackgroundComputed(n._computeRequiredRange),n.createBackgroundComputed(n._computeMappedItemSetContent),n}return Object(r.__extends)(t,e),t.prototype.getOriginalItemIndexByMappedIndex=function(e){return this._indexMap?this._indexMap[e]:e},t.prototype.getNewMappedIndexByOldIndex=function(e){throw"Not implemented"},t.prototype._computeMappedItemSet=function(){var e=this.itemSet(),t=new Se.e(e.key,e.context);return t.item=e.item,t.content.peek().groupings=e.content.peek().groupings,t.schema=e.schema,t.isPlaceholder=e.isPlaceholder,t.content.peek().items=[],t},t.prototype._computeRequiredRange=function(){var e=this.mappedRequiredRange(),t=0,n=0;this._indexMap&&(t=this._indexMap[e.start],n=this._indexMap[e.end]);var a={start:t,end:n};this._requiredRange(a)},t.prototype._computeMappedItemSetContent=function(){for(var e=this.itemSet(),t=e.content(),n=[],a=[],i=0;i<t.items.length;i++)if(t.items[i]){var r=t.items[i],o=r.peek();be.r(o)||(n.push(r),a.push(i))}else n.push(void 0),a.push(i);this._indexMap=a,this.mappedItemSet.peek().isPlaceholder=e.isPlaceholder,this.mappedItemSet.peek().content({items:n,groupings:t.groupings})},t}(ve.n),Ie=n(2715),xe=function(e){function t(t){var n=e.call(this,t)||this;return n.lastItem=d.observable(null),n._itemKeyToHistoryItem={},n._currentItemSet=n.resources.consume(g.o),n.currentItem=n.createComputed(function(){var e=n._currentItemSet();return n.lastItem.peek()&&e.key===n.currentItem.peek().item.key?n.currentItem.peek():n._pushCurrentItemSet()},{deferEvaluation:!0}),n}return Object(r.__extends)(t,e),t.prototype.getHistoryItemByKey=function(e){return this._itemKeyToHistoryItem[e]},t.prototype._pushCurrentItemSet=function(){var e=this._currentItemSet.peek();if(e){var t=this._itemKeyToHistoryItem[e.key],n={item:e,anchorItem:t&&t.anchorItem||d.observable(null)};return this.lastItem(this.currentItem.peek()),this._itemKeyToHistoryItem[e.key]=n,this._itemKeyToHistoryItem[e.key]}},t}(ve.n),Ce=n(2367),Oe=n(61),we=n(1747),Ee=n(1956),Ae=new W.t({name:"ItemsScopePhotoPage.key",loader:new q.t(function(){return n.e(237).then(n.bind(null,4105)).then(function(e){return e.resourceKey})})}),Le=n(366),ke=n(2845),Me=n(69),Pe=n(2190),Te=n(137),Ue=n(363),Fe=n(2768),He=n(1229),Re=n(1062),Ne=n(7),Be=n(19);function je(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return(t={items:{}}).items[e]={demands:(a={},a[Be.e.id]=!0,a[Ne.u.id]=!0,a)},[4,n(Object(Re.e)(t))];case 1:return[2,i.sent()]}})})}}var Ve=n(1740),ze=n(2628),Ge=n(2285),Ke=n(20),We=n(1185),qe=!Ke.e.isActivated("1CD3875B-537E-4E98-BE77-30E191728F4A","01/19/2022","Assign value to ContextMenuHelper which will be used in KnockoutPhotoShim in Lightspeed"),Qe=function(e){function t(t){var a=e.call(this,t)||this;a._navigation=a.resources.consume(Me.e),a._urlDataSource=a.resources.consume(y.n),a._engagement=a.resources.consume(fe.e),a.photoType=a.createPureComputed(a._computePhotoType,{deferEvaluation:!0}),a._shouldRedirectForMoJ(),a.oneUpOverlayTagName=i.e.tagName,a.transclusionContentTagName=le.e.tagName,a.smartBannerTagName=de.e.tagName,a._isOneDriveWinApp=Object(U.e)(),a._commandSetForLightspeed=t.commandSet,a._contextMenuHelperForLightspeed=t.contextMenuHelper,a.addBindingHandlers({clientRect:j.e,element:G.e,scrollContainer:K.e,control:V.n}),a._canMarqueeSelect=a.resources.consume(g.a);var d=a.resources.consume(v.e);a.haveDeferredControlsLoaded=d.getBundleInfo(1).isLoaded,d.queueBundle(1,function(){return o.n.resolve(n.e(213).then(n.bind(null,3456)))}),a.resources.expose(Oe.Q,new(a.managed(me.e))),a.resources.expose(v.v,new(a.managed(Ce.e))),a.platform=a.resources.consume(s.e),a.resources.expose(v.l,new(a.managed(xe))),a.detailsPaneSpecification=Object(V.a)(ie.resourceKey,{}),a._activePivot=a.createPureComputed(a._computeActivePivot,{deferEvaluation:!0}),a._photoPage=a.observables.pureCompute(a._computePhotoPage);var l=a.resources;Object(r.__awaiter)(a,void 0,void 0,function(){var e,t,n,a,i,o,s,d,u,f;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,Promise.all([this.resources.consumeAsync(Ue.e.bypass),this.resources.consumeAsync(We.e.bypass)])];case 1:return e=p.sent(),t=e[0],n=e[1],a=l.consume(v._),i=l.consume(Ve.resourceKey),o=l.consume(Oe.Se),t.dispatch(Object(Fe.e)(a,i,o,n,l)),s=this.viewParams.peek(),d=t.dispatch(Object(ce.e)(function(e){return Object(He.e)(e,{viewParams:s})})),t.dispatch(Object(Ge.e)())&&Te.e.matches(d)&&(u=Te.e.deserialize(d).photosRootKeyPart,f=c.e.serialize(u),t.dispatch(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n(je(e))];case 1:return t.sent(),[2]}})})}}(f))),[2]}})}),a.createComputed(function(){var e=a.layoutType();a.isSuiteNavHamburgerVisible();var t=a.responsiveUI;a.isTopBarHamburgerVisible((!a._isOneDriveWinApp||Object(b.isWinAppVersionCompatible)())&&e!==T.l&&t.compareSize(t.formFactorSize(),"Large")>0)}),Object(b.isWinAppVersionCompatible)()||a.hideLeftNav(!0),a.createBackgroundComputed(a._computeUpdateCanMarqueeSelect).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),a.shouldShowPromotedPhotos=a.createPureComputed(a._computeShouldShowPromotedPhotos);var u=a._setupCommandSet();return a._commandSetForLightspeed&&a._commandSetForLightspeed(u),a.commandBarSpecification=a.createPureComputed(function(){return a._computeCommandBarSpecification(u)}),a.promotedPhotosParams={},a.createComputed(a._computeIsSuiteNavHidden),a.createComputed(a._computeIsSearchHidden),a._photosItemsScopeItemProps=a.createPureComputed(a._computePhotosItemsScopeProps),a._placesItemsScopeItemProps=a.createPureComputed(function(){return{props:{}}}),a._albumsItemsScopeItemProps=a.createPureComputed(function(){return{props:{child:function(e){return a.child(e)}}}}),a._isItemsScopeInAllPhotosEnabled=a.resources.consume(we.n),a._isItemsScopeInAllTagsEnabled=a.resources.consume(we.i),a._isItemsScopeInAllPlacesEnabled=a.resources.consume(we.a),a._isItemsScopeInAllAlbumsEnabled=a.resources.consume(we.e),a._isItemsScopeInSingleAlbumEnabled=a.resources.consume(we.c),a._isItemsScopeInSingleTagEnabled=a.resources.consume(we.l),a._isItemsScopeInSinglePlaceEnabled=a.resources.consume(we.d),a._isItemsScopeOnThisDayEnabled=a._isItemsScopeInAllPhotosEnabled&&Object(b.isFeatureEnabled)(b.UseItemsScopeInOnThisDay),a._isItemsScopeOnThisMonthEnabled=a._isItemsScopeInAllPhotosEnabled,a._isItemsScopeLastWeekPreviousYearsEnabled=a._isItemsScopeInAllPhotosEnabled,Object(b.isFeatureEnabled)(b.UseItemsScopeInAllPhotosEnableGrid)||a.observables.backgroundCompute(function(){a.layoutType()===T.s&&a.layoutType(T.t)}),a._itemsScopePhotoPageReady=a.createObservable(!1),a.createBackgroundComputed(function(){a.resources.consumeAsync(Ae.bypass).then(function(e){a._itemsScopePhotoPage=e.photoPage,a._itemsScopePhotoPageReady(!0)})}),a.isOneUpForPhotosOnly(!0),a}return Object(r.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.isTopBarHamburgerVisible(!1),this.hideLeftNav(!1),this.isSearchHidden(!1),this.isSuiteNavHidden(!1),this.isCommandBarDarkTheme(!1),this.isOneUpForPhotosOnly(!1)},t.prototype.computeCurrentPageName=function(){var e=this._photoPage&&this._photoPage(),t=ke.e[e||ke.e.none],n="".concat(t.substring(0,1).toUpperCase()).concat(t.substring(1));return"Photos-".concat(n)},t.prototype.computeContentControl=function(){var t=e.prototype.computeContentControl.call(this);if(t)return t;var n=this.getContentControlParams();switch(this._photoPage()){case ke.e.allPhotos:return this._isItemsScopeInAllPhotosEnabled?Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps()):Object(V.a)($.resourceKey.bypass,n);case ke.e.singleTag:return this._isItemsScopeInSingleTagEnabled?Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps()):Object(V.a)($.resourceKey.bypass,n);case ke.e.singlePlace:return this._isItemsScopeInSinglePlaceEnabled?Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps()):Object(V.a)($.resourceKey.bypass,n);case ke.e.search:return Object(V.a)(X.resourceKey.bypass,n);case ke.e.tags:return this._isItemsScopeInAllTagsEnabled?Object(V.a)(oe.bypass,{props:{}}):Object(V.a)(ee.bypass,n);case ke.e.places:return this._isItemsScopeInAllPlacesEnabled?Object(V.a)(ne.bypass,this._placesItemsScopeItemProps()):Object(V.a)(ee.bypass,n);case ke.e.albums:return this._isItemsScopeInAllAlbumsEnabled?Object(V.a)(ae.bypass,this._albumsItemsScopeItemProps()):Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)?Object(V.a)(Y.bypass,n):Object(V.a)(J.bypass,n);case ke.e.singleAlbum:return this._isItemsScopeInSingleAlbumEnabled?Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps()):Object(V.a)(Q.bypass,n);case ke.e.onThisDay:return this._isItemsScopeOnThisDayEnabled?Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps()):Object(V.a)(Z.bypass,n);case ke.e.onThisMonth:if(this._isItemsScopeOnThisMonthEnabled)return Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps());break;case ke.e.lastWeekPreviousYears:if(this._isItemsScopeLastWeekPreviousYearsEnabled)return Object(V.a)(re.e.bypass,this._photosItemsScopeItemProps())}},t.prototype.computeCreateDataManager=function(){var e=this.viewParams(),t=this.urlDataSource.getQueryType(e);return"photos"!==e.v?null:t===he.e.Search?this._createFilesDataManager:this._createPhotosDataManager},t.prototype.computeDataManagerMapper=function(){var t=this._photoPage(),n=this.viewParams(),a=this.dataManager();return Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&t===ke.e.albums&&n.tagFilter!==pe.n?new(this.managed(De))({itemSet:this.unmappedItemSet,requiredRange:a.requiredRange}):e.prototype.computeDataManagerMapper.call(this)},t.prototype._shouldRedirectForMoJ=function(){var e=this.identityDataSource.getIdentity().type,t=this.viewParams.peek(),n=Object(f.S)(t)||Object(f.D)(t)||Object(f.y)(t)||Object(f.C)(t);if(e===Le.e.anonymous&&(Object(f.g)(t)||Object(f.h)(t))&&n){this._logTelemetry("AllPhotos.MoJRedirect",{entryPoint:Object(ze.e)(t.sc)});var a=void 0;Object(f.S)(t)?(a=this._urlDataSource.getOnThisDayQueryUrl(t),this._navigation.navigateTo(a)):Object(f.D)(t)?(a=this._urlDataSource.getOnThisMonthQueryUrl(t),this._navigation.navigateTo(a)):Object(f.y)(t)?(a=this._urlDataSource.getLastWeekPreviousYearsQueryUrl(t),this._navigation.navigateTo(a)):Object(f.C)(t)&&(a=this._urlDataSource.getRecentPhotoUrl(t),this._navigation.navigateTo(a))}},t.prototype._computeIsSuiteNavHidden=function(){var e=this._photoPage();this.isSuiteNavHidden(e===ke.e.singleAlbum&&!Object(b.isFeatureEnabled)(b.UseItemsScopeInSingleAlbum)||this._isOneDriveWinApp)},t.prototype._computeIsSearchHidden=function(){var e=this._photoPage();this.isSearchHidden(e===ke.e.singleAlbum||this._isOneDriveWinApp)},t.prototype._createPhotosDataManager=function(){return new(this.managed(Ie.e))({requiredPageType:_e.e.Photos})},t.prototype._createFilesDataManager=function(){return new(this.managed(ge.e))({requiredPageType:_e.e.Photos})},t.prototype._computePhotoType=function(){var e=this.viewParams();return this.urlDataSource.getPhotoType(e)},t.prototype._computeUpdateCanMarqueeSelect=function(){var e;switch(this.photoType()){case u.e.allTags:case u.e.allPlaces:e=!1;break;default:e=!0}this._canMarqueeSelect(e)},t.prototype._computeActivePivot=function(){var e=this.photoType();return e===u.e.Albums||e===u.e.singleAlbum?u.e.Albums:e===u.e.allTags||e===u.e.singleTag?u.e.allTags:e===u.e.allPlaces||e===u.e.singlePlace?u.e.allPlaces:e===u.e.AllMyPhotos?u.e.AllMyPhotos:null},t.prototype._computeShouldShowPromotedPhotos=function(){return!this._isItemsScopeInAllPhotosEnabled&&Object(b.isFeatureEnabled)(b.PromotedPhotosContentEnabled)&&this._photoPage()===ke.e.allPhotos},t.prototype._computePhotoPage=function(){var e=this.item(),t=this.viewParams(),n=this._itemsScopePhotoPageReady&&this._itemsScopePhotoPageReady()?this._itemsScopePhotoPage():ke.e.none,a=this.urlDataSource.getKeyParams(e.key);return"search"===a.qt?ke.e.search:"allmyphotos"===a.qt?a.tagFilter?this._isItemsScopeInSingleTagEnabled?n:ke.e.singleTag:a.locationFilter?this._isItemsScopeInSinglePlaceEnabled?n:ke.e.singlePlace:a.onThisDay?Object(b.isFeatureEnabled)(b.UseItemsScopeInOnThisDay)?n:ke.e.onThisDay:a.onThisMonth||a.lastWeekPreviousYears||this._isItemsScopeInAllPhotosEnabled?n:ke.e.allPhotos:"tags"===a.id?this._isItemsScopeInAllTagsEnabled?n:ke.e.tags:"places"===a.id?this._isItemsScopeInAllPlacesEnabled?n:ke.e.places:Object(f.f)(t)?this._isItemsScopeInAllAlbumsEnabled?n:ke.e.albums:Object(f.w)(t)?this._isItemsScopeInSingleAlbumEnabled?n:ke.e.singleAlbum:ke.e.none},t.prototype._computePhotosItemsScopeProps=function(){var e=this;this.layoutType();var t=this.viewParams(),n=this.urlDataSource.getLayoutContentType(t),a=this.dataManager.peek().getContextualQueryType(he.e.AllMyPhotos),i=(n||a)===Ee.n?T.s:T.t,r=this.urlDataSource.getPhotoType(t);Object(f.p)(t)||i!==T.s||(i=T.t);var o,s={layoutType:i,isMobile:this.platform.isMobile,child:function(t){return e.child(t)},photoType:r,isInFilePicker:!1};be.r(this.item())&&(o={saveAutoAlbumAction:new(this.managed(this.actionMap.SaveAutoAlbumAction))({item:this.item}),discardAutoAlbumAction:new(this.managed(this.actionMap.DiscardAutoAlbumAction))({item:this.item})},s.footerProps=o);var c=this._photosItemsScopeItemProps.peek();return c&&c.props.layoutType===s.layoutType&&c.props.isMobile===s.isMobile&&c.props.photoType===s.photoType&&c.props.footerProps===o?c:{props:s}},t.prototype._setupCommandSet=function(){var e={currentView:this._activePivot,photoType:this.photoType,isOneUp:this.isOneUp},t=new(this.managed(N))(e);return qe&&b.isODCLightspeedManifest?(this.resources.expose(F.s,new(this.managed(z.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-Content",shouldHideIcons:!0})),this._contextMenuHelperForLightspeed&&this._contextMenuHelperForLightspeed(new(this.managed(z.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"od-Photos",boundingElementClass:"od-Content",shouldHideIcons:!0}))):(this.resources.expose(F.s,new(this.managed(z.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0})),this.contextMenuHelper(new(this.managed(z.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"od-Photos",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}))),t},t.prototype._computeCommandBarSpecification=function(e){return this._isItemsScopeInAllAlbumsEnabled&&this._photoPage()===ke.e.albums?(this.contextMenuHelper(null),Object(V.a)(se.e,{props:{handleRenderComplete:function(e,t){t.unblockItemPageRender()}}})):Object(V.a)(ue.e,{commandSet:e})},t.prototype._logTelemetry=function(e,t){if(this._engagement){var n={name:Pe.e[this.photoType()]+"."+e,extraData:t};this._engagement.logData(n)}},t}(B.e),Ye=n(388).e({tagName:"od-photos",template:'\x3c!--ko if:shouldShowPromotedPhotos--\x3e<div class="od-photos-promotedWrapper" data-bind="css:{\'od-photos-promotedWrapper--loaded\':haveDeferredControlsLoaded}">\x3c!--ko if:haveDeferredControlsLoaded--\x3e<div class="od-photos-promoted" data-bind="component:{name:\'od-promoted-photos\',params:promotedPhotosParams}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isBannerApplicable--\x3e<div class="od-photos-smartBanner" data-bind="component:{name:smartBannerTagName,params:{isVisible:isSmartBannerVisible}}"></div>\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:commandBarTransclusionContentParams}--\x3e<div data-bind="control:commandBarSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isOneUp--\x3e\x3c!--ko component:{name:oneUpOverlayTagName,params:{}}--\x3e\x3c!--ko control:oneUpSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:Qe,synchronous:!0});t.default=Ye},4303:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return S});var a=n(0),i=n(128),r=n(183),o=n(3433),s=n(2535),c=n(1876),d=n(570),l=n(166),u=n(792),f=n(1772),p=n(1738),m=n(2777),_=n(1744),h=n(25),b=n(20),g=!b.e.isActivated("1CD3875B-537E-4E98-BE77-30E191728F4A","01/19/2022","Assign value to ContextMenuHelper which will be used in KnockoutPhotoShim in Lightspeed"),v=!b.e.isActivated("8C43511E-8E69-4231-991E-6D42DDCAE763","04/05/2022","Do not add scroll attribute to the root the KO photo shim component"),y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addBindingHandlers({react:d.t,control:l.n,interactionScope:u.t,contextMenu:f.e,scrollContainer:p.e}),r.resources.exposeFactory(_.e.leftNav.isLeftNavUserExpanded,new i.e(m.e)),r._commandSet=r.resources.consume(s.e),r.contextMenuHelper=g?r.observables.create():r.createPureComputed(r._computeContextMenu),r.contentTagName=o.default.tagName,r.contentParams=Object(a.__assign)({commandSet:r._commandSet},g?{contextMenuHelper:r.contextMenuHelper}:{}),r.isScrollable=!v,r}return Object(a.__extends)(t,e),t.prototype._computeContextMenu=function(){return new(this.managed(c.e))({items:this._commandSet().commands.peek(),rootElementClass:"od-Content",boundingElementClass:"od-Content",shouldHideIcons:!0})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.t.dependencies),{viewParams:h.T}),t}(r.t),S=Object(l.t)({automationName:"od-knockout-photo-shim",name:"KnockoutPhotoShim",template:'<div class="od-Content" data-bind="scrollContainer:isScrollable,contextMenu:contextMenuHelper,automation:\'content\'" role="presentation">\x3c!--ko component:{name:contentTagName,params:contentParams}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:y})}}]);