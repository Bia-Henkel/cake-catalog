(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[189],{1488:function(e,t,n){"use strict";n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return i.e});var a=n(1289),i=n(1232)},1558:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(1776),r=n(8),o=function(){function e(e,t){this._componentType=e,this.dependencies=Object(a.__assign)(Object(a.__assign)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}},e}();function s(e,t,n){return new r.t({name:e,factory:new o(t,n)})}},1563:function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(1483),i=n(424),r=n(12);function o(e){return decodeURI(e)}function s(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=Object(a.e)(e,!0):(e=e.replace("#","%23"),r.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(a.e)(e,!0))),e}function c(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}},1751:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(1076),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.t):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p){void 0===i&&(i="POST");var m=e(),_=a&&a(),h=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:_,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:h,authToken:f,webAbsoluteUrl:p})},e}();t.t=r},1756:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(0),i=n(284),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},1773:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(398),r=n(1756),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.a.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.__extends)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},1775:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"o",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"s",function(){return y}),n.d(t,"c",function(){return S});var a=n(0),i=n(2),r=n(30),o=n(209),s=n(566),c=n(201),d=n(72),l=new r.e("photosConfigurationKeyFacet",{}),u=l.serialize({}),f=new i.e("PhotosAddonSource"),p=new i.e("photosEnableLastWeekPreviousYearsFacet"),m=new i.e("photosEnableNewDesignCarouselExpFacet"),_=new i.e("photosEnableGroupHeaderFacet"),h=new i.e("PhotosMaxPageSize"),b=new i.e("PhotosWidthsMaxPageSize"),g=new i.e("PhotosInitialBurstSize"),v=new i.e("usePhotoPaging"),y=new i.e("PhotosTargetHeight");function S(e){return function(t){var n,i,r;t(Object(o.t)({keyFacet:l,facets:[]}));var p=e.initialBurstSize||0,m=e.widthsPageSize||1e3,_=e.targetHeight||1e3;t(Object(o.e)({items:(n={},n[u]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f.pack(e.addonSource)),h.pack(e.pageSize)),g.pack(p)),b.pack(m)),y.pack(_)),n)})),t(Object(o.e)({items:(i={},i[c.e]=Object(a.__assign)({},d.r.pack({reportRUMOnePerfData:!1,logRenderEndTime:e.logRumOneData,scenarioId:"ODC.AllPhotos-Photos"})),i)})),t(Object(s.t)({items:(r={},r[u]={},r)}))}}},1776:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a=n(0),i=n(1),r={dependencies:n(1735).object.isRequired};function o(e,t){var n=e,o={dependencies:Object(a.__assign)({},t||{})},s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getChildContext=function(){return o},t.prototype.render=function(){return i.createElement(n,Object(a.__assign)({},this.props))},t.childContextTypes=Object(a.__assign)({},r),t}(i.Component);return s}function s(e,t){var n=e.contextTypes,i=void 0===n?{}:n,r=(i.dependencies,Object(a.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(a.__assign)(Object(a.__assign)({},i),{dependencies:t}))};return o.contextTypes=r,o}},1782:function(e,t,n){"use strict";n.r(t),n.d(t,"UserPhotoSize",function(){return o}),n.d(t,"tryGetAlternativeUrl",function(){return f}),n.d(t,"isAlterantiveUrlFresh",function(){return p}),n.d(t,"updateMap",function(){return m}),n.d(t,"getUrlTable",function(){return _}),n.d(t,"getUserPhotoUrl",function(){return h}),n.d(t,"_testGetCDNUrlExpiryFromCache",function(){return b});var a=n(76),i=n(131),r=n(52),o={Small:1,Medium:2,Large:3},s="_oat_",c="UserPhotoAspx",d={},l={},u="TryGetAlternativeUrlFailure";function f(e){var t,n;function a(e){return p(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var o=d&&d[e];if(o||c!==e||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?o=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(o=a("_spHomePageContext"))),!o)return;return p(o)?o:void delete d[e]}catch(e){new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"Unexpected",extraData:{error:e}})}}function p(e){if(-1===e.indexOf(s))return!0;var t=l[e];if(t)return Date.now()/1e3<t;var n=new a.t(e),o=n.getQueryParameter(s);if(o){var c=o.split("_");if(2===c.length&&(t=Number(c[0])),!t)return new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:o}}),l[e]=Date.now()/1e3+86400,!0;if(t-=30,l[e]=t,Date.now()/1e3>t)return!1}var d=n.getQueryParameter("P1");if(!d)return!0;var f=Number(d);return f-=30,l[e]=Math.min(f,l[e]),!(Date.now()/1e3>f)}function m(e){if(e)for(var t in e)d[t]=e[t]}function _(){return d}function h(e,t,n){var i;switch(n=n||f(c)||"/_layouts/15/userphoto.aspx",t){case o.Medium:i="M";break;case o.Large:i="L";break;default:i="S"}var r=new a.t(n);return r.setQueryParameter("size",i),r.setQueryParameter("accountname",e||""),r.toString()}function b(e){return l[e]}},1816:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s});var a=n(2),i=new a.e("allGroupToCountsFacet"),r=new a.e("allGroupToCountsPointerFacet"),o=new a.e("AllPhotosTotalCount"),s=new a.e("allGroupToStartFacet")},1864:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(137),r=new a.e("allGroupToCountsItemKeyFacet",{photosRootItemSetKeyPart:i.e.subKeyPart})},1884:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isNewAlbum")},1885:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("dateRange")},1890:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(14),r=n(137),o=new a.e("allPhotosGroup",{photosRootItemSetKeyPart:r.e.subKeyPart,id:i.e})},1921:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a,i=n(372),r=n(1782);function o(e,t){var n;switch(e.size){case a.Large:n=r.UserPhotoSize.Large;break;case a.Medium:n=r.UserPhotoSize.Medium;break;default:n=r.UserPhotoSize.Small}return Object(r.getUserPhotoUrl)(e.userLoginName,n,t)}function s(e,t,n){var a=Object(r.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},1934:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={unsupportedCommand:"unsupportedCommand",handlerError:"handlerError",handlerRejection:"handlerRejection",acknowledgeTimeout:"acknowledgeTimeout",resultTimeout:"resultTimeout",setupTimeout:"setupTimeout",canceled:"canceled",disposed:"disposed"}},1940:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(1890),o=new a.e("allPhotoGroupPage",{groupKeyPart:r.e.subKeyPart,offset:i.e,count:i.e})},1941:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(137),o=new a.e("photoPageKey",{photosRootItemSetKeyPart:r.e.subKeyPart,offset:i.e,count:i.e})},1942:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(91),i=n(591);function r(e){return function(t){var n=t(i.e);a.e.withManager(n).logData(e)}}},1947:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(236),i=n(93),r=n(288),o=n(1934),s=0,c=function(){function e(e,t){void 0===t&&(t={});var n=this,s=new Map,c={onCommand:e.onCommand,onNotification:e.onNotification},d=e.initResources,l=e.initTimeoutMs,u=void 0===l?1e4:l,f=e.ackTimeoutMs,p=void 0===f?1e3:f,m=e.resultTimeoutMs,_=void 0===m?1e4:m,h=t.asyncType,b=void 0===h?a.e:h,g=t.eventGroupType,v=void 0===g?i.e:g,y=this._scope=new r.e;y.attach(d);var S,D=this._async=y.attach(new b(this)),I=y.attach(new v(this));this._ackTimeoutMs=p,this._resultTimeoutMs=_,this._invokeCommandHandler=function(e){try{var t=c.onCommand&&c.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:o.e.handlerRejection,isExpected:!1,message:"Unknown error"}).code||e.name||o.e.handlerRejection,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:o.e.unsupportedCommand,message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.handlerError,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{c.onNotification&&c.onNotification(e)}catch(e){}};var x=this._port=new Promise(function(t,a){y.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=o.e.canceled,a(e)}}),S=D.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(u,"ms"));e.code=o.e.setupTimeout,a(e)},u),e.init(function(e){D.clearTimeout(S),y.attach({dispose:function(){e.close()}}),I.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=x.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=s}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:o.e.canceled,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.disposed,message:"disposed"}});var a=++s,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,c=t.acknowledgeTimeoutMs,l=void 0===c?this._ackTimeoutMs:c;return this._port.then(function(t){var i=n._async,s=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.acknowledgeTimeout))},l),resultTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.resultTimeout))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e}),s})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function d(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}},1957:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=new a.e("widthsFacet"),r=new a.e("widthsPointerFacet"),o=new a.e("targetHeightFacet")},1962:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},1984:function(e,t,n){"use strict";n.d(t,"e",function(){return O});var a=n(0),i=n(1),r=n(1735),o=n(1776),s=n(1558),c=n(8),d=n(808),l=n(58),u=n(514),f=n(40),p=n(363),m=n(1116),_=n(66),h=n(32),b=n(20),g=n(541),v=n(400),y=n(51),S=b.e.isActivated("53A1449A-9FDC-48A1-81C0-ADE2DFCBF340","2/4/2021","Freeze store when KO pivots are active"),D=Object(g.n)({itemsScope:v.e});function I(e){var t=e.isKnockoutShimPivot,n=e.freezeForKnockoutShimContent,a=i.useRef();t||(a.current=e.currentItemKey);var r=a.current,o=i.useCallback(function(e,a){return t&&n?{currentItemKey:r}:{}},[t,r,n]),s=i.useMemo(function(){return{itemsScope:o}},[o]);return!r&&n?null:i.createElement(D,{value:s},e.children)}var x=Object(l.t)(function(e,t){var n,a=t.freezeForKnockoutShimContent,r=void 0!==a&&a,o=Object(h.e)(e).itemsScopeItemKey,s=null===(n=e.demandItemFacet(y.n,o))||void 0===n?void 0:n.itemKey,c=e.demandItemFacet(_.t,o);return b.e.isActivated("019FFBDD-E9BB-40DB-B2DE-F519C242B84F","12/9/2021","Freeze current item key when transitioning away from ItemsScope pivots")?i.createElement(m.e,{mode:c&&r?"freeze":"none",fallback:null},t.children):i.createElement(I,{currentItemKey:s,isKnockoutShimPivot:c,freezeForKnockoutShimContent:r},t.children)}),C=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t.prototype.getChildContext=function(){return{currentItemsScope:this.context.dependencies.itemsScopeItemKey}},t.prototype.render=function(){var e=i.createElement(f.e,{resources:this.context.dependencies.resources},this.props.children),t=S?e:i.createElement(x,{freezeForKnockoutShimContent:this.props.freezeForKnockoutShimContent},e);return this.context.currentItemsScope?t:i.createElement(d.e,{store:this.context.dependencies.itemCacheStore,itemsScopeItemKey:this.context.dependencies.itemsScopeItemKey},t)},t.contextTypes=Object(a.__assign)(Object(a.__assign)({},o.e),{currentItemsScope:r.string}),t.childContextTypes={currentItemsScope:r.string},t}(i.PureComponent),O=Object(s.e)("CurrentItemsScope",C,{itemsScopeItemKey:u.e,itemCacheStore:p.e,resources:c.r})},1986:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1);function i(e,t){var n=void 0===t?{}:t,i=n.threshold,r=void 0===i?0:i,o=n.root,s=void 0===o?null:o,c=n.rootMargin,d=void 0===c?"0%":c,l=Object(a.useRef)(!1),u=Object(a.useState)(!1),f=u[0],p=u[1];function m(e){var t=e[0];l.current=t.isIntersecting,p(t.isIntersecting)}return Object(a.useEffect)(function(){var t,n=null!=(t=e)&&"object"==typeof t&&t.hasOwnProperty("current")?e.current:e,a=!!window.IntersectionObserver;if(n&&a){var i=new IntersectionObserver(m,{threshold:r,root:s,rootMargin:d});return i.observe(n),function(){return i.disconnect()}}},[e,r,s,d]),[f,l]}},2002:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(93),i=n(1947),r=n(288);function o(e,t){void 0===t&&(t={});var n=e.channelId,o=e.onReinitialize,s=e.origin,c=e.receiver,d=void 0===c?window:c,l=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?a.e:f,m=t.messengerType,_=void 0===m?i.e:m,h=new r.e,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&l){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};l.postMessage(e,s)},100);a=h.attach({dispose:function(){clearInterval(i)}})}var r=!1;b.on(d,"message",function(t){var i=t.data;if(t.origin===s&&(!l||t.source===l)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),o){if(r)return o(),void b.dispose();r=!0}else b.dispose();var c=i.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},2029:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(166),r=n(183),o=n(570),s=n(1748);function c(e,t){var n=function(t){function n(e,n){var a=t.call(this,e,n)||this;a.addBindingHandlers({react:o.t,host:s.e});var i=a.observables;return a.reactParams={componentType:n.componentType,error:e.error,rootProps:e.rootProps,props:i.wrap(e.props),useDOMContext:e.useDOMContext},a}return Object(a.__extends)(n,t),n.dependencies=Object(a.__assign)(Object(a.__assign)({},r.t.dependencies),{componentType:e.local}),n}(r.t);return Object(i.t)({automationName:t.automationName,name:t.name,template:'<div role="presentation" data-bind="react:reactParams">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:n})}},2033:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("requestResponseBatchType")},2043:function(e,t,n){"use strict";function a(e,t){return{id:e.id||e.labels.join(",")+t.toString(),labels:e.labels,count:e.count,headers:r(e)}}function i(e){return e.labels}function r(e){if(e.headers)return e.headers;var t=i(e);return e.header?[e.header,t[1],t[2]]:t}n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r})},2052:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"n",function(){return f});var a=n(2043),i=n(2365),r=n(2587),o=n(346),s=n(2257);function c(e,t,n,a,c){var d,l=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),u=!1;if("onthismonth"===n&&a){var f=JSON.parse(a).applyUtilityFiltering;u=!f||f&&!0===c}return d="lastweekpreviousyears"===n||"onthisday"===n&&(s.t||o.n.isFeatureEnabled(s.e))?function(e,t){var n=(new Date).getFullYear(),a=t.getFullYear(),i=n-a,o=a.toString(),s=a.toString();switch(i){case 1:s=o=r.n;break;case 2:s=o=r.a;break;case 3:s=o=r.i;break;case 4:s=o=r.r;break;case 5:s=o=r.o}return{labels:[s,s,s],count:e,headers:[o,o,o]}}(t,l):"onthismonth"===n&&u?function(e,t){var n=t.toLocaleDateString("default",{month:"short",day:"numeric"});return{labels:[n,n,n],count:e,headers:[n,n,n]}}(t,l):{labels:[Object(i.n)(l),Object(i.a)(l),e.getUTCFullYear().toString()],count:t,headers:[Object(i.i)(l),Object(i.t)(l),e.getUTCFullYear().toString()]},d}function d(e,t,n,i,r){var o=c(e,t,i,r);return Object(a.e)(o,n)}function l(e,t,n,a){for(var i=[],r=void 0,o=void 0,s=0,c=0;c<e.length;c++){var l=void 0;l=e[c].dateTakenTime?e[c].dateTakenTime:0===c?new Date:e[c-1].dateTakenTime,r=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())),void 0===o&&(o=r),r.getUTCFullYear()===o.getUTCFullYear()&&r.getUTCMonth()===o.getUTCMonth()&&r.getUTCDate()===o.getUTCDate()||(i.push(d(o,s,i.length,t,n)),s=0,o=r),s++}return s>0&&r&&i.push(d(r,s,i.length,t,n)),"lastweekpreviousyears"===t&&f(i),"onthismonth"===t&&n&&JSON.parse(n).applyUtilityFiltering&&!a&&u(i,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),i}function u(e,t,n,a){for(var i=0,r=0;r<e.length;r++)i+=e[r].count;e[0]={header:t,headers:n,labels:a,count:i},e.splice(1,e.length-1)}function f(e){for(var t,n,a=0;a<e.length-1;a++)(null===(t=e[a].headers)||void 0===t?void 0:t[0])===(null===(n=e[a+1].headers)||void 0===n?void 0:n[0])&&(e[a].count+=e[a+1].count,e.splice(a+1,1),a--)}},2053:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("nextItem")},2097:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(14),r=new a.e("recentPlacesKey",{driveId:i.e,endpoint:i.e})},2111:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(2002),r=n(52),o=function(e){function t(t){var n=this,r=t.initTimeoutMs,o=void 0===r?4e4:r,s=Object(a.__rest)(t,["initTimeoutMs"]);return(n=e.call(this)||this)._customerPromiseLogger=s.customerPromiseLogger,n._messenger=Object(i.e)(Object(a.__assign)(Object(a.__assign)({},s),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return Object(a.__extends)(t,e),t.prototype.sendShareDestruct=function(){return this._send({command:"shareCommand",name:"share_destruct"})},t.prototype.sendShareRevisible=function(e){return e.command="shareCommand",this._send(e)},t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)},t.prototype.sendNewToken=function(e,t,n){var a={command:"shareCommand",name:"share_newToken"};return e?a.token=e:t&&(a.error=t,a.errorDetails=n),this._send(a)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:r.e.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}())},2118:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("PhotoLocation")},2119:function(e,t,n){"use strict";function a(e){return e.length>0?function(e){return e.large||e.medium||e.small||void 0}(e[0]):void 0}n.d(t,"e",function(){return a})},2120:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={sharepoint:0,microservice:1}},2142:function(e,t,n){"use strict";function a(e){var t=new ArrayBuffer(2*e);return new Uint16Array(t)}function i(e,t){for(var n=a(t),i=Math.min(e.length,t),r=0;r<i;r++)n[r]=e[r];return n}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},2143:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(9),r=n(137),o=new a.e("photoToGroupKey",{driveItemKeyPart:i.e.subKeyPart,photosRootItemSetKeyPart:r.e.subKeyPart})},2144:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(137),o=new a.e("indexedPhotoRecord",{photosRootItemSetKeyPart:r.e.subKeyPart,index:i.e})},2145:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("photoToGroupKey")},2146:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("previousItem")},2177:function(e,t,n){"use strict";n.r(t),n.d(t,"SharePrefetch",function(){return fe});var a,i,r=n(0),o=n(2120),s=n(2162),c=n(1083),d=n(60),l=n(210),u=n(1060),f=n(2327),p=n(428),m=n(1773),_=n(1751),h=n(2425);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(a||(a={})),function(e){e[e.Network=1]="Network",e[e.Embed=3]="Embed",e[e.App=4]="App",e[e.View=5]="View",e[e.Edit=6]="Edit",e[e.Form=7]="Form",e[e.Direct=8]="Direct",e[e.Organization=9]="Organization",e[e.AppAccess=10]="AppAccess",e[e.RequestAccess=11]="RequestAccess",e[e.None=100]="None"}(i||(i={}));var b=n(2426),g=n(2427),v=n(1590),y=n(2428),S=n(2429),D=n(2430),I=n(2191),x=n(510),C=n(161),O=n(1563),w=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var a=this._sharingContextInformation,i=a.isFolder,r=a.isListSharing,o=a.itemUrl,s=a.listId,c=a.listItemId,d=a.listUrl,l=a.resourceId,u=a.serverRelativeItemUrl,f=a.uniqueId,p=a.webAbsoluteUrl;if(r)return e.build().webByUrl({webUrl:p}).method("Lists",s);if(f){if(s)return e.build().webByUrl({webUrl:p}).segment("lists").method("getbyid",s).method("GetItemByUniqueId",f);var m=i?"GetFolderById":"GetFileById",_={guid:f};return e.build().webByUrl({webUrl:p}).method(m,_).segment("ListItemAllFields")}return d?e.build().webByUrl({listUrl:d}).method("GetListItem",u):o?e.build().webByUrl({webUrl:p}).method("GetFileByUrl",O.t(o)).segment("ListItemAllFields"):s&&c?e.build().webByUrl({webUrl:p}).method("Lists",s).method("GetItemById",c):e.build().webByUrl({webUrl:p}).method("GetListItemByResourceId",l)}var h;h=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var b=e.build().webByItemUrl(h).method("Lists",n);return t.isRootFolder||(b=t.properties.ID?b.method("GetItemById",t.properties.ID):b.method("GetItemByUniqueId",t.properties.uniqueId)),b},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}(),E=n(1749),A=n(295),L=n(1921),k=n(12),M=n(1133),P=n(1962),T=n(1099),U=!k.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),F=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new p.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new m.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new w({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(x.r)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(r.__extends)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return h.e.None;default:return h.e.View;case 2:return h.e.Edit;case 6:return h.e.Review}},t.prototype.getSharingInformation=function(e,t,n,i,r,o){var s,c=this,d=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),r&&(l+=",addressBarLinkSettings"),s=d.oDataParameter("$Expand",l).toString(),this.getData(function(){return s},function(t){var n=JSON.parse(t),i=c._parseGetSharingInformationResponse(n,e);return i.getSharingInformationSources=a.api,i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&j(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(o.rawPersonData)}var s={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i};return JSON.stringify(s)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a,r=this,o=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===i.Organization||n.linkType===i.Edit||n.linkType===i.View)return this._shareLink(e,n);if(o){var s=n.items[0],c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));a=c.segment("ShareObject").toString()}else a=this._shareUrl;return this.getData(function(){return a},function(e){var a=JSON.parse(e).d,i=[];Object(T.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],a=0;a<e.length;a++){var i=e[a];t.push(i.rawPersonData)}n.roleValue===h.e.Edit.toString()?n.roleValue=P.e:n.roleValue===h.e.View.toString()&&(n.roleValue=P.a);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return o||(s.url=r._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(T.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case b.e.none:case b.e.view:case b.e.review:case b.e.edit:case b.e.owner:t=n;break;default:t=b.e.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case b.e.none:t=0;break;case b.e.view:t=1;break;case b.e.review:t=6;break;case b.e.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString(),i={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&j(this._sharingContextInformation.listId.slice(1,-1))&&(i["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(i.Prefer="DirectUrlWithShareToken")),this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?(Object(T.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),function(e){if(e.d)return H(e.d.ShareLink.sharingLinkInfo)}(t)):t.error?{error:g.t.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(f.e)(t.expiration.toString()));var a=null;if(e.recipients&&e.recipients.length>0){a=[];for(var i=0,r=e.recipients;i<r.length;i++){var o=r[i];o.rawPersonData&&a.push(o.rawPersonData)}}var s=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){s=[];for(var c=0,d=t.inviteesToRemove;c<d.length;c++){var l=d[c];s.push({id:l.id,loginName:l.loginName,name:l.primaryText,isExternal:l.isExternal,principalType:l.type,email:l.email})}}var u={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};if(s&&(u.request.settings.inviteesToRemove={results:s}),a&&a.length>0){u.request.peoplePickerInput=JSON.stringify(a);var p=e.emailData,m=e.emailSubject;void 0!==p&&void 0===m&&(u.request.emailData={body:e.emailData,subject:""}),void 0===p&&void 0!==m&&(u.request.emailData={body:"",subject:e.emailSubject}),void 0!==p&&void 0!==m&&(u.request.emailData={body:e.emailData,subject:e.emailSubject})}var _=e.settings.shareId;_&&(u.request.settings.shareId=_,u.request.emailData={body:""});var h=JSON.stringify(u);return Object(T.e)()&&window.sessionStorage.setItem("ShareLink_Payload",h),h},"POST",0!==Object.keys(i).length?i:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(U)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:g.t.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?H(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:g.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(U)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:g.t.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(M.e)(this._pageContext))return v.e.sharePoint;switch(e){case A.t.teamSite:case A.t.group:case A.t.subgroup:case A.t.sitePagePublishing:return v.e.sharePoint;case A.t.mySite:return v.e.odb;default:return v.e.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,r=e;i<r.length;i++){var o=r[i];a.push(o.rawPersonData)}var s=null;t.expiration&&(s=Object(f.e)(t.expiration));var c={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:s}};return JSON.stringify(c)})},t.prototype._getSharingLinkKind=function(e,t){var n=y.e.direct;return e===i.Edit?n=y.e.anonymousEdit:e===i.View?n=y.e.anonymousView:e===i.Organization&&(n=t===h.e.Edit.toString()?y.e.organizationEdit:y.e.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:g.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,i=n.permissionsInformation,r=!!i,o=!!n.sharingLinkTemplates,s=r,c=!!n.addressBarLinkSettings,d=r?this._parseSharingLinks(i.links.results,n.directUrl,a):[],l=o?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],u=c?n.addressBarLinkSettings:null,f=[];if(r){var p=i.siteAdmins.results,m=i.principals.results,_=this._parseSharingPrincipals(p,void 0,a);_.forEach(function(e){return e.isSiteAdmin=!0});var h=this._parseSharingPrincipals(m,void 0,a);f=_.concat(h)}var b=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,d,n.sharingAbilities),v={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var I=t.properties,x=I.ItemChildCount?parseInt(I.ItemChildCount,10):0,O=I.FolderChildCount?parseInt(I.FolderChildCount,10):0,w=t.type===C.t.OneNote?0:x+O,A=this._isPolicyTipFlagSet(t.policyTip,E.a.blockSharing);v={name:t.name,childCount:w,hasDlpPolicy:A,extension:t.extension,appmap:t.appMap,itemType:t.type}}var L=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||d.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:b,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(d,f),item:v,sharingLinks:d,sharingPrincipals:f,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:S.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:y.e.direct,sharingScope:D.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:l,addressBarLinkSettings:u,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation}},t.prototype._computeIsShared=function(e,t){for(var n=!1,a=0,i=e;a<i.length;a++){var r=i[a];r.isActive&&r.sharingLinkKind!==y.e.direct&&(n=!0)}return n||(n=t.length>0),n},t.prototype._parseSharingLinks=function(e,t,n){var a=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;return t=void 0!==i.Scope&&i.Scope!==D.e.uninitialized?N(i.LinkKind,i.Scope):R(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:B(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:a._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:a._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:a._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});return(i=i.sort(function(e,t){return a._getLinkRanking(t)-a._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:S.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:y.e.direct,sharingScope:D.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),i},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case S.e.anyone:t+=30;break;case S.e.organization:t+=20;break;case S.e.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case I.e.anyone:t+=30;break;case I.e.organization:t+=20;break;case I.e.specificPeople:t+=10}switch(e.role){case b.e.edit:t+=3;break;case b.e.review:t+=2;break;case b.e.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==D.e.uninitialized?N(r.LinkKind,r.Scope):R(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:B(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(L.n)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(L.n)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return w.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:u.e[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(L.n)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===y.e.direct&&(e=y.e.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==y.e.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=y.e.anonymousView),i!==y.e.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=y.e.organizationEdit),r!==D.e.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=D.e.organization)):(i!==y.e.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=y.e.anonymousView),i!==y.e.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=y.e.organizationEdit),r!==D.e.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=D.e.organization)),a.organizationLinkAbilities&&(i!==y.e.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=y.e.organizationView),i!==y.e.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=y.e.direct),r!==D.e.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=D.e.specificPeople)),a.peopleSharingLinkAbilities&&(r!==D.e.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=D.e.existing));var o=void 0;return e===y.e.anonymousEdit||e===y.e.anonymousView?o=S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?o=S.e.organization:e===y.e.direct?o=S.e.specificPeople:e===y.e.flexible&&(o=S.e.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(_.t);function H(e){var t;t=void 0!==e.Scope&&e.Scope!==D.e.uninitialized?N(e.LinkKind,e.Scope):R(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:B(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function R(e,t,n){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t?S.e.anyone:!1===n?S.e.organization:S.e.specificPeopleFlex:void 0}function N(e,t){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t==D.e.anyone?S.e.anyone:t===D.e.organization?S.e.organization:S.e.specificPeopleFlex:void 0}function B(e){return e===y.e.anonymousEdit||e===y.e.organizationEdit||e!==y.e.anonymousView&&e!==y.e.organizationView&&null}function j(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}var V=function(){function e(e){this._dataSource=e.sharingDataSource||new F({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,i)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return t._invalidateItem(e.items[0]),n})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateItem(e.item),n})},e.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,n,a){return this._dataSource.emailWithoutPermissioning(e,t,n,a).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}(),z=n(372),G=n(684),K=n(1137),W=n(291),q=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(Object(K.e)()(function(e){function t(t){var n=t.context,a=void 0===n?{}:n,i=t.accountType,o=void 0===i?"Unknown":i,s=t.clientName,c=void 0===s?"Unknown":s,d=t.cloudType,l=void 0===d?"Unknown":d,u=t.correlationId,f=t.environment,p=void 0===f?t.ariaEnvironment||"prod":f,m=t.isAuthenticated,_=void 0===m?"NA":m,h=t.language,b=void 0===h?a.Market:h,g=t.scenario,v=void 0===g?"Unknown":g,y=t.siteSubscriptionId,S=void 0===y?"Unknown":y,D=t.userId,I=void 0===D?"Unknown":D,x=t.version,C=void 0===x?"Unknown":x,O=t.tenantToken,w=void 0===O?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":O,E=(t.context,Object(r.__rest)(t,["accountType","clientName","cloudType","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,Object(r.__assign)({tenantToken:w,context:Object(r.__assign)({AccountType:o,ClientName:c,CloudType:l,CorrelationId:u,Environment:p,IsAuthenticated:_,IsSharedControl:!0,Market:b,Scenario:v,Session:W.generate(),SiteSubscriptionId:S,UserId:I,Version:C,Workload:"SharedControls"},a)},E))||this}return Object(r.__extends)(t,e),t}(function(e){function t(t){var a=this,i=t.context,o=void 0===i?{}:i,s=t.ariaLoader,c=void 0===s?function(){return Object(r.__awaiter)(a,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,n.e(356).then(n.t.bind(null,3193,7))]})})}:s,d=(t.context,Object(r.__rest)(t,["ariaLoader","context"]));return a=e.call(this,Object(r.__assign)({ariaLoader:c,context:Object(r.__assign)({},o)},d))||this}return Object(r.__extends)(t,e),t}(G.e)))),Q=n(1128),Y=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(Object(Q.e)()(q)),J=n(204),X=n(237),Z=n(1076),$=n(179),ee=n(131),te=n(52),ne=n(346),ae=n(314),ie=n(1496),re=n(2111),oe={ECS:1000799},se={ODB:60596},ce=k.t.isActivated("acd90abc-a3c2-4370-a5cd-c49cd5e7850b","02/15/2022","use sharingMessenger for shareprefetch")||ne.n.isFeatureEnabled({ECS:1002676}),de=!k.t.isActivated("d5b8cbb0-c266-4df4-9114-140574fe3794","01/24/2022","use new prefetch for converged share dialog endpoint"),le=!k.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user"),ue=!k.t.isActivated("c877bf24-d915-49e7-8142-4f3051896aad","04/21/2022","crossdomain url"),fe=function(){function e(e){var t,n=this;this._iframe=document.createElement("iframe"),this._form=document.createElement("form"),this._formInput=document.createElement("input"),this._sharingHostMessenger=null,this._channelId=ae.e.generate(),this._signal=new l.e,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._sessionId=ae.e.generate(),this._manager=Object(J.t)(),this._hostOrigin="",this._clientOrigin="",this._sessionQos=new(ee.e.withManager(this._manager).withContext(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{"AppInfo.Session":n._sessionId})}))({name:"SharingSession.".concat(u.e[e.context.mode||u.e.share])}),this._shareCustomerPromiseLogger=new ie.e({scenario:"sharePrefetch.load",perfGoalInMs:3e4});var a,i=void 0===this._props.context.hostMethod?o.e.microservice:this._props.context.hostMethod,s=this._props.isConsumer;if(this._launchNewSharedialog=de&&i===o.e.sharepoint&&!s,!(null===(t=this._context)||void 0===t?void 0:t.authToken))throw new Error("An access token is required for SharePrefetch optimization");var c="";if(le&&ne.n.isFeatureEnabled(se)&&this._context.invitationId&&(c="&invitationId=".concat(this._context.invitationId)),this._launchNewSharedialog){var d=ue&&this._props.sharepointHostUrl?"".concat(this._props.sharepointHostUrl,"&sessionid=").concat(this._sessionId):void 0;this._iframeUrl=d||"".concat(this._context.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?sessionid=").concat(this._sessionId).concat(c,"&crossdomain=true")}else if(i===o.e.sharepoint&&this._props.sharepointHostUrl)this._iframeBaseUrl=this._iframeUrl=this._props.sharepointHostUrl;else switch((a=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0])?"test":e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"ag08":this._iframeBaseUrl="https://odweba.svc.ms.eaglex.ic.gov";break;case"ag09":this._iframeBaseUrl="https://odweba.svc.ms.microsoft.scloud";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var f={clientName:this._context.clientId,userAuthToken:this._context.authToken,Session:this._sessionId};if(s&&(this._context.userId?f.userId=this._context.userId:f.accountType="ConsumerAnonymous"),new Y(f).attach(this._manager),!this._iframeUrl&&i===o.e.microservice){var p=s?"&consumer=true":"";this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(p,"&sessionid=").concat(this._sessionId).concat(c).concat(a?"&devhost=".concat(encodeURIComponent(a)):"")}if(this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe),s)this._initializeForm(),e.element.appendChild(this._form);else if(this._launchNewSharedialog){this._initializeForm();var m=this._iframe.contentWindow;m&&(m.document.body.appendChild(this._form),this._form.submit())}ce||this._sharingHostMessenger||(this._sharingHostMessenger=this._createSharingHostMessenger())}return e.prototype.initializeUI=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,o,s,c,l=this;return Object(r.__generator)(this,function(f){return e=this._context&&this._context.correlationId,t=this._props.isConsumer,n=this._context.mode===u.e.copy&&"teams"===this._context.clientId&&!this._context.shareId,a=n?this._getDefaultLink():Promise.resolve(void 0),i=t||this._props.disablePrefetchSharingInformation?Promise.resolve(void 0):this._getSharingInformation(),o=t?Promise.resolve(void 0):this._signal.getPromise(),this._isShareReady=!1,Promise.all([this._toTuple(a),this._toTuple(i),this._toTuple(o)]).then(function(n){var a=n[0],i=n[1];n[2];try{var o=!1;if(!t){var s=l._props.options.onError;if(l._isError(a)&&(o=!0,s&&s({name:"SharePrefetchError",message:"",error:a.error,resultCode:d.n.isCanceled(a.error)?"Canceled":Object($.i)(a.error)})),l._isError(i)){o=!0;var c=i.error,u={code:c.code,status:c.status};s&&s({name:"SharePrefetchError",message:"",error:c,resultCode:d.n.isCanceled(i.error)?"Canceled":"[".concat(u.status.toString(),"] ").concat(u.code||"Unknown")})}}var f=l._iframe.contentWindow;if(f&&!t){var p=l._props.options.spRestTokenProvider,m=Object(r.__assign)(Object(r.__assign)({},l._context),{rawInvite:a.value,sharingInformation:i.value,hasTokenProvider:!!p&&!!p.getAuthToken});l._sharingHostMessenger?l._sharingHostMessenger.sendSharingContextInformation(m):f.postMessage(m,l._iframeUrl)}else t?(l._formInput.value=JSON.stringify(l._context),l._form.submit()):o||l._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:l._elementWindow.document.body.contains(l._iframe),messagesReceived:Object.keys(l._messagesReceived).join(","),mode:l._context.mode,correlationId:e}})}catch(t){l._sessionQos.end({resultType:te.e.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}}),this._props.disableIframeDomainCheck||(s=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout,setTimeout(function(){if(!l._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=l._props.options&&l._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach ".concat(l._iframeBaseUrl," domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges"),resultCode:t}),l._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:t,extraData:{mode:l._context.mode,iframeBaseUrl:l._iframeBaseUrl,correlationId:e}}),clearTimeout(l._timeoutId)},t.src="".concat(l._iframeBaseUrl,"/favicon.ico?").concat(Math.random())}},s)),c=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return Object(r.__awaiter)(l,void 0,void 0,function(){var n,o,s,d,l,u,f,p,m,_,h;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i];case 2:return s=r.sent(),o=!!s,[3,4];case 3:return d=r.sent(),n=d,[3,4];case 4:u=!1,r.label=5;case 5:return r.trys.push([5,7,,8]),[4,a];case 6:return f=r.sent(),u=!(!f||!f),[3,8];case 7:return p=r.sent(),l=p,[3,8];case 8:return m=this._elementWindow.document.body.contains(this._props.element),_={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),rootElementInBody:m,messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:o,getSharingError:n,inviteHasData:u,inviteError:l,isConsumer:t,timeout:c,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e},this._showShareUX(),(h=this._props.options&&this._props.options.onTimeout)&&h(_),this._sessionQos.end({resultType:m?te.e.Failure:te.e.ExpectedFailure,resultCode:"timeout",extraData:_}),[2]}})})},c),[2]})})},e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a=this;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return e=new c.t({},{urlDataSource:{getApiBaseUrl:function(){return"".concat(a._context.webAbsoluteUrl,"/_api/v2.0")}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return d.n.resolve({accessToken:a._context.authToken})}},apiEvent:X.e.withManager(this._manager)}),t=new s.e({},{dataRequestor:e}),n=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(n=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",n,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",n,!this._props.disableUseMultiPart)];case 1:return[2,{value:i.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,n=this._manager,a=new F({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(a){function i(i){return a.call(this,i,{pageContext:e,apiEvent:X.e.withManager(n),tokenProvider:t})||this}return Object(r.__extends)(i,a),i}(Z.e),tokenProvider:t}),i=new V({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:a}),o=this._launchNewSharedialog||this._context.mode===u.e.copy||this._context.mode===u.e.linkSettings;return i.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0,void 0,this._context.mode===u.e.manageAccess)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.name="shareFrame",this._iframe.id="shareFrame",this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},!ce&&this._iframeUrl&&(this._hostOrigin=new z.e(window.location.href).authority,this._iframeUrl+="&channelId=".concat(this._channelId,"&origin=").concat(this._hostOrigin)),this._launchNewSharedialog||(this._iframe.src=this._iframeUrl),this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden"},e.prototype._initializeForm=function(){var e;this._form.target="shareFrame",this._form.method="POST",this._form.action=this._iframeUrl,this._form.style.display="none",this._formInput.type="text";var t=null===(e=this._context)||void 0===e?void 0:e.authToken;this._launchNewSharedialog?(this._formInput.value=t,this._formInput.name="access_token"):this._formInput.name="context",this._form.appendChild(this._formInput);var n=document.createElement("input");n.type="submit",this._form.appendChild(n)},e.prototype._showShareUX=function(){var e,t;this._isShareReady=!0;var n=this._props.styles;n&&n.border?this._iframe.style.border=n.border:this._iframe.style.border="0",n&&(n.margin&&(this._iframe.style.margin=n.margin),n.minWidth&&(this._iframe.style.minWidth=n.minWidth),n.minHeight&&(this._iframe.style.minHeight=n.minHeight)),this._iframe.style.visibility="visible",this._iframe.style.height=this._context.fullScreenIframe?"100%":"".concat(this._iframeHeight||400,"px");var a=k.t.isActivated("209e41e5-d804-4aa1-9d59-5209d8d48f2c","02/03/2022","render wider dialog across all endpoints")||ne.n.isFeatureEnabled(oe)||!1===(null===(t=null===(e=this._props.context)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.enableWiderDialog)?320:480;this._iframe.style.width=this._context.fullScreenIframe?"100%":"".concat(a||this._iframeWidth||this._iframe.style.minWidth,"px"),clearTimeout(this._timeoutId)},e.prototype._receiveMessage=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(a){try{t=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,this.dispose(),[2]}catch(e){}return n=t.name,this._messagesReceived[n||""]=!0,this._processEvent(t),[2]})})},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e.prototype._createSharingHostMessenger=function(){var e=this;if(console.log("in sharePrefetch, _createSharingHostMessenger(), host created"),this._clientOrigin=new z.e(this._iframeUrl).authority,this._clientOrigin&&this._iframe.contentWindow){var t=new re.e({origin:this._clientOrigin,channelId:this._channelId,source:this._iframe.contentWindow,customerPromiseLogger:this._shareCustomerPromiseLogger});return t.addCommandHandler(function(t){return console.log("SharingHostMessenger: sharePrefetch, command received: ",t.name),e._processEvent(t),{result:"success"}}),t}return null},e.prototype._processEvent=function(e){var t,n,a,i,r,o,s,c,d,l,u,f=this;switch(e.name){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date,this._signal.complete();var p=this._props.options&&this._props.options.onScriptsLoaded;p&&p();break;case"share_resize":if(!this._context.fullScreenIframe){var m=this._props.options&&this._props.options.onResize;m&&e.width&&e.height&&m(e.width,e.height),this._iframeWidth=e.width||320,this._iframeHeight=e.height||400,this._isShareReady&&(this._iframe.style.height="".concat(this._iframeHeight,"px"),this._iframe.style.width="".concat(this._iframeWidth,"px"))}break;case"share_started":var _=this._props.options&&this._props.options.onStarted;_&&_();break;case"share_ready":this._showShareUX();var h={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:null===(t=this._context)||void 0===t?void 0:t.correlationId};this._sessionQos.end({resultType:te.e.Success,extraData:h}),this._shareCustomerPromiseLogger.end({resultType:te.e.Success});var b=this._props.options&&this._props.options.onReady;b&&b();break;case"share_error":this._showShareUX();var g=this._props.options&&this._props.options.onError,v=JSON.parse(e.data.debugErrorMessage||"{}"),y=v.code||v.status||"ShareError: [".concat(null===(n=e.data)||void 0===n?void 0:n.error,"]");this._sessionQos.end({resultType:te.e.Failure,resultCode:y,extraData:{correlationId:null===(a=this._context)||void 0===a?void 0:a.correlationId}}),this._shareCustomerPromiseLogger.end({resultType:te.e.Failure,errorCode:y,extraData:{clientId:this._context.clientId,mode:null===(i=this._context)||void 0===i?void 0:i.mode,correlationId:null===(r=this._context)||void 0===r?void 0:r.correlationId}}),g&&g({name:"SharePrefetchError",message:(null===(o=e.data)||void 0===o?void 0:o.errorMessage)||"",error:Error(null===(s=e.data)||void 0===s?void 0:s.error),debugErrorMessage:null===(c=e.data)||void 0===c?void 0:c.debugErrorMessage,errorMessage:null===(d=e.data)||void 0===d?void 0:d.errorMessage,resultCode:y});break;case"share_completed":var S=this._props.options&&this._props.options.onCompleted;S&&S({scope:(null===(l=e.data)||void 0===l?void 0:l.scope)||""});break;case"share_dismiss":var D=this._props.options&&this._props.options.onDismiss;D&&D();break;case"share_manageAccessClicked":var I=this._props.options&&this._props.options.openManageAccess;I&&I();break;case"share_linkSettingsCompleted":var x=this._props.options&&this._props.options.onLinkSettingsComplete;x&&x(e.data);break;case"share_grantAccessCompleted":var C=this._props.options&&this._props.options.onGrantAccessComplete;(null===(u=e.data)||void 0===u?void 0:u.successful)&&C&&C();break;case"share_getToken":var O=new ee.e({name:"SharingSession.GetToken"}),w=this._iframe.contentWindow;if(!w){O.end({resultType:te.e.Failure,error:"no_window"});break}this._props.options.spRestTokenProvider&&this._props.options.spRestTokenProvider.getAuthToken?this._props.options.spRestTokenProvider.getAuthToken(e.data).then(function(e){e?(f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(e,void 0):w.postMessage(JSON.stringify({name:"share_newToken",token:e}),f._iframeUrl),O.end({resultType:te.e.Success})):(f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(void 0,"no_token"):w.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),f._iframeUrl),O.end({resultType:te.e.Failure,error:"no_token"}))}).catch(function(e){f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(void 0,"token_exception",e.toString()):w.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:e}),f._iframeUrl),O.end({resultType:te.e.Failure,error:String(e)})}):(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_handler"):w.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),O.end({resultType:te.e.Failure,error:"no_handler"}))}},e}()},2183:function(e,t,n){"use strict";n.d(t,"i",function(){return C}),n.d(t,"n",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"t",function(){return E}),n.d(t,"e",function(){return A});var a=n(571),i=n(515),r=n(226),o=n(411),s=n(687),c=n(30),d=n(14),l=new c.e("playlistPlaybackItem",{currentItemKey:d.e,playbackItemKey:d.e}),u=n(263),f=n(803),p=n(685),m=new c.e("spItemSet",{parentItemKey:f.e.subKeyPart,sortFieldKey:d.e,sortAscending:u.e,filterParams:d.e,groupByFieldKey:d.e,viewKey:p.e.subKeyPart}),_=n(46),h=n(160),b=n(212),g=n(133),v=n(236),y=n(971),S=n(143),D=n(19),I=n(12),x=Object(h.e)(function(e){return a.e.getRUMOneLogger()});function C(e){return function(t){var n=t(x);if(e&&e.keyChanges&&e.keyChanges.currentItemKey!==e.keyChanges.previousItemKey&&b.r(o.e.render.start),!n.isRunning()){var a=L(n,e);e&&a===r.e.none||n.resetLogger()}}}function O(e,t,n,a){return void 0===a&&(a=!1),function(r){n&&n.keyChanges&&n.keyChanges.currentItemKey!==n.keyChanges.previousItemKey&&(b.r(o.e.render.end),b.o("Items-View.Render",o.e.render.start,o.e.render.end));var c=r(x),d=n||{},l=d.itemsScopeItemKey,u=void 0===l?"":l,f=d.itemsScopeInitTime,m=void 0===f?0:f,h="ItemsViewListView".concat(u);c.writeScenarioId("".concat(t||"Unknown",".ItemsViewListView")),c.addExpectedControl(h),I.e.isActivated("5DFC9288-3AE8-41E0-84E4-7A68B2D2E483","06/10/2022","Add W3CPerf timings to Rumone")&&c.collectW3CPerfTimings();var g=L(c,n);c.writePageTransitionType(g);var v=r(function(e){return function(t){return t(Object(S.e)(function(t){var n=(e&&e.keyChanges||{}).currentItemKey,a=t.demandItemFacet(s.e,n),i=a&&a.viewKey,r=i&&p.e.serialize(i);return t.demandItemFacet(_.On,r)}))}}(n)),C=r(function(e){return function(t){return t(Object(S.e)(function(t){var n,a,i,r,o,s=null===(n=null==e?void 0:e.keyChanges)||void 0===n?void 0:n.currentItemKey,c=t.demandItemFacet(D.e,s),d=0;return(null==c?void 0:c.itemKeys)&&(null===(a=null==c?void 0:c.itemKeys)||void 0===a?void 0:a.length)&&c.itemKeys.forEach(function(e){var n=t.demandItemFacet(_.Et,e);n&&n._activity&&d++}),{activityNumber:d,itemNumber:null===(i=null==c?void 0:c.itemKeys)||void 0===i?void 0:i.length,activityPercent:d&&(null==c?void 0:c.itemKeys)&&(null===(r=null==c?void 0:c.itemKeys)||void 0===r?void 0:r.length)?Math.round(d/(null===(o=null==c?void 0:c.itemKeys)||void 0===o?void 0:o.length)*100):0}}))}}(n)),O=c.getMarkerTime(o.e.itemsView.start)||b.i("OnePageNavigation.Start")||m,w=c.getMarkerTime(o.e.authToken.start),E=c.getMarkerTime(o.e.authToken.end),A=c.getMarkerTime(o.e.dataFetch.start),k=c.getMarkerTime(o.e.dataFetch.end),M=c.getMarkerTime(o.e.appStart.start),P=c.getMarkerTime(o.e.processData.start),T=c.getMarkerTime(o.e.processData.end),U=c.getMarkerTime(o.e.resolveData.start),F=c.getMarkerTime(o.e.resolveData.end),H=0;A&&k&&(H=k-A);var R={"itemsView.appStart":{data:M-O>0?M-O:0,needFlatten:!0},"itemsView.render":{data:e-Math.max(m,isNaN(M)?0:M,O)-H,needFlatten:!0}};w&&E&&(R["itemsView.authTokenDuration"]={data:E-w,needFlatten:!0}),A&&k&&(R["itemsView.dataFetch"]={data:H,needFlatten:!0}),P&&T&&(R["itemsView.processData"]={data:T-P,needFlatten:!0}),U&&F&&(R["itemsView.resolveData"]={data:F-U,needFlatten:!0}),v&&(R["listView.viewType"]={data:v,needFlatten:!0}),C&&(R["listView.activityNumber"]={data:JSON.stringify(C),needFlatten:!1});for(var N=Object(y.n)(),B=0,j=Object.keys(N);B<j.length;B++){var V=j[B],z=N[V];z&&(R[V]=z)}a&&Object(y.a)();var G=new i.e({controlId:h,startTime:O,endTime:e});c.writeControlPerformanceData(G),c.writeEUPLBreakdown(JSON.stringify(R))}}function w(e){return void 0===e&&(e=!1),function(t){for(var n=Object(y.n)(),a=t(x),i={},r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],c=n[s];c&&(i[s+".tti"]=c)}e&&Object(y.a)(),a.writeTTIBreakdown(JSON.stringify(i))}}function E(e,t){var n=new v.e(void 0);return function(a){n.setTimeout(function(){var r="Items-View.ContextMenu.Start",o="Items-View.ContextMenu.End";b.r(o);var s=performance.getEntriesByName("".concat(b.t).concat(o),"mark").pop(),c=s?s.startTime:NaN,d="ItemsViewContextMenu",l=0===performance.getEntriesByName("".concat(b.t).concat(d,".FirstRender"),"mark").length,u=performance.getEntriesByName("".concat(b.t).concat(r),"mark").pop(),f=u?u.startTime:NaN;b.o("".concat(d,".").concat(l?"FirstRender":"Render"),r,o);var p=a(x),m=L(p,t);p.writeScenarioId("".concat(e||"Unknown",".").concat(d)),p.addExpectedControl(d),p.writePageTransitionType(m);var _=new i.e({controlId:d,startTime:f,endTime:c});p.writeControlPerformanceData(_),n.dispose()},0)}}function A(e,t,n){return function(a){a(x).addEUPLBreakdown(e,t,n)}}function L(e,t){if(t){if(t.isFullPageLoad)return e.getMarkerTime(g.t)?r.e.onePageAppNavigation:r.e.fullPageLoad;var n=void 0,a=void 0,i=void 0,o=t.keyChanges||{},c=o.previousItemKey,d=void 0===c?void 0:c,u=o.currentItemKey,f=void 0===u?void 0:u;if(s.e.matches(d)&&l.matches(f))return r.e.fullPageLoad;if(d&&s.e.matches(d)&&(n=s.e.deserialize(d)),d&&m.matches(d)&&(a=m.deserialize(d)),f&&s.e.matches(f)&&(i=s.e.deserialize(f)),!n&&!a)return r.e.onePageAppNavigation;if(i){var p=n&&n.listFullUrl||a&&a.parentItemKey&&a.parentItemKey.listFullUrl,_=n&&n.rootFolder||a&&a.parentItemKey&&a.parentItemKey.rootFolder;if(p&&p!==i.listFullUrl)return r.e.onePageAppNavigation;if(_!==i.rootFolder)return r.e.none}}return r.e.none}},2190:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(292),r=((a={})[i.e.AllMyPhotos]="Folder",a[i.e.Albums]="Albums",a[i.e.allTags]="Tags",a[i.e.allPlaces]="Places",a[i.e.allPeople]="People",a[i.e.singleAlbum]="Album",a[i.e.singleTag]="Tag",a[i.e.singlePlace]="Place",a[i.e.singlePerson]="Person",a[i.e.onThisDay]="OnThisDay",a[i.e.onThisMonth]="OnThisMonth",a[i.e.lastWeekPreviousYears]="LastWeekPreviousYears",a.folder="Folder",a.tag="Tag",a.album="Album",a.place="Place",a.onthisday="OnThisDay",a.onthismonth="OnThisMonth",a.lastweekpreviousyears="LastWeekPreviousYears",a);t.t=r},2191:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}},2247:function(e,t,n){"use strict";n.d(t,"e",function(){return N});var a,i=n(1469),r=n(31),o=n(103),s=n(425),c=n(543),d=Object(o.t)(function(){return Object(r.M)({"0%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"78.57%":{transform:"translate(0, 0)",animationTimingFunction:"cubic-bezier(0.62, 0, 0.56, 1)"},"82.14%":{transform:"translate(0, -5px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0, 1)"},"84.88%":{transform:"translate(0, 9px)",animationTimingFunction:"cubic-bezier(1, 0, 0.56, 1)"},"88.1%":{transform:"translate(0, -2px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0.67, 1)"},"90.12%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"100%":{transform:"translate(0, 0)"}})}),l=Object(o.t)(function(){return Object(r.M)({"0%":{transform:" scale(0)",animationTimingFunction:"linear"},"14.29%":{transform:"scale(0)",animationTimingFunction:"cubic-bezier(0.84, 0, 0.52, 0.99)"},"16.67%":{transform:"scale(1.15)",animationTimingFunction:"cubic-bezier(0.48, -0.01, 0.52, 1.01)"},"19.05%":{transform:"scale(0.95)",animationTimingFunction:"cubic-bezier(0.48, 0.02, 0.52, 0.98)"},"21.43%":{transform:"scale(1)",animationTimingFunction:"linear"},"42.86%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"45.71%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"50%":{transform:"scale(1)",animationTimingFunction:"linear"},"90.12%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"92.98%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"97.26%":{transform:"scale(1)",animationTimingFunction:"linear"},"100%":{transform:"scale(1)"}})}),u=Object(o.t)(function(){return Object(r.M)({"0%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"83.33%":{transform:" rotate(0deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"83.93%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"84.52%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.12%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.71%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"86.31%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"100%":{transform:"rotate(0deg)"}})}),f=n(3),p=n(1),m=n(786),_=n(102),h=n(115),b=n(236),g=n(93),v=n(972),y=n(1401),S=n(1048),D=n(208),I=n(567),x=n(83),C=n(1731),O=Object(o.t)(function(){var e;return Object(r.T)({root:[{position:"absolute",boxSizing:"border-box",border:"1px solid ${}",selectors:(e={},e[r.r]={border:"1px solid WindowText"},e)},Object(r.S)()],container:{position:"relative"},main:{backgroundColor:"#ffffff",overflowX:"hidden",overflowY:"hidden",position:"relative"},overFlowYHidden:{overflowY:"hidden"}})}),w=n(1552),E=n(138),A=n(50),L=n(105),k={opacity:0},M=((a={})[x.t.top]="slideUpIn20",a[x.t.bottom]="slideDownIn20",a[x.t.left]="slideLeftIn20",a[x.t.right]="slideRightIn20",a),P=function(e){function t(t){var n=e.call(this,t)||this;return n._positionedHost=p.createRef(),n._contentHost=p.createRef(),n.dismiss=function(e){n.onResize(e)},n.onResize=function(e){var t=n.props.onDismiss;t?t(e):n._updateAsyncPosition()},n._setInitialFocus=function(){n._contentHost.current&&n.props.setInitialFocus&&!n._didSetInitialFocus&&n.state.positions&&(n._didSetInitialFocus=!0,Object(h.n)(n._contentHost.current))},n._onComponentDidMount=function(){n._async.setTimeout(function(){n._events.on(n._targetWindow,"scroll",n._async.throttle(n._dismissOnScroll,10),!0),n._events.on(n._targetWindow,"resize",n._async.throttle(n.onResize,10),!0),n._events.on(n._targetWindow.document.body,"focus",n._dismissOnLostFocus,!0),n._events.on(n._targetWindow.document.body,"click",n._dismissOnLostFocus,!0)},0),n.props.onLayerMounted&&n.props.onLayerMounted(),n._updateAsyncPosition(),n._setHeightOffsetEveryFrame()},Object(v.e)(n),n._async=new b.e(n),n._events=new g.e(n),n._didSetInitialFocus=!1,n.state={positions:void 0,heightOffset:0},n._positionAttempts=0,n}return Object(f.a)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._setTargetWindowAndElement(this._getTarget())},t.prototype.componentDidMount=function(){this._onComponentDidMount()},t.prototype.componentDidUpdate=function(){this._setInitialFocus(),this._updateAsyncPosition()},t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this._getTarget(e);(t!==this._getTarget()||"string"==typeof t||t instanceof String)&&(this._maxHeight=void 0,this._setTargetWindowAndElement(t)),e.offsetFromTarget!==this.props.offsetFromTarget&&(this._maxHeight=void 0),e.finalHeight!==this.props.finalHeight&&this._setHeightOffsetEveryFrame()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){if(!this._targetWindow)return null;var e=this.props,t=e.className,n=e.positioningContainerWidth,a=e.positioningContainerMaxHeight,i=e.children,o=this.state.positions,s=O(),c=o&&o.targetEdge?r.e[M[o.targetEdge]]:"",d=this._getMaxHeight()+this.state.heightOffset,l=a&&a>d?d:a,u=p.createElement("div",{ref:this._positionedHost,className:Object(A.e)("ms-PositioningContainer",s.container)},p.createElement("div",{className:Object(r.U)("ms-PositioningContainer-layerHost",s.root,t,c,!!n&&{width:n}),style:o?o.elementPosition:k,tabIndex:-1,ref:this._contentHost},i,l));return this.props.doNotLayer?u:p.createElement(w.e,null,u)},t.prototype._dismissOnScroll=function(e){var t=this.props.preventDismissOnScroll;this.state.positions&&!t&&this._dismissOnLostFocus(e)},t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._positionedHost.current&&!Object(I.e)(this._positionedHost.current,t);(!this._target&&n||e.target!==this._targetWindow&&n&&(this._target.stopPropagation||!this._target||t!==this._target&&!Object(I.e)(this._target,t)))&&this.onResize(e)},t.prototype._updateAsyncPosition=function(){var e=this;this._async.requestAnimationFrame(function(){return e._updatePosition()})},t.prototype._updatePosition=function(){var e=this.state.positions,t=this.props,n=t.offsetFromTarget,a=t.onPositioned,i=this._positionedHost.current,r=this._contentHost.current;if(i&&r){var o=Object(f.e)({},this.props);if(o.bounds=this._getBounds(),o.target=this._target,document.body.contains(o.target)){o.gapSpace=n;var s=Object(C.r)(o,i,r);!e&&s||e&&s&&!this._arePositionsEqual(e,s)&&this._positionAttempts<5?(this._positionAttempts++,this.setState({positions:s},function(){a&&a(s)})):(this._positionAttempts=0,a&&a(s))}else void 0!==e&&this.setState({positions:void 0})}},t.prototype._getBounds=function(){if(!this._positioningBounds){var e=this.props.bounds;e||(e={top:0+this.props.minPagePadding,left:0+this.props.minPagePadding,right:this._targetWindow.innerWidth-this.props.minPagePadding,bottom:this._targetWindow.innerHeight-this.props.minPagePadding,width:this._targetWindow.innerWidth-2*this.props.minPagePadding,height:this._targetWindow.innerHeight-2*this.props.minPagePadding}),this._positioningBounds=e}return this._positioningBounds},t.prototype._getMaxHeight=function(){var e=this.props,t=e.directionalHintFixed,n=e.offsetFromTarget,a=e.directionalHint;if(!this._maxHeight)if(t&&this._target){var i=n||0;this._maxHeight=Object(C.t)(this._target,a,i,this._getBounds())}else this._maxHeight=this._getBounds().height-2;return this._maxHeight},t.prototype._arePositionsEqual=function(e,t){return this._comparePositions(e.elementPosition,t.elementPosition)},t.prototype._comparePositions=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var a=e[n],i=t[n];if(a&&i&&a.toFixed(2)!==i.toFixed(2))return!1}return!0},t.prototype._setTargetWindowAndElement=function(e){var t=this._positionedHost.current;if(e)if("string"==typeof e){var n=Object(D.e)();this._target=n?n.querySelector(e):null,this._targetWindow=Object(L.e)(t)}else if(e.stopPropagation)this._targetWindow=Object(L.e)(e.target),this._target=e;else if(void 0===e.left&&void 0===e.x||void 0===e.top&&void 0===e.y){var a=e;this._targetWindow=Object(L.e)(a),this._target=e}else this._targetWindow=Object(L.e)(t),this._target=e;else this._targetWindow=Object(L.e)(t)},t.prototype._setHeightOffsetEveryFrame=function(){var e=this;this._contentHost&&this.props.finalHeight&&(this._setHeightOffsetTimer=this._async.requestAnimationFrame(function(){if(e._contentHost.current){var t=e._contentHost.current.lastChild,n=t.scrollHeight-t.offsetHeight;e.setState({heightOffset:e.state.heightOffset+n}),t.offsetHeight<e.props.finalHeight?e._setHeightOffsetEveryFrame():e._async.cancelAnimationFrame(e._setHeightOffsetTimer)}}))},t.prototype._getTarget=function(e){return void 0===e&&(e=this.props),e.target},t.defaultProps={preventDismissOnScroll:!1,offsetFromTarget:0,minPagePadding:8,directionalHint:E.e.bottomAutoEdge},t}(p.Component);function T(e){var t;return{root:[{position:"absolute",boxShadow:"inherit",border:"none",boxSizing:"border-box",transform:e.transform,width:e.width,height:e.height,left:e.left,top:e.top,right:e.right,bottom:e.bottom}],beak:{fill:e.color,display:"block",selectors:(t={},t[r.r]={fill:"windowtext"},t)}}}var U=function(e){function t(t){var n=e.call(this,t)||this;return Object(v.e)(n),n}return Object(f.a)(t,e),t.prototype.render=function(){var e,t,n,a,i,r,o=this.props,s=o.left,c=o.top,d=o.bottom,l=o.right,u=o.color,f=o.direction,_=void 0===f?x.t.top:f;switch(_===x.t.top||_===x.t.bottom?(e=10,t=18):(e=18,t=10),_){case x.t.top:default:n="9, 0",a="18, 10",i="0, 10",r="translateY(-100%)";break;case x.t.right:n="0, 0",a="10, 10",i="0, 18",r="translateX(100%)";break;case x.t.bottom:n="0, 0",a="18, 0",i="9, 10",r="translateY(100%)";break;case x.t.left:n="10, 0",a="0, 10",i="10, 18",r="translateX(-100%)"}var h=Object(m.e)()(T,{left:s,top:c,bottom:d,right:l,height:e+"px",width:t+"px",transform:r,color:u});return p.createElement("div",{className:h.root,role:"presentation"},p.createElement("svg",{height:e,width:t,className:h.beak},p.createElement("polygon",{points:n+" "+a+" "+i})))},t}(p.Component),F=n(1732),H=Object(m.e)(),R=function(e){function t(t){var n=e.call(this,t)||this;return n._entityHost=p.createRef(),n._entityInnerHostElement=p.createRef(),n._translateAnimationContainer=p.createRef(),n._ariaAlertContainer=p.createRef(),n._childrenContainer=p.createRef(),n._positioningContainer=p.createRef(),n.dismiss=function(e){var t=n.props.onDismiss;t&&t(e)},n._onKeyDown=function(e){(e.altKey&&e.which===_.e.c||e.which===_.e.enter&&n._translateAnimationContainer.current&&n._translateAnimationContainer.current.contains(e.target))&&n._onFocusHandler()},n._onFocusHandler=function(){n.state.isCollapsed&&n._openCoachmark()},n._onPositioned=function(e){n._async.requestAnimationFrame(function(){n.setState({targetAlignment:e.alignmentEdge,targetPosition:e.targetEdge})})},n._setBeakPosition=function(){var e,t,a,i,r,o,c=n.state.targetAlignment,d="3px";switch(n._beakDirection){case x.t.top:case x.t.bottom:c?c===x.t.left?(e="7px",r="left"):(a="7px",r="right"):(e="calc(50% - 9px)",r="center"),n._beakDirection===x.t.top?(t=d,o="top"):(i=d,o="bottom");break;case x.t.left:case x.t.right:c?c===x.t.top?(t="7px",o="top"):(i="7px",o="bottom"):(t="calc(50% - 9px)",o="center"),n._beakDirection===x.t.left?(Object(s.e)(n.props.theme)?a=d:e=d,r="left"):(Object(s.e)(n.props.theme)?e=d:a=d,r="right")}n.setState({beakLeft:e,beakRight:a,beakBottom:i,beakTop:t,transformOrigin:r+" "+o})},n._openCoachmark=function(){n.setState({isCollapsed:!1}),n.props.onAnimationOpenStart&&n.props.onAnimationOpenStart(),n._entityInnerHostElement.current&&n._entityInnerHostElement.current.addEventListener("transitionend",function(){n._async.setTimeout(function(){n._entityInnerHostElement.current&&Object(h.n)(n._entityInnerHostElement.current)},1e3),n.props.onAnimationOpenEnd&&n.props.onAnimationOpenEnd()})},n._async=new b.e(n),n._events=new g.e(n),Object(v.e)(n),Object(y.e)("Coachmark",t,{teachingBubbleRef:void 0,collapsed:"isCollapsed",beakWidth:void 0,beakHeight:void 0,width:void 0,height:void 0}),n.state={isCollapsed:t.isCollapsed,isBeaconAnimating:!0,isMeasuring:!0,entityInnerHostRect:{width:0,height:0},isMouseInProximity:!1,isMeasured:!1},n}return Object(f.a)(t,e),Object.defineProperty(t.prototype,"_beakDirection",{get:function(){var e=this.state.targetPosition;return void 0===e?x.t.bottom:Object(C.n)(e)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.beaconColorOne,n=e.beaconColorTwo,a=e.children,i=e.target,r=e.color,o=e.positioningContainerProps,s=e.ariaDescribedBy,c=e.ariaDescribedByText,d=e.ariaLabelledBy,l=e.ariaLabelledByText,u=e.ariaAlertText,m=e.delayBeforeCoachmarkAnimation,_=e.styles,h=e.theme,b=e.className,g=e.persistentBeak,v=this.state,y=v.beakLeft,S=v.beakTop,D=v.beakRight,I=v.beakBottom,x=v.isCollapsed,C=v.isBeaconAnimating,O=v.isMeasuring,w=v.entityInnerHostRect,E=v.transformOrigin,A=v.alertText,L=v.isMeasured,k=r;!k&&h&&(k=h.semanticColors.primaryButtonBackground);var M=H(_,{theme:h,beaconColorOne:t,beaconColorTwo:n,className:b,isCollapsed:x,isBeaconAnimating:C,isMeasuring:O,color:k,transformOrigin:E,isMeasured:L,entityHostHeight:w.height+"px",entityHostWidth:w.width+"px",width:"32px",height:"32px",delayBeforeCoachmarkAnimation:m+"ms"}),T=x?32:w.height;return p.createElement(P,Object(f.e)({target:i,offsetFromTarget:10,componentRef:this._positioningContainer,finalHeight:T,onPositioned:this._onPositioned,bounds:this._getBounds()},o),p.createElement("div",{className:M.root},u&&p.createElement("div",{className:M.ariaContainer,role:"alert",ref:this._ariaAlertContainer,"aria-hidden":!x},A),p.createElement("div",{className:M.pulsingBeacon}),p.createElement("div",{className:M.translateAnimationContainer,ref:this._translateAnimationContainer},p.createElement("div",{className:M.scaleAnimationLayer},p.createElement("div",{className:M.rotateAnimationLayer},this._positioningContainer.current&&(x||g)&&p.createElement(U,{left:y,top:S,right:D,bottom:I,direction:this._beakDirection,color:k}),p.createElement("div",{className:M.entityHost,ref:this._entityHost,tabIndex:-1,"data-is-focusable":!0,role:"dialog","aria-labelledby":d,"aria-describedby":s},x&&[d&&p.createElement("p",{id:d,key:0,className:M.ariaContainer},l),s&&p.createElement("p",{id:s,key:1,className:M.ariaContainer},c)],p.createElement(F.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},p.createElement("div",{className:M.entityInnerHost,ref:this._entityInnerHostElement},p.createElement("div",{className:M.childrenContainer,ref:this._childrenContainer,"aria-hidden":x},a)))))))))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isCollapsed&&!e.isCollapsed&&this._openCoachmark()},t.prototype.shouldComponentUpdate=function(e,t){return!Object(S.n)(e,this.props)||!Object(S.n)(t,this.state)},t.prototype.componentDidUpdate=function(e,t){t.targetAlignment===this.state.targetAlignment&&t.targetPosition===this.state.targetPosition||this._setBeakPosition(),e.preventDismissOnLostFocus!==this.props.preventDismissOnLostFocus&&this._addListeners()},t.prototype.componentDidMount=function(){var e=this;this._async.requestAnimationFrame(function(){e._entityInnerHostElement.current&&e.state.entityInnerHostRect.width+e.state.entityInnerHostRect.width===0&&(e.setState({isMeasuring:!1,entityInnerHostRect:{width:e._entityInnerHostElement.current.offsetWidth,height:e._entityInnerHostElement.current.offsetHeight},isMeasured:!0}),e._setBeakPosition(),e.forceUpdate()),e._addListeners(),e._async.setTimeout(function(){e._addProximityHandler(e.props.mouseProximityOffset)},e.props.delayBeforeMouseOpen),e.props.ariaAlertText&&e._async.setTimeout(function(){e.props.ariaAlertText&&e._ariaAlertContainer.current&&e.setState({alertText:e.props.ariaAlertText})},0),e.props.preventFocusOnMount||e._async.setTimeout(function(){e._entityHost.current&&e._entityHost.current.focus()},1e3)})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype._addListeners=function(){var e=this.props.preventDismissOnLostFocus,t=Object(D.e)();this._events.off(),t&&(this._events.on(t,"keydown",this._onKeyDown,!0),e||(this._events.on(t,"click",this._dismissOnLostFocus,!0),this._events.on(t,"focus",this._dismissOnLostFocus,!0)))},t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._translateAnimationContainer.current&&!Object(I.e)(this._translateAnimationContainer.current,t),a=this.props.target;n&&t!==a&&!Object(I.e)(a,t)&&this.dismiss(e)},t.prototype._getBounds=function(){var e=this.props,t=e.isPositionForced,n=e.positioningContainerProps;return t?!n||n.directionalHint!==E.e.topAutoEdge&&n.directionalHint!==E.e.bottomAutoEdge?{left:-1/0,top:-1/0,bottom:1/0,right:1/0,width:1/0,height:1/0}:{left:0,top:-1/0,bottom:1/0,right:window.innerWidth,width:window.innerWidth,height:1/0}:void 0},t.prototype._addProximityHandler=function(e){var t=this;void 0===e&&(e=0);var n=[];this._async.setTimeout(function(){t._setTargetElementRect(),t._events.on(window,"resize",function(){n.forEach(function(e){clearInterval(e)}),n.push(t._async.setTimeout(function(){t._setTargetElementRect()},100))})},10),this._events.on(document,"mousemove",function(n){if(t.state.isCollapsed){var a=n.clientY,i=n.clientX;t._setTargetElementRect(),t._isInsideElement(i,a,e)!==t.state.isMouseInProximity&&t._openCoachmark()}t.props.onMouseMove&&t.props.onMouseMove(n)})},t.prototype._setTargetElementRect=function(){this._translateAnimationContainer&&this._translateAnimationContainer.current&&(this._targetElementRect=this._translateAnimationContainer.current.getBoundingClientRect())},t.prototype._isInsideElement=function(e,t,n){return void 0===n&&(n=0),e>this._targetElementRect.left-n&&e<this._targetElementRect.left+this._targetElementRect.width+n&&t>this._targetElementRect.top-n&&t<this._targetElementRect.top+this._targetElementRect.height+n},t.defaultProps={isCollapsed:!0,mouseProximityOffset:10,delayBeforeMouseOpen:3600,delayBeforeCoachmarkAnimation:0,isPositionForced:!0,positioningContainerProps:{directionalHint:E.e.bottomAutoEdge}},t}(p.Component),N=Object(i.e)(R,function(e){var t,n=e.theme,a=e.className,i=e.color,o=e.beaconColorOne,f=e.beaconColorTwo,p=e.delayBeforeCoachmarkAnimation,m=e.isCollapsed,_=e.isBeaconAnimating,h=e.isMeasuring,b=e.isMeasured,g=e.entityHostHeight,v=e.entityHostWidth,y=e.transformOrigin;if(!n)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var S=r.c.continuousPulseAnimationDouble(o||n.palette.themePrimary,f||n.palette.themeTertiary,"35px","150px","10px"),D=r.c.createDefaultAnimation(S,p);return{root:[n.fonts.medium,{position:"relative"},a],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:Object(s.e)(n)?"translate(50%, -50%)":"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:"0"},m&&_&&D],translateAnimationContainer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:d(),transition:"opacity 0.5s ease-in-out"},!m&&{opacity:"1"}],scaleAnimationLayer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:l()}],rotateAnimationLayer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:u()},!m&&{opacity:"1"}],entityHost:[{position:"relative",outline:"none",overflow:"hidden",backgroundColor:i,borderRadius:32,transition:"border-radius 250ms, width 500ms, height 500ms cubic-bezier(0.5, 0, 0, 1)",visibility:"hidden",selectors:(t={},t[r.r]={backgroundColor:"Window",border:"2px solid WindowText"},t["."+c.e+" &:focus"]={outline:"1px solid "+n.palette.themeTertiary},t)},!h&&{width:32,height:32,visibility:"visible"},!m&&{borderRadius:"1px",opacity:"1",width:v,height:g}],entityInnerHost:[{transition:"transform 500ms cubic-bezier(0.5, 0, 0, 1)",transformOrigin:y,transform:"scale(0)"},!m&&{width:v,height:g,transform:"scale(1)"},!h&&{visibility:"visible"}],childrenContainer:[{display:b&&m?"none":"block"}],ariaContainer:{position:"fixed",opacity:0,height:0,width:0,pointerEvents:"none"}}},void 0,{scope:"Coachmark"})},2257:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r});var a,i={ODC:"EnableNewCarouselDesign"},r=function(e){a=!!e}},2258:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(67),i=n(19),r=n(137),o=n(1941),s=new a.e("photosIndexMap",function(e,t){var n=t.itemKey;if(r.e.matches(n)){var a=e.demandItemFacet(i.e,n);if(void 0!==a){var s=[],c=0;return a.itemKeys.forEach(function(e){o.e.matches(e)?c+=o.e.deserialize(e).count:(s[c]=e,c++)}),s}}})},2284:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return T}),n.d(t,"n",function(){return R});var a=n(0),i=n(2052),r=n(336),o=n(2160),s=n(2190),c=n(323),d=n(11),l=n(35),u=n(812),f=n(818),p=n(819),m=n(1827),_=n(1833),h=n(1834),b=n(143),g=n(90),v=[1e4,1e3,100],y="landing",S="counts",D=function(){function e(){this._groupToCountData={counts:[],dates:[]}}return e.prototype.clearGroupToCountsData=function(){this._groupToCountData={counts:[],dates:[]},this._filter=void 0},e.prototype.updateGroupToCountsData=function(e,t,n,a){if("folder"===e){var i=n.counts,r=n.dates;a?this._groupToCountData.pageToken===a&&this._filter===t&&(this._groupToCountData={counts:this._groupToCountData.counts.concat(i),dates:this._groupToCountData.dates.concat(r),pageToken:a}):(this._groupToCountData=n,this._filter=t)}},e.prototype.calculateDateAndOffsetOfIndex=function(t,n,a){if("folder"!==t)return e.UnknownDateAndOffset;if(n!==this._filter)return e.UnknownDateAndOffset;for(var i=0,r=-1,o=0,s=this._groupToCountData,c=s.counts,d=s.dates,l=0;l<c.length;l++){if((i+=c[l].count)>a){r=l;break}o=i}return r>=0?{date:d[r],index:o}:e.UnknownDateAndOffset},e.UnknownDateAndOffset={date:void 0,index:-1},e}(),I=function(){function e(e,t){this._vroomDataRequestor=e,this._successfullGroupToCountPageSizeIndex=0,this._indexToDateMapper=new D,this._photosNextLinkSkipToken={},this._itemCacheStore=t}return e.prototype.updateResource=function(e){var t=e;this._engagement=t.consume(r.e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(e=new Date,this._photosNextLinkSkipToken={},r){case"album":return[3,1];case"tag":return[3,3];case"folder":return[3,5];case"onthisday":case"lastweekpreviousyears":case"onthismonth":return[3,7]}return[3,9];case 1:return[4,this._getGroupToCountForSingleAlbum(r,t,n)];case 2:case 8:case 10:return o=a.sent(),[3,11];case 3:case 9:return[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 4:return s=a.sent(),o=this._reduceGroupToCount(s,t,[t,t,t],[t,t,t]),[3,11];case 5:return void 0===i&&this._indexToDateMapper.clearGroupToCountsData(),[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 6:return s=a.sent(),this._indexToDateMapper.updateGroupToCountsData(r,t,s,i),o=s,[3,11];case 7:return[4,this._getGroupToCountForMOJ(t,n,i,r)];case 11:return this._sendGroupToCountPerfTelemetry(e,o.counts.length,r),[2,{counts:o.counts,pageToken:o.pageToken}]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=new Date,"album"===s?[3,1]:[3,3];case 1:return[4,this._getPhotoRecordsForSingleAlbum(e,t,n)];case 2:return d=a.sent(),[3,5];case 3:return[4,this._getPhotoRecordsForAllPhotos(e,t,s,n,i,r,o)];case 4:d=a.sent(),a.label=5;case 5:return this._sendPerfPhotoRecordsTelemetry(c,1,d.length,e,s),[2,d]}})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,y,"folder")];case 1:return[2,a.sent()]}})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._makeQuery=function(e,t,n,i,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,c,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return s="allPhotos.".concat(t,".").concat(n,".").concat(i),(null==o?void 0:o.indexOf("/_api/v2.1"))>=0&&(s+=".V2"),c={apiName:s,path:e,useAuthorizationHeaders:!0,endpoint:o},u=[],Object(d.isFeatureEnabled)(d.AllowTestPhotoNotification)&&(f=this._itemCacheStore.dispatch(Object(m.e)()),Object(l.k)(f)&&u.push("testphotonotification")),this._shouldEnableUtilityFiltering(t,r)&&u.push("applyRecommendationHeuristics"),u.length>0&&(c.headers={prefer:u.join(", ")}),[4,this._vroomDataRequestor.send(c).catch(function(t){throw new Error("error loading "+e)})];case 1:return[2,a.sent()]}})})},e.prototype._shouldEnableUtilityFiltering=function(e,t){switch(e){case"onthisday":return!0;case"onthismonth":return!t||Object(f.e)(t).applyUtilityFiltering;case"lastweekpreviousyears":return!t||Object(p.e)(t).applyUtilityFiltering;default:return!1}},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfullGroupToCountPageSizeIndex,a.label=1;case 1:if(!(o<v.length))return[3,6];s=T(v[o],e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(s,e,S,y,t)];case 3:return c=a.sent(),this._successfullGroupToCountPageSizeIndex=o,[2,c];case 4:return d=a.sent(),r=d,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=i?parseInt(i,10):1,[4,this._getGroupCountWithVariablePageSize(e,t,n,o)];case 1:return s=a.sent(),c=s.value.length>0&&s["@odata.nextLink"],d=s.value,l=d.length,u=c?(o+l).toString():void 0,[4,R(d,e,t,u,r)];case 2:return(f=a.sent())&&f.dates&&f.dates.length>0&&(p=f.dates[f.dates.length-1])&&this._sendLastMediaDateTelemetry(p,e),[2,f]}})})},e.prototype._reduceGroupToCount=function(e,t,n,a){return Object(i.a)(e.counts,t,n,a),{counts:e.counts}},e.prototype._getGroupToCountForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._makeQuery(U(t,n),e,S,y,t)];case 1:return i=a.sent(),r=i.bundle.childCount,o=[i.name,i.name,i.name],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[],pageToken:void 0}]}})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,u,f,p,m,_,h,b,v,y;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=e+1,0===e&&(this._photosNextLinkSkipToken={}),u=this._indexToDateMapper.calculateDateAndOffsetOfIndex(n,i,e),f=u.date,p=u.index,m=new Date("01/01/1900"),f&&void 0!==p&&(c-=p),_=this._getServerSkipToken(e,n,i),h=Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M),[4,this._makeQuery(P(c,t-e,n,i,r,o,f,m,_),n,"records",s,i,h?Object(l.l)({apiVersion:"v2.1",driveId:"me"}):void 0)];case 1:if(!(b=a.sent()))throw new Error("Did not receive a response while requesting photos for the CoreApi");if(b.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return v=b["@odata.nextLink"],this._storeServerSkipToken(t,v,n,i),y=[],b.value.map(function(e){y.push(function(e){var t=[];e.thumbnails&&e.thumbnails[0]&&(t=[F(e.thumbnails[0].small),F(e.thumbnails[0].medium),F(e.thumbnails[0].large)]);var n=e.location;return{id:e.id,thumbnails:t,name:e.name||e.id,location:n?n.address:void 0,dateTakenTime:H(e),isVideo:!1,driveItem:e}}(e))}),[2,y]}})})},e.prototype._storeServerSkipToken=function(e,t,n,a){if(t&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)){var i=t.split("$skiptoken=");if(2===i.length){this._photosNextLinkSkipToken[n+a]||(this._photosNextLinkSkipToken[n+a]={});var r=i[1];Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M)&&(r=r.split("&")[0]),this._photosNextLinkSkipToken[n+a][e]=r}}},e.prototype._getServerSkipToken=function(e,t,n){return this._photosNextLinkSkipToken[t+n]&&this._photosNextLinkSkipToken[t+n][e]&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)?this._photosNextLinkSkipToken[t+n][e]:""},e.prototype._getGroupToCountForMOJ=function(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=this._itemCacheStore.dispatch(Object(b.e)(function(e){return e.demandItemFacet(h.e,_.e)})),s=o&&o.isEnableMonthRecapGroupHeaderExpOn(),[4,this._getGroupToCountForAllPhotos(r,e,t,n,s)];case 1:return c=a.sent(),(d=c.counts).forEach(function(e){e.headers&&e.headers.length>=3&&(e.headers=[e.headers[2],e.headers[2],e.headers[2]]),e.labels&&e.labels.length>=3&&(e.labels=[e.labels[2],e.labels[2],e.labels[2]])}),"lastweekpreviousyears"===r&&Object(i.n)(d),"onthismonth"===r&&Object(f.e)(e).applyUtilityFiltering&&!s&&Object(i.a)(d,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),l=d.reduce(function(e,t){return e+t.count},0),this._logTelemetry("AllPhotos.ElementsCount",{count:l},r),[2,{counts:d,pageToken:c.pageToken}]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){throw new Error("Not implemented")})})},e.prototype._logTelemetry=function(e,t,n){this._engagement&&this._engagement.logData({name:(s.e[n]||"unknown")+"."+e,extraData:t})},e.prototype._sendGroupToCountPerfTelemetry=function(e,t,n){var a=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:a,groups:t,requests:1},n)},e.prototype._sendPerfPhotoRecordsTelemetry=function(e,t,n,a,i){var r=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:r,count:n,requests:t,skip:a,api:"vroom"},i)},e.prototype._sendLastMediaDateTelemetry=function(e,t){var n=e.toISOString();this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:n},t)},e}();function x(e,t){var n,a,i,r="/drives/"+t+"/items/root/items?$filter=photo+ne+null",s=e.split(o.e),c=null===(n=s[0])||void 0===n?void 0:n.replace(/'/g,"''"),d=null===(a=s[1])||void 0===a?void 0:a.replace(/'/g,"''"),l=null===(i=s[2])||void 0===i?void 0:i.replace(/'/g,"''");return c&&(r+="+and+location/address/countryOrRegion+eq+'"+c+"'"),d&&(r+="+and+location/address/state+eq+'"+d+"'"),l&&(r+="+and+location/address/city+eq+'"+l+"'"),r}function C(e,t){return"/drives/"+t+"/items/root/items?$filter=photo+ne+null+and+tags/any(tag:tag/name+eq+'"+e+"')"}function O(e,t){var n="",a="";if(e){var i=new Date(e);i.setUTCHours(23,59,59,999),n="+and+photo/takenDateTime+le+"+i.toISOString()}if(t){var r=new Date(t);r.setUTCHours(0,0,0,0),a="+and+photo/takenDateTime+ge+"+r.toISOString()}return n+a}function w(e,t,n,a){return"/drives/"+t+"/items/"+e+"/items?filter=photo+ne+null"+O(n,a)}function E(e,t,n,a){var i=Object(u.e)(e),r=i.date,o=i.resourceId,s=new Date(Date.now()),c=r.getFullYear()%4==0&&r.getFullYear()%100!=0||r.getFullYear()%400==0,d=1===r.getMonth()&&29===r.getDate();if(s.getFullYear()===r.getFullYear()){var l=c&&d?r.getFullYear()-4:r.getFullYear()-1;r.setFullYear(l)}var f=k(r);return"/drives/"+t+"/items/"+o+"/items?filter=photo+ne+null"+O(f,f)+"&interval=R/P1Y"}function A(e,t){var n=Object(f.e)(e),a=n.date,i=n.resourceId,r=new Date(Date.UTC(a.getFullYear(),a.getMonth(),1));return"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(new Date(Date.UTC(a.getFullYear(),a.getMonth()+1,0)),r)+"&interval=R1/P1Y"}function L(e,t){var n=Object(p.e)(e),a=n.date,i=n.resourceId;if(new Date(Date.now()).getFullYear()===a.getFullYear()){var r=a.getFullYear()-1;a.setFullYear(r)}var o=k(a),s=k(a);return s.setDate(s.getDate()+6),"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(s,o)+"&interval=R/P1Y"}function k(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0))}function M(e,t){var n="";return e>1&&(n="&skiptoken="+e+"/"+t),n}function P(e,t,n,a,i,r,o,s,c){var d="";switch(n){case"folder":d=w(a,i,o,s);break;case"place":d=x(a,i);break;case"tag":d=C(a,i);break;case"onthisday":d=E(a,i);break;case"onthismonth":d=A(a,i);break;case"lastweekpreviousyears":d=L(a,i)}return(d+="&orderby=photo/takenDateTime+desc&expand=tags,thumbnails&top="+t)+(c?"&skiptoken="+c:M(e,r))}function T(e,t,n,a,i){var r="";switch(t){case"folder":r=w(n,a);break;case"place":r=x(n,a);break;case"tag":r=C(n,a),r+="&expand=tags";break;case"onthisday":r=E(n,a);break;case"onthismonth":r=A(n,a);break;case"lastweekpreviousyears":r=L(n,a)}return(r+="&orderby=photo/takenDateTime+desc&apply=groupby((photo/takenDateTime),aggregate(id+with+countdistinct+as+totalCount))&top="+e)+M(i,i)}function U(e,t){return"/drives/"+t+"/bundles/"+e}function F(e){return e?{url:e.url,width:e.width,height:e.height}:{url:"",width:0,height:0}}function H(e){var t=new Date;if(e.photo&&e.photo.takenDateTime)t=new Date(e.photo.takenDateTime);else if(e.photo&&e.photo.alternateTakenDateTime)t=new Date(e.photo.alternateTakenDateTime);else{var n=[];e.fileSystemInfo&&e.fileSystemInfo.createdDateTime&&n.push(new Date(e.fileSystemInfo.createdDateTime).getTime()),e.fileSystemInfo&&e.fileSystemInfo.lastModifiedDateTime&&n.push(new Date(e.fileSystemInfo.lastModifiedDateTime).getTime()),e.createdDateTime&&n.push(new Date(e.createdDateTime).getTime()),e.lastModifiedDateTime&&n.push(new Date(e.lastModifiedDateTime).getTime()),n.length>0&&(t=new Date(Math.min.apply(Math,n)))}return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function R(e,t,n,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:s={counts:[],dates:[],pageToken:r},d=0,a.label=1;case 1:return d<e.length?(function(e,t,n,a,r,o,s){for(var c=Math.min(t+25,e.length),d=t;d<c;++d){var l=e[d],u=new Date(l.photo.takenDateTime);a.counts.push(Object(i.e)(u,l.totalCount,r,o,s)),a.dates.push(u)}}(e,d,0,s,t,n,o),[4,Object(c.t)(0)]):[3,4];case 2:a.sent(),a.label=3;case 3:return d+=25,[3,1];case 4:return[2,s]}})})}},2285:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(143),i=n(1833),r=n(1834),o=n(11);function s(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.EnableNewCarouselDesign)||Boolean(t&&t.isEnableNewCarouselDesignExpOn())}}},2286:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0),i=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return Object(a.__extends)(t,e),t.prototype.apply=function(e){return void 0===e&&(e=this._value),e},t}(n(68).t)},2300:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1),i=n(101);function r(){return{width:window.innerWidth,height:window.innerHeight}}function o(){var e=Object(a.useState)(r()),t=e[0],n=e[1];return Object(a.useEffect)(function(){function e(){n(r())}var t=new i.t(window);return t.on(window,"resize",e,!0),function(){t.off(window,"resize",e,!0)}},[]),t}},2303:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(14),r=new a.e("requestResponseBatchKey",{driveId:i.e,endpoint:i.e})},2307:function(e,t,n){"use strict";n.d(t,"e",function(){return V});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(1112),c=n(809),d=n(30),l=n(14),u=new d.e("placeSet",{placesRootKeyPart:c.e.subKeyPart,filter:l.e}),f=n(576),p=n(7),m=n(19),_=n(89),h=n(0),b=n(382),g=n(107),v=n(2097),y=n(1007),S=n(137),D=n(286),I=n(983);function x(e){var t=e&&e.address;return[t&&t.countryOrRegion,t&&t.countryOrRegion,t&&t.countryOrRegion].join(I.t)}var C=n(2119),O=n(1942);function w(e,t,n,a,i){var r=[];return e&&r.push(e),t&&r.push(t),n&&r.push(n),a&&r.push(a),r.length>1?r[0]+", "+r[r.length-1]:i||""}var E=n(2791),A=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=c.e.deserialize(n),i=a.driveId,r=a.endpoint,o=v.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,l,v,I,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z,$;return Object(h.__generator)(this,function(ee){switch(ee.label){case 0:return t=Date.now(),s={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/view.listLocations")},[4,e(Object(g.t)(s))];case 1:return c=ee.sent().value,d=Date.now()-t,l=Date.now(),v=function(e){var t=[];if(e&&e.length){for(var n=e[0].location&&e[0].location.address&&e[0].location.address.countryOrRegion||"",a={displayName:n,places:[]},i=0,r=e;i<r.length;i++){var o=r[i],s=o.location&&o.location.address&&o.location.address.countryOrRegion||"";n!==s&&(t.push(a),a={displayName:n=s,places:[]}),a.places.push(o)}t.push(a)}return t}(c),I=new b.e,A=[],[4,e(Object(y.e)(function(e){return e.demandItemFacet(m.e,o)}))];case 2:for((L=ee.sent())&&0===L.itemKeys.length||A.push(o),k=0,M=v;k<M.length;k++){for(P=M[k],T={placesRootKeyPart:{driveId:i,endpoint:r},filter:P.displayName},U=u.serialize(T),F=[],H=0,R=P.places;H<R.length;H++)N=R[H],B=N.location&&N.location.address,j=B&&B.countryOrRegion?B.countryOrRegion:"",V=B&&B.state?B.state:"",z=B&&B.locality?B.locality:"",G=B&&B.city?B.city:"",K=f.e.serialize({placesRootKeyPart:a,countryOrRegion:j,state:V,locality:z,city:G}),W=w(G,z,V,"",null===($=N.location)||void 0===$?void 0:$.displayName),q=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(N.location),filterType:"place"}),Q=N.previewThumbnails&&Object(C.e)(N.previewThumbnails),I.resolveItems({items:(J={},J[K]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(W)),m.t.pack({itemKey:q})),_.h.pack(Q)),J)}),F.push(K);I.resolveItems({items:(X={},X[U]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.displayName)),m.e.pack({itemKeys:F})),X)}),A.push(U)}return I.resolveItems({items:(Z={},Z[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(E.e)),m.e.pack({itemKeys:A})),Z)}),e(I.execute()),Y=Date.now()-l,e(Object(O.e)({name:"Places.GetAllPlaces",extraData:{fetchTimeMs:d,processTimeMs:Y,placesCount:(null==c?void 0:c.length)||0,groupsCount:v.length}})),[2]}})})}}),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=u.deserialize(n).placesRootKeyPart,i=c.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){return Object(h.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(y.e)(function(e){e.demandItemFacet(m.e,i)}))];case 1:return t.sent(),[2]}})})}}),k=n(990),M=Object(a.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,a=f.e.deserialize(n),i=a.placesRootKeyPart,o=a.countryOrRegion,s=a.state,c=a.city,d=i.driveId,l=i.endpoint;return o=null==o?void 0:o.replace(/'/g,"''"),s=null==s?void 0:s.replace(/'/g,"''"),c=null==c?void 0:c.replace(/'/g,"''"),function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,a,i,u,f,p,b,v,y;return Object(h.__generator)(this,function(I){switch(I.label){case 0:return t="photo ne null",t+=o?" and location/address/countryOrRegion eq '".concat(o,"'"):"",t+=s?" and location/address/state eq '".concat(s,"'"):"",t+=c?" and location/address/city eq '".concat(c,"'"):"",a=Object(k.e)({filter:t,orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:1,select:"id,thumbnails,location"}),i={qosName:"allPlaces",endpoint:l,driveId:d,url:"".concat(l,"/drives/").concat(d,"/items/root/items?").concat(a)},[4,e(Object(g.t)(i))];case 1:return u=I.sent().value,f=u&&u.length&&u[0].thumbnails&&u[0].thumbnails[0],p=f&&f.medium?{url:f.medium.url,width:f.medium.width,height:f.medium.height}:void 0,b=u[0]&&u[0].location,v=S.e.serialize({photosRootKeyPart:{driveId:d,endpoint:l},groupBy:D.e.Date,filter:x(b),filterType:"place"}),e(Object(r.e)({items:(y={},y[n]=Object(h.__assign)(Object(h.__assign)({},_.h.pack(p)),m.t.pack({itemKey:v})),y)})),[2]}})})}}),P=n(2792),T=n(440),U=n(55),F=n(369),H=n(1103),R=n(2033),N=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=v.e.deserialize(n),i=a.driveId,r=a.endpoint;return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,l,u,v,y,I,C,O,E,A,L,M,N,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue;return Object(h.__generator)(this,function(fe){switch(fe.label){case 0:return t=Object(k.e)({filter:"photo ne null",orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:100,select:"id,thumbnails,location"}),o={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/items/root/items?").concat(t)},[4,e(Object(g.t)(o))];case 1:if(s=fe.sent().value,c=[],d=new Map,l=new Map,u=new Map,v=0,s&&s.length)for(y=0;v<2&&y<s.length;y++)(I=s[y])&&I.location&&I.location.displayName&&I.location.latitude&&I.location.longitude&&((C=u.get(I.location.displayName))||u.set(I.location.displayName,I),O=l.get(I.location.displayName),E=O?O+1:1,l.set(I.location.displayName,E),3===E&&(v++,C&&d.set(I.location.displayName,C)),d.has(I.location.displayName)||d.set(I.location.displayName,I));if(A=Array.from(d.values()),L=A[0],M=A.slice(1),L){for(N=0,V=M;N<V.length;N++)if(z=V[N],G=L.location,K=null==z?void 0:z.location,z&&B(G)&&B(K)&&j(G,K,50)){c.push(z);break}c.unshift(L)}for(W=new b.e,q=[],Q=0,Y=c;Q<Y.length;Q++)J=Y[Q],X=J.location&&J.location.address,Z=X&&X.countryOrRegion?X.countryOrRegion:"",$=X&&X.state?X.state:"",ee=X&&X.locality?X.locality:"",te=X&&X.city?X.city:"",ne=f.e.serialize({placesRootKeyPart:a,countryOrRegion:Z,state:$,locality:ee,city:te}),ae=w(te,ee,$,Z,null===(ue=J.location)||void 0===ue?void 0:ue.displayName),ie=J.thumbnails&&J.thumbnails.length&&J.thumbnails[0],re=ie&&ie.medium?{url:ie.medium.url,width:ie.medium.width,height:ie.medium.height}:void 0,oe=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(J.location),filterType:"place"}),se=F.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),ce=H.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),W.resolveItems({items:(de={},de[ne]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[se]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[ce]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),R.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de)}),q.push(ne);return W.resolveItems({items:(le={},le[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.e)),m.e.pack({itemKeys:q})),le)}),e(W.execute()),[2]}})})}});function B(e){return Boolean((null==e?void 0:e.latitude)&&e.longitude)}function j(e,t,n){var a=Math.PI/180,i=(t.latitude-e.latitude)*a,r=(t.longitude-e.longitude)*a,o=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(e.latitude*a)*Math.cos(t.latitude*a);return 3959*Math.asin(Math.sqrt(o))*2>=n}var V=Object(a.t)(function(){return function(e){e(s.e),e(Object(r.t)({keyFacet:c.e,facets:[m.e]})),e(Object(r.t)({keyFacet:u,facets:[p.u,m.e]})),e(Object(r.t)({keyFacet:f.e,facets:[p.u,_.h]})),e(Object(i.a)(c.e,o.e)(A)),e(Object(i.a)(f.e,o.e)(M)),e(Object(i.a)(u,o.e)(L)),e(Object(i.a)(v.e,o.e)(N))}})},2313:function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1109),_=n(1885),h=n(1884),b=n(286),g=n(1007),v=n(1816),y=n(1864),S=n(137),D=n(1775),I=n(143),x=n(812),C=n(55),O=n(2033),w=n(1103),E=n(2285),A=n(299),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=e.options.demands,i=m.e.deserialize(n),o=new Date(i.date);return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,m,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y;return Object(f.__generator)(this,function(J){switch(J.label){case 0:return M=Object(x.t)(o,i.resourceId),(P=e(Object(I.e)(function(e){return e.demandItemFacet(D.e,D.t)})))?(T=e(Object(I.e)(function(e){return{hasCount:e.isItemFacetResolved(d.e,n),hasThumbnail:e.isItemFacetResolved(l.h,n)}})),U=T.hasCount,F=T.hasThumbnail,H="carousel",F&&U&&(H="carouselDupeCall"),[4,P.getPhotoRecords(0,1,M,i.driveId,1,H,"onthisday")]):[2];case 1:return R=J.sent(),(N=R&&R.length>0?null===(Y=R[0])||void 0===Y?void 0:Y.driveItem:void 0)&&(B=N.thumbnails[0],(j=B.large||B.medium||B.small)&&(t={url:j.url,width:j.width,height:j.height}),m=o.toString(),L=o),void 0!==m&&L?(V=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),z=new p.e,G=i.driveId,K=i.endpoint,W=w.e.serialize({driveId:G,endpoint:K,type:C.e.OnThisDay,resourceId:"root",key:n}),z.resolveItems({items:(q={},q[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:L,maxDate:L})),s.t.pack({itemKey:V})),q[W]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),O.e.pack(C.e.OnThisDay)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:V})),q)}),e(z.execute()),e(Object(E.e)())?[3,3]:a[d.e.id]?[4,e(Object(g.e)(function(e){var t=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),n=y.e.serialize({photosRootItemSetKeyPart:S.e.deserialize(t)});return e.demandItemFacet(v.a,n)}))]:[3,3]):[3,3];case 2:k=J.sent(),e(Object(r.e)({items:(Q={},Q[n]=Object(f.__assign)({},d.e.pack(k)),Q)})),J.label=3;case 3:return[2]}})})}}),k=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(L))}})},2314:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1110),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(818),D=n(42),I=n(299),x=n(55),C=n(2033),O=n(1103),w=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(a.date),o=new Date(Date.UTC(r.getFullYear(),r.getMonth()+1,0));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,r,d,m,w,E,A,L,k,M,P,T,U,F,H,R,N;return Object(f.__generator)(this,function(B){switch(B.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),w=new p.e,E=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"onthismonth"}),(A=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,A.getPhotoRecords(0,3,m,a.driveId,3,"carousel","onthismonth")]:[2];case 1:return L=B.sent(),k=L.find(function(e){return e.isVideo}),L.length<3&&!k||((M=L&&L.length>0?null===(N=L[0])||void 0===N?void 0:N.driveItem:void 0)&&(P=M.thumbnails[0],(T=P.large||P.medium||P.small)&&(t={url:T.url,width:T.width,height:T.height}),r=D.format(I.u,i.toLocaleString("default",{month:"long"})),d=i),U=a.driveId,F=a.endpoint,H=O.e.serialize({driveId:U,endpoint:F,type:x.e.OnThisMonth,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==r&&d&&(w.resolveItems({items:(R={},R[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:o})),s.t.pack({itemKey:E})),R[H]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),C.e.pack(x.e.OnThisMonth)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:E})),R)}),e(w.execute()))),[2]}})})}}),E=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(w))}})},2315:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1111),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(819),D=n(299),I=n(55),x=n(1103),C=n(2033),O=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()+6));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,o,d,m,O,w,E,A,L,k,M,P,T,U,F,H,R;return Object(f.__generator)(this,function(N){switch(N.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),O=new p.e,w=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"lastweekpreviousyears"}),(E=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,E.getPhotoRecords(0,3,m,a.driveId,3,"carousel","lastweekpreviousyears")]:[2];case 1:return A=N.sent(),L=A.find(function(e){return e.isVideo}),A.length<3&&!L||((k=A&&A.length>0?null===(R=A[0])||void 0===R?void 0:R.driveItem:void 0)&&(M=k.thumbnails[0],(P=M.large||M.medium||M.small)&&(t={url:P.url,width:P.width,height:P.height}),o=D.c,d=i),T=a.driveId,U=a.endpoint,F=x.e.serialize({driveId:T,endpoint:U,type:I.e.LastWeekPreviousYears,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==o&&d&&(O.resolveItems({items:(H={},H[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:r})),s.t.pack({itemKey:w})),H[F]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),C.e.pack(I.e.LastWeekPreviousYears)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:w})),H)}),e(O.execute()))),[2]}})})}}),w=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(O))}})},2325:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("galleryHeader",{label:a.t,count:a.t,dateRange:a.t})},2326:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return c});var a=n(2),i=n(559),r=n(919),o=new a.e("updateTags"),s=new i.e("updateTags"),c=Object(r.e)({operationTypeFacet:o,progressKeyFacet:s})},2327:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(42);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},2339:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1),i=n(601);function r(e,t){var n=a.useRef(t);return n.current||(n.current=Object(i.e)(e)),n.current}},2364:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(8),i=n(25),r=n(1104),o=n(342),s=n(16),c=new a.t({name:"ItemsScopeCurrentItemKey.key",factory:{dependencies:{viewParamsObservable:i.T,itemCacheObservablesFactory:r.e},create:function(e){var t=e.viewParamsObservable,n=e.itemCacheObservablesFactory.pureCompute(function(e){var n=e.demandItemFacet(o.e,s.a);return o.e.evaluate(n)(e,{viewParams:t(),isNavigation:!0}).itemKey});return{instance:n,disposable:n}}}})},2365:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return c});var a=n(1743);function i(e){return Object(a.i)(e,!1,!1,!1,{displayHoursInDates:!1,displayHoursToOneDay:!1,displayMinutesToOneHour:!1,displayShortenedWeekday:!1})}var r=Object(a.t)({month:"short",day:"numeric",year:"numeric"}),o=Object(a.t)({month:"long",year:"numeric"}),s=Object(a.t)({month:"short",year:"numeric"}),c=Object(a.t)({month:"long",day:"numeric"})},2366:function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(56),o=n(2078),s=n(2160),c=n(1799),d=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.extractSharedAlbumsFromItemSet=function(e){for(var t=this,n=[],a=0,i=e.content.peek().items;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);o.isAlbum&&o.ownerId!==c.t.viewerId&&n.push(r)}return n.sort(function(e,n){return t.peekUnwrapObservable(n).dateSharedTime.getTime()-t.peekUnwrapObservable(e).dateSharedTime.getTime()})},t.prototype.getTagsAndPlaces=function(e,t){for(var n=[],a={},i=[],r={},o=0;o<100;o++){var s=e[o];if(!s)break;var c=s.peek(),d=c.tags&&c.tags.length>0,l=c.geoLocation&&c.geoLocation.hierarchyIndex;d&&l?Math.random()<.5?this._makeTagEntry(c,a,n,t):this._makePlaceEntry(c,r,i,t):d?this._makeTagEntry(c,a,n,t):l&&this._makePlaceEntry(c,r,i,t)}return{tags:n,places:i}},t.prototype._makePlaceEntry=function(e,t,n,a){var i=e.geoLocation,r=i&&i.hierarchyIndex;if(r&&e.thumbnail){var o=t[r];if(!o){var s=this._makePlace(i,a);o=t[r]=s,n.push(s)}var c=o.peek();c.folder.covers?c.folder.covers.push(e.thumbnail):c.folder.covers=[e.thumbnail],o(c)}},t.prototype._makeTagEntry=function(e,t,n,a){var i=e.tags[Math.floor(Math.random()*e.tags.length)],r=t[i.tag];if(!r){var o=this._makeTag(i,a);r=t[i.tag]=o,n.push(o)}var s=r.peek();s.folder.covers?s.folder.covers.push(e.thumbnail):s.folder.covers=[e.thumbnail],r(s)},t.prototype._makeTag=function(e,t){var n={count:0,localizedTag:e.localizedTag,tag:e.tag};return i.observable(s.n(o.e.allTags,n,null,t))},t.prototype._makePlace=function(e,t){return i.observable(s.n(o.e.allPlaces,null,e,t))},t}(r.n);t.e=d},2367:function(e,t,n){"use strict";var a=n(0),i=n(60),r=n(56),o=n(61),s=n(95),c=n(2098),d=n(1740),l=n(36),u=n(11),f=n(1087),p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._promotedPhotosDataSource=n.resources.consume(o.Q),n._albumProvider=n.resources.consume(c.resourceKey),n._photoProvider=n.resources.consume(s._),n._itemProvider=n.resources.consume(d.resourceKey),n._urlDataSource=n.resources.consume(o.Se),n}return Object(a.__extends)(t,e),t.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&f.r(t)||!Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})},t.prototype.getTagsAndPlaces=function(e){var t=this,n=this._photoProvider.getAllPhotosSync(e);return this._photoProvider.getAllPhotosForPage(e).then(function(){var a=n.content().items;return t._promotedPhotosDataSource.getTagsAndPlaces(a,e)})},t.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var n={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},a=this._photoProvider.getAllPhotosSync(n),r=a.item,o=r.peek();return a.isPlaceholder||a.isExpired||o.isPlaceholder?this._photoProvider.getOnThisDayPhotos(n).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):o.folder.covers.length?i.n.wrap([r]):i.n.wrap([])},t.prototype.getSharedAlbums=function(){var e=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(l.e.SharedWithMe)}).then(function(t){return e._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(t)})},t}(r.n);t.e=p},2399:function(e,t,n){"use strict";n.d(t,"e",function(){return xn});var a=n(0),i=n(28),r=n(201),o=n(209),s=n(311),c=n(379),d=n(654),l=n(9),u=n(274),f=n(137),p=n(1864),m=n(30),_=n(14),h=n(547),b=new m.e("allPhotosGroupToCountItemPageFacet",{groupToCountsItemKeyPart:p.e.subKeyPart,pageToken:_.e,offset:h.e}),g=n(1890),v=n(1940),y=n(1163),S=n(143),D=n(382),I=n(70),x=n(234),C=n(797),O=n(1816),w=n(1957),E=new m.e("widthsItemKeyFacet",{photosRootItemSetKeyPart:f.e.subKeyPart}),A=n(1775),L=n(2142),k=n(2052),M=n(19),P=n(672),T=n(627),U=n(2),F=n(1540),H=n(135),R=n(1271);function N(e,t){var n=0,a=[],i=[],r=Object(x.e)();if(p.e.matches(t))for(var o=p.e.deserialize(t).photosRootItemSetKeyPart,s=0;s<e.length;++s){var c=e[s];a.push(n),n+=c.count;var d=g.e.serialize({photosRootItemSetKeyPart:o,id:c.id});i.push(d),r=r.forFacet(M.e).thenInvalidate(d,M.e)}return{groupKeys:i,totalPhotoCount:n,groupToStart:a,invalidationFacet:r}}function B(e,t,n,i,o){var s,c,d,l,u;void 0===o&&(o=[]);var m=new D.e,_=n.counts;if(p.e.matches(t)){var h=p.e.deserialize(t).photosRootItemSetKeyPart,y=i+_.length,x=o.slice(0,i);if(x=x.concat(_),n.pageToken){var C=_[_.length-1],w=C.id,E=-1;if(C)for(var L=i;L<o.length-1;L++)if(o[L].id===w){E=L+1;break}y=E>=0?E:y,x=x.concat(o.slice(y))}var k=N(x,t),B=k.groupKeys,j=k.totalPhotoCount,V=k.groupToStart,z=k.invalidationFacet;if(n.pageToken){var G=b.serialize({groupToCountsItemKeyPart:{photosRootItemSetKeyPart:h},pageToken:n.pageToken,offset:y});m.merge(Object(P.t)({itemKey:G}).itemResolver),m.resolveItems({items:(s={},s[t]=Object(a.__assign)({},M.e.pack({itemKeys:[G]})),s)})}else m.resolveItems({items:(c={},c[t]=Object(a.__assign)({},M.e.pack({itemKeys:[]})),c)});var K=e(Object(S.e)(function(e){return e.demandItemFacet(A.d,r.e)})),W=f.e.serialize(h);if(m.resolveItems({items:(d={},d[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(x)),O.a.pack(j)),O.n.pack(V)),d[W]=K?Object(a.__assign)({},I.e.pack(j)):Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},I.e.pack(x.length)),M.e.pack({itemKeys:B})),z.pack()),d)}),K){if(_.length>0||n.pageToken){var q=f.e.serialize(h);e(Object(T.e)({items:(l={},l[q]=[O.t],l)}))}}else{var Q=function(e,t,n,a,i){for(var r=[],o=a;o<a+i;++o)Object(R.e)(e[o],t[o])||r.push(n[o]);return r}(x,o,B,i,y-i);m.invalidateItems({items:Object(H.e)(Q,function(){return[M.e]})});var Y=e(Object(S.e)(function(e){return e.demandItemFacet(M.e,f.e.serialize(h))}));if(Y){var J=Y.itemKeys.length-1,X=Y.itemKeys[J],Z=x[J],$=e(Object(S.e)(function(e){if(e.isItemFacetResolved(I.e,X))return e.demandItemFacet(I.e,X)}));if($&&Z&&$<Z.count&&g.e.matches(X)){var ee=g.e.deserialize(X);if(ee.id===Z.id){var te=v.e.serialize({groupKeyPart:ee,offset:$+V[J],count:Z.count-$});m.resolveItems({items:(u={},u[X]=Object(U.t)({childItems:M.e},{childItems:{itemKeys:new F.e([te])}}),u)})}else console.warn("GroupToCount patching groups did not match indicies!")}}}}else console.warn("Key ",t," was not a valid AllPhotosGroupToCountItemKey. Unable to resolve GroupToCount!");return m}var j=n(2118),V=new U.e("PhotoRotation"),z=n(7),G=n(89),K=n(929),W=n(578),q=n(47),Q=n(403),Y=n(2119);function J(e,t,n){return n.driveItem?X(e,t,n.driveItem):Z(e,t,n)}function X(e,t,n){return function(i){var r,o=new D.e({publisher:X});if(l.e.matches(e)){var s=l.e.deserialize(e),c=s.driveId,d=s.endpoint,u=void 0;n.parentReference&&(u=l.e.serialize({itemId:n.parentReference.id,driveId:c,endpoint:d})),o.merge(i(Object(W.e)({itemKey:e,driveItemKey:{endpoint:d,driveId:c,itemId:n.id},driveItem:n,endpoint:d,parentFolderItemKey:u})).itemResolver);var f=n.thumbnails?Object(Y.e)(n.thumbnails):void 0,p=void 0;n.location&&(p=Object(a.__assign)(Object(a.__assign)({},n.location.address?n.location.address:{}),{longitude:n.location.longitude,altitude:n.location.altitude,latitude:n.location.latitude}));var m=n.photo||n.remoteItem&&n.remoteItem.photo,_=n.video||n.remoteItem&&n.remoteItem.video,h=_&&void 0!==_.audioBitsPerSample&&void 0!==_.audioChannels&&_.audioFormat&&void 0!==_.audioSamplesPerSecond,b=function(e){var t=void 0;if(e.photo&&e.photo.takenDateTime)t=new Date(e.photo.takenDateTime).getTime();else{var n=[];e.fileSystemInfo&&e.fileSystemInfo.createdDateTime&&n.push(new Date(e.fileSystemInfo.createdDateTime).getTime()),e.fileSystemInfo&&e.fileSystemInfo.lastModifiedDateTime&&n.push(new Date(e.fileSystemInfo.lastModifiedDateTime).getTime()),e.createdDateTime&&n.push(new Date(e.createdDateTime).getTime()),e.lastModifiedDateTime&&n.push(new Date(e.lastModifiedDateTime).getTime()),n.length>0&&(t=Math.min.apply(Math,n))}return t}(n),g=n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime,v=n.tags;o.resolveItems({items:(r={},r[e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack({itemId:n.id,driveId:c,endpoint:d})),z.u.pack(n.name)),z.p.pack(Object(W.t)(n.name?n.name:"",!1))),V.pack(void 0)),M.t.pack({itemKey:q.e.serialize({driveItemKey:l.e.deserialize(e),sortBy:"",isAscending:!0})})),Q.e.pack(n["@microsoft.graph.downloadUrl"]||n["@content.downloadUrl"])),Object(x.e)().forFacet(M.t).thenInvalidate(e,V).forFacet(M.t).thenInvalidate(e,z.u).forFacet(M.t).thenInvalidate(e,G.h).forFacet(G.h).thenInvalidate(t,M.e).forFacet(V).thenInvalidate(t,M.e).pack()),f?G.h.pack(f):{}),j.e.pack(p)),n.image?G.d.pack({height:n.image.height?n.image.height:0,width:n.image.width?n.image.width:0}):{}),n.video&&!n.image?G.d.pack({height:n.video.height?n.video.height:0,width:n.video.width?n.video.width:0}):{}),m?G.m.pack({}):{}),m&&m.cameraMake?G.o.pack(m.cameraMake):{}),m&&m.cameraModel?G.s.pack(m.cameraModel):{}),m&&m.fNumber?G.a.pack(m.fNumber):{}),m&&m.focalLength?G.i.pack(m.focalLength):{}),m&&m.exposureDenominator&&m.exposureNumerator?G.n.pack({denominator:m.exposureDenominator,numerator:m.exposureNumerator}):{}),m&&m.iso?G.r.pack(m.iso):{}),_?G.g.pack({}):{}),_&&_.bitrate?G.t.pack(_.bitrate):{}),_&&_.duration?G.l.pack(_.duration):{}),_&&_.frameRate?G.f.pack(_.frameRate):{}),_&&_.fourCC?G.u.pack(_.fourCC):{}),_&&h?G.b.pack({bitsPerSample:_.audioBitsPerSample||0,channels:_.audioChannels||0,format:_.audioFormat||"",samplesPerSecond:_.audioSamplesPerSecond||0}):{}),m&&m.livePhoto?G.p.pack({}):{}),m&&m.samsungMotionPhoto?G._.pack({}):{}),b?G.c.pack(b):{}),g?z.c.pack(new Date(g).getTime()):{}),v?K.e.pack(v):{}),r)})}return{itemResolver:o}}}function Z(e,t,n){return function(i){var r,o=new D.e({publisher:Z});if(l.e.matches(e)){var s=n.thumbnails&&n.thumbnails.length>0?n.thumbnails[n.thumbnails.length-1]:void 0,c=l.e.deserialize(e),d=c.driveId,u=c.endpoint;o.resolveItems({items:(r={},r[e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack({itemId:n.id,driveId:d,endpoint:u})),G.h.pack(s)),z.u.pack(n.name)),z.p.pack({name:n.name,extension:n.extension?n.extension:""})),void 0!==n.isVideo&&n.isVideo?G.g.pack({}):G.m.pack({})),Q.e.pack(n.originalUrl)),j.e.pack(n.location)),V.pack(void 0)),M.t.pack({itemKey:q.e.serialize({driveItemKey:l.e.deserialize(e),sortBy:"",isAscending:!0})})),G.c.pack(n.dateTakenTime.getTime())),Object(x.e)().forFacet(M.t).thenInvalidate(e,V).forFacet(M.t).thenInvalidate(e,z.u).forFacet(M.t).thenInvalidate(e,G.h).forFacet(V).thenInvalidate(t,M.e).pack()),r)})}return{itemResolver:o}}}var $=n(2053),ee=n(2146);function te(e,t,n,i,r){if(f.e.matches(e)&&g.e.matches(t)){var o=g.e.deserialize(t).id,s=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},g.e.pack({photosRootItemSetKeyPart:f.e.deserialize(e),id:o})),z.u.pack(o)),M.e.pack({itemKeys:n})),I.e.pack(n.length)),I.r.pack(!0)),Object(x.e)().forFacet(M.e).thenInvalidate(e,O.t).forFacet(M.e).thenInvalidate(e,M.e).forFacet(M.e).thenInvalidate(t,I.e).pack());return r&&(s=Object(a.__assign)(Object(a.__assign)({},s),$.e.pack({itemKey:r}))),i&&(s=Object(a.__assign)(Object(a.__assign)({},s),ee.e.pack({itemKey:i}))),s}return{}}var ne=n(2145),ae=n(2143),ie=n(2144),re=n(2286),oe=n(577),se=n(1885),ce=n(1941),de=n(2258),le=n(2671),ue=n(983),fe=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=f.e.deserialize(n),o=p.e.serialize({photosRootItemSetKeyPart:i}),s=E.serialize({photosRootItemSetKeyPart:i});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,d,l,u,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return t=e(Object(S.e)(function(e){return{targetHeight:e.demandItemFacet(A.s,A.t),usePhotoPaging:e.demandItemFacet(A.d,r.e)}})),c=t.targetHeight,d=t.usePhotoPaging,(l=new D.e).resolveItems({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f.e.pack(i)),z.u.pack(le.e)),O.t.pack({itemKey:o})),w.n.pack({itemKey:s})),I.r.pack(!0)),Object(x.e)().forFacet(O.t).thenInvalidate(o,O.e).forFacet(M.e).thenInvalidate(n,O.t).pack()),m[s]=Object(U.t)({widths:w.t,targetHeight:w.e},{widths:new re.e(Object(L.e)(0)),targetHeight:new re.e(c)}),m)}),l.merge(function(e){var t,n,i,r=f.e.deserialize(e),o=r.photosRootKeyPart,s=r.filter,c=r.filterType,d=new D.e,l=void 0;switch(c){case"folder":case"onthisday":case"onthismonth":case"lastweekpreviousyears":break;case"album":l=C.e.serialize({albumsRootKeyPart:o,id:s});break;case"tag":l=oe.e.serialize({tagsRootKeyPart:o,id:s}),d.resolveItems({items:(t={},t[l]=Object(a.__assign)({},z.u.pack(s)),t)});break;case"place":var u=s.split(ue.t).pop();d.resolveItems({items:(n={},n[e]=Object(a.__assign)({},z.u.pack(u)),n)})}return l&&d.resolveItems({items:(i={},i[e]=Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:l})),Object(x.e)().forFacet(M.e).thenInvalidate(l,I.e).forFacet(M.e).thenInvalidate(l,se.e).pack()),i)}),d}(n)),d?(l.merge(function(e,t,n){var i,r=new D.e,o=f.e.deserialize(t),s=e(Object(S.e)(function(e){var a=e.isItemFacetResolved(M.e,t);return{totalCount:e.demandItemFacet(O.a,n),pageSize:e.demandItemFacet(A.r,A.t),currentChildItems:a?e.demandItemFacet(M.e,t):void 0,mappedChildItems:a?e.demandItemFacet(de.e,t):void 0}})),c=s.currentChildItems,d=s.mappedChildItems,l=s.totalCount,u=s.pageSize,p=void 0!==c?c.itemKeys.slice():[];if(void 0===u)throw Error("Page size is not defined, we cannot generate page keys for photos itemset!");var m=0,_=p.length>0&&p[p.length-1];if(_)if(ce.e.matches(_)){var h=ce.e.deserialize(_);m=h.offset+h.count}else void 0!==d&&(m=d.length);if(void 0!==l)for(var b=m;b<l;b+=u){var g=ce.e.serialize({photosRootItemSetKeyPart:o,offset:b,count:Math.min(u,l-b)});p.push(g),r.merge(Object(P.t)({itemKey:g}).itemResolver)}else 0===m&&(g=ce.e.serialize({photosRootItemSetKeyPart:o,offset:0,count:u}),p.push(g),r.merge(Object(P.t)({itemKey:g}).itemResolver));return r.resolveItems({items:(i={},i[t]=Object(a.__assign)({},M.e.pack({itemKeys:p})),i)}),r}(e,n,o)),[3,3]):[3,1];case 1:return p=(u=l).merge,[4,pe(e,n,o,s,c)];case 2:p.apply(u,[_.sent()]),_.label=3;case 3:return e(l.execute()),[2]}})})}});function pe(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,u,p,m,_,h,b;return Object(a.__generator)(this,function(g){switch(g.label){case 0:return o=new D.e,s=f.e.deserialize(t),c=s.photosRootKeyPart,d=s.filter,u=s.filterType,p=e(Object(S.e)(function(e){var n=e.demandItemFacet(M.e,t),a=e.demandItemFacet(A.o,A.t),i=e.demandItemFacet(A.e,A.t);return{hasBurst:n&&n.itemKeys.length>0,burstSize:a,addonSrc:i}})),m=p.burstSize,_=p.addonSrc,h=p.hasBurst,_&&!h&&m&&r&&"folder"===u?[4,_.getPhotoRecordsForBurstMode(m,d,c.driveId)]:[3,2];case 1:(b=g.sent()).length>0&&o.merge(function(e,t,n,i,r,o){var s,c,d,u,p,m=Object(k.t)(n),_=function(e,t){var n=Object(L.e)(t.length);return t.map(function(t,a){var i=t.thumbnails[t.thumbnails.length-1];if(i){var r=Math.round(e*(i.width/i.height));n[a]=r}}),n}(i,n),h=N(m,r),b=h.groupKeys,g=h.totalPhotoCount,v=h.groupToStart,y=h.invalidationFacet,S=new D.e;if(S.resolveItems({items:(s={},s[r]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(m)),O.n.pack(v)),O.a.pack(g)),s[o]=Object(a.__assign)(Object(a.__assign)({},w.t.pack(_)),w.e.pack(i)),s)}),f.e.matches(t)){for(var x=f.e.deserialize(t),C=x.photosRootKeyPart,E=0,A=[{keys:[]}],P=0;P<n.length;++P){var T=n[P],U={itemId:T.id,driveId:C.driveId,endpoint:C.endpoint},F=l.e.serialize(U),H=v[E];P>=H&&P<H+m[E].count?A[E].keys.push(F):A[++E]={keys:[F]};var R=b[E],B=ae.e.serialize({driveItemKeyPart:Object(a.__assign)({},U),photosRootItemSetKeyPart:Object(a.__assign)({},x)}),j=ie.e.serialize({index:P,photosRootItemSetKeyPart:Object(a.__assign)({},x)});R&&(S.merge(e(J(F,R,T)).itemResolver),S.resolveItems({items:(c={},c[B]=Object(a.__assign)({},ne.e.pack({itemKey:R})),c[j]=Object(a.__assign)({},l.e.pack(U)),c)}),T.isVideo&&S.resolveItems({items:(d={},d[F]=Object(a.__assign)({},G.g.pack({})),d)}))}for(var V=0;V<b.length;V++)S.resolveItems({items:(u={},u[b[V]]=Object(a.__assign)({},te(t,b[V],A[V].keys,b[V-1],b[V+1])),u)});S.resolveItems({items:(p={},p[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},I.e.pack(m.length)),M.e.pack({itemKeys:b})),y.pack()),p)})}return S}(e,t,b,r,n,i)),g.label=2;case 2:return[2,o]}})})}var me=n(1007),_e=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=g.e.deserialize(n),r=i.photosRootItemSetKeyPart,o=i.id;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,s,c,d,l,u,p,m,_,h,b,y,S,I,x,C,w,E;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return t=f.e.serialize(r),[4,e(Object(me.e)(function(e){var n,a=e.demandItemFacet(A.r,A.t),i=e.demandItemFacet(O.t,t);return i&&(n=e.demandItemFacet(O.e,i.itemKey),e.demandItemFacet(M.e,i.itemKey)),{maxPageSize:a,groupToCount:n}}))];case 1:if(i=L.sent(),s=i.maxPageSize,(c=i.groupToCount)&&s){for(d=void 0,l=0,u=void 0,p=void 0,m=0;m<c.length;m++){if((_=c[m]).id===o){d=_,c[m+1]&&(u=g.e.serialize({photosRootItemSetKeyPart:r,id:c[m+1].id})),c[m-1]&&(p=g.e.serialize({photosRootItemSetKeyPart:r,id:c[m-1].id}));break}l+=_.count}if(d){for(h=new D.e,b=[],y=d.count,S=l;y>0;)I=y<s?y:s,x=v.e.serialize({groupKeyPart:g.e.deserialize(n),offset:S,count:I}),b.push(x),h.merge(Object(P.t)({itemKey:x}).itemResolver),S+=I,y-=I;h.resolveItems({items:(C={},C[n]=Object(a.__assign)({},te(t,n,b,p,u)),C)}),p&&h.resolveItems({items:(w={},w[p]=Object(a.__assign)({},$.e.pack({itemKey:n})),w)}),u&&h.resolveItems({items:(E={},E[u]=Object(a.__assign)({},ee.e.pack({itemKey:n})),E)}),e(h.execute())}else console.error("photosAddon: Unable to find the groupObject for id: ",o)}else console.error("photosAddon: Failed to get GroupByCount while resolving a GroupItemSet!");return[2]}})})}}),he=n(2043),be=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=b.deserialize(n),r=i.groupToCountsItemKeyPart,o=i.pageToken,s=i.offset;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,c,d,l,u,f,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return t=p.e.serialize(r),[4,e(Object(me.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t)}}))];case 1:return(i=_.sent().addonSrc)?(c=r.photosRootItemSetKeyPart,d=new D.e,[4,i.getGroupToCount(c.groupBy,c.filter,c.photosRootKeyPart.driveId,o,c.filterType)]):[3,4];case 2:return l=_.sent(),u=l.counts.map(function(e,t){return Object(he.e)(e,t)}),[4,e(Object(me.e)(function(e){return e.demandItemFacet(O.e,t)}))];case 3:(f=_.sent())&&(d.merge(B(e,t,{counts:u,pageToken:l.pageToken},s,f)),d.resolveItems({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)({},M.a.pack({})),M.e.pack(void 0)),m)}),e(d.execute())),_.label=4;case 4:return[2]}})})}}),ge=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=p.e.deserialize(n).photosRootItemSetKeyPart;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c,d;return Object(a.__generator)(this,function(l){switch(l.label){case 0:return(t=e(Object(S.e)(function(e){return e.demandItemFacet(A.e,A.t)})))?(r=new D.e,[4,t.getGroupToCount(i.groupBy,i.filter,i.photosRootKeyPart.driveId,void 0,i.filterType)]):[3,2];case 1:o=l.sent(),s=o.counts.map(function(e,t){return Object(he.e)(e,t)}),c=e(Object(S.e)(function(e){return e.demandItemFacet(O.e,n)||[]})),r.merge(B(e,n,{counts:s,pageToken:o.pageToken},0,c)),r.resolveItems({items:(d={},d[n]=Object(a.__assign)({},Object(x.e)().forFacet(O.e).thenInvalidate(n,M.e).forFacet(O.e).thenInvalidate(n,O.a).forFacet(O.e).thenInvalidate(n,O.n).pack()),d)}),e(r.execute()),l.label=2;case 2:return[2]}})})}});function ve(e,t,n,i,r,o,s,c,d){return Object(a.__awaiter)(this,void 0,void 0,function(){var l,u,f,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return l=E.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:t,groupBy:n,filter:i,filterType:r}}),[4,e(Object(S.e)(function(e){return{widths:e.demandItemFacet(w.t,l)}}))];case 1:if((u=_.sent().widths)?u.length>=d?u=u.slice(0,d):((f=new Uint16Array(d)).set(u),u=f):u=new Uint16Array(d),u){for(p=0;p<s.length;++p)u[p+c]=s[p];o.resolveItems({items:(m={},m[l]=Object(a.__assign)({},w.t.pack(u)),m)})}return[2]}})})}function ye(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d,u,p,m,_,h,b,y,S,I,x,C,O,w,E,A,L,k,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(c=new D.e,!e.length||!f.e.matches(n))return[3,3];for(d=f.e.deserialize(n),u=d.groupBy,p=d.filter,m=d.photosRootKeyPart,_=d.filterType,h=r,b=new Map,y=new Uint16Array(e.length),S=0,I=0,x=0;x<e.length;++x){for(C=e[x],(O=C.thumbnails[C.thumbnails.length-1])&&O.width&&O.height?(w=Math.round(o*O.width/O.height),y[x]=w):y[x]=0,E={itemId:C.id,driveId:m.driveId,endpoint:m.endpoint},A=l.e.serialize(E),L=ae.e.serialize({driveItemKeyPart:E,photosRootItemSetKeyPart:d}),k=x+h,T=void 0;S<i.length;++S){if(U=i[S],F=I+U.count,k>=I&&k<F){T=g.e.serialize({photosRootItemSetKeyPart:d,id:U.id}),(H=b.get(T))?(H.newChildKeys.push(A),H.newChildIndices.push(k)):b.set(T,{key:T,newChildKeys:[A],newChildIndices:[k],curChildKeysIdx:-1});break}I+=U.count}T&&(R=ie.e.serialize({index:k,photosRootItemSetKeyPart:Object(a.__assign)({},d)}),c.merge(t(J(A,T,C)).itemResolver),c.resolveItems({items:(j={},j[R]=Object(a.__assign)({},l.e.pack(E)),j[L]=Object(a.__assign)({},ne.e.pack({itemKey:T})),j)}))}return[4,ve(t,m,u,p,_,c,y,h,s)];case 1:return V.sent(),N=[],b.forEach(function(e){var n=t(Object(me.e)(function(t){var n=t.demandItemFacet(M.e,e.key);if(n)return n.itemKeys})),a=N.push(n);e.curChildKeysIdx=a-1}),[4,Promise.all(N)];case 2:B=V.sent(),b.forEach(function(e){var t=0;e.totalChildCount=0;var n=new Map;if(e.curChildKeysIdx>=0){var a=B[e.curChildKeysIdx];if(a)for(var i=0,r=a;i<r.length;i++){var o=r[i];if(v.e.matches(o)){var s=v.e.deserialize(o),d=s.offset,l=s.count;if(d<h){e.totalChildCount+=l;continue}e.totalChildCount+=e.newChildKeys.length;for(var u=[],f=Math.min(e.newChildKeys.length-t,l),p=0;p<f;++p){var m=d+p;e.newChildIndices[t]===m&&u.push(e.newChildKeys[t++])}if(u.length>0){if(l>f){var _=g.e.deserialize(e.key),b=v.e.serialize({groupKeyPart:_,offset:d+f,count:l-f});u.push(b),c.merge(Object(P.t)({itemKey:b}).itemResolver)}n.set(o,u)}if(t>=e.newChildKeys.length)break}else e.totalChildCount++}}n.forEach(function(t,n){c.merge(Object(P.e)({itemKey:n,itemSetKey:e.key,childItemKeys:t}).itemResolver)})}),V.label=3;case 3:return[2,c]}})})}var Se=n(266),De=new U.e("doNotFetchResolvedPhotos"),Ie=Object(i.i)({maxQueueSize:2,prioritizeRecent:!0})(function(e){var t=this,n=e.itemKey,i=v.e.deserialize(n),r=i.groupKeyPart,o=i.offset,s=r.photosRootItemSetKeyPart;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,c,d,l,u,p,m,_,h,b,g,v,y,S;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(me.e)(function(e){var t=e.demandItemFacet(A.e,A.t),n=e.demandItemFacet(A.r,A.t),a=e.demandItemFacet(O.t,f.e.serialize(s));return{addonSrc:t,maxPageSize:n,totalPhotoCount:a?e.demandItemFacet(O.a,a.itemKey):void 0,targetHeight:e.demandItemFacet(A.s,A.t)}}))];case 1:return t=a.sent(),i=t.addonSrc,r=t.maxPageSize,c=t.totalPhotoCount,d=t.targetHeight,i&&r&&c&&d?e(Object(Se.e)({doNotFetchResolvedPhotos:De})).doNotFetchResolvedPhotos?(p=(u=Math).min,m=[r],[4,Oe(e,n,r)]):[3,3]:[3,8];case 2:return l=p.apply(u,m.concat([a.sent()])),[3,4];case 3:l=r,a.label=4;case 4:return h=(_=o)+l,[4,i.getPhotoRecords(_,h,s.filter,s.photosRootKeyPart.driveId,c,"landing",s.filterType)];case 5:return b=a.sent(),[4,e(Object(me.e)(function(e){var t=e.demandItemFacet(O.t,f.e.serialize(s));return t?e.demandItemFacet(O.e,t.itemKey):void 0}))];case 6:return(g=a.sent())?(v=new D.e,S=(y=v).merge,[4,ye(b,e,f.e.serialize(s),g,o,d,c)]):[3,8];case 7:S.apply(y,[a.sent()]),e(v.execute()),a.label=8;case 8:return[2]}})})}});function xe(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(me.e)(function(e){return e.demandItemFacet($.e,t)}))];case 1:return(n=a.sent())&&g.e.matches(n.itemKey)?[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,n.itemKey)}))]:[3,3];case 2:return i=a.sent(),[2,{groupKey:n.itemKey,childrenKeys:i}];case 3:return[2,{groupKey:void 0,childrenKeys:void 0}]}})})}function Ce(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=v.e.deserialize(t).groupKeyPart,i=g.e.serialize(n),[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,i)}))];case 1:return r=a.sent(),[2,{groupKey:i,childrenKeys:r}]}})})}function Oe(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=v.e.deserialize(t).count,[4,Ce(e,t)];case 1:if(r=a.sent(),o=r.groupKey,s=r.childrenKeys,(c=s?s.itemKeys.findIndex(function(e){return e===t}):-1)<0)return[2,i];c+=1,a.label=2;case 2:return o&&s?(d=function(e,t,n){for(var a=0,i=!1,r=e;r<t.length&&a<n;){var o=t[r];if(!v.e.matches(o)){i=!0;break}a+=v.e.deserialize(o).count,r++}return{unresolvedCount:a,foundResolved:i}}(c,s.itemKeys,n-i),l=d.unresolvedCount,u=d.foundResolved,i+=l,u||i>=n?[3,4]:[4,xe(e,o)]):[3,4];case 3:return f=a.sent(),o=f.groupKey,s=f.childrenKeys,c=0,[3,2];case 4:return[2,i]}})})}var we=new m.e("AllPhotosWidthsItemPageKeyFacet",{widthsItemKeyPart:E.subKeyPart,offset:h.e,count:h.e}),Ee=String.fromCharCode(9);function Ae(e,t){return{leafItemKey:t.itemKey,crumbControlHandler:function(e,t){var n=e.demandItemFacet(f.e,t.itemKey);if(n){var i=n.filter;if("place"===n.filterType){var r=i.split(Ee),o=void 0;if(r.length>1){var s=r.slice(0,r.length-1);o=f.e.serialize(Object(a.__assign)(Object(a.__assign)({},n),{filter:s.join(Ee)}))}return{displayName:r[r.length-1],parentItemKey:o}}}return{}}}}var Le=n(325),ke=n(1155),Me=n(1156),Pe=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return t=new D.e,i=!1,[4,e(Object(S.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t)}}))];case 1:return(r=s.sent().addonSrc)?[4,r.getIsSamsungFolderAvailable()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:return t.resolveItems({items:(o={},o[n]=Object(a.__assign)({},Me.e.pack({isAvailable:i})),o)}),e(t.execute()),[2]}})})}}),Te=n(2325);function Ue(e,t){var n=e.demandItemFacet(f.e,t.itemKey);return"album"===(null==n?void 0:n.filterType)?{}:{count:void 0,dateRange:void 0,label:void 0}}var Fe=n(476);function He(e,t){var n=t.setItemKey,a=e.demandItemFacet(A.d,r.e,{suppressGetItems:!0});if(!n||!a)return{};var i=e.demandItemFacet(f.e,n,{suppressGetItems:!0});if(void 0!==i){var o=e.demandItemFacet(M.e,n,{suppressGetItems:!0}),s=e.demandItemFacet(I.e,n)||o&&o.itemKeys.length,c=e.demandItemFacet(A.r,A.t),d=void 0===e.demandItemFacet(M.e,p.e.serialize({photosRootItemSetKeyPart:i}),{suppressGetItems:!0});return{totalItemCount:s,getPageKey:void 0!==o?function(e,t){if(void 0!==o&&o.itemKeys.length>0){d&&t++;for(var n=0;n<o.itemKeys.length;++n){var a=o.itemKeys[n];if(ce.e.matches(a)){var i=ce.e.deserialize(a),r=i.offset;if(e<=r+i.count&&r<=t)return a}}}return""}:void 0,pageSize:c}}return{}}var Re=n(1743),Ne=Object(i.i)({maxQueueSize:2,prioritizeRecent:!0})(function(e){var t=this,n=e.itemKey,i=ce.e.deserialize(n),o=i.photosRootItemSetKeyPart,s=i.offset,c=i.count;if(s<0)throw new Error("Page offset cannot be less than 0");if(c<=0)throw new Error("Page count cannot be 0 or less items");return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,d,u,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(I){switch(I.label){case 0:if(t=new D.e,i=e(Object(S.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t),photoCount:e.demandItemFacet(O.a,p.e.serialize({photosRootItemSetKeyPart:o})),targetHeight:e.demandItemFacet(A.s,A.t)}})),d=i.addonSrc,u=i.photoCount,void 0===(m=i.targetHeight))throw new Error("Target Height for photo resolution has not been defined in config!");return _=f.e.serialize(o),[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,_)}))];case 1:return I.sent(),void 0===u&&(u=c),b=(h=s)+c,g=[],void 0===d?[3,3]:[4,d.getPhotoRecords(h,b,o.filter,o.photosRootKeyPart.driveId,Math.max(u,h+1),"landing",o.filterType)];case 2:g=I.sent(),I.label=3;case 3:return t.merge(function(e,t,n,i,r,o,s){var c,d=new D.e,u=n.photosRootKeyPart,m=[],_=p.e.serialize({photosRootItemSetKeyPart:n}),h=e(Object(S.e)(function(e){return{generateNewCounts:void 0===e.demandItemFacet(M.e,_)}})).generateNewCounts;r=Math.max(r,o+i.length);var b=E.serialize({photosRootItemSetKeyPart:n}),g=function(e,t,n){var a=e(Object(S.e)(function(e){return e.demandItemFacet(w.t,t)}));if(a)if(a.length>=n)a="function"==typeof a.slice?a.slice(0,n):new Uint16Array(Array.prototype.slice.call(a,0,n));else{var i=new Uint16Array(n);i.set(a),a=i}else a=new Uint16Array(n);return a}(e,b,r);if(i.forEach(function(t,a){var i=t.thumbnails[t.thumbnails.length-1];if(i&&i.width&&i.height){var r=Math.round(s*i.width/i.height);g[o+a]=r}else g[o+a]=0;var c=l.e.serialize({itemId:t.id,driveId:u.driveId,endpoint:u.endpoint});m.push(c),d.merge(e(J(c,f.e.serialize(n),t)).itemResolver)}),h&&i.length>0){var v=ce.e.serialize({photosRootItemSetKeyPart:n,offset:o+i.length,count:i.length});m.push(v),d.merge(Object(P.t)({itemKey:v}).itemResolver)}var y=f.e.serialize(n);return d.merge(Object(P.e)({itemKey:t,itemSetKey:y,childItemKeys:m}).itemResolver),d.resolveItems({items:(c={},c[b]=Object(a.__assign)({},w.t.pack(g)),c)}),d}(e,n,o,g,u,h,m)),v=f.e.serialize(o),t.resolveItems({items:(y={},y[n]=Object(a.__assign)(Object(a.__assign)({},M.a.pack({})),M.e.pack({itemKeys:[]})),y[v]=Object(a.__assign)({},Object(x.e)().forFacet(M.e).thenInvalidate(n,M.e).pack()),y)}),e(t.execute()),e(function(e,t){var n,i=new D.e,o=p.e.serialize({photosRootItemSetKeyPart:t}),s=f.e.serialize(t),c=e(Object(S.e)(function(e){return{generateNewCounts:void 0===e.demandItemFacet(M.e,o),childItems:e.demandItemFacet(M.e,s),oldGroupToCount:e.demandItemFacet(O.e,o)}})),d=c.generateNewCounts,u=c.childItems,m=c.oldGroupToCount;if(d&&u){var _=function(e){if(!e)return 0;var t=0;return e.forEach(function(e){t+=e.count}),t}(m),h=e(Object(S.e)(function(e){for(var t=[],n=_;n<u.itemKeys.length;n++){var a=u.itemKeys[n];if(l.e.matches(a)){var i=e.demandItemFacet(G.c,a),r=void 0!==i?new Date(i):void 0;if(!r)break;var o=Object(Re.e)(r);t[n-_]={dateTakenTime:o}}}return t})),b=e(Object(S.e)(function(e){return e.demandItemFacet(A.n,r.e)})),g=function(e,t){if(void 0===e)return t;var n=e.slice();return n.length>0&&t.length>0&&t[0].labels.join(",")===n[n.length-1].labels.join(",")&&(n[n.length-1].count+=t[0].count,t.shift()),n.concat(t)}(m,Object(k.t)(h,t.filterType,t.filter,b)),v=_+h.length;i.resolveItems({items:(n={},n[o]=Object(a.__assign)(Object(a.__assign)({},O.e.pack(g)),O.a.pack(v)),n)})}return i}(e,o).execute()),[2]}})})}}),Be=Object(i.t)(function(){return function(e){e(Object(o.t)({keyFacet:u.e,facets:[u.e,M.t]})),e(Object(o.t)({keyFacet:f.e,facets:[f.e,O.t,w.n,M.r,M.e,I.r]})),e(Object(o.t)({keyFacet:g.e,facets:[g.e,z.u,M.e,M.e]})),e(Object(o.t)({keyFacet:v.e,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:l.e,facets:[l.e,z.d,z.u,G.h,j.e]})),e(Object(o.t)({keyFacet:p.e,facets:[O.e,M.e,O.a,O.n]})),e(Object(o.t)({keyFacet:b,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:E,facets:[w.e,w.t,M.e]})),e(Object(o.t)({keyFacet:we,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:ce.e,facets:[M.a,M.e]})),e(y.e),e(Object(s.a)(f.e,c.e)(fe)),e(Object(s.a)(g.e,c.e)(_e)),e(Object(s.a)(v.e,c.e)(Ie)),e(Object(s.a)(ce.e,c.e)(Ne)),e(Object(s.a)(p.e,c.e)(ge)),e(Object(s.a)(b,c.e)(be)),e(Object(s.a)(ke.e,c.e)(Pe)),e(Object(d.e)(f.e,Le.t)(Ae)),e(Object(d.e)(f.e,Te.e)(Ue)),e(Object(d.e)(f.e,Fe.e)(He))}}),je=n(590),Ve=n(822),ze=n(2326),Ge=n(394),Ke=n(525),We=n(699),qe=n(691),Qe=n(696),Ye=n(519),Je=n(1112),Xe=n(339),Ze=n(804),$e=new m.e("albumSetKey",{albumsRootKeyPart:Xe.e.subKeyPart,nextLink:_.e}),et=new m.e("sharedAlbumsKey",{driveId:_.e,endpoint:_.e}),tt=n(392),nt=n(1884),at=n(2672),it=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Xe.e.deserialize(n),r=Ze.e.serialize({albumsRootKeyPart:i,groupType:"all"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(i){return e(Object(o.e)({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(at.e)),M.t.pack({itemKey:r})),t)})),[2]})})}}),rt=n(107),ot=n(990),st=n(1942),ct=n(2673);function dt(e){void 0===e&&(e=[]);var t={type:"auto",items:[],displayName:ct.e},n={type:"all",items:[],displayName:ct.t};return e.forEach(function(e){e.tags&&e.tags.some(function(e){return e.name===ue.e.__New})?t.items.push(e):n.items.push(e)}),{autoAlbums:t,allAlbums:n}}var lt=n(286);function ut(e,t,n,i){var r=[];if(n.items.forEach(function(i){var o=function(e,t,n,i){var r,o=C.e.serialize({albumsRootKeyPart:t,id:n.id}),s=f.e.serialize({photosRootKeyPart:t,groupBy:lt.e.Date,filter:n.id,filterType:"album"});return e.resolveItems({items:(r={},r[o]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(n.name)),I.e.pack(n.bundle&&n.bundle.childCount)),tt.i.pack(n.createdDateTime)),z.A.pack(n.webUrl)),z.m.pack(n.size)),z._.pack({})),nt.e.pack(i)),M.t.pack({itemKey:s})),r)}),o}(e,t,i,"auto"===n.type);r.push(o)}),i){var o=$e.serialize({albumsRootKeyPart:t,nextLink:i});e.merge(Object(P.t)({itemKey:o}).itemResolver),r.push(o)}return r}var ft=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ze.e.deserialize(n).albumsRootKeyPart,r=i.driveId,o=i.endpoint,s=Xe.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,c,d,l,u,f,p,m,_,h,b,g;return Object(a.__generator)(this,function(v){switch(v.label){case 0:return t=Date.now(),n=Object(ot.e)({filter:"bundle/album ne null",orderby:"createdDateTime desc",expand:"tags",select:"bundle,id,name,webUrl,createdDateTime,size,tags"}),c={qosName:"allAlbums",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/bundles?").concat(n)},[4,e(Object(rt.t)(c))];case 1:return d=v.sent(),l=d.value,u=d["@odata.nextLink"],f=Date.now()-t,p=Date.now(),m=dt(l),_=m.autoAlbums,h=m.allAlbums,b=new D.e,[_,h].forEach(function(e){var t,n=Ze.e.serialize({albumsRootKeyPart:i,groupType:e.type}),r=ut(b,i,e,u);b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:s})),M.e.pack({itemKeys:r})),z.u.pack(e.displayName)),t)})}),e(b.execute()),g=Date.now()-p,e(Object(st.e)({name:"Albums.GetAllAlbums",extraData:{fetchTimeMs:f,processTimeMs:g,AutoAlbumsCount:_.items.length,AllAlbumsCount:h.items.length}})),[2]}})})}}),pt=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=Date.now(),i=e.itemKey,r=$e.deserialize(i),o=r.albumsRootKeyPart,s=r.nextLink,c=o.endpoint,d=o.driveId,l={qosName:"allAlbums",endpoint:c,driveId:d,url:s},[4,n(Object(rt.t)(l))];case 1:return u=a.sent(),f=u.value,p=u["@odata.nextLink"],m=Date.now()-t,_=Date.now(),h=dt(f),b=h.autoAlbums,g=h.allAlbums,v=new D.e,[b,g].forEach(function(e){var t=Ze.e.serialize({albumsRootKeyPart:o,groupType:e.type}),n=ut(v,o,e,p);v.merge(Object(P.e)({itemKey:i,itemSetKey:t,childItemKeys:n}).itemResolver)}),n(v.execute()),y=Date.now()-_,function(e,t,n,a){Object(st.e)({name:"Albums.GetAllTags",extraData:{fetchTimeMs:e,processTimeMs:t,AutoAlbumsCount:n,AllAlbumsCount:a}})}(m,y,b.items.length,g.items.length),[2]}})})}}),mt=Object(i.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,i=e.options.demands,r=C.e.deserialize(n),s=r.albumsRootKeyPart,c=s.driveId,d=s.endpoint,l=r.id,u=f.e.serialize({photosRootKeyPart:{driveId:c,endpoint:d},groupBy:lt.e.Date,filter:l,filterType:"album"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,p,m,_;return Object(a.__generator)(this,function(h){switch(h.label){case 0:return t=Object(ot.e)({expand:"thumbnails(select=medium),children",select:"bundle,id,name,webUrl,createdDateTime,size,thumbnails"}),r={qosName:"allAlbums",endpoint:d,driveId:c,url:"".concat(d,"/drives/").concat(c,"/items/").concat(l,"?").concat(t)},[4,e(Object(rt.t)(r))];case 1:return s=h.sent(),f=s.thumbnails&&s.thumbnails[0]&&s.thumbnails[0].medium,e(Object(o.e)({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(s.name)),I.e.pack(s.bundle&&s.bundle.childCount)),tt.i.pack(s.createdDateTime)),z.A.pack(s.webUrl)),G.h.pack(f)),z.m.pack(s.size)),z._.pack({})),M.t.pack({itemKey:u})),Object(x.e)().forFacet(M.t).thenInvalidate(u,M.e).pack()),m)})),i[se.e.id]?[4,e(_t(n))]:[3,3];case 2:p=h.sent(),e(Object(o.e)({items:(_={},_[n]=Object(a.__assign)({},se.e.pack(p)),_)})),h.label=3;case 3:return[2]}})})}});function _t(e){var t=this,n=C.e.deserialize(e);return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i(Object(S.e)(function(t){return t.demandItemFacet(I.e,e)}))?[4,Promise.all([i(ht({albumKeyPart:n,pageSize:1,sortBy:"createdDateTime",sortOrder:"asc"})),i(ht({albumKeyPart:n,pageSize:1,sortBy:"createdDateTime",sortOrder:"desc"}))])]:[3,2];case 1:if(t=a.sent(),r=t[0][0],o=t[1][0],r&&r.createdDateTime&&o&&o.createdDateTime&&(s=new Date(r.createdDateTime),c=new Date(o.createdDateTime),bt(s)&&bt(c)))return[2,{minDate:s,maxDate:c}];a.label=2;case 2:return[2]}})})}}function ht(e){var t=this,n=e.albumKeyPart,i=e.pageSize,r=e.sortBy,o=e.sortOrder,s=n.albumsRootKeyPart,c=s.driveId,d=s.endpoint,l=n.id;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=Object(ot.e)({orderby:"".concat(r," ").concat(o),top:i}),n={qosName:"allAlbums",endpoint:d,driveId:c,url:"".concat(d,"/drives/").concat(c,"/items/").concat(l,"/children?").concat(t)},[4,e(Object(rt.t)(n))];case 1:return[2,a.sent().value||[]]}})})}}function bt(e){return e instanceof Date&&!isNaN(e.getTime())}var gt=Object(i.i)()(function(e){var t=e.itemKey,n=C.e.deserialize(t),i=n.albumsRootKeyPart,r=i.driveId,s=i.endpoint,c=n.id;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(d){switch(d.label){case 0:return n={qosName:"allAlbums",method:"DELETE",endpoint:s,driveId:r,url:"".concat(s,"/drives/").concat(r,"/items/").concat(c)},[4,e(Object(rt.t)(n))];case 1:return d.sent(),e(Object(o.e)({items:(i={},i[t]=Object(a.__assign)({},z.d.pack({})),i)})),[2]}})})}}),vt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.names,i=C.e.deserialize(t),r=i.albumsRootKeyPart,s=r.driveId,c=r.endpoint,d=i.id,l=n[Object.keys(n)[0]].newName;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i,r,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=Object(ot.e)({select:"id,name"}),i={qosName:"allAlbums",method:"PATCH",endpoint:c,driveId:s,url:"".concat(c,"/drives/").concat(s,"/items/").concat(d,"?").concat(n),body:{name:l}},[4,e(Object(rt.t)(i))];case 1:return r=f.sent().name,e(Object(o.e)({items:(u={},u[t]=Object(a.__assign)({},z.u.pack(r)),u)})),[2]}})})}}),yt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.tagsToAdd,r=n.tagsToDelete,o=n.keysToInvalidate,s=C.e.deserialize(t),c=s.albumsRootKeyPart,d=c.driveId,l=c.endpoint,u=s.id;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,s,c,f,p,m,_,h,b,g,v;return Object(a.__generator)(this,function(y){switch(y.label){case 0:return n=[],i&&i.forEach(function(e){return n.push({name:e})}),r&&r.forEach(function(e){return n.push({name:e,"@oneDrive.removed":{}})}),s=Object(ot.e)({expand:"tags",select:"id,tags"}),c={qosName:"allAlbums",method:"PATCH",endpoint:l,driveId:d,url:"".concat(l,"/drives/").concat(d,"/items/").concat(u,"?").concat(s),body:{tags:n}},[4,e(Object(rt.t)(c))];case 1:for(f=y.sent(),p=new D.e,m=f.tags&&f.tags.indexOf({name:ue.e.__New})>-1,p.resolveItems({items:(g={},g[t]=Object(a.__assign)({},nt.e.pack(m)),g)}),_=0,h=o;_<h.length;_++)b=h[_],p.invalidateItems({items:(v={},v[b]=[M.e],v)});return e(p.execute()),[2]}})})}}),St=n(2674),Dt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=et.deserialize(n),r=i.driveId,o=i.endpoint,s=Xe.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,d,l,u,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return t=Object(ot.e)({filter:"remoteItem/bundle/album ne null",orderby:"createdDateTime desc"}),c={qosName:"sharedAlbums",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/view.sharedWithMe?").concat(t)},[4,e(Object(rt.t)(c))];case 1:return d=m.sent().value,l=new D.e,u=[],d.forEach(function(e){var t;if(e.remoteItem){var n,r=e.remoteItem;n=r.parentReference?C.e.serialize({albumsRootKeyPart:{driveId:r.parentReference.driveId,endpoint:i.endpoint},id:r.id}):C.e.serialize({albumsRootKeyPart:i,id:e.id});var o=f.e.serialize({photosRootKeyPart:i,groupBy:lt.e.Date,filter:e.id,filterType:"album"});l.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.name)),I.e.pack(r.bundle&&r.bundle.childCount)),tt.i.pack(e.createdDateTime)),z.A.pack(e.webUrl)),z.m.pack(r.size)),z._.pack({})),M.t.pack({itemKey:o})),t)}),u.push(n)}}),l.resolveItems({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:s})),M.e.pack({itemKeys:u})),z.u.pack(St.e)),p)}),e(l.execute()),[2]}})})}}),It=n(1091);function xt(e,t){return{isAvailable:!0}}var Ct=n(824);function Ot(e,t){return{isAvailable:!0,validator:Ct.e}}var wt=n(54),Et=n(686),At=n(579);function Lt(e,t){var n=t.itemKeys;if(1!==n.length)return{};var i=n[0];if(C.e.matches(i)){var r=C.e.deserialize(i).id;return{isAvailable:!0,getSharingInformation:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=n(Object(Se.e)({graphEndpoint:wt.g})).graphEndpoint||"",[4,n(Object(At.e)({endpoint:t}))];case 1:return[2,{authToken:(i=a.sent())&&i.accessToken,shareItemKey:Et.e.serialize({itemId:e})}]}})})}}(r)}}}return{}}var kt=n(38),Mt=n(2177);function Pt(e,t){return{initializeShareFrame:Tt}}function Tt(e){var t=e.parentElement,n=e.calloutProps,a=e.sharingInformation,i=e.onError,r=a.authToken,o=a.shareItemKey,s=a.webAbsoluteUrl;if(o&&Et.e.matches(o)){var c=Et.e.deserialize(o).itemId;new Mt.SharePrefetch({element:t,environment:kt.e.prod,locale:n.locale,disableIframeDomainCheck:!0,isConsumer:!0,context:{authToken:r||"",webAbsoluteUrl:s||"",listItemId:c,itemName:n.itemName,mode:Number(n.mode),defaultRecipients:n.defaultRecipients,theme:n.theme,clientId:n.getClientId()},options:{onError:i,openManageAccess:n.openManageAccess}}).initializeUI()}}var Ut=n(314);function Ft(e,t){var n,i=t.itemKeys.reduce(function(t,a){var i=e.demandItem({albumKeyPart:C.e,name:z.u,photoCount:I.e,size:z.m,folder:z._},a),r=i.albumKeyPart,o=i.name,s=i.photoCount,c=i.size,d=i.folder;if(r&&s&&s>0){var l=r.albumsRootKeyPart,u=l.driveId,f=l.endpoint,p=r.id;n=f,t.push({name:o||"",size:c||0,docId:"".concat(f,"/drives/").concat(u,"/items/").concat(p),isFolder:!!d})}return t},[]);if(0===i.length||!n)return{isAvailable:!1};var r=n;return{isAvailable:!0,getDownloadData:function(){return function(e,t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=1===e.length&&e[0].name?"".concat(e[0].name.replace(" ","_"),".zip"):"OneDrive_".concat((new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,""),".zip"),r=Ut.e.generate(),[4,i(Object(At.e)({endpoint:t}))];case 1:return o=a.sent(),s=o&&o.accessToken,[2,{url:"https://southcentralus1-media".concat(Rt,".svc.ms/transform/zip?cs=V2VifE9EQw=="),method:"POST",postData:{zipFileName:n,guid:r,provider:"url",files:JSON.stringify({items:e}),accessToken:s||"",appId:Nt||""}}]}})})}}(i,r)}}}var Ht=window.FilesConfig,Rt=Ht&&Ht.df?"s":"p",Nt=Ht&&Ht.appId,Bt=n(1107),jt=n(438),Vt=n(585),zt=n(470),Gt=n(583),Kt=[jt.n,Gt.e,Vt.e,zt.e];function Wt(e,t){return{commands:Kt}}var qt=n(680),Qt={name:"Error",size:40},Yt={name:"PhotoCollection",size:40};function Jt(e,t){return{errorThumbnailIcon:Qt,invalidThumbnailIcon:Yt}}var Xt=n(999);function Zt(e,t){return{isAvailable:!1}}var $t=Object(i.t)(function(){return function(e){e(Je.e),e(Object(o.t)({keyFacet:Xe.e,facets:[z.u,M.t]})),e(Object(o.t)({keyFacet:Ze.e,facets:[M.r,M.e,z.u]})),e(Object(o.t)({keyFacet:C.e,facets:[M.t,z.u,I.e,tt.i,z.A,G.h,nt.e,z.m,z._,se.e]})),e(Object(o.t)({keyFacet:$e,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:et,facets:[M.r,M.e,z.u]})),e(Object(s.a)(Xe.e,c.e)(it)),e(Object(s.a)(Ze.e,c.e)(ft)),e(Object(s.a)($e,c.e)(pt)),e(Object(s.a)(C.e,c.e)(mt)),e(Object(s.a)(C.e,je.e)(gt)),e(Object(s.a)(C.e,Ve.t)(vt)),e(Object(s.a)(C.e,ze.t)(yt)),e(Object(s.a)(et,c.e)(Dt)),e(Object(d.e)(C.e,Ge.e)(It.t)),e(Object(d.e)(C.e,qt.e)(Jt)),e(Object(d.e)(C.e,Ke.e)(xt)),e(Object(d.e)(C.e,We.e)(Ot)),e(Object(d.e)(C.e,qe.e)(Lt)),e(Object(d.e)(C.e,Qe.e)(Pt)),e(Object(d.e)(C.e,Ye.e)(Ft)),e(Object(d.e)(Xe.e,Bt.e)(Wt)),e(Object(d.e)(Ze.e,Xt.e)(Zt))}}),en=n(806),tn=n(556),nn=new m.e("tagSetKey",{tagsRootKeyPart:en.e.subKeyPart,groupType:Object(tn.e)({top:0,all:1,promoted:2})}),an=n(2675),rn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=en.e.deserialize(i),o=r.driveId,s=r.endpoint,c=-1!==s.indexOf("/_api/v2.1");return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,l,u,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return n=Date.now(),d=Object(ot.e)({expand:"tag($select=*,localizedName),previewThumbnails"}),l="".concat(s,"/drives/").concat(o,"/view.listTags"),c||(l+="?".concat(d)),u={qosName:"allTags",endpoint:s,driveId:o,url:l},[4,t(Object(rt.t)(u))];case 1:return p=S.sent().value,m=Date.now()-n,_=Date.now(),h=function(e){if(!e||0===e.length)return[];var t={type:"top",name:an.n,tags:[]},n={type:"all",name:an.e,tags:[]};return e.forEach(function(e){var a=e.tag;if(a&&a.name&&!(a.name in ue.e)){var i={name:a.name,displayName:a.localizedName||a.name,thumbnail:e.previewThumbnails&&Object(Y.e)(e.previewThumbnails)};t.tags.length<11&&a.name.toLocaleLowerCase()in ue.a&&t.tags.push(i),n.tags.push(i)}}),n.tags.sort(function(e,t){return e.displayName.localeCompare(t.displayName)}),[t,n]}(p),b=new D.e({publisher:e}),g=[],h.forEach(function(e){var t,n=nn.serialize({tagsRootKeyPart:r,groupType:e.type}),i=[];e.tags.forEach(function(e){var t,n=oe.e.serialize({tagsRootKeyPart:r,id:e.name}),c=f.e.serialize({photosRootKeyPart:{driveId:o,endpoint:s},groupBy:lt.e.Date,filter:e.name,filterType:"tag"});b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.displayName)),M.t.pack({itemKey:c})),G.h.pack(e.thumbnail)),t)}),i.push(n)}),b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.name)),M.e.pack({itemKeys:i})),t)}),g.push(n)}),b.resolveItems({items:(y={},y[i]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(an.t)),M.e.pack({itemKeys:g})),y)}),t(b.execute()),v=Date.now()-_,t(Object(st.e)({name:"Tags.GetAllTags",extraData:{fetchTimeMs:m,processTimeMs:v,tagsCount:(null==p?void 0:p.length)||0}})),[2]}})})}}),on=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=nn.deserialize(n).tagsRootKeyPart,r=en.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(me.e)(function(e){e.demandItemFacet(M.e,r)}))];case 1:return t.sent(),[2]}})})}}),sn=Object(i.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,i=oe.e.deserialize(n),r=i.tagsRootKeyPart,s=r.driveId,c=r.endpoint,d=i.id,l=f.e.serialize({photosRootKeyPart:{driveId:s,endpoint:c},groupBy:lt.e.Date,filter:d,filterType:"tag"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,u,f,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return t=Object(ot.e)({filter:"photo ne null and tags/any(t:t/name eq '".concat(d,"')"),orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium),tags",top:1,select:"id,thumbnails,tags"}),i={qosName:"allTags",endpoint:c,driveId:s,url:"".concat(c,"/drives/").concat(s,"/items/root/items?").concat(t)},[4,e(Object(rt.t)(i))];case 1:return r=m.sent().value,u=r&&r.length&&r[0].thumbnails&&r[0].thumbnails[0],f=u&&u.medium?{url:u.medium.url,width:u.medium.width,height:u.medium.height}:void 0,e(Object(o.e)({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)({},G.h.pack(f)),M.t.pack({itemKey:l})),p)})),[2]}})})}}),cn=Object(i.t)(function(){return function(e){e(Je.e),e(Object(o.t)({keyFacet:en.e,facets:[M.e]})),e(Object(o.t)({keyFacet:nn,facets:[z.u,M.e]})),e(Object(o.t)({keyFacet:oe.e,facets:[z.u,G.h]})),e(Object(s.a)(en.e,c.e)(rn)),e(Object(s.a)(nn,c.e)(on)),e(Object(s.a)(oe.e,c.e)(sn)),e(Object(d.e)(oe.e,Ge.e)(It.t)),e(Object(d.e)(oe.e,qt.e)(Jt))}}),dn=n(576),ln=n(2307),un=Object(i.t)(function(){return function(e){e(ln.e),e(Object(d.e)(dn.e,Ge.e)(It.t)),e(Object(d.e)(dn.e,qt.e)(Jt))}}),fn=n(1109),pn=n(2313),mn=Object(i.t)(function(){return function(e){e(pn.e),e(Object(d.e)(fn.e,Ge.e)(It.t))}}),_n=n(1110),hn=n(2314),bn=Object(i.t)(function(){return function(e){e(hn.e),e(Object(d.e)(_n.e,Ge.e)(It.t))}}),gn=n(1111),vn=n(2315),yn=Object(i.t)(function(){return function(e){e(vn.e),e(Object(d.e)(gn.e,Ge.e)(It.t))}}),Sn=n(11),Dn=n(1827),In=n(1165),xn=Object(i.t)(function(){return function(e){var t;e(Be),e($t),e(cn),e(un),Object(Sn.isFeatureEnabled)({ODC:"EnableRecommendationApi"})?e(In.e):(e(mn),e(bn),e(yn)),e(Object(o.e)({items:(t={},t[r.e]=Object(a.__assign)(Object(a.__assign)({},De.pack(e(Object(Dn.t)()))),A.d.pack(Object(Sn.isFeatureEnabled)(Sn.UseItemsScopeInAllPhotosForwardPaging))),t)}))}})},2425:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Owner=0]="Owner",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Submitter=3]="Submitter",e[e.CoOwner=4]="CoOwner",e[e.None=5]="None",e[e.Review=6]="Review",e[e.Custom=7]="Custom"}(a||(a={}))},2465:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(17);Object(a.n)([{rawString:".border_f34f7ade{width:100%;height:100%;pointer-events:none;position:absolute;z-index:1;-webkit-box-sizing:border-box;box-sizing:border-box;left:0;top:0}\n"}]);var i="border_f34f7ade"},2504:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(118),i=n(11),r=function(){function e(e){this._identityDataSource=e}return e.prototype.isExperimentOn=function(e,t,n){var i=this._identityDataSource.getIdentity().email;a.t.init({userLoginName:i});var r={name:e,startDate:t,version:a.e.v2};return new a.t(r,n).isOn()},e.prototype.isUseVroomInItemsScopeAllPhotosOtdExpOn=function(){return this.isExperimentOn("useVroomInItemsScopeAllPhotosOtdExp","2021/01/11",i.UseVroomInItemsScopeAllPhotosOtdExp)},e.prototype.isEnableLastWeekPreviousYearsExpOn=function(){return this.isExperimentOn("EnableLastWeekPreviousYearsExp","2021/06/04",i.EnableLastWeekPreviousYearsExp)},e.prototype.isEnableMonthRecapGroupHeaderExpOn=function(){return this.isExperimentOn("EnableMonthRecapGroupHeaderExp","2021/06/04",i.EnableMonthRecapGroupHeaderExp)},e.prototype.isEnableNewCarouselDesignExpOn=function(){return this.isExperimentOn("EnableNewCarouselDesignExp","2021/08/24",i.EnableNewCarouselDesignExp)},e}()},2505:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(2284),r=n(11),o=n(35),s=n(90),c=n(1827),d=function(){function e(e,t,n){this._photoProviderAddonSource=n,this._vroomAddonSource=new i.e(e,t),this._itemCacheStore=t}return e.prototype.updateResource=function(e){this._photoProviderAddonSource.updateResource(e),this._vroomAddonSource.updateResource(e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(r).getGroupToCount(e,t,n,i,r)]})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(s).getPhotoRecords(e,t,n,i,r,o,s)]})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource("folder").getPhotoRecordsForBurstMode(e,t,n)]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomAddonSource.getIsSamsungFolderAvailable()]})})},e.prototype.getAddonSource=function(e){switch(e){case"folder":case"onthisday":return this._itemCacheStore.dispatch(Object(c.t)())?this._vroomAddonSource:this._photoProviderAddonSource;case"place":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSinglePlace)?this._vroomAddonSource:this._photoProviderAddonSource;case"tag":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSingleTag)||Object(r.isFeatureEnabled)(r.UpdateOdcPhotoApiForConvergence)&&Object(s.e)(o.M)?this._vroomAddonSource:this._photoProviderAddonSource;case"onthismonth":case"lastweekpreviousyears":return this._vroomAddonSource}return this._photoProviderAddonSource},e}()},2506:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(2),r=n(209),o=n(28),s=n(201),c=n(95),d=n(8),l=new i.e("promotedPhotosDataSource"),u=new i.e("PhotosDataSource"),f=new d.t({name:"PromotedPhotosDataSourceConfig",factory:{dependencies:{photosProvider:c._,promotedPhotosProvider:c.v},create:function(e){return{instance:Object(o.t)(function(){return function(t){var n;t(Object(r.e)({items:(n={},n[s.e]=Object(a.__assign)(Object(a.__assign)({},l.pack(e.promotedPhotosProvider)),u.pack(e.photosProvider)),n)}))}})}}}})},2507:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(2043),r=n(292),o=n(42),s=n(2284),c=n(36),d=n(151),l=n(2190),u=n(812),f=n(10),p=[1e4,1e3,100],m="root",_=function(){function e(e,t,n,a,i){this._groupToCount=[],this._groupToCountDate=[],this._vroomDataRequestor=e,this._successfulPageSizeIndex=0,this._photoProvider=t,this._itemProvider=n,this._urlDataSource=a,this._engagement=i}return e.prototype.updateResource=function(e){},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,"landing","folder")];case 1:return[2,a.sent()]}})})},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(r){case"album":return[3,1];case"tag":return[3,3];case"onthisday":return[3,5]}return[3,7];case 1:return[4,this._getGroupToCountForSingleAlbum(t,n)];case 2:return e=a.sent(),[3,9];case 3:return[4,this._getGroupToCountForSingleTag(t)];case 4:return e=a.sent(),[3,9];case 5:return[4,this._getGroupToCountForOnThisDay(t)];case 6:return e=a.sent(),[3,9];case 7:return[4,this._getGroupToCountForAllPhotos(t,n,i,r)];case 8:e=a.sent(),a.label=9;case 9:return[2,e]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(s){case"album":i=this._getPhotoRecordsForSingleAlbum(e,t,n);break;case"tag":i=this._getPhotoRecordsForSingleTag(e,t,n);break;case"onthisday":i=this._getPhotoRecordsForOnThisDay(e,t,n);break;default:i=this._getPhotoRecordsForAllPhotos(e,t,n,s)}return[2,i]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,u,f,p,m,_,h,b;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=void 0,o=0,0!==e&&(s=this._getStartDate(e,n),c=s.date,d=s.index,void 0!==c&&d>=0?(r=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),24,0,0,-1)),o=d):o=e),l=e-o,u=t-o,f=this._photoProvider.getAllPhotosSettings(),p=r?r.toISOString():void 0,m=new Date,[4,this._getPhotoRecords(o,t,l,p,f.peek().rootId,void 0,void 0)];case 1:return _=a.sent(),h=new Date,b=h.getTime()-m.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:b,count:u,requests:_.requestsCount,skip:e-o,api:"skyapi"},i),[2,_.photos]}})})},e.prototype._getPhotoRecords=function(e,t,n,i,o,s,c){return Object(a.__awaiter)(this,void 0,void 0,function(){var d,l,u,f,p,m,_,h,b,g,v;return Object(a.__generator)(this,function(a){switch(a.label){case 0:d=[],l=200,u=0,f=t-e,p=0,a.label=1;case 1:return f>0?(p++,m=Math.min(l,f),h=(_=e+u)+m,[4,this._photoProvider.getAllPhotosForPage({rootItemId:o,parentKey:null,startIndex:_,endIndex:h-1,jumpToStartDate:i,photoType:r.e.AllMyPhotos,ascending:!1,locationFilter:c,pageSize:l,revision:0,skipInMemoryCache:!1,tagFilter:s})]):[3,5];case 2:return b=a.sent(),g=void 0,Array.isArray(b)?(g=b[0].content(),console.warn("Invalid result from getAllPhotosForPage (array)")):b&&b.content&&(g=b.content()),g&&g.items?(v=Math.min(g.items.length,h),[4,this._transformIOneDriveItemsToIPhotoRecords(g.items,_+n,v,d)]):[3,4];case 3:a.sent(),a.label=4;case 4:return u+=m,n=n>m?n-m:0,f-=m,[3,1];case 5:return[2,{photos:d,requestsCount:p}]}})})},e.prototype._getPhotoRecordsForOnThisDay=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(i=Object(u.e)(n).date).setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),[4,this._urlDataSource.getCurrentItemKey()];case 1:return r=a.sent(),o={parentKey:r,startDate:i.toISOString(),onThisDay:!0,highlights:!1,pageSize:100,ascending:!1,rootItemId:m,startIndex:0,endIndex:0},[4,this._photoProvider.getOnThisDayPhotos(o)];case 2:return s=a.sent(),c=[],d=s.content(),l=d.items,f=t>0?Math.min(t,l.length):l.length,[4,this._transformIOneDriveItemsToIPhotoRecords(d.items,e,f,c)];case 3:return a.sent(),[2,c]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,r=1,[4,this._getItemsForSingleAlbum(e,t,n)];case 1:return o=a.sent(),s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r,api:"skyapi"},"album"),[2,o]}})})},e.prototype._getPhotoRecordsForSingleTag=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,[4,this._getPhotoRecords(e,t,0,void 0,m,n,void 0)];case 1:return r=a.sent(),o=r.photos,s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r.requestsCount,api:"skyapi"},"tag"),[2,o]}})})},e.prototype.getOwnerId=function(e){return this._urlDataSource.getKeyParams(e).cid||f.z},e.prototype._getItemsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=[],[4,this._urlDataSource.getCurrentItemKey()];case 1:r=a.sent(),o=t-e,s=e,a.label=2;case 2:return o>0?[4,this._itemProvider.getItem({parentKey:r,ownerId:this.getOwnerId(r),id:n,startIndex:s,endIndex:t-1,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})]:[3,6];case 3:if(d=a.sent(),Array.isArray(d))throw new Error("Invalid result from getAllPhotosForPage (array)");return d&&d.content&&(l=d.content())&&l.items?[4,this._transformIOneDriveItemsToIPhotoRecords(l.items,e,t,i)]:[3,5];case 4:a.sent(),a.label=5;case 5:return o=t-i.length-e,s=e+i.length,[3,2];case 6:return[2,i]}})})},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfulPageSizeIndex,a.label=1;case 1:if(!(o<p.length))return[3,6];c=p[o],d=Object(s.t)(c,e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(d)];case 3:return l=a.sent(),this._successfulPageSizeIndex=o,[2,l];case 4:return u=a.sent(),r=u,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u,f,p,m,_;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new Date,o=n?parseInt(n,10):1,[4,this._getGroupCountWithVariablePageSize(i,e,t,o)];case 1:return c=a.sent(),d=c.value.length>0&&c["@odata.nextLink"],l=c.value,u=l.length,[4,Object(s.n)(l,i,e)];case 2:return f=a.sent(),n?this._mergeGroupToCounts(f.counts,f.dates):(this._groupToCount=f.counts,this._groupToCountDate=f.dates),this._groupToCountDate.length>0&&(p=this._groupToCountDate[this._groupToCountDate.length-1].toISOString(),this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:p},i)),m=new Date,_=m.getTime()-r.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:_,groups:f.counts.length,requests:1},i),[2,{counts:f.counts,pageToken:d?(o+u).toString():void 0}]}})})},e.prototype._getGroupToCountForSingleAlbum=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._urlDataSource.getCurrentItemKey()];case 1:return t=a.sent(),[4,this._itemProvider.getItem({parentKey:t,ownerId:this.getOwnerId(t),id:e,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})];case 2:return n=a.sent(),i=n.item(),r=i&&i.folder&&i.folder.photoCount?i.folder.photoCount:0,o=[e,e,e],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[]}]}})})},e.prototype._getGroupToCountForSingleTag=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=this._urlDataSource.getKey(((i={}).id=m,i.qt="allmyphotos",i.tagFilter=e,i)),n=this._urlDataSource.getKeyParams(t),[4,this._itemProvider.getItem({avoidSeamSnapping:!0,parentKey:t,ownerId:this.getOwnerId(),skipCache:!0,pageSize:0,filters:{tagFilter:n.tagFilter,locationFilter:n.locationFilter}})];case 1:return[2,{counts:[{count:a.sent().content().items.length,headers:[e,e,e],labels:[e,e,e]}]}]}})})},e.prototype._getGroupToCountForOnThisDay=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._getPhotoRecordsForOnThisDay(0,0,e)];case 1:if(0===(t=a.sent()).length)return[2,{counts:[]}];if(!t[0].dateTakenTime)throw new Error("Invalid date object");for(n=t[0].dateTakenTime.getUTCFullYear(),i=[],r=0,o=0;o<t.length;o++)(s=t[o]).dateTakenTime&&((c=s.dateTakenTime.getUTCFullYear())!==n&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]}),n=c,r=0),r++);return r>0&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]})),[2,{counts:i}]}})})},e.prototype._getStartDate=function(e,t){for(var n=0,a=-1,i=0,r=0;r<this._groupToCount.length;r++){if((n+=this._groupToCount[r].count)>e){a=r;break}i=n}return a>=0?{date:this._groupToCountDate[a],index:i}:{date:void 0,index:-1}},e.prototype._makeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._vroomDataRequestor.send({apiName:"allPhotos",path:e,useAuthorizationHeaders:!0})];case 1:return t=n.sent(),[3,3];case 2:throw n.sent(),new Error("error loading "+e);case 3:return[2,t]}})})},e.prototype._timeStampToDate=function(e){var t=e;return null==t&&(t="0000-00-00 12:00:00 AM"),/[A,P]M/.test(t)&&(t=t.replace(/-/g,"/")),new Date(t)},e.prototype._transformIOneDriveItemsToIPhotoRecords=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:o=t,a.label=1;case 1:return o<n?e[o]?(s=e[o](),[4,this._transformPhoto(s)]):[3,3]:[3,5];case 2:return r=a.sent(),i.push(r),[3,4];case 3:i.push({id:"",thumbnails:[],name:o.toString(),dateTakenTime:r?r.dateTakenTime:new Date,isVideo:!1}),a.label=4;case 4:return++o,[3,1];case 5:return[2]}})})},e.prototype._transformPhoto=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,s,c,d,l,u,f,p,m,_,h;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return".gif"!==t.extension||t.photo&&t.photo.originalUrl?[3,2]:[4,this._itemProvider.getItem({parentKey:t.key})];case 1:n=a.sent(),(i=n.item()).photo&&i.photo.originalUrl?t=i:console.warn("Retrieved getItems for Gif did not have an Open URL"),a.label=2;case 2:return r=t.thumbnail&&t.thumbnail.width?t.thumbnail.width:t.photo&&t.photo.width,s=t.thumbnail&&t.thumbnail.height?t.thumbnail.height:t.photo&&t.photo.height,r&&s||(r=600,s=600,console.warn("Image doesn't have width and height, using default instead")),c=0!==s?r/s:1,d=Math.min(32,s),l=Math.floor(d*c),u=Math.min(352,s),f=Math.floor(u*c),p=void 0,t.dateTakenTime&&!e._platform.isSafari?p=t.dateTakenTime:t.dateTaken?p=this._timeStampToDate(t.dateTaken):t.dateCreatedTime&&(m=t.dateCreatedTime,_=t.dateModifiedTime,p=m&&_&&m>_?t.dateModifiedTime:t.dateCreatedTime),h=t.thumbnail?o.format(t.thumbnail.url,r,s):"",[2,{id:t.id||t.key,thumbnails:r&&s&&t.thumbnail?[{url:o.format(t.thumbnail.url,l,d),width:l,height:d},{url:o.format(t.thumbnail.url,f,u),width:f,height:u},{url:h,width:r,height:s}]:[{url:"",width:0,height:0}],name:t.name||"No Name",dateTakenTime:p,location:t.geoLocation,extension:t.extension,originalUrl:t.photo&&".gif"===t.extension?t.photo.originalUrl:h,isVideo:!!t.video}]}})})},e.prototype._mergeGroupToCounts=function(e,t){if(this._groupToCount.length>0&&e.length>0){var n=this._groupToCount.length-1;Object(i.n)(this._groupToCount[n]).join(";")===Object(i.n)(e[0]).join(";")?(this._groupToCount[n].count+=e[0].count,e.length>1&&(this._groupToCount=this._groupToCount.concat(e.slice(1)),this._groupToCountDate=this._groupToCountDate.concat(t.slice(1)))):(this._groupToCount=this._groupToCount.concat(e),this._groupToCountDate=this._groupToCountDate.concat(t))}else console.warn("Tried to add empty group to count into local groupToCount variables!")},e.prototype._logTelemetry=function(e,t,n){if(this._engagement)try{this._engagement.logData({name:(l.e[n]||"unknown")+"."+e,extraData:t})}catch(e){console.warn("Exception while logging! ResourceScope may have been disposed.")}},e._platform=new d.e,e}()},2565:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(1),r=n(58),o=n(1732),s=n(51),c=n(32),d=n(399),l=function(e){var t=e.pendingNavigation,n=e.layout,r=e.disabled,s=void 0===r||r,c=e.version,d=Object(a.__rest)(e,["pendingNavigation","layout","disabled","version"]),l=i.useRef(null),u=i.useRef(),f=e.disableFirstFocus,p=i.useRef(f);return p.current=f,i.useEffect(function(){if(!p.current)return t&&t.pendingNavigationSignal.promise.then(function(){u.current=setTimeout(function(){l.current&&l.current.focus()},0)}),function(){u.current&&clearTimeout(u.current)}},[t,n,c,p]),i.createElement(o.e,Object(a.__assign)({disabled:s,disableFirstFocus:!0,componentRef:l},d),e.children)},u=Object(r.t)(function(e,t){var n=Object(c.e)(e).itemsScopeItemKey,r=e.demandItemFacet(s.o,n),o=Object(d.e)(e);return i.createElement(l,Object(a.__assign)({},t,{pendingNavigation:r,layout:o}))})},2580:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(236),i=function(){function e(e){this._callback=e,this._timeStart=0,this._timeEnd=0}return e.prototype.start=function(e){this._timeStart=Date.now(),this._userInteraction=e},e.prototype.onVisibleImageDone=function(){this._timeEnd=Date.now()},e.prototype.end=function(){(0===this._timeEnd||this._timeEnd<this._timeStart)&&(this._timeEnd=Date.now()),0!==this._timeStart&&this._timeStart!==this._timeEnd&&void 0!==this._userInteraction&&(this._callback(this._timeStart,this._timeEnd,this._userInteraction),this._timeStart=0,this._timeEnd=0,this._userInteraction=void 0)},e}(),r=n(983),o=function(){function e(e){this.timeMounted=e}return e.prototype.wasUpdatedAfter=function(e){return void 0!==this.timeMounted&&this.timeMounted>=e||void 0!==this.timeSrcSet&&this.timeSrcSet>=e||void 0!==this.timeLoaded&&this.timeLoaded>=e||void 0!==this.timeErrored&&this.timeErrored>=e},e}(),s=function(e){this.timings=new o(e),this.visible=!1},c=function(){function e(e,t){var n=this;this.sendPageLoadTelemetry=function(e,t,a){var i=n._getImageTelemetry(e);i&&(i.time=t-e,i.userInteraction=a,a===r.i.PageLoad&&n._onPageLoadCallbackHandler&&n._onPageLoadCallbackHandler(),n._telemetryCallbacks.genericEvent&&n._telemetryCallbacks.genericEvent("AllPhotos.PageLoadTime",i))},this._sendLoadEvent=function(){n._galleryLoadLogger.end()},this._telemetryCallbacks=e,this._onPageLoadCallbackHandler=t,this._initTime=Date.now(),this._userInteraction=r.i.PageLoad,this._galleryImageState=new Map,this._galleryLoadLogger=new i(this.sendPageLoadTelemetry),this._async=new a.e,this._debouncedSendLoadEvent=this._async.debounce(this._sendLoadEvent,2500),this._fileTotalCount=void 0,this._fileMountCount=0,this._fileMountIndexMax=0,this._fileLoadCount=0,this._fileLoadIndexMax=0,this._fileVisibleCount=0,this._fileVisibleIndexMax=0,this._scrubberJumpUsed=!1,this._scrubberJumpIndex=0,this._galleryLoadLogger.start(r.i.PageLoad),this._mark("AllPhotos.PageLoad.Start")}return e.prototype.onScrubberLoaded=function(e){if(this._fileTotalCount=e,this._telemetryCallbacks.genericEvent){var t=Date.now()-this._initTime;this._telemetryCallbacks.genericEvent("AllPhotos.ScrubberLoadTimeMs",{time:t})}this._mark("AllPhotos.ScrubberLoad")},e.prototype.onGallerySessionEnd=function(){this._telemetryCallbacks.genericEvent&&this._telemetryCallbacks.genericEvent("AllPhotos.GallerySessionEnd",{fileTotalCount:this._fileTotalCount,fileMountCount:this._fileMountCount,fileMountIndexMax:this._fileMountIndexMax,fileLoadCount:this._fileLoadCount,fileLoadIndexMax:this._fileLoadIndexMax,fileVisibleCount:this._fileVisibleCount,fileVisibleIndexMax:this._fileVisibleIndexMax,scrubberJumpUsed:this._scrubberJumpUsed,scrubberJumpIndex:this._scrubberJumpIndex,lastUserInteraction:this._userInteraction})},e.prototype.onScrubberClicked=function(e){this._scrubberJumpUsed=!0,this._scrubberJumpIndex=e},e.prototype.setUserInteraction=function(e){this._userInteraction=e,this._mark("AllPhotos.UserInteraction.".concat(e))},e.prototype.onPageUpdate=function(){this._galleryLoadLogger.end(),this._galleryLoadLogger.start(this._userInteraction),this._mark("AllPhotos.".concat(this._userInteraction,".Start"))},e.prototype.onImageMounted=function(e){this._fileMountCount+=1,this._fileMountIndexMax=Math.max(e,this._fileMountIndexMax),this._addImageLog(e,Date.now())},e.prototype.onImageUnmounted=function(e){this._removeImageLog(e)},e.prototype.onImageSrcChanged=function(e){var t=this._getImageLog(e);t.timings.timeSrcSet=Date.now(),t.timings.timeLoaded=void 0,t.timings.timeErrored=void 0},e.prototype.onImageLoaded=function(e,t){this._fileLoadCount+=1,this._fileLoadIndexMax=Math.max(e,this._fileLoadIndexMax);var n=this._getImageLog(e);n.visible=t,n.timings.timeErrored=void 0,n.timings.timeLoaded=Date.now(),t&&(this._fileVisibleCount+=1,this._fileVisibleIndexMax=Math.max(e,this._fileVisibleIndexMax),this._galleryLoadLogger.onVisibleImageDone()),this._debouncedSendLoadEvent()},e.prototype.onImageErrored=function(e,t,n){var a=this._getImageLog(e);a.visible=t,a.timings.timeErrored=Date.now(),a.timings.timeLoaded=void 0,a.url=n,t&&this._galleryLoadLogger.onVisibleImageDone(),this._debouncedSendLoadEvent()},e.prototype._addImageLog=function(e,t){this._galleryImageState.set(e,new s(t))},e.prototype._getImageLog=function(e){var t=this._galleryImageState.get(e);return t||(t=new s(Date.now()),this._galleryImageState.set(e,t)),t},e.prototype._removeImageLog=function(e){this._galleryImageState.delete(e)},e.prototype._getImageTelemetry=function(e){var t=!1,n=!1,a=0,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,c=Array(),d=Array(),l=Array(),u=Array();if(this._galleryImageState.forEach(function(f,p){var m;if(f&&f.visible&&f.timings.wasUpdatedAfter(e)&&(t=!0,i=Math.min(i,p),r=Math.max(r,p),void 0!==f.timings.timeErrored&&(a+=1,u.push({index:p,url:null!==(m=f.url)&&void 0!==m?m:""})),f.visible)){o=Math.min(o,p),s=Math.max(s,p);var _=f.timings.timeMounted-e;if(_>0&&c.push(_),void 0!==f.timings.timeSrcSet){var h=f.timings.timeSrcSet-e;h>0&&d.push(h)}if(void 0!==f.timings.timeLoaded){var b=f.timings.timeLoaded-e;b&&l.push(b)}else void 0===f.timings.timeErrored&&(n=!0)}}),t){var f={mounted:this._getArrayMinMaxAvg(c),srcSet:this._getArrayMinMaxAvg(d),loaded:this._getArrayMinMaxAvg(l)};return{errorCount:a,imageRange:[i,r],visibleImageRange:[o,s],visibleImageTimings:JSON.stringify(f),interrupted:n,urlsError:u}}},e.prototype._getArrayMinMaxAvg=function(e){if(0===e.length)return{count:0};for(var t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,a=0,i=0,r=e;i<r.length;i++){var o=r[i];t=Math.min(t,o),n=Math.max(n,o),a+=o}return{min:t,max:n,avg:Math.round(a/e.length),count:e.length}},e.prototype._mark=function(e){performance&&performance.mark&&performance.mark(e)},e}()},2581:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"customOverlay",function(){return s}),n.d(a,"customOverlayHovered",function(){return c}),n.d(a,"customOverlaySelected",function(){return d}),n.d(a,"customOverlayFocused",function(){return l}),n.d(a,"customOverlayBorder",function(){return u}),n.d(a,"customOverlayInner",function(){return f}),n.d(a,"customOverlayInnerHovered",function(){return p}),n.d(a,"customOverlayInnerSelected",function(){return m}),n.d(a,"customOverlayInnerBorder",function(){return _});var i=n(0),r=n(1),o=n(17);Object(o.n)([{rawString:".customOverlay_4f5d120d{border-width:1px;border-style:solid}.customOverlay_4f5d120d.customOverlayHovered_4f5d120d{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.customOverlay_4f5d120d.customOverlaySelected_4f5d120d{border-color:#0078d4}.customOverlay_4f5d120d.customOverlaySelected_4f5d120d.customOverlayHovered_4f5d120d{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.customOverlay_4f5d120d.customOverlaySelected_4f5d120d.customOverlayHovered_4f5d120d.customOverlayFocused_4f5d120d{border-color:#605e5c}.customOverlay_4f5d120d.customOverlayFocused_4f5d120d{border-color:#605e5c}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d{border-width:2px;border-style:solid;border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d .customOverlayInner_4f5d120d{border-width:1px;border-style:solid}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d .customOverlayInner_4f5d120d.customOverlayInnerHovered_4f5d120d{border-color:#323130}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d .customOverlayInner_4f5d120d.customOverlayInnerSelected_4f5d120d{border-color:#0078d4}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d .customOverlayInner_4f5d120d.customOverlayInnerSelected_4f5d120d.customOverlayInnerHovered_4f5d120d{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.customOverlay_4f5d120d .customOverlayBorder_4f5d120d .customOverlayInner_4f5d120d .customOverlayInnerBorder_4f5d120d{border-width:2px;border-style:solid;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}\n"}]);var s="customOverlay_4f5d120d",c="customOverlayHovered_4f5d120d",d="customOverlaySelected_4f5d120d",l="customOverlayFocused_4f5d120d",u="customOverlayBorder_4f5d120d",f="customOverlayInner_4f5d120d",p="customOverlayInnerHovered_4f5d120d",m="customOverlayInnerSelected_4f5d120d",_="customOverlayInnerBorder_4f5d120d",h=n(2465),b=n(50),g=a,v=function(e){function t(t){return e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props.isHovered||this.props.isFocused||this.props.isSelected,t=void 0;if(this.props.isFocused&&(this.props.isHovered||this.props.isSelected)){var n=this._getOutlineElement(g.customOverlayInnerBorder,g.customOverlayInnerBorderSelected,g.customOverlayInnerBorderHovered,g.customOverlayInnerBorderFocused,void 0);t=this._getOutlineElement(g.customOverlayInner,g.customOverlayInnerSelected,g.customOverlayInnerHovered,g.customOverlayInnerFocused,n)}var a=this._getOutlineElement(g.customOverlayBorder,g.customOverlayBorderSelected,g.customOverlayBorderHovered,g.customOverlayBorderFocused,t),i=this._getOutlineElement(g.customOverlay,g.customOverlaySelected,g.customOverlayHovered,g.customOverlayFocused,a);return!this.props.isScrolling&&e?r.createElement(r.Fragment,null,i):r.createElement(r.Fragment,null)},t.prototype._getOutlineElement=function(e,t,n,a,i){return r.createElement("div",{className:Object(b.e)(e,h.e,this.props.isSelected?t:"",this.props.isFocused?a:"",this.props.isHovered?n:"")},i)},t}(r.PureComponent);t.e=v},2628:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(11),i=n(983);function r(){return Object(a.isFeatureEnabled)(a.HideExploreYourPhotosCarousel)}function o(e){switch(e){case"0":return i.n[i.n.carousel];case"1":return i.n[i.n.syncClient];case"2":return i.n[i.n.email];case"3":return i.n[i.n.cherryHill];case"4":return i.n[i.n.filesCarousel];default:return i.n[i.n.unknown]}}},2768:function(e,t,n){"use strict";n.d(t,"e",function(){return he});var a=n(0),i=n(28),r=n(2313),o=n(2314),s=n(2315),c=n(2307),d=n(311),l=n(209),u=n(379),f=n(1112),p=n(2303),m=n(19),_=n(382),h=n(137),b=n(286),g=n(7),v=n(89),y=n(392),S=n(990),D=n(107),I=n(55),x=n(1103),C=n(2033),O=n(1743),w=n(576),E=n(346),A=n(1111),L=n(1109),k=n(1110),M=n(2097),P=n(1062),T=n(1007),U=n(1775),F=n(201),H=n(2257),R=n(440),N=n(595),B={ODC:"EnableRecommendationApi"};function j(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n(V(e))];case 1:return t.sent(),[2]}})})}}function V(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:for(t={items:{}},i=0,r=e;i<r.length;i++)o=r[i],t.items[o]={demands:(s={},s[m.e.id]=!0,s[g.u.id]=!0,s)};return[4,n(Object(P.e)(t))];case 1:return[2,a.sent()]}})})}}var z=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=p.e.deserialize(n),r=i.driveId,o=i.endpoint;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,s,c,d,l,u,f,P,V,z,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re;return Object(a.__generator)(this,function(oe){switch(oe.label){case 0:return[4,e(Object(T.e)(function(e){t=e.demandItemFacet(U.i,F.e,{suppressGetItems:!0}),i=e.demandItemFacet(N.t,F.e)}))];case 1:return oe.sent(),E.n.isFeatureEnabled(B)?(s=Object(S.e)({expand:"thumbnails"}),c={qosName:"recommendations",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/view.recommendedItems?").concat(s)},[4,e(Object(D.t)(c))]):[3,3];case 2:return d=oe.sent().value,l=new _.e,u=[],d&&(d.forEach(function(e){u.push(function(e,t,n,i){var r,o,s=e.name,c=e.id,d=e.recommendation,l=d.recommendationType,u=d.startDate,f=Object(O.e)(new Date(u)),p=(e.thumbnails||[])[0];if(p){var _=p.large||p.medium||p.small;_&&(o={url:_.url,width:_.width,height:_.height})}var S=h.e.serialize({photosRootKeyPart:{driveId:n,endpoint:i},groupBy:b.e.Date,filter:c,filterType:l}),D=x.e.serialize({driveId:n,endpoint:i,type:l,resourceId:"root"});return t.resolveItems({items:(r={},r[D]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},g.u.pack(s)),C.e.pack(l)),y.i.pack(f.toISOString())),v.h.pack(o)),g._.pack({})),m.t.pack({itemKey:S})),r)}),D}(e,l,r,o))}),l.resolveItems({items:(ae={},ae[n]=Object(a.__assign)({},m.e.pack({itemKeys:u})),ae)})),e(l.execute()),[3,6];case 3:return t||E.n.isFeatureEnabled(H.e)?(f=[],P=p.e.deserialize(n),(V=new Date).setHours(0,0,0,0),z={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:V.toISOString()},K=L.e.serialize(z),(W=new Date).setHours(0,0,0,0),W.setMonth(W.getMonth()-1),W.setDate(1),q={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:W.toISOString(),applyUtilityFiltering:!0},Q=k.e.serialize(q),(Y=new Date).setHours(0,0,0,0),J=Y.getDay(),(X=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate()-J+(0===J?-6:1))).setDate(X.getDate()-7),Z={driveId:P.driveId,endpoint:P.endpoint,resourceId:"root",date:X.toISOString(),applyUtilityFiltering:!0},$=A.e.serialize(Z),ee=M.e.serialize(P),[4,e(j([K,Q,$,ee]))]):[3,6];case 4:return oe.sent(),[4,e(Object(T.e)(function(e){var t=e.demandItemFacet(m.e,ee),n=t&&t.itemKeys||[];f.push(G(I.e.OnThisDay,r,o,K)),f.push(G(I.e.OnThisMonth,r,o,Q,q.date,q.applyUtilityFiltering)),f.push(G(I.e.LastWeekPreviousYears,r,o,$,Z.date,Z.applyUtilityFiltering)),n.forEach(function(e){var t=w.e.deserialize(e),n=t.countryOrRegion,a=t.city,i=t.state,s=t.locality;f.push(x.e.serialize({driveId:r,endpoint:o,type:I.e.PromotedPlaces,resourceId:"root",key:e,filter:[n,i,a||s].join(String.fromCharCode(9))}))})}))];case 5:oe.sent(),(te=new _.e).resolveItems({items:(ie={},ie[n]=Object(a.__assign)({},m.e.pack({itemKeys:f})),ie)}),i&&(ne=x.e.serialize(Object(a.__assign)(Object(a.__assign)({},P),{type:I.e.PhotoStoryStaticCard,resourceId:"root"})),te.resolveItems({items:(re={},re[ne]=Object(a.__assign)(Object(a.__assign)({},R.e.pack(I.e.PhotoStoryStaticCard)),g._.pack({})),re)})),e(te.execute()),oe.label=6;case 6:return[2]}})})}});function G(e,t,n,a,i,r){return x.e.serialize({driveId:t,endpoint:n,type:e,resourceId:"root",key:a,date:i,applyUtilityFiltering:r})}var K=n(654),W=n(394),q=n(1091),Q=Object(i.t)(function(){return function(e){e(f.e),e(Object(l.t)({keyFacet:p.e,facets:[m.e,g.u]})),e(Object(d.a)(p.e,u.e)(z)),e(Object(K.e)(x.e,W.e)(q.t))}}),Y=n(2505),J=n(2507),X=n(524),Z=n(2183),$=n(1810),ee=n(363),te=n(8),ne=n(2506),ae=n(61),ie=n(2504),re=n(2366),oe=n(95),se=n(2367),ce=n(1834),de=n(1833),le=n(336),ue=n(833),fe=n(338),pe=n(12),me=new te.t({name:"PrefetchCarouselAddon",factory:{dependencies:{identityDataSource:ae.D},create:function(e){var t=e.identityDataSource;return{instance:new ie.e(t)}}}}),_e=!pe.t.isActivated("C8D7C238-3F3E-4A7A-BF73-B6661092EC15","2022-05-24","show dynamic ps cards on photos carousel");function he(e,t,n,d,u){var f=this;return Object(i.t)(function(){return function(i){return Object(a.__awaiter)(f,void 0,void 0,function(){var f,p,m,h,b,g,v,y,S,D,I,x;return Object(a.__generator)(this,function(C){return i(r.e),i(o.e),i(s.e),i(c.e),i(Q),_e&&Object(fe.n)()&&d&&i(d.addon),u.expose(ae.Q,new(u.injected(re.e))),u.expose(oe.v,new(u.injected(se.e))),f=u.consume(me),(p=new _.e).resolveItems({items:(I={},I[de.e]=Object(a.__assign)({},ce.e.pack(f)),I)}),i(Object(l.e)({items:(x={},x[de.e]=Object(a.__assign)({},ce.e.pack(f)),x[F.e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},U.a.pack(f.isEnableLastWeekPreviousYearsExpOn())),U.n.pack(f.isEnableMonthRecapGroupHeaderExpOn())),U.i.pack(f.isEnableNewCarouselDesignExpOn())),ue.e.pack({accessMemoriescardStaticImage:window.require.toUrl("odsp-media/images/staticcards/accessmemoriescard.svg"),psIntroCardStaticImage:window.require.toUrl("odsp-media/images/staticcards/psintrocard.svg")})),N.t.pack(Object(fe.n)())),x)})),i(p.execute()),m=u.consume(le.e),h=new te.t({name:"PrefetchCarouselAddon",factory:{dependencies:{vroomDataRequestor:$.e,store:ee.e},create:function(a){var i=a.vroomDataRequestor,r=a.store,o=new J.e(i,e,t,n,m);return{instance:new Y.e(i,r,o)}}}}),b=u.consume(h),g=u.consume(X.t),v=pe.t.isActivated("882A3AE3-7D25-485F-B28D-658F339604DF")?"browser.pipe.aria.microsoft.com":"/Collector/3.0/",g&&g.rumone&&g.rumone.startAPIMeasurement&&g.rumone.startAPIMeasurement({ignore:function(e){return e.indexOf(v)>=0}}),S={addonSource:b,logRumOneData:function(e,t){g&&g.logRUMOneForItemsScopeListView(e,t,y)},logTTI:y=function(){i(Object(Z.a)())},pageSize:100,initialBurstSize:100,widthsPageSize:250},i(Object(U.c)(S)),D=u.consume(ne.e),i(D),[2]})})}})}},3098:function(e,t,n){"use strict";n.r(t);var a=n(1488);n.d(t,"Check",function(){return a.e}),n.d(t,"CheckBase",function(){return a.t})},3115:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return hr}),n.d(t,"knockoutResourceKey",function(){return br});var a={};n.r(a),n.d(a,"ReactGridGalleryScrollBar",function(){return tt}),n.d(a,"ReactGridGallery",function(){return nt});var i={};n.r(i),n.d(i,"groupHeader",function(){return rt}),n.d(i,"groupHeaderTitle",function(){return ot}),n.d(i,"groupHeaderMenu",function(){return st}),n.d(i,"groupHeaderCheckbox",function(){return ct}),n.d(i,"checkVisible",function(){return dt}),n.d(i,"checkHidden",function(){return lt});var r={};n.r(r),n.d(r,"groupHeaderMenu",function(){return mt}),n.d(r,"locationHeader",function(){return _t}),n.d(r,"locationStyle",function(){return ht});var o={};n.r(o),n.d(o,"tileViewport",function(){return At}),n.d(o,"thumbnailTile",function(){return Lt}),n.d(o,"tileViewportTopLeft",function(){return kt}),n.d(o,"tileViewportTopRight",function(){return Mt}),n.d(o,"tileViewportBottomLeft",function(){return Pt}),n.d(o,"tileViewportBottomRight",function(){return Tt}),n.d(o,"tileViewportImage",function(){return Ut});var s={};n.r(s),n.d(s,"header_md_separator",function(){return jn}),n.d(s,"header_md_text",function(){return Vn});var c=n(0),d=n(1),l=n(1776),u=n(1558),f=(n(1512),n(25)),p=n(1794),m=n(61),_=n(1810),h=n(977),b=n(17);Object(b.n)([{rawString:".Tile-playButton{position:absolute;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:8px;font-size:1.3em}[dir=ltr] .Tile-playButton{left:8px}[dir=rtl] .Tile-playButton{right:8px}"}]);var g=n(2160),v=n(1803),y=n(116),S=n(1744),D=[640,768,1024,1366,1920,2560],I=[160,175,190,200,205,225],x=[32,32,32,32,32,32],C=[2,2,2,2,2,2],O=[0,28,28,32,32,32],w=[0,16,32,64,128,256],E=[0,16,32,32,32,32],A=[0,28,28,64,64,64],L=[3,1.58,1.35,1.25,1.2,1.2],k=[26,26,26,40,40,40],M=[22,40,40,40,40,40],P=[16,0,0,0,0,0],T=[20,32,32,32,32,32],U=[28,40,40,40,40,40],F=[24,24,24,44,44,44],H=[20,20,20,20,20,20],R=[20,20,20,20,20,20],N=[28,28,28,28,28,28],B=[125,125,125,125,125,125],j=[0,0,0,0,0,0],V=[1,1,1,1,1,1],z=[0,28,28,32,32,32],G=[0,28,28,64,64,64],K=[4,1.6,1.6,1.6,1.6,1.6],W=[2,2,2,2,2,2],q=[2,2,2,2,2,2],Q=[8,0,0,0,0,0],Y=[16,32,64,128,128,256],J=[16,32,64,128,128,256],X=[16,32,64,128,128,256],Z=[16,32,64,128,128,256],$=[6,6,6,6,6,6],ee=[6,6,6,6,6,6],te=[0,0,0,0,0,0],ne=[35,35,35,35,35,35],ae=[1,1,1,1,1,1],ie=[170,190,210,220,230,240],re=[3,2.68,2.4,2.3,2.2,2.1],oe=[1.6,1.58,1.35,1.25,1.2,1.2],se=[0,16,32,32,32,32],ce=[0,16,60,60,60,60],de=[20,20,30,30,40,40],le=[20,20,30,30,40,40],ue=[16,0,0,0,0,0],fe=n(22),pe=n(410),me=n(11),_e=n(1476),he=n(2628),be=n(35),ge=n(58),ve=n(99),ye=n(142),Se=n(373),De=n(1466),Ie=n(1816),xe=n(1957),Ce=n(137),Oe=n(18),we=n(50);Object(b.n)([{rawString:".calloutMain_355d015c{position:absolute;border-radius:2px;background:#fff;border-radius:2px;-webkit-box-shadow:0px 1.6px 3.6px 0px rgba(0,0,0,0.13),0px 0.3px 0.9px 0px rgba(0,0,0,0.11);box-shadow:0px 1.6px 3.6px 0px rgba(0,0,0,0.13),0px 0.3px 0.9px 0px rgba(0,0,0,0.11)}@media screen and (-ms-high-contrast: active), screen and (forced-colors: active){.calloutMain_355d015c{-ms-high-contrast-adjust:none;forced-color-adjust:none}}.calloutMain_355d015c:hover{border-radius:2px;-webkit-box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11);box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11)}.calloutMain_355d015c:focus{border-radius:0px;border:1px solid #605e5c;height:32px;width:84px}.calloutMain_355d015c:active{border-radius:2px;-webkit-box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11);box-shadow:0px 6.4px 14.4px 0px rgba(0,0,0,0.13),0px 1.2px 3.6px 0px rgba(0,0,0,0.11)}.textCallout_355d015c{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:rgba(0,0,0,0);font-weight:550}\n"}]);var Ee=n(814),Ae=function(e){function t(t){var n=e.call(this,t)||this;return n._onMouseDown=function(e){n.props.onMouseDown(e)},n._onMouseUp=function(e){n.props.onMouseUp(e)},n._onMouseEnter=function(e){n.props.onMouseEnter(e)},n._onMouseLeave=function(e){n.props.onMouseLeave(e)},n.state={tagWidth:n.props.width,listenToPointerEvents:!1},n.textCallout=d.createRef(),n.calloutRef=d.createRef(),n._currentCalloutCaption=t.caption,n}return Object(c.__extends)(t,e),t.prototype.getTagWidth=function(){var e=this.props.width;if(this.textCallout.current){var t=this.textCallout.current.getBoundingClientRect().width;if(e=t,t<this.props.width)return this.props.width}return e},t.prototype.setListenToPointerEvents=function(e){this.setState({listenToPointerEvents:e})},t.prototype.setCalloutTextValue=function(e){this.textCallout&&this.textCallout.current&&this._currentCalloutCaption!==e&&(this.textCallout.current.innerHTML=e,this._currentCalloutCaption=e,this._tryUpdateCalloutWidth())},t.prototype.setTopValue=function(e){this.calloutRef&&this.calloutRef.current&&(this.calloutRef.current.style.top=e.toString()+"px")},t.prototype.componentDidUpdate=function(){this._tryUpdateCalloutWidth()},t.prototype.render=function(){var e=this.props,t=e.textOffset,n=e.caption,a=e.top,i=e.height,r=e.offsetFromScrollbar,o=e.textOffsetOnScrollbarSide,s=e.fontSize,c={position:"absolute",left:"",right:"",top:a,width:this.state.tagWidth+2*t,height:i,pointerEvents:this.state.listenToPointerEvents?"all":"none"};return Ee.e.isRightToLeft?c.left=r+"px":c.right=r+"px",n?d.createElement("div",{className:Object(we.e)("".concat("calloutMain_355d015c")),style:c,key:"callout_display",onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,ref:this.calloutRef},d.createElement("svg",{width:"100%",height:"100%"},d.createElement("text",{ref:this.textCallout,className:Object(we.e)("".concat("textCallout_355d015c")),textAnchor:/MSIE|Trident/.test(window.navigator.userAgent)&&Ee.e.isRightToLeft?"start":"end",x:Ee.e.isRightToLeft?o+t:this.state.tagWidth-o+t,y:i-t-2,fill:"rgb(0;0;0)",height:s,key:"cursor_text",fontSize:s},n))):d.createElement("div",null)},t.prototype._tryUpdateCalloutWidth=function(){var e=this.getTagWidth();e!==this.state.tagWidth&&this.setState({tagWidth:e})},t}(d.Component),Le=function(){function e(e,t){var n=this;this._update=function(){if(n._animationFrameId=null,n._isUpdateActive){if(n._value!==n._animEndValue){var e=+new Date-n._animStartTime-n._animationDelay;if(e<0)return void(n._animationFrameId=window.requestAnimationFrame(n._update));var t=e/n._animDurationMs;t<0&&(t=0),t>1&&(t=1);var a=n._animStartValue+(n._animEndValue-n._animStartValue)*t;n._value=a,n._onValueChanged&&n._onValueChanged(a),1===t&&(n._isUpdateActive=!1)}n._animationFrameId=window.requestAnimationFrame(n._update)}},this._isUpdateActive=!1,this._animStartTime=+new Date,this._animStartValue=-1,this._animEndValue=-1,this._animDurationMs=100,this._animationDelay=0,this._value=t,this._onValueChanged=e,this._animationFrameId=null}return e.prototype.animateTo=function(e,t,n){void 0===n&&(n=0),e!==this._animEndValue&&(this._animStartTime=+new Date,this._animStartValue=this._value,this._animEndValue=e),this._animDurationMs=t,this._animationDelay=n,this._startUpdates()},e.prototype.dispose=function(){null!==this._animationFrameId&&(window.cancelAnimationFrame(this._animationFrameId),this._animationFrameId=null),this._isUpdateActive=!1},e.prototype._startUpdates=function(){this._isUpdateActive||(this._isUpdateActive=!0,this._animationFrameId=window.requestAnimationFrame(this._update))},e}();Object(b.n)([{rawString:".normalText_0b454417{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-ser-select:none;-ms-user-select:none;user-select:none;color:gray;font-size:12px;-webkit-text-fill-color:gray}\n"}]);var ke,Me=function(e){function t(t){return e.call(this,t)||this}return Object(c.__extends)(t,e),t.prototype.render=function(){var e=this.props.item;return d.createElement("g",null,d.createElement("rect",{x:Ee.e.isRightToLeft?this.props.x-12:this.props.x-20,y:e.yPosition-7.5,height:this.props.height+"px",width:"35px",rx:"2",ry:"2",fill:"rgb(255,255,255)",fillOpacity:"0.8"}),d.createElement("text",{textAnchor:/MSIE|Trident/.test(window.navigator.userAgent)&&Ee.e.isRightToLeft?"start":"end",x:Ee.e.isRightToLeft?this.props.x-10:this.props.x+10,y:e.yPosition+10,className:"normalText_0b454417"},e.text))},t}(d.Component);!function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third"}(ke||(ke={})),Object(b.n)([{rawString:".scrubber_197f21b6{outline:none;cursor:pointer}.timeLine_197f21b6{position:absolute;border:0px;padding:0px;padding-left:0px;padding-right:0px;overflow:hidden;pointer-events:none;outline:none}html[dir='ltr'] .timeLine_197f21b6{margin-right:0px}html[dir='rtl'] .timeLine_197f21b6{margin-left:0px}.timeLine_197f21b6:focus{outline:none;outline-color:none;outline-width:0px}.timeLineInteractive_197f21b6{position:absolute;border:0px;padding:0px;padding-left:0px;padding-right:0px;overflow:hidden;pointer-events:auto;outline:none}html[dir='ltr'] .timeLineInteractive_197f21b6{margin-right:0px}html[dir='rtl'] .timeLineInteractive_197f21b6{margin-left:0px}.timeLineInteractive_197f21b6:focus{outline:none;outline-color:none;outline-width:0px}\n"}]);var Pe,Te="timeLine_197f21b6",Ue=n(31);!function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(Pe||(Pe={}));var Fe=0,He=function(e){function t(t){var n=e.call(this,t)||this;return n._scrubberTexts=[],n._calloutDataByYPos=[],n._show=function(){n._fader.animateTo(1,267),n._clearHideTimer(),n._scrubberIsActivated=!0},n._hideScrubber=function(){n._fader.animateTo(0,267,300),n._scrubberIsActivated=!1},n._onParentScrolled=function(e){var t=n.props.layout.getTotalHeight();if(t>0){var a=e.target.scrollTop/n.props.layout.getTotalHeight()*t;n.setState({scrollTop:a,showCursorAtMouse:n._containsMouse}),n._interacted(),n._containsMouse||n._mouseDownFlag||(n._hideTimer=window.setTimeout(n._hideScrubber,300))}},n._handleWindowMouseOrTouchMove=function(e){var t=n._clickInScrubberRegion;if(t||n._containsMouse){e.preventDefault();var a=n._getMouseYPositionFromEvent(e);if(t){var i=n._calculateScrollRow(a);n._scrollToRow(i)}if(n._scrubberCalloutRef&&n._scrubberCalloutRef.current){var r=n._clampMouseYPosToScrubber(a);n._scrubberCalloutRef.current.setTopValue(n._calculateCallOutTopValue(r));var o=n._calloutDataByYPos[r].calloutLabel;n._scrubberCalloutRef.current.setCalloutTextValue(o)}}},n._handleTouchEnd=function(e){n._clickInScrubberRegion=!1},n._handleWindowMouseDown=function(e){n._mouseDownFlag=!0,e.clientX>=window.innerWidth-n._totalWidth-n.state.scrollbarWidth&&n.props.onMouseDown&&n.props.onMouseDown()},n._onMouseEnter=function(e){n._containsMouse=!0,n.setState({showCursorAtMouse:!0}),n._scrubberCalloutRef&&n._scrubberCalloutRef.current&&n._scrubberCalloutRef.current.setListenToPointerEvents(!0),n._interacted()},n._onMouseLeave=function(e){n._containsMouse=!1,n._clickInScrubberRegion||n._hideScrubber()},n._onMouseDown=function(e){e.preventDefault();var t=n._getMouseYPositionFromEvent(e),a=n._calculateScrollRow(t);n._scrollToRow(a),n._clickInScrubberRegion=!0,n.setState({mouseY:t,showCursorAtMouse:!0})},n._onTouchStart=function(e){n._clickInScrubberRegion=!0},n._handleWindowMouseUp=function(e){(n._clickInScrubberRegion||n._mouseDownFlag)&&(n._clickInScrubberRegion=!1,n._containsMouse||n._hideScrubber(),n._mouseDownFlag=!1,n.props.onMouseUp&&n.props.onMouseUp())},n._onMouseUp=function(e){},n.state={scrollbarWidth:0,height:0,scrollTop:0,mouseY:0,showCursorAtMouse:!1,opacity:0,areLabelsAtStart:n.props.layout.getAreLabelsAtStart()},n._id="ScrubberComponent_".concat(Fe),Fe++,n._callOutLabelCount=0,n._callOutLabelsInitialized=!1,n._calloutTagWidth=100,n._calloutTagFontSize=14,n._calloutOffsetFromScrollbar=30,n._calloutTextOffsetOnScrollBarSide=0,n._calloutTextOffset=6,n._interactableWidth=100,n._scrollPosLineWidth=32,n._totalWidth=n._calloutTagWidth+n._calloutOffsetFromScrollbar,n._calloutTagHeight=n._calloutTagFontSize+2*n._calloutTextOffset,n._scrubberCalloutRef=d.createRef(),n._clickInScrubberRegion=!1,n._containsMouse=!1,n._fader=new Le(function(e){n.setState({opacity:e}),0===e&&n._scrubberCalloutRef&&n._scrubberCalloutRef.current&&n._scrubberCalloutRef.current.setListenToPointerEvents(!1)},n.state.opacity),n._mouseDownFlag=!1,n._scrubberIsActivated=!1,n}return Object(c.__extends)(t,e),t.prototype.getSelectedLabelRowIndex=function(){var e=this._getCalloutYPosition();return this._calloutDataByYPos[e].closestLabelRowIndex},t.prototype.componentDidUpdate=function(){this._updateLayout()},t.prototype.shouldComponentUpdate=function(e,t){var n=!1;return t.scrollbarWidth===this.state.scrollbarWidth&&t.height===this.state.height||(n=!0),this.props.rows!==e.rows&&(this._callOutLabelsInitialized=!1,n=!0),n&&this._buildScrubberData(e,t),!0},t.prototype.componentDidMount=function(){window.addEventListener("mouseup",this._handleWindowMouseUp),window.addEventListener("mousemove",this._handleWindowMouseOrTouchMove),window.addEventListener("mousedown",this._handleWindowMouseDown),window.addEventListener("touchend",this._handleTouchEnd),this._updateLayout()},t.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this._handleWindowMouseUp),window.removeEventListener("mousemove",this._handleWindowMouseOrTouchMove),window.removeEventListener("mousedown",this._handleWindowMouseDown),window.removeEventListener("touchend",this._handleTouchEnd),this._fader.dispose(),this._scrollBox&&(this._scrollBox.onscroll=null),this._clearHideTimer()},t.prototype.render=function(){if(this._callOutLabelsInitialized&&this._callOutLabelCount<2)return d.createElement("div",{id:this._id});var e={position:"absolute",width:this._totalWidth+"px",height:this.state.height+"px",right:"",left:"",opacity:this.state.opacity};Ee.e.isRightToLeft?e.left=this.state.scrollbarWidth+"px":e.right=this.state.scrollbarWidth+"px";var t=Object(c.__assign)(Object(c.__assign)({},e),{pointerEvents:"auto",width:this._scrubberIsActivated?this._interactableWidth+"px":this.props.activatingZone+"px"});if(0===this.props.layout.getRows().length)return d.createElement("div",{className:Object(we.e)("".concat(Te)),style:e,id:this._id,key:this._id});var n,a=this._getCalloutYPosition();a-this._calloutTagHeight/2<0&&(a=this._calloutTagHeight/2),n=d.createElement("g",{key:"scroll_pos_line"},d.createElement("rect",{id:"Fill",x:Ee.e.isRightToLeft?0:this._totalWidth-this._scrollPosLineWidth,y:a,width:"32",height:"2",rx:"1",fill:"#0078D4"}),d.createElement("circle",{id:"Oval",cx:Ee.e.isRightToLeft?this._scrollPosLineWidth:this._totalWidth-this._scrollPosLineWidth,cy:a+1,r:"3",fill:"#0078D4"})),this.state.showCursorAtMouse&&(a=this._clampMouseYPosToScrubber(this.state.mouseY));var i=this._scrubberTexts;return d.createElement("div",{id:this._id,className:Object(we.e)("".concat("scrubber_197f21b6")),key:this._id,onWheel:this.props.onWheel},d.createElement("div",{className:Object(we.e)("".concat("timeLineInteractive_197f21b6")),style:t,onMouseEnter:this._onMouseEnter,onMouseDown:this._onMouseDown,onMouseLeave:this._onMouseLeave,onMouseUp:this._onMouseUp,onTouchMove:this._handleWindowMouseOrTouchMove,onTouchStart:this._onTouchStart}),d.createElement("div",{className:Object(we.e)("".concat(Te)),style:e},d.createElement("svg",{"aria-hidden":"true",height:this.state.height,width:this._totalWidth,style:{cursor:"default"},key:"timeline"},i,n),this._calloutDataByYPos[a]&&d.createElement(Ae,{caption:this._getCallOutLabelForInitialization(a),height:this._calloutTagHeight,offsetFromScrollbar:this._calloutOffsetFromScrollbar-15,textOffsetOnScrollbarSide:this._calloutTextOffsetOnScrollBarSide,top:this._calculateCallOutTopValue(a),width:this._calloutTagWidth,textOffset:this._calloutTextOffset,fontSize:this._calloutTagFontSize,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,ref:this._scrubberCalloutRef})))},t.prototype._interacted=function(){this._show()},t.prototype._clearHideTimer=function(){this._hideTimer&&(window.clearTimeout(this._hideTimer),this._hideTimer=void 0)},t.prototype._jumptoFirstLabel=function(e){for(var t="",n=e;n<this._calloutDataByYPos.length;n++)if(""!==this._calloutDataByYPos[n].calloutLabel){t=this._calloutDataByYPos[n].calloutLabel;break}return t},t.prototype._getCallOutLabelForInitialization=function(e){var t=this._calloutDataByYPos[e].calloutLabel;return t&&0===t.localeCompare("")?this._jumptoFirstLabel(e):t},t.prototype._updateLayout=function(){var e=document.getElementById(this._id);if(e&&e.parentElement){var t=e.parentElement;if(t&&this.props.listOwnerClass){var n=t.getElementsByClassName(this.props.listOwnerClass),a=document.getElementById(this.props.galleryId);if(0!==n.length&&a){var i=n[0],r=a.offsetWidth-(i.offsetWidth>0?i.offsetWidth:a.clientWidth),o=a.clientHeight;r===this.state.scrollbarWidth&&o===this.state.height||this.setState({scrollbarWidth:r,height:o}),this._scrollBox||(this._scrollBox=a,this._scrollBox.onscroll=this._onParentScrolled)}else console.warn("Updating layout but unable to find elements")}else console.warn("Updating layout but unable to find elements")}},t.prototype._scrollToRow=function(e){this.props.scrollToRow(e)},t.prototype._calculateScrollRow=function(e){var t=this._convertFromMouseYToScrollPos(e);return this.props.layout.getRowIndexFromYPosition(t)},t.prototype._getMouseYPositionFromEvent=function(e){var t=document.getElementById(this._id);if(t){var n=t.getBoundingClientRect();return"touchmove"===e.type?e.touches[0].clientY-n.top:e.clientY-n.top}return"touchmove"===e.type?e.touches[0].clientY:e.clientY},t.prototype._clampMouseYPosToScrubber=function(e){var t=this.state.scrollbarWidth,n=this.state.height-2*t,a=Math.max(t,e);return a=Math.min(a,t+n),Math.round(a)},t.prototype._buildScrubberData=function(e,t){var n=this;if(!(this._callOutLabelsInitialized&&this._callOutLabelCount<2)){this._scrubberTexts=[],this._calloutDataByYPos=[],this._callOutLabelCount=0;var a=[],i=[],r=e.layout.getRows();if(0!==r.length){var o,s,c,l,u=e.layout.getTotalHeight(),f=t.scrollbarWidth,p=t.height-2*f,m=new Map,_=0,h={closestLabelRowIndex:-1,calloutLabel:""};r.forEach(function(r,d){var b=e.layout.getRowLevelLabel(ke.Second,d)||"",g=e.layout.getRowLevelLabel(ke.First,d);if(g!==h.calloutLabel){n._callOutLabelCount++;for(var v=Math.round(f+r.y/u*p);_<v;)n._calloutDataByYPos[_++]=h;var y=e.layout.getRowLevelLabel(ke.Third,d);if(y||(y=""),y!==s){var S=void 0;t.areLabelsAtStart?S={text:y,yPosition:v,showText:!1,key:g+";"+b+";"+y,priority:Pe.Medium}:s&&(S={text:s,yPosition:v,showText:!1,key:h.calloutLabel+";"+o+";"+s,priority:Pe.Medium}),S&&(i.push(S),a.push(S),c?l=S:c=S),s=y}if(b!==o){var D=void 0;t.areLabelsAtStart?D={text:b,yPosition:v,showText:!1,key:g+";"+b+";"+y,priority:Pe.Low}:o&&(D={text:o,yPosition:v,showText:!1,key:h.calloutLabel+";"+o+";"+s,priority:Pe.Low}),D&&(i.push(D),a.push(D))}h={closestLabelRowIndex:d,calloutLabel:g}}var I=m.has(s)?m.get(s):0;I+=1,m.set(s,I),o=b});for(var b=f+p;_<=b;)this._calloutDataByYPos[_++]=h;if(r.length>0&&!t.areLabelsAtStart){var g=e.layout.getRowLevelLabel(ke.Third,r.length-1);if(g){var v={text:g,yPosition:b-25,showText:!1,key:g+"lastitem",priority:Pe.Medium};a.push(v),i.push(v),l=v}}c&&(c.priority=Pe.High),l&&(l.priority=Pe.High),i.length>0&&(i.sort(function(e,t){var n=t.priority-e.priority;return 0!==n?n:void 0!==m.get(t.key)&&void 0!==m.get(e.key)?m.get(t.key)-m.get(e.key):0}),i.forEach(function(e,t){for(var n=!1,a=0;a<t;a++){var r=i[a];if(r.showText&&Math.abs(e.yPosition-r.yPosition)<40){n=!0;break}}e.showText=!n}));var y=0;a.map(function(e,t){e.showText&&""!==e.text&&(e.key.split(";")[2]!==a[t].text&&(e.priority<Pe.High||0===t)?n._scrubberTexts[y]=d.createElement("circle",{key:"month_"+e.key,cx:Ee.e.isRightToLeft?n._scrollPosLineWidth:n._totalWidth-n._scrollPosLineWidth,cy:e.yPosition,r:"3",fill:"#f3f2f1"}):n._scrubberTexts[y]=d.createElement(Me,{x:Ee.e.isRightToLeft?n._calloutOffsetFromScrollbar+n._calloutTextOffsetOnScrollBarSide:n._totalWidth-n._calloutOffsetFromScrollbar-n._calloutTextOffsetOnScrollBarSide,height:25,item:e,key:"text_"+e.key}),y++)}),this._callOutLabelsInitialized=!0,this._calloutTagWidth=this._getMaxCalloutLabelTextWidth(this._calloutDataByYPos)}}},t.prototype._getCalloutYPosition=function(){var e=this.props.layout.getTotalHeight(),t=this.state.scrollbarWidth,n=this.state.height-2*t,a=this.props.rows&&this.props.rows.length>0?this.props.rows[0].height:0,i=(this.state.scrollTop-a)/e*n;return Math.floor(i)},t.prototype._convertFromMouseYToScrollPos=function(e){var t=this.state.scrollbarWidth,n=this.props.layout.getTotalHeight();return Math.round(n*(e-t)/(this.state.height-2*t))},t.prototype._calculateCallOutTopValue=function(e){var t=this.state.height-this._calloutTagHeight,n=e-this._calloutTagHeight+1;return n<0?0:n>t?t:n},t.prototype._getMaxCalloutLabelTextWidth=function(e){var t=0,n=document.createElement("canvas").getContext("2d");if(n){var a=Object(Ue.L)().fonts.medium.fontFamily;n.font=this._calloutTagFontSize+"px "+a,e.forEach(function(e){if(n){var a=n.measureText(e.calloutLabel),i=Math.ceil(a.width);i>t&&(t=i)}})}return t},t}(d.Component),Re=n(2142),Ne=[],Be=[];function je(e,t){for(var n=0,a=e.length-1;n<=a;){var i=Math.floor(n+(a-n)/2),r=e[i];if(void 0!==r){var o=t(r,i);if(o>0)n=i+1;else{if(!(o<0))return i;a=i-1}}}return a>=e.length-1?e.length-1:0}var Ve=function(){function e(){this.startingPhotoIndex=-1,this.photoCount=-1,this.needsUpdate=!0,this.useNaiveLayout=!0,this.rows=[],this.rowsWereRenderedWithNaiveRiverLayout=!1}return Object.defineProperty(e.prototype,"endingPhotoIndex",{get:function(){return this.startingPhotoIndex+this.photoCount-1},enumerable:!1,configurable:!0}),e}(),ze=4/3,Ge=function(){function e(e){this.rows=[],this._widths=Object(Re.e)(0),this._currentTargetHeight=0,this._galleryLabels=e,this._layoutRanges=[],this._PreviousBuildRowsOptionsString=""}return e.prototype.setLayoutData=function(e,t,n){this._currentTargetHeight=t;var a=this._getPlaceHolderWidth();this._widths.length!==n&&(this._widths=Object(Re.t)(this._widths,n));var i=0;this._layoutRanges[0]=this._layoutRanges[0]||new Ve;var r=this._layoutRanges[0];r.useNaiveLayout=!0,r.needsUpdate=!1;for(var o=0,s=this._galleryLabels.getGroupIds(),c=0;c<this._widths.length;++c){var d=0;c<e.length&&e[c]?(r.useNaiveLayout=!1,r.rowsWereRenderedWithNaiveRiverLayout&&(r.needsUpdate=!0),d=e[c]):d=a,this._widths[c]!==d&&(r.needsUpdate=!0,this._widths[c]=d);var l=c===this._widths.length-1,u=c-o+1,f=!!l||s[c]!==s[c+1];(u>=1e3&&f||l)&&(r.startingPhotoIndex!==o&&(r.startingPhotoIndex=o,r.needsUpdate=!0),r.photoCount!==u&&(r.photoCount=u,r.needsUpdate=!0),l||(i++,this._layoutRanges[i]=this._layoutRanges[i]||new Ve,o=c+1,(r=this._layoutRanges[i]).useNaiveLayout=!0,r.needsUpdate=!1))}this._layoutRanges.length=i+1},e.prototype.getRows=function(){return this.rows},e.prototype.getAreLabelsAtStart=function(){return!1},e.prototype.getRowLevelLabel=function(e,t){var n=this.getFirstPhotoIndexInClosestImageRow(t),a=this._galleryLabels.getGroupIdbyIndex(n);return e===ke.First?this._galleryLabels.getLabel(a):e===ke.Second?this._galleryLabels.getParentLabel(a):e===ke.Third?this._galleryLabels.getGrandParentLabel(a):""},e.prototype.getPhotosCount=function(){return this._widths.length},e.prototype.isGroupHeaderRow=function(e){var t=!1;return this.rows[e]&&this.rows[e].isLabel&&(t=!0),t},e.prototype.getFirstPhotoIndexInClosestImageRow=function(e){return e>=this.rows.length&&(e=this.rows.length-1),this.rows[e].isLabel&&e++,this.rows[e].items[0].index},e.prototype.getVisibleImageIndexRange=function(e,t){if(t>=this.rows.length)console.warn("getVisibleImageIndexRange received invalid end Row value ",e,t,this.rows.length);else if(e>=this.rows.length)console.warn("getVisibleImageIndexRange received invalid start row value ",e,t,this.rows.length);else if(e!==t||!this.rows[e].isLabel)if(this.rows[e].isLabel&&e++,this.rows[t].isLabel&&t--,t>=this.rows.length)console.warn("end Row value is invalid ",e,t,this.rows.length);else if(e>=this.rows.length)console.warn("startRow row value is invalid ",e,t,this.rows.length);else{if(!(e>t)){var n=this.rows[e].items[0].index,a=this.rows[t].items.length;return{min:n,max:this.rows[t].items[a-1].index}}console.warn("unexpected startRow > endRow ",e,t,this.rows.length)}},e.prototype.getRowHeight=function(e){return this.rows[e].height&&e>=0&&e<this.rows.length?this.rows[e].height:0},e.prototype.getTotalHeight=function(){if(0===this.rows.length)return 0;var e=this.rows[this.rows.length-1];return e?e.y+e.height:0},e.prototype.getRowIndexFromImageIndex=function(e){return this._getRowIndexFromImgIdxBinarySearch(e)},e.prototype.getRowIndexFromYPosition=function(e){return je(this.rows,function(t,n){return e>=t.y+t.height?1:e<t.y?-1:0})},e.prototype.buildAllRows=function(e){var t,n;if(e.containerWidth<=0)return this.rows=[],this.rows;var a=JSON.stringify(e),i=a!==this._PreviousBuildRowsOptionsString,r=0,o=0;if(!i)for(;r<this._layoutRanges.length&&!(c=this._layoutRanges[r]).needsUpdate;)o+=c.rows.length,r++;this.rows=this.rows.slice(0,o);for(var s=r;s<this._layoutRanges.length;s++){var c;if((c=this._layoutRanges[s]).needsUpdate||i){var d=[];e.squareTiles?(d=this._buildImageRowsSquareTiles(e,c.startingPhotoIndex,c.endingPhotoIndex),c.rowsWereRenderedWithNaiveRiverLayout=!1):c.useNaiveLayout?(d=this._buildImageRowsNaiveRiverLayout(e,c.startingPhotoIndex,c.endingPhotoIndex),c.rowsWereRenderedWithNaiveRiverLayout=!0):(d=this._buildImageRowsRiverLayout(e,c.startingPhotoIndex,c.endingPhotoIndex),c.rowsWereRenderedWithNaiveRiverLayout=!1),e.showGroupHeaders&&(d=this._insertLabelRows(e,d)),c.rows=d,c.needsUpdate=!1,0!==d.length&&(t=this.rows).push.apply(t,d)}else(n=this.rows).push.apply(n,c.rows)}if(this.rows.length>0)for(this.rows[0].y=0,s=Math.max(o,1);s<this.rows.length;s++){var l=this.rows[s-1];this.rows[s].y=l.y+l.height}return this._PreviousBuildRowsOptionsString=a,this.rows},e.prototype.getLastImageIdx=function(){if(this.rows.length>0){for(var e=this.rows.length-1,t=this.rows[e];void 0!==t&&0===t.items.length;)e--,t=this.rows[e];if(void 0!==t)return t.items[t.items.length-1].index}},e.prototype._getPlaceHolderWidth=function(){return Math.floor(this._currentTargetHeight*ze)},e.prototype._adjustImageRowToFitContainer=function(e,t,n){var a,i,r=e.items,o=2*t.margin,s=0,c=0;c=t.startRowLeadingMargin+t.endRowTrailingMargin-o;for(var d=0;d<r.length;d++){i=n[(b=r[d]).index],c+=o,void 0!==a&&i!==a&&(c+=t.midRowGroupGap);var l=this._widths[b.index]/this._currentTargetHeight;s+=t.rowHeight*l,a=i}var u=t.containerWidth-c,f=u/s;e.fillsSpace=!(f>t.maxRowScaleUpFactor),f=Math.min(t.maxRowScaleUpFactor,f);for(var p=Math.round(t.rowHeight*f),m=0,_=0,h=0;h<r.length;h++){var b;(b=r[h]).vheight=p;var g=(l=this._widths[b.index]/this._currentTargetHeight)*p,v=Math.round(g);b.vwidth=v,m+=v}if(e.fillsSpace&&0!=(_=m-u)){var y=0;_>0?y=1:_<0&&(y=-1);for(var S=0;0!==_&&_;)e.items[S].vwidth-=y,S=(S+1)%e.items.length,_-=y}},e.prototype._getNumberOfSameWidthTilesThatCanFitInARow=function(e,t){for(var n=e.containerWidth-e.startRowLeadingMargin-e.endRowTrailingMargin,a=0,i=0;;){if(i+=t,0!==a&&(i+=2*e.margin),i>=n)return a;a++}},e.prototype._buildImageRowsNaiveRiverLayout=function(e,t,n){var a=[],i=this._widths,r=this._galleryLabels.getGroupIds();if(0===i.length||0===r.length)return a;for(var o=ze*e.rowHeight,s=this._getNumberOfSameWidthTilesThatCanFitInARow(e,o),c=2*e.margin,d=e.startRowLeadingMargin+e.endRowTrailingMargin,l=0;l<s;l++)0!==l&&(d+=c),d+=o;for(var u=o+(e.containerWidth-d)/s,f=u/ze,p=f+c,m=t;m<=n;){for(var _=r[m],h=[];m<=n&&r[m]===_&&h.length!==s;)h.push({index:m,vheight:f,vwidth:u}),m++;a.push({isLabel:!1,items:h,height:p,width:0,y:0,groupId:r[t]})}return a},e.prototype._buildImageRowsSquareTiles=function(e,t,n){var a=[],i=this._widths,r=this._galleryLabels.getGroupIds();if(0===i.length||0===r.length)return a;for(var o=e.rowHeight,s=this._getNumberOfSameWidthTilesThatCanFitInARow(e,o),c=e.startRowLeadingMargin+e.endRowTrailingMargin,d=0;d<s;d++)0!==d&&(c+=2*e.margin),c+=o;for(var l=o+(e.containerWidth-c)/s,u=t;u<=n;){for(var f=r[u],p=[];u<=n&&(r[u]===f||e.enableDateStitching)&&p.length!==s;)p.push({index:u,vheight:l,vwidth:l}),u++;a.push({isLabel:!1,items:p,height:l+2*e.margin,width:0,y:0,groupId:r[t]})}return a},e.prototype._buildImageRowsRiverLayout=function(e,t,n){var a=this._widths,i=this._galleryLabels.getGroupIds();if(0===a.length||0===i.length)return[];for(var r=this._currentTargetHeight/e.rowHeight,o=e.containerWidth*r,s=function(e,t,n,a,i){var r,o;void 0===a&&(a=0),void 0===i&&(i=e.length-1);var s=i-a+1,c=n.targetRowWidth,d=void 0===c?100:c,l=n.maxRowWidth,u=void 0===l?150:l,f=n.margin,p=n.lastRowUndersizedPenaltyFactor,m=void 0===p?.1:p,_=n.midRowGroupBreakingPenalty,h=void 0===_?1e5:_,b=n.enableDateStitching,g=void 0===b||b,v=n.midRowGroupGap,y=void 0===v?0:v,S=n.startRowLeadingMargin,D=n.endRowTrailingMargin,I=n.wrappingGroupRowUndersizedPenalty,x=void 0===I?50:I,C=2*(void 0===f?0:f),O=(void 0===D?0:D)+(void 0===S?0:S)-C;if(Ne.length<s){var w=Math.ceil(1.2*s);Ne=new Array(w),Be=new Array(w)}var E=new Array(s),A=-1;for(r=a;r<=i;r++){var L=Number.MAX_VALUE,k=O,M=void 0,P=t[r],T=r<t.length-1?t[r+1]:void 0,U=!1;for(o=r;o>=a&&(M=t[o],k+=e[o]+C,U&&M!==t[o+1]&&(k+=y),!(k>u&&U));o--){var F=o===a?-1:o-1,H=F>=0?t[F]:void 0,R=0,N=d-k,B=N/d;R=B*B*B*B,N>0&&(T!==P&&H!==M||r===i?R*=m:T===P&&(R+=x)),g?M===P||T!==P&&H!==M||(R+=h):M!==P&&(R+=Math.abs(M-P)*h),F>=a&&(R+=Ne[F-a]),R<L&&(L=R,A=F),U=!0}Ne[r-a]=L,Be[r-a]=A}for(r=i,o=0,E[o++]=r;;){var j=Be[r-a];if(-1===j)break;E[o++]=j,r=j}return E.length=o,E}(a,i,{targetRowWidth:o,maxRowWidth:o*e.maxCandidateRowSizeFactor,margin:e.margin*r,enableDateStitching:e.enableDateStitching,midRowGroupGap:e.midRowGroupGap*r,startRowLeadingMargin:e.startRowLeadingMargin*r,endRowTrailingMargin:e.endRowTrailingMargin*r},t,n),c=t-1,d=new Array(s.length),l=0,u=-1,f=-1,p=s.length-1;p>=0;p--){var m=s[p],_=m-c;if(0===_)break;for(var h=new Array(_),b=0,g=c+1;g<=m;g++){if(h[b]={index:g,vheight:0,vwidth:0},e.showRoundCorners&&(-1===u&&(u=b,f=l,h[b].roundedCornerTopLeft=!0),i[g]!==i[g+1])){if(h[b].roundedCornerBottomRight=!0,l===f)h[b].roundedCornerTopRight=!0,h[u].roundedCornerBottomLeft=!0;else{h[0].roundedCornerBottomLeft=!0;var v=d[f].items;v[v.length-1].roundedCornerTopRight=!0}u=-1,f=-1}b++}var y={isLabel:!1,items:h,height:0,width:0,y:0,groupId:i[c=m]};this._adjustImageRowToFitContainer(y,e,i),y.height=y.items[0].vheight+2*e.margin,d[l++]=y}return this._adjustNonFillingRowHeights(d,e),d},e.prototype._adjustNonFillingRowHeights=function(e,t){var n=Object(c.__assign)({},t);n.maxRowScaleUpFactor=1;for(var a=0,i=this._galleryLabels.getGroupIds(),r=0;r<=e.length;r++){var o=!0;if(r<e.length&&(o=e[r].fillsSpace),o){var s=r-a,d=r-1;if(s<=d){var l=t.rowHeight,u=t.rowHeight;s-1>=0&&(l=e[s-1].height),d+1<e.length&&(u=e[d+1].height),n.rowHeight=(l+u)/2;for(var f=s;f<=d;f++)this._adjustImageRowToFitContainer(e[f],n,i),e[f].height=e[f].items[0].vheight+2*n.margin}a=0}else a++}},e.prototype._insertLabelRows=function(e,t){for(var n=[],a=-1,i=this._galleryLabels.getGroupIds(),r=-1,o=0;o<t.length;o++){for(var s=t[o],c=s.items,d=-1,l=!1,u=0;u<c.length;u++)d!==(r=i[c[u].index])&&(d=r,r!==a&&(l=!0));if(l){var f=this._galleryLabels.getLabel(r);n.push({isLabel:!0,label:f,height:e.groupHeaderMarginTop+e.labelRowHeight+e.groupHeaderMarginBottom,items:[],width:0,y:0,groupId:r})}a=r,n.push(s)}return n},e.prototype._getRowIndexFromImgIdxBinarySearch=function(e){var t=this,n=this.getLastImageIdx();return e>=0&&void 0!==n&&e<=n?je(this.rows,function(n,a){if(0===n.items.length){for(var i=a-1,r=t.rows[i];i>=0&&0===r.items.length;)i--,r=t.rows[i];return i>=0&&e<=r.items[r.items.length-1].index?-1:1}return e<n.items[0].index?-1:e>n.items[n.items.length-1].index?1:0}):-1},e}(),Ke=n(665),We=n(93),qe=n(1698),Qe=n(1697),Ye=n(333);Object(b.n)([{rawString:".AllPhotosTilesList .ms-Tile .ms-Tile-link{margin:0px}.AllPhotosTilesList .ms-Tile .ms-Tile-link:hover .ms-Tile-nameplate .ms-Tile-name{text-decoration:none}.AllPhotosTilesList .ms-Tile .ms-Tile-content{position:static}.AllPhotosTilesList .ms-Tile .ms-Tile-aboveNameplate{margin:0px}.AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected .ms-Tile-name{font-weight:600}.AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable.ms-Tile--isSelected:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.AllPhotosTilesList .ms-Tile.ms-Tile--isSelectable .ms-FolderCover-signal i{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.AllPhotosTilesList .ms-Tile-name,.AllPhotosTilesList .ms-Tile-activity{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.ms-Fabric--isFocusVisible .AllPhotosTilesList .ms-Tile:focus,.ms-Fabric--isFocusVisible .AllPhotosTilesList .ms-Tile.ms-Tile--isSelected:focus{outline:0px;border:0px}.ms-Fabric--isFocusVisible .AllPhotosTilesList .ms-Tile:focus,.ms-Fabric--isFocusVisible .AllPhotosTilesList .ms-Tile.ms-Tile--isSelected:focus{outline:0px;border:0px}\n"}]);var Je=n(3785),Xe=n(2565),Ze=function(e){function t(t){var n=e.call(this,t)||this;return n._getPageHeight=function(e,t,a){if(void 0!==e&&e>=0&&a){var i=Math.min(e+a-1,n.props.rows.length-1),r=n.props.rows[e],o=n.props.rows[i];return o.y+o.height-r.y}return 0},n._getPageStyle=function(e){var t=e.height;if(e.items){var a=e.startIndex,i=Math.min(a+e.items.length-1,n.props.rows.length-1),r=n.props.rows[a],o=n.props.rows[i];t=o.y+o.height-r.y}for(var s=[],c=0;c<e.itemCount;c++)s[e.startIndex+c]=n.props.containerWidth;return{widths:s,width:n.props.containerWidth,height:t}},n._getPageSpecification=function(e,t){if(void 0!==e&&e>=0&&e<n.state.items.length){var a=n.state.items[e];return{height:n._getPageHeight(e,t,1),key:"page_"+a.key,itemCount:1}}return{}},n._renderRow=function(e){if(n.props.rowRenderer)return n.props.rowRenderer(e);console.warn("RowRenderer is undefined when trying to render row!")},n.state={items:[]},n}return Object(c.__extends)(t,e),t.prototype.componentDidUpdate=function(e){e.rows!==this.props.rows&&this._generateItemsAsRows()},t.prototype.render=function(){var e={getPageStyle:this._getPageStyle,getPageSpecification:this._getPageSpecification,onPagesUpdated:this.props.onListPagesUpdated,role:"listbox","aria-label":Je.e,renderedWindowsBehind:0},t=d.createElement(Xe.e,{firstFocusableTarget:'[data-selection-index="0"]',disableFirstFocus:!0},d.createElement(Qe.e,{componentRef:this.props.focusZoneComponentRef,direction:Ye.e.bidirectional},d.createElement(qe.e,Object(c.__assign)({items:this.state.items,onRenderCell:this._renderRow},e))));return d.createElement("div",{className:"AllPhotosTilesList"},this.props.onRenderTileListParent?this.props.onRenderTileListParent({},t):void 0)},t.prototype._generateItemsAsRows=function(){for(var e=[],t="",n=0,a=0;a<this.props.rows.length;++a){var i=this.props.rows[a];i.label&&(t=i.label,n=a);var r=a-n,o=t+"_"+i.groupId+"_"+r;e.push({key:o,rowIndex:a,rowData:i})}this.setState({items:e})},t}(d.Component),$e=n(102),et=n(236);Object(b.n)([{rawString:".ReactGridGalleryScrollBar_f4e400bd{scrollbar-width:auto;-ms-overflow-style:auto;-webkit-overflow-scrolling:touch;overscroll-behavior:none}.ReactGridGalleryScrollBar_f4e400bd:focus{outline:none}.ReactGridGallery_f4e400bd{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;overscroll-behavior:none}.ReactGridGallery_f4e400bd:focus{outline:none}.ReactGridGallery_f4e400bd::-webkit-scrollbar{width:0px;background:transparent}\n"}]);var tt="ReactGridGalleryScrollBar_f4e400bd",nt="ReactGridGallery_f4e400bd";function at(e,t,n,a,i,r,o){var s={top:e,right:e,bottom:e,left:e};return Ee.e.isRightToLeft?(void 0===o&&(s.left=a),void 0===i?s.right=n:r!==i&&(s.right+=t)):(void 0===o&&(s.right=a),void 0===i?s.left=n:r!==i&&(s.left+=t)),s}var it=n(1289);Object(b.n)([{rawString:".ms-Fabric--isFocusVisible .groupHeader_f59ab539 .groupHeaderTitle_f59ab539:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.groupHeader_f59ab539{-webkit-user-select:none;position:relative;padding:0px;overflow:visible;font-size:14px;text-overflow:ellipsis;white-space:nowrap;margin-top:6px;margin-bottom:6px;position:'absolute'}html[dir='ltr'] .groupHeader_f59ab539{float:left}html[dir='rtl'] .groupHeader_f59ab539{float:right}.groupHeader_f59ab539 .groupHeaderTitle_f59ab539{font-size:14px;height:16px;margin:0;float:left;position:relative;font-weight:600;display:block;cursor:pointer;height:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:6px;padding-bottom:6px;line-height:28px}.groupHeader_f59ab539 .groupHeaderTitle_f59ab539:focus{outline:none}.groupHeader_f59ab539 .groupHeaderTitle_f59ab539 .aboveNameplate{position:relative;margin:0px}.groupHeader_f59ab539 .groupHeaderMenu_f59ab539{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px;background-color:white;padding:0px;border:0px}.groupHeader_f59ab539 .groupHeaderMenu_f59ab539:hover{background-color:white}.groupHeader_f59ab539 .ms-Button-label{font-weight:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:normal;margin:0px;border:0px}.groupHeader_f59ab539 .ms-Button-label:hover{text-decoration:underline}.groupHeader_f59ab539 .groupHeaderCheckbox_f59ab539{float:left;cursor:pointer;position:relative}.groupHeader_f59ab539 .groupHeaderCheckbox_f59ab539:focus{outline:none}.groupHeader_f59ab539 .groupHeaderCheckbox_f59ab539:active{outline:none}.groupHeader_f59ab539 .checkVisible_f59ab539{display:-webkit-box;display:-ms-flexbox;display:flex}.groupHeader_f59ab539 .checkHidden_f59ab539{display:none}\n"}]);var rt="groupHeader_f59ab539",ot="groupHeaderTitle_f59ab539",st="groupHeaderMenu_f59ab539",ct="groupHeaderCheckbox_f59ab539",dt="checkVisible_f59ab539",lt="checkHidden_f59ab539",ut=n(3098),ft=n(2587),pt=n(42);Object(b.n)([{rawString:".groupHeaderMenu_de9f8442{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px;background-color:white;padding:0px;border:0px}.groupHeaderMenu_de9f8442:hover{background-color:white}.locationHeader_de9f8442{color:#605e5c}.locationHeader_de9f8442:hover{text-decoration:underline}.locationHeader_de9f8442:focus{text-decoration:underline}.locationStyle_de9f8442{float:none;position:relative;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:1px;margin-top:5px;line-height:28px}.locationStyle_de9f8442 .locationHeader_de9f8442{cursor:pointer}.locationStyle_de9f8442 .locationHeader_de9f8442:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.locationStyle_de9f8442 .locationHeader_de9f8442:hover{text-decoration:underline}.locationStyle_de9f8442 .locationHeader_de9f8442:active{outline:none}\n"}]);var mt="groupHeaderMenu_de9f8442",_t="locationHeader_de9f8442",ht="locationStyle_de9f8442",bt=n(1136),gt=", ",vt={height:"36px",fontSize:"14px",paddingLeft:"8px",paddingRight:"8px"},yt=r,St=function(e){function t(t){var n=e.call(this,t)||this;return n.state={locationInfoSet:[]},n._menuRef=Object(d.createRef)(),n._locationDivRef=Object(d.createRef)(),n._locationChildRef=Object(d.createRef)(),n._isMenu=!1,n._locationInfoSet=[],n._buttonLabelElement=null,n._updateLocationsInfo(),n}return Object(c.__extends)(t,e),t.prototype.componentDidUpdate=function(){if(this.props.locations&&(this._updateLocationsInfo(),this._locationChildRef&&this._locationChildRef.current)){var e=this._locationChildRef.current.querySelector(".ms-Button-menuIcon");if(this._buttonLabelElement=this._locationChildRef.current.querySelector(".ms-Button-label"),this._buttonLabelElement&&e){var t=this._locationChildRef.current.offsetWidth-2*e.offsetWidth+"px";this._buttonLabelElement.style.maxWidth=t}}},t.prototype.render=function(){var e=this,t=d.createElement(d.Fragment,null);if(this._isMenu){var n=this._buttonLabelElement&&this._buttonLabelElement.style.maxWidth&&this._buttonLabelElement.scrollWidth>parseInt(this._buttonLabelElement.style.maxWidth,10)?pt.format(ft.t,this._locationInfoSet[0].displayText,this._locationInfoSet.length-1)||"":void 0,a=pt.format(ft.t,this._locationInfoSet[0].displayText,this._locationInfoSet.length-1)||"",i={items:this._locationInfoSet.map(function(t){return{key:t.displayText,text:t.displayText,onClick:e._createLocationClickHandler(t),style:vt}})};t=d.createElement(bt.e,{className:yt.groupHeaderMenu,componentRef:this._menuRef,"data-is-focusable":"true",role:"menuitem",text:a,title:n,menuProps:i,menuIconProps:{style:{paddingLeft:"9px",marginLeft:"0px",marginRight:"0px"}}})}else{var r=Object(we.e)("".concat(yt.locationHeader)),o={cursor:"pointer"},s=this._locationInfoSet.map(function(t,n){return d.createElement("span",{key:e.props.labelKey+t.displayText},d.createElement("span",{className:r,"data-is-focusable":"true",onClick:e._createLocationClickHandler(t),ref:e._locationDivRef,role:"link",style:o,title:t.displayText},t.displayText),d.createElement("span",null,n<e._locationInfoSet.length-1?gt:""))});t=d.createElement(d.Fragment,null,s)}return d.createElement("div",{key:this.props.labelKey+"location",ref:this._locationChildRef,className:yt.locationStyle,style:{float:"none",position:"relative",bottom:this._isMenu?"3px":0}},t)},t.prototype._createLocationClickHandler=function(e){var t=this;return function(){e&&t.props.onLocationHeaderClick(e.locationData)}},t.prototype._updateLocationsInfo=function(){var e={};this._locationInfoSet=[];for(var t=0,n=this.props.locations;t<n.length;t++){var a=n[t],i=void 0,r=a.city||a.locality;r&&r.length>0?(i=r+gt,i+=a.state&&a.state.length>0?a.state+gt:"",i+=a.country&&a.country.length>0?a.country:"",i+=a.countryOrRegion&&a.countryOrRegion.length>0?a.countryOrRegion:""):a.locationTag&&a.locationTag.length>0&&(i=a.locationTag+gt,i+=a.state&&a.state.length>0?a.state+gt:"",i+=a.country&&a.country.length>0?a.country:""),void 0!==i&&i.length>0&&!e[i]&&(e[i]=!0,this._locationInfoSet.push({displayText:i,locationData:a}))}this._isMenu=this._locationInfoSet.length>2},t}(d.Component),Dt=i,It=ut,xt=function(e){function t(t){var n=e.call(this,t)||this;return n._getCheckboxClassNames=function(e){var t,a,i,r,o=n.state.hover||e||n.state.focus;return[Object(we.e)("ms-Tile-check",Dt.check,It.checkHost,(t={},t[Ue.e.slideLeftOut400?Ue.e.slideLeftOut400:""]=!o,t),(a={},a[Ue.e.slideRightIn400?Ue.e.slideRightIn400:""]=o,a),(i={},i[Dt.checkHidden]=!o,i),(r={},r[Dt.checkVisible]=o,r)),Dt.groupHeaderCheckbox].join(" ")},n._setSelectionState=function(e){e!==n.state.isSelected&&n.setState({isSelected:e})},n._onClick=function(e){n._selectGroup(!n.state.isSelected),e.stopPropagation(),e.preventDefault()},n._onKeyDown=function(e){e.keyCode!==$e.e.enter&&e.keyCode!==$e.e.space||(n._selectGroup(!n.state.isSelected),e.stopPropagation(),e.preventDefault())},n._onMouseEnterRenderCheck=function(){return n.setState({hover:!0})},n._onMouseLeaveRenderCheck=function(){return n.setState({hover:!1})},n._onMouseEnter=function(){return n.setState({hover:!0})},n._onMouseLeave=function(){return n.setState({hover:!1})},n._onBlur=function(){return n.setState({focus:!1})},n._onFocus=function(){return n.setState({focus:!0})},n.state={hover:!1,isSelected:t.selection.getGroupHeaderSelectionState(t.groupId),focus:!1},n._labelRef=Object(d.createRef)(),n}return Object(c.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.selection.registerGroupHeaderSetStateFuncByGroupId(this.props.groupId,this._setSelectionState)},t.prototype.componentWillUnmount=function(){this.props.selection.deregisterGroupHeaderSetStateFuncByGroupId(this.props.groupId)},t.prototype.render=function(){var e=this.state.isSelected,t=pt.format(ft.e,this.props.label),n=this.props.rowKey+"-"+this.props.label,a={maxWidth:this.props.labelRowWidth},i=this._labelRef.current&&this._labelRef.current.scrollWidth>this.props.labelRowWidth?this.props.label:void 0,r=this.state.hover||e||this.state.focus,o=d.createElement("div",{"aria-checked":e,className:this._getCheckboxClassNames(r),"data-selection-toggle":!0,id:this.props.label+"Checkbox",key:"check",onClick:this._onClick,onMouseEnter:this._onMouseEnterRenderCheck,onMouseLeave:this._onMouseLeaveRenderCheck,style:{paddingRight:"9px",paddingBottom:"4px",paddingTop:"4px"}},d.createElement(it.e,{checked:e})),s=d.createElement(d.Fragment,null);return this.props.locations&&this.props.locations.length>0&&(s=d.createElement(St,{labelKey:n,onLocationHeaderClick:this.props.onLocationHeaderClick,locations:this.props.locations})),d.createElement("div",{className:Dt.groupHeader,key:"GroupHeaderCell",style:{width:this.props.labelRowWidth,height:this.props.labelRowHeight,marginTop:this.props.margins.top,marginBottom:this.props.margins.bottom,marginLeft:this.props.margins.left,marginRight:this.props.margins.right}},d.createElement("h2",{"aria-checked":e,"aria-label":t,className:Dt.groupHeaderTitle,"data-is-focusable":"true","data-is-sub-focuszone":"true",id:n,"is-checked":e.toString(),key:n,onBlur:this._onBlur,onClick:this._onClick,onFocus:this._onFocus,onKeyDown:this._onKeyDown,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,ref:this._labelRef,role:"checkbox",style:a,title:i},o,this.props.label),d.createElement("div",{style:{width:9,height:this.props.labelRowHeight,float:"left"}}),s)},t.prototype._selectGroup=function(e){this._setSelectionState(e),this.props.selection.selectGroup(this.props.groupId,e)},t}(d.Component),Ct=n(2118),Ot=Object(ge.e)(function(e,t){var n=t.itemKeys,a=[];if(t.showLocations)for(var i=0,r=n;i<r.length;i++){var o=r[i];if(e.isItemFacetResolved(Ct.e,o)){var s=e.demandItemFacet(Ct.e,o);s&&a.push(s)}}return{locations:a}})(xt),wt=n(1452),Et=n(3786);Object(b.n)([{rawString:".tileViewport_02496ce6{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.thumbnailTile_02496ce6 .ms-Tile-check{right:4px !important;top:4px}.tileViewportTopLeft_02496ce6{border-top-left-radius:6px}.tileViewportTopRight_02496ce6{border-top-right-radius:6px}.tileViewportBottomLeft_02496ce6{border-bottom-left-radius:6px}.tileViewportBottomRight_02496ce6{border-bottom-right-radius:6px}.tileViewportImage_02496ce6{overflow:hidden;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}\n"}]);var At="tileViewport_02496ce6",Lt="thumbnailTile_02496ce6",kt="tileViewportTopLeft_02496ce6",Mt="tileViewportTopRight_02496ce6",Pt="tileViewportBottomLeft_02496ce6",Tt="tileViewportBottomRight_02496ce6",Ut="tileViewportImage_02496ce6",Ft=n(109),Ht=n(2581),Rt=n(151),Nt=0,Bt=o,jt=function(e){function t(t){var n=e.call(this,t)||this;return n._onSelectionChanged=function(){var e=n.props.selection,t=void 0!==e&&e&&e.isIndexSelected(n.props.index);n.setState({isSelected:t})},n._onClick=function(e){var t=n.props.selection;t&&(t.setAllSelected(!1),t.setIndexSelected(n.props.index,!0,!1)),n.props.openItemOverlay.call(n,e,n.props.index),e.stopPropagation()},n._onMouseEnter=function(e){n.setState({hoverd:!0})},n._onMouseLeave=function(e){n.setState({hoverd:!1})},n._onFocus=function(e){n.setState({focused:!0})},n._onBlur=function(e){n.setState({focused:!1})},n._onLoad=function(e){n.setState({thumbLoaded:!0}),n.props.onLoad(n.props.index,n._getThumbnailUrl(),e.currentTarget)},n._onError=function(e){n.props.onError(n.props.index,n._getThumbnailUrl(),e.currentTarget),n._handleError()},n._events=new We.e(n),n._uniqueId=String(Nt++),n.state={hoverd:!1,loaded:!1,thumbLoaded:!1,imageElementId:"img_"+n._uniqueId,thumbnailError:!1,focused:!1,isSelected:!1},n}return Object(c.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onMount(this.props.index,this._getThumbnailUrl()),this.props.item&&(this.props.onSrcChanged(this.props.index,this._getThumbnailUrl()),this.props.registerAnchorId&&this.props.registerAnchorId(this.props.index,this.props.item.id)),this.props.selection&&this._events.on(this.props.selection,Ft.e,this._onSelectionChanged)},t.prototype.componentWillUnmount=function(){this.props.onUnmount(this.props.index,this._getThumbnailUrl()),this.props.item&&this.props.deregisterAnchorId&&this.props.deregisterAnchorId(this.props.index,this.props.item.id),this._events.dispose()},t.prototype.componentDidUpdate=function(e,t,n){if(this.props.item){var a=this.props.item&&this.props.item.thumbnailUrl;a!==(e.item&&e.item.thumbnailUrl)&&(this.props.onSrcChanged(this.props.index,a),this.setState({thumbLoaded:!1,thumbnailError:!1})),!this.props.registerAnchorId||!this.props.deregisterAnchorId||this.props.index===e.index&&e.item&&this.props.item.id===e.item.id||(e.item&&this.props.deregisterAnchorId(e.index,e.item.id),this.props.registerAnchorId(this.props.index,this.props.item.id))}},t.prototype.tileStyle=function(){var e=this.props.margins;return{margin:e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px",WebkitUserSelect:"none",position:"relative",float:Ee.e.isRightToLeft?"right":"left",padding:"0px",width:this.props.width,height:this.props.height,cursor:"pointer"}},t.prototype.tileViewportStyle=function(){return{width:this.props.width,height:this.props.height}},t.prototype.getClassName=function(){return Object(we.e)(this.state.thumbLoaded?Ue.e.fadeIn200:"")},t.prototype.getTileViewportClassName=function(){return Object(we.e)(Bt.tileViewport,Bt.tileViewportImage,this.props.roundedCornerTopLeft?Bt.tileViewportTopLeft:"",this.props.roundedCornerTopRight?Bt.tileViewportTopRight:"",this.props.roundedCornerBottomLeft?Bt.tileViewportBottomLeft:"",this.props.roundedCornerBottomRight?Bt.tileViewportBottomRight:"")},t.prototype.thumbnailStyle=function(){return this.props.useSquareTiles?{cursor:"pointer",width:this.props.width,height:this.props.height,marginLeft:0,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",flexShrink:0,opacity:this.state.thumbLoaded?1:0,minWidth:"100%",minHeight:"100%",objectFit:"cover"}:{cursor:"pointer",height:this.props.height,width:this.props.width,marginLeft:0,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",flexShrink:0,opacity:this.state.thumbLoaded?1:0,minWidth:void 0,minHeight:void 0,objectFit:void 0}},t.prototype.render=function(){var e,t=d.createElement(d.Fragment,null),n={width:this.props.width,height:this.props.height};if(this._getThumbnailUrl().length>0){var a=((e={role:"option",id:"tile-"+this.props.index,contentSize:n,style:this.tileStyle(),selectionIndex:this.props.index,className:"ms-Tile--isSelectable od-ItemTile2 od-hasContextMenu od-ItemTile2--isLarge ms-Tile--isLarge ms-Tile--invokable "+Bt.thumbnailTile,label:"ImageTileCell",tileSize:"large",ariaLabel:this._getImageAriaLabelWithSelection()})["aria-label"]=this._getImageAriaLabelWithSelection(),e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onClick=this._onClick,e.onFocus=this._onFocus,e.onBlur=this._onBlur,e.toggleSelectionAriaLabel=this._getToggleSelectionAriaLabel(),e.href=this._getHRef(),e),i=this.props.onRenderTile(a,t),r=this._renderThumbnail();return Object(wt.a)(i,{foreground:r,background:null})}return d.createElement("div",{"aria-hidden":"true",className:Bt.tileViewport,id:"tile-viewport-"+this.props.index,key:"tile-viewport-"+this.props.index,style:this.tileStyle(),"data-is-focusable":"true"})},t.prototype._getThumbnailUrl=function(){return this.props.item?this.props.item.thumbnailUrl:""},t.prototype._errorThumbnailStyle=function(){return{display:"block",marginLeft:"auto",marginRight:"auto",width:"96px",marginTop:"-48px",alignContent:"center"}},t.prototype._getImageAriaLabelAttribute=function(){var e="";return this.props.item&&(e=this.props.item.name+this.props.item.extension),e},t.prototype._getImageAriaLabelWithSelection=function(){var e=this._getImageAriaLabelAttribute(),t="";if(this.props.selection){t=this.state.isSelected?Et.t:Et.e;var n=this.props.selection.getSelectedCount();n>0&&(t=t+" "+pt.format(Et.n,n))}return e.length>0?e+" "+t:""},t.prototype._getToggleSelectionAriaLabel=function(){return pt.format(Et.a,this._getImageAriaLabelAttribute())},t.prototype._renderThumbnail=function(){if(!this.props.item)return null;var e=".gif"===this.props.item.extension&&(this.state.hoverd||this.state.focused)&&!t._platform.isSafari&&this.props.item.originalUrl?this.props.item.originalUrl:this._getThumbnailUrl();return this.state.thumbnailError&&(e=this.props.item.isVideo?this.props.videoErrorThumbnail:this.props.imageErrorThumbnail),d.createElement(d.Fragment,null,d.createElement(Ht.e,{isFocused:this.state.focused,isHovered:this.state.hoverd,isSelected:this.state.isSelected,isScrolling:this.props.isScrolling}),d.createElement("div",{"aria-hidden":"true",className:this.getTileViewportClassName(),style:this.tileViewportStyle(),key:"tile-viewport-"+this.props.index},d.createElement("img",{key:"imgSmall-"+this._uniqueId,id:this.state.imageElementId,src:e,alt:"",style:this.state.thumbnailError?this._errorThumbnailStyle():this.thumbnailStyle(),onLoad:this._onLoad,onError:this._onError,className:this.getClassName()}),this.state.thumbnailError&&d.createElement("div",{className:"ItemTile-namePlate",style:{minHeight:"35px",borderTop:"1px solid rgba(255,255,255,.2)"}},d.createElement("div",{className:"ItemTile-name",style:{fontSize:"15px",lineHeight:"20px"}},this.props.item.name))),this.props.onRenderTileAnnotation({imageIndex:this.props.index},d.createElement(d.Fragment,null)))},t.prototype._handleError=function(){var e;(null===(e=this.props.item)||void 0===e?void 0:e.thumbnailUrl)&&this.setState({thumbnailError:!0})},t.prototype._getHRef=function(){if(this.props.item)return"#id="+this.props.item.id},t.defaultProps={margin:0,height:0,width:0},t._platform=new Rt.e,t}(d.PureComponent),Vt=n(9),zt=n(403),Gt=n(7),Kt=n(89),Wt=n(346),qt=n(1091),Qt={ODC:"UsePhysicalPixelSizeThumbsInAllPhotosView"};function Yt(e){var t=window.devicePixelRatio||1;return t=Math.min(t,2),Math.ceil(e*t)}var Jt,Xt=Object(ge.e)(function(e,t){var n,a,i=t.recordKey,r=t.width,o=t.height;if(i.length>0&&e.isItemFacetResolved(Kt.h,i)){var s=e.demandItem({key:Vt.e,thumbnail:Kt.h,name:Gt.u,fileName:Gt.p,originalUrl:zt.e,isVideo:Kt.g},i),d=s.key,l=s.thumbnail,u=s.name,f=s.fileName,p=s.originalUrl,m=s.isVideo,_=(n={width:r,height:o},a=Object(c.__assign)({},n),Wt.n.isFeatureEnabled(Qt)&&(a.width=Yt(n.width),a.height=Yt(n.height)),a),h=l?Object(qt.e)(l.url,_):"";return{item:{id:d&&d.itemId?d.itemId:"",thumbnailUrl:h,name:u||"",extension:f?f.extension:"",originalUrl:p||"",isVideo:void 0!==m}}}return{item:void 0}})(jt),Zt=n(250),$t=n(175),en=n(2580),tn=n(983),nn=function(){function e(e){var t=this;this.setSelection=function(e){t._event.off(t._selection),t._selection=e,t._event.on(t._selection,Ft.e,t.imageSelectionOnChangedHandler)},this.imageSelectionOnChangedHandler=function(){t._event.off(t._selection),t._updateGroupHeaderSelection(),t._event.on(t._selection,Ft.e,t.imageSelectionOnChangedHandler)},this.selectGroup=function(e,n){if(t._selection){t._event.off(t._selection);var a=t._galleryLabels.getImageCountByGroupId(e),i=t._galleryLabels.getStartIndexByGroupId(e),r=t._selection.isRangeSelected(i,a);if(r!==n){var o=i+a;t._selection.setChangeEvents(!1);for(var s=i;s<o;s++)t._selection.setIndexSelected(s,!r,!1);t._selection.setChangeEvents(!0)}t._notifyGroupSelectionStateChange(e,n),t._event.on(t._selection,Ft.e,t.imageSelectionOnChangedHandler)}},this._notifyGroupSelectionStateChange=function(e,n){var a=t._groupHeaderSetSelectionRequestMap.get(e);a&&a(n)},this._event=new We.e(void 0),this._groupHeaderSetSelectionRequestMap=new Map,this._galleryLabels=e}return e.prototype.dispose=function(){this._event.dispose()},e.prototype.getGroupHeaderSelectionState=function(e){return this._isGroupSelected(e)},e.prototype.registerGroupHeaderSetStateFuncByGroupId=function(e,t){this._groupHeaderSetSelectionRequestMap.set(e,t)},e.prototype.deregisterGroupHeaderSetStateFuncByGroupId=function(e){this._groupHeaderSetSelectionRequestMap.set(e,void 0)},e.prototype._isGroupSelected=function(e){if(!this._selection)return!1;var t=this._galleryLabels.getStartIndexByGroupId(e);if(t<0)return!1;var n=this._galleryLabels.getImageCountByGroupId(e);return!(n<0)&&this._selection.isRangeSelected(t,n)},e.prototype._updateGroupHeaderSelection=function(){var e=this;this._groupHeaderSetSelectionRequestMap.forEach(function(t,n){var a=e._isGroupSelected(n);e._notifyGroupSelectionStateChange(n,a)})},e}(),an=n(2043);!function(e){e[e.Label=0]="Label",e[e.ParentLabel=1]="ParentLabel",e[e.GrandparentLabel=2]="GrandparentLabel"}(Jt||(Jt={}));var rn=function(){function e(){this._groupIds=new Uint16Array,this._groupIdToLabel=[],this._groupIdToHeader=[],this._groupIdToParentLabel=[],this._groupIdToGrandParentLabel=[],this._groupIdToImageIndex=[],this._groupIdToImageCount=[]}return e.prototype.setGroupData=function(e,t,n){this._groupIds=new Uint16Array(t),this._groupIdToLabel=[],this._groupIdToHeader=[],this._groupIdToParentLabel=[],this._groupIdToGrandParentLabel=[],this._groupIdToImageIndex=[],this._groupIdToImageCount=[];for(var a=0,i=e.length,r=0;r<i;++r){for(var o=e[r],s=r+1,c=o.count,d=this._getLabelsByGrouping(o,n);s<i&&this._isInSameGrouping(o,e[s],n);)c+=e[s].count,s++,r++;var l=d[0];this._groupIdToParentLabel[r]=d[1],this._groupIdToGrandParentLabel[r]=d[2],this._groupIdToLabel[r]=l,this._groupIdToHeader[r]=Object(an.t)(o)[n],this._groupIdToImageIndex[r]=a,this._groupIdToImageCount[r]=c;for(var u=0;u<c;u++)this._groupIds[a]=r,a++}},e.prototype.getStartIndexByGroupId=function(e){var t=this._groupIdToImageIndex[e];return void 0!==t?t:-1},e.prototype.getImageCountByGroupId=function(e){var t=this._groupIdToImageCount[e];return void 0!==t?t:-1},e.prototype.getLabel=function(e){return void 0!==this._groupIdToLabel[e]?this._groupIdToLabel[e]:""},e.prototype.getHeader=function(e){return void 0!==this._groupIdToHeader[e]?this._groupIdToHeader[e]:""},e.prototype.getLabelByIndex=function(e){var t=this.getGroupIdbyIndex(e);return this.getLabel(t)},e.prototype.getHeaderByIndex=function(e){var t=this.getGroupIdbyIndex(e);return this.getHeader(t)},e.prototype.getParentLabel=function(e){return void 0!==this._groupIdToParentLabel[e]?this._groupIdToParentLabel[e]:""},e.prototype.getGrandParentLabel=function(e){return void 0!==this._groupIdToGrandParentLabel[e]?this._groupIdToGrandParentLabel[e]:""},e.prototype.getGrandParentLabelByIndex=function(e){var t=this.getGroupIdbyIndex(e);return this.getGrandParentLabel(t)},e.prototype.getFullLabelByGroupId=function(e){return this.getLabel(e)+";"+this.getParentLabel(e)+";"+this.getGrandParentLabel(e)},e.prototype.getFullLabelByIndex=function(e){var t=this.getGroupIdbyIndex(e);return this.getFullLabelByGroupId(t)},e.prototype.getGroupIdbyIndex=function(e){return void 0!==this._groupIds[e]?this._groupIds[e]:this._groupIds[this._groupIds.length-1]},e.prototype.getGroupIds=function(){return this._groupIds},e.prototype._getLabelsByGrouping=function(e,t){var n=Object(an.n)(e),a=[];switch(t){case Jt.GrandparentLabel:a[0]=n[2],a[1]=n[2],a[2]=n[2];break;case Jt.ParentLabel:a[0]=n[1],a[1]=n[1],a[2]=n[2];break;default:a=n}return a},e.prototype._isInSameGrouping=function(e,t,n){var a=Object(an.n)(e),i=Object(an.n)(t);switch(n){case Jt.GrandparentLabel:return a[2]===i[2];case Jt.ParentLabel:return a[1]===i[1]&&a[2]===i[2];default:return!1}},e}(),on=n(3784),sn=n(314),cn=[],dn=Object(Re.e)(0),ln=a,un=function(e){function t(t){var n=e.call(this,t)||this;return n._imageRows=[],n._scrubberRows=[],n.resetAnchor=function(){n._anchorScrollEnabled=!1,n._anchorData=void 0,n._isAnchorScroll=!1},n.registerAnchorId=function(e,t){if(n._anchorMap.set(e,t),n.props.createSelectionItemKey){var a=n.props.createSelectionItemKey(t);a&&(n._selectionItems[e]={key:a},n.props.selection&&n.props.selection.setItems(n._selectionItems,!1))}n._anchorData&&!n._anchorData.anchorId&&n._anchorData.imageIndex===e&&(n._anchorData.anchorId=t)},n.deregisterAnchorId=function(e,t){n._anchorMap.get(e)===t&&n._anchorMap.delete(e)},n._isImageElementVisible=function(e){if(n.galleryRef.current){var t=n.galleryRef.current.getBoundingClientRect(),a=e.getBoundingClientRect();if(a.top<t.bottom&&a.bottom>t.top)return!0}return!1},n._handleOnWheel=function(e){e.deltaY<0?n._galleryLogger.setUserInteraction(tn.i.MouseWheelUp):e.deltaY>0&&n._galleryLogger.setUserInteraction(tn.i.MouseWheelDown)},n._handleMouseUp=function(e){1===e.button&&n._galleryLogger.setUserInteraction(tn.i.MousePan)},n._handleKeyDown=function(e){(e.which===$e.e.space||e.which===$e.e.pageUp||e.which===$e.e.pageDown||e.which===$e.e.end||e.which===$e.e.home||e.which===$e.e.left||e.which===$e.e.up||e.which===$e.e.right||e.which===$e.e.down)&&n._galleryLogger.setUserInteraction(tn.i.Keyboard)},n._handleOnWheelScrubber=function(e){if(n.galleryRef&&n.galleryRef.current){var t=e.deltaY;1===e.deltaMode?t*=40:2===e.deltaMode&&(t*=800),n.galleryRef.current.scrollTop+=t}n._handleOnWheel(e)},n._onRenderTileListParent=function(e,t){return n.props.onRenderTileListParent({selection:n.props.selection,selectionMode:n.props.selectionMode},t)},n._onRenderTile=function(e,t){var a=Object(c.__assign)(Object(c.__assign)({},e),{selection:n.props.selection});return n.props.onRenderTile(a,t)},n._scrollToRow=function(e,t,a){void 0===t&&(t=!0),void 0===a&&(a=0);var i=0;0!==e&&(t&&e>0&&!n._imageRows[e].isLabel&&n._imageRows[e-1].isLabel&&(e-=1),i=n._imageRows[e].y+n.state.headerHeight+a),n.galleryRef&&n.galleryRef.current&&n.galleryRef.current.scrollTop!==i&&(n.galleryRef.current.scrollTop=i)},n._scrollToRowScrubber=function(e,t){void 0===t&&(t=0),n._galleryLogger.setUserInteraction(tn.i.ScrubberClick),n._galleryLogger.onScrubberClicked(e),n._scrollToRow(e)},n._onListPagesUpdated=function(e){n._calculateMinMaxVisibleRows(e),void 0===n._nextFrameTimer&&(n._nextFrameTimer=window.setTimeout(function(){if(n._visibleRowsMinMax){var e=n._layout.getVisibleImageIndexRange(n._visibleRowsMinMax.min,n._visibleRowsMinMax.max);!e||n._visibleImagesMinMax&&e.min===n._visibleImagesMinMax.min&&e.max===n._visibleImagesMinMax.max||(n._visibleImagesMinMax=e,n._visibleImagesMinMax&&n.props.visibleRangeUpdated(n._visibleImagesMinMax.min,n._visibleImagesMinMax.max))}n._nextFrameTimer=void 0},0))},n._telemetryCallbackScreenSize=function(e,t){n.props.telemetryCallbacks.genericEvent&&n.props.telemetryCallbacks.genericEvent("AllPhotos.ScreenSize",{width:e,height:t,devicePixelRatio:window.devicePixelRatio||1})},n._checkWidthChanged=function(){n.galleryRef&&n.galleryRef.current&&n.galleryRef.current.clientWidth!==n.state.containerWidth&&(n.setState({containerWidth:n.galleryRef.current.clientWidth}),0!==n.state.containerWidth&&n._debouncedTelemetryCallbackScreenSize(window.outerWidth,window.outerHeight))},n._renderRowForTilesList=function(e){return n._renderRow(e.rowIndex,e.key,{height:e.rowData.height,left:0,position:"absolute",top:e.rowData.y,width:n.state.containerWidth},!1,!0)},n._renderHeader=function(){var e=n.props.onRenderGalleryHeader;if(e){var t=n._getRowStyle();return d.createElement("div",{ref:n._headerContainerRef,style:t},e({},n.screenResIndex))}return d.createElement(d.Fragment,null)},n._getRowStyle=function(){var e=n.props.squareTiles?n.props.galleryPadding_squaretiles[n.screenResIndex]:n.props.galleryPadding_aspect[n.screenResIndex],t=n.props.squareTiles?n.props.galleryPaddingRight_squaretiles[n.screenResIndex]:n.props.galleryPaddingRight_aspect[n.screenResIndex],a={left:0,top:0,width:n.state.containerWidth-e-t+"px"};return Ee.e.isRightToLeft?(a.marginLeft=t,a.marginRight=e):(a.marginLeft=e,a.marginRight=t),a},n._renderFooter=function(){return n.props.onRenderGalleryFooter?d.createElement("div",{style:n._getRowStyle()},n.props.onRenderGalleryFooter()):d.createElement(d.Fragment,null)},n._onWindowResize=function(){n._galleryLogger.setUserInteraction(tn.i.PageResize),n._galleryLogger.onPageUpdate(),n._debouncedWindowResized(),n._checkWidthChanged(),n._recalculateGalleryHeaderHeight()},n._windowResized=function(){n._updateAnchorData()},n._onScrubberMouseUp=function(){n._updateAnchorData()},n.onImageMount=function(e,t){n._galleryLogger.onImageMounted(e)},n.onImageUnmount=function(e,t){n._galleryLogger.onImageUnmounted(e)},n.onImageSrcChanged=function(e,t){n._galleryLogger.onImageSrcChanged(e)},n.onImageLoad=function(e,t,a){var i=n._isImageElementVisible(a);n._galleryLogger.onImageLoaded(e,i)},n.onImageError=function(e,t,a){var i=n._isImageElementVisible(a);n._galleryLogger.onImageErrored(e,i,t)},n._onGalleryScroll=function(){n._isAnchorScroll?n._isAnchorScroll=!1:(n._galleryLogger.onPageUpdate(),n.resetAnchor(),void 0!==n._scrollEndedTimer&&clearTimeout(n._scrollEndedTimer),n._scrollEndedTimer=window.setTimeout(function(){n._scrollEndedTimer=void 0,n._updateAnchorData()},500))},n._onClickRow=function(e){var t=e.currentTarget,a=!!e.target.attributes.getNamedItem("data-selection-toggle"),i=Object(Ke.i)(t);!a&&n._focusZoneRef&&n._focusZoneRef.current&&i&&n.props.selection&&0===n.props.selection.getSelectedIndices().length&&n._focusZoneRef.current.focusElement(i)},n.parentGalleryRef=d.createRef(),n.galleryRef=d.createRef(),n.galleryId="ReactGridGallery_"+sn.e.generate(),n._focusZoneRef=d.createRef(),n._headerContainerRef=d.createRef(),n.state={squareTiles:n.props.squareTiles,containerWidth:0,headerHeight:0},n.galleryTopOffset=0,n._galleryLabels=new rn,n._gallerySelection=new nn(n._galleryLabels),n._layout=new Ge(n._galleryLabels),n._visibleImagesMinMax=void 0,n.screenResIndex=0,n._events=new We.e(void 0),n._isAnchorScroll=!1,n._anchorScrollEnabled=!1,n._anchorData=void 0,n._anchorMap=new Map,n._selectionItems=[],n._galleryLogger=new en.e(n.props.telemetryCallbacks,n.props.onPageLoaded),n._async=new et.e,n._onScrubberMouseUp=n._async.debounce(n._onScrubberMouseUp,500,{leading:!0}),n._debouncedWindowResized=n._async.debounce(n._windowResized,1e3,{leading:!0}),n._debouncedTelemetryCallbackScreenSize=n._async.debounce(n._telemetryCallbackScreenSize,1e3),n}return Object(c.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.squareTiles?Jt.ParentLabel:Jt.Label;this._galleryLabels.setGroupData(this.props.groupToCount,this.props.photoCount,e),this._layout.setLayoutData(this.props.widths,this.props.targetHeight,this.props.photoCount),this.props.selection&&this._gallerySelection.setSelection(this.props.selection),this._recalculateGalleryHeaderHeight(),this.updateGalleryLayout(this.props,this.state,e),this._checkWidthChanged(),window.addEventListener("resize",this._onWindowResize)},t.prototype.componentDidUpdate=function(){this._recalculateGalleryHeaderHeight()},t.prototype.componentWillUnmount=function(){this._galleryLogger.onGallerySessionEnd(),this._gallerySelection.dispose(),this._events.dispose(),window.removeEventListener("resize",this._onWindowResize),this._nextFrameTimer&&(clearTimeout(this._nextFrameTimer),this._nextFrameTimer=void 0),void 0!==this._scrollEndedTimer&&(clearTimeout(this._scrollEndedTimer),this._scrollEndedTimer=void 0)},t.prototype.shouldComponentUpdate=function(e,t){var n=!1,a=!1,i=this.props.squareTiles?Jt.ParentLabel:Jt.Label;return e.selection&&e.selection!==this.props.selection&&(this._gallerySelection.setSelection(e.selection),a=!0),t.containerWidth===this.state.containerWidth&&this.props.squareTiles===e.squareTiles||(n=!0,a=!0),this.props.groupToCount===e.groupToCount&&this.props.widths===e.widths&&this.props.targetHeight===e.targetHeight&&this.props.photoCount===e.photoCount||(this._galleryLabels.setGroupData(e.groupToCount,e.photoCount,i),this._layout.setLayoutData(e.widths,e.targetHeight,e.photoCount),n=!0,a=!0),e.finishedPagingCounts&&e.finishedPagingCounts!==this.props.finishedPagingCounts&&this._galleryLogger.onScrubberLoaded(e.photoCount),this.props.items!==e.items&&(!this.props.items||!e.items||this.props.items.length!==e.items.length||this.props.items.some(function(t,n){return t!==e.items[n]}))&&(n=!0,a=!0),n&&this.updateGalleryLayout(e,t,i),a},t.prototype.updateGalleryLayout=function(e,t,n){this.screenResIndex=e.screenResBreakPoints.length-1;for(var a=0;a<e.screenResBreakPoints.length;a++)if(t.containerWidth<=e.screenResBreakPoints[a]){this.screenResIndex=a;break}if(this.galleryTopOffset=0,this.galleryRef.current){var i=this.galleryRef.current.getBoundingClientRect(),r=window.pageYOffset||document.documentElement.scrollTop;this.galleryTopOffset=Math.round(i.top+r)}var o={rowHeight:e.squareTiles?e.rowHeight_squaretiles[this.screenResIndex]:e.rowHeight_aspect[this.screenResIndex],margin:e.squareTiles?e.imagePadding_squaretiles[this.screenResIndex]:e.imagePadding_aspect[this.screenResIndex],squareTiles:e.squareTiles,groupHeaderMarginTop:e.groupHeaderMarginTop[this.screenResIndex],groupHeaderMarginBottom:e.groupHeaderMarginBottom[this.screenResIndex],groupHeaderLeadingMargin:e.groupHeaderLeadingMargin[this.screenResIndex],labelRowHeight:e.labelRowHeight,containerWidth:t.containerWidth,maxRowScaleUpFactor:e.squareTiles?e.maxRowScaleUpFactor_squaretiles[this.screenResIndex]:e.maxRowScaleUpFactor[this.screenResIndex],maxCandidateRowSizeFactor:1.5,midRowGroupGap:e.squareTiles?e.midRowGroupGap_squaretiles[this.screenResIndex]:e.midRowGroupGap_aspect[this.screenResIndex],enableDateStitching:n===Jt.Label&&e.enableDateStitching,startRowLeadingMargin:e.squareTiles?e.galleryPadding_squaretiles[this.screenResIndex]:e.galleryPadding_aspect[this.screenResIndex],endRowTrailingMargin:e.squareTiles?e.galleryPaddingRight_squaretiles[this.screenResIndex]:e.galleryPaddingRight_aspect[this.screenResIndex],showGroupHeaders:e.showGroupHeaders,showRoundCorners:e.showRoundCorners};this._imageRows=this._layout.buildAllRows(o);var s={height:this.state.headerHeight,y:0};this._scrubberRows=Object(c.__spreadArray)([s],this._imageRows,!0),this._anchorScrollEnabled&&this._scrollToAnchor()},t.prototype.getRowHeight=function(e){var t=e.index;return this._layout.getRowHeight(t)},t.prototype.render=function(){return d.createElement("div",{id:"GalleryContainer"+this.props.id,className:"ms-normalize",style:{display:"block",minHeight:"1px",width:"100%",overflow:"auto"},ref:this.parentGalleryRef},d.createElement("div",{id:this.galleryId,className:this.props.enableScrubber?ln.ReactGridGallery:ln.ReactGridGalleryScrollBar,"data-is-scrollable":!0,"data-is-focusable":!1,tabIndex:-1,style:{height:"calc(100vh - "+this.galleryTopOffset+"px)",float:"left",width:"100%",contain:"layout",overflowY:"scroll",overflowX:"hidden",scrollbarWidth:this.props.enableScrubber?"none":"auto"},"aria-label":on.e,ref:this.galleryRef,onScroll:this._onGalleryScroll,onWheel:this._handleOnWheel,onMouseUp:this._handleMouseUp,onKeyDown:this._handleKeyDown},d.createElement(this._renderHeader,null),d.createElement(Ze,{rows:this._imageRows,focusZoneComponentRef:this._focusZoneRef,rowRenderer:this._renderRowForTilesList,containerWidth:this.state.containerWidth,onRenderTileListParent:this._onRenderTileListParent,onListPagesUpdated:this._onListPagesUpdated}),d.createElement(this._renderFooter,null)),this.props.enableScrubber&&d.createElement(He,{galleryId:this.galleryId,layout:this._layout,rows:this._scrubberRows,key:"timeline",focusZoneRef:this._focusZoneRef,onMouseDown:this.resetAnchor,onMouseUp:this._onScrubberMouseUp,listOwnerClass:"AllPhotosTilesList",activatingZone:this.props.squareTiles?this.props.galleryPaddingRight_squaretiles[this.screenResIndex]:this.props.galleryPaddingRight_aspect[this.screenResIndex],scrollToRow:this._scrollToRowScrubber,onWheel:this._handleOnWheelScrubber}))},t.prototype._recalculateGalleryHeaderHeight=function(){var e=this._headerContainerRef.current?this._headerContainerRef.current.clientHeight:0;this.state.headerHeight!==e&&this.setState({headerHeight:e})},t.prototype._scrollToAnchor=function(){var e=this;if(this._anchorData){var t=-1;if(this._anchorData.anchorId)if(this._anchorData.isHeader){var n=this._layout.getRowIndexFromImageIndex(this._anchorData.imageIndex);n>0&&!this._imageRows[n].isLabel&&this._imageRows[n-1].isLabel&&(n-=1),t=n}else this._anchorMap.forEach(function(n,a,i){void 0!==e._anchorData&&n===e._anchorData.anchorId&&(t=e._layout.getRowIndexFromImageIndex(a))},this);if(t<0&&(t=this._layout.getRowIndexFromImageIndex(this._anchorData.imageIndex)),t>=0){var a=this._imageRows[t],i=this._anchorData.pctOffset?this._anchorData.pctOffset*a.height:0;this._isAnchorScroll=!0,this._scrollToRow(t,!1,i)}}},t.prototype._updateAnchorData=function(){if(this._imageRows.length>0&&this.galleryRef&&this.galleryRef.current){var e=Math.max(0,Math.round(this.galleryRef.current.scrollTop)-this.state.headerHeight),t=this._layout.getRowIndexFromYPosition(e),n=this._imageRows[t],a=n.isLabel,i=0,r=void 0;a?(i=this._layout.getFirstPhotoIndexInClosestImageRow(t),r=this._galleryLabels.getFullLabelByIndex(i)):(i=n.items[Math.floor((n.items.length-1)/2)].index,r=this._anchorMap.get(i));var o=a?0:Math.max(0,e-n.y),s=o>0?Math.min(1,o/n.height):0;this._anchorData={imageIndex:i,anchorId:r,isHeader:a,pctOffset:s},this._anchorScrollEnabled=!0}},t.prototype._calculateMinMaxVisibleRows=function(e){for(var t=Number.POSITIVE_INFINITY,n=-1,a=!1,i=0;i<e.length;++i){var r=e[i];if(r.isVisible&&(a=!0),r.isSpacer){if(a)break;t=Number.POSITIVE_INFINITY,n=-1}else t=Math.min(r.startIndex,t),n=Math.max(r.startIndex+r.itemCount-1,n)}this._visibleRowsMinMax=a?{min:t,max:n}:void 0},t.prototype._renderRow=function(e,t,n,a,i){var r=this,o=this._gallerySelection,s=this._galleryLabels,l=this._imageRows,u=this.props.squareTiles?this.props.imagePadding_squaretiles[this.screenResIndex]:this.props.imagePadding_aspect[this.screenResIndex],f=this.props.groupHeaderMarginTop[this.screenResIndex],p=this.props.groupHeaderMarginBottom[this.screenResIndex],m=this.props.groupHeaderLeadingMargin[this.screenResIndex],_=this.props.labelRowHeight,h=this.props.squareTiles?this.props.midRowGroupGap_squaretiles[this.screenResIndex]:this.props.midRowGroupGap_aspect[this.screenResIndex],b=this.props.squareTiles?this.props.galleryPadding_squaretiles[this.screenResIndex]:this.props.galleryPadding_aspect[this.screenResIndex],g=this.props.squareTiles?this.props.galleryPaddingRight_squaretiles[this.screenResIndex]:this.props.galleryPaddingRight_aspect[this.screenResIndex],v=this.props.showLocations,y=l[e];if(y){if(y.isLabel){var S=l[e+1],D=[],I=0,x=m,C=S.items[S.items.length-1].index,O=void 0,w=0,E=0,A=!0;S.items.forEach(function(n){var a=s.getGrandParentLabelByIndex(n.index),i=s.getGroupIdbyIndex(n.index),c=n.index<C?s.getGroupIdbyIndex(n.index+1):void 0,d=at(u,h,b,g,O,i,c);if(A?(Ee.e.isRightToLeft?E=d.right:(w=x+d.left,0===r.screenResIndex&&(I-=x)),A=!1):Ee.e.isRightToLeft?I+=d.right:I+=d.left,I+=n.vwidth,n.index<C?Ee.e.isRightToLeft?I+=d.left:I+=d.right:Ee.e.isRightToLeft&&(w=x,I-=x),i!==c){var l=s.getStartIndexByGroupId(i),m=s.getImageCountByGroupId(i);D.push({rowIndex:e,rowKey:t,label:s.getHeaderByIndex(n.index),selectionLabel:s.getLabelByIndex(n.index),grandParentLabel:a,locations:[],imageStartIndex:l,imageCount:m,labelRowHeight:_,labelRowWidth:I,margins:{top:f,bottom:p,left:w,right:E},selection:o,onLocationHeaderClick:r.props.onLocationHeaderClick,groupId:i}),I=0,A=!0}O=i});var L=D;return d.createElement("div",{id:t,style:n,"data-list-index":e,onClick:this._onClickRow},d.createElement(Zt.e,{key:t},function(e){var t=e.itemCache;return e.dispatch,L.map(function(e){var n=e.selectionLabel,a=e.imageStartIndex,i=e.imageCount,o=n+"_"+e.groupId;return Object($t.a)(t,d.createElement(Ot,Object(c.__assign)({itemKeys:r._getItemKeysForGroup(a,i),key:o,showLocations:v,focusZoneRef:r._focusZoneRef},e)))})}))}var k="32px";if(Ce.e.matches(this.props.itemKey)){var M=Ce.e.deserialize(this.props.itemKey);k="onthismonth"===M.filterType||"lastweekpreviousyears"===M.filterType?"80px":"32px"}var P=Object(c.__assign)(Object(c.__assign)({},n),{paddingBottom:l.length===e+1?k:"0px"});return d.createElement("div",{className:"row","data-list-index":e,id:t,style:P,onClick:this._onClickRow},d.createElement(Zt.e,{key:t},function(t){var n=t.itemCache,i=void t.dispatch,o=y.items[y.items.length-1].index;return y.items.map(function(t,c){var l=s.getGroupIdbyIndex(t.index),f=t.index<o?s.getGroupIdbyIndex(t.index+1):void 0,p=at(u,h,b,g,i,l,f),m=c;i=l;var _=r.props.items&&r.props.items[t.index]?r.props.items[t.index]:"";return Object($t.a)(n,d.createElement(Xt,{key:m,recordKey:_,index:t.index,rowIndex:e,selection:r.props.selection,margin:u,width:t.vwidth,height:t.vheight,roundedCornerTopLeft:!!t.roundedCornerTopLeft&&t.roundedCornerTopLeft,roundedCornerTopRight:!!t.roundedCornerTopRight&&t.roundedCornerTopRight,roundedCornerBottomLeft:!!t.roundedCornerBottomLeft&&t.roundedCornerBottomLeft,roundedCornerBottomRight:!!t.roundedCornerBottomRight&&t.roundedCornerBottomRight,isScrolling:a,onMount:r.onImageMount,onUnmount:r.onImageUnmount,onSrcChanged:r.onImageSrcChanged,onLoad:r.onImageLoad,onError:r.onImageError,registerAnchorId:r.registerAnchorId,deregisterAnchorId:r.deregisterAnchorId,openItemOverlay:r.props.openItemOverlay,onRenderTile:r._onRenderTile,onRenderTileAnnotation:r.props.onRenderTileAnnotation,margins:p,useSquareTiles:r.props.squareTiles,imageErrorThumbnail:r.props.imageErrorThumbnail,videoErrorThumbnail:r.props.videoErrorThumbnail}))})}))}return console.warn("Requested row to render is not in rows array!"),d.createElement("span",{key:t},"An error has occurred rendering this row.")},t.prototype._getItemKeysForGroup=function(e,t){for(var n=[],a=Math.min(e+t,this.props.items.length),i=e;i<a;++i){var r=this.props.items[i];r&&n.push(r)}return n},t.defaultProps={id:"ReactGridGallery",squareTiles:!1,labelRowHeight:40,targetHeight:1e3,photoCount:0,groupToCount:cn,widths:dn},t}(d.Component),fn=n(1890),pn=n(1940),mn=n(19),_n=n(599),hn=n(600),bn=n(1268),gn=n(1152),vn=n(476),yn=n(201),Sn=n(1775),Dn=n(2258),In=n(603),xn=n(2257),Cn=Object(ge.e)(function(e,t){var n,a=t.itemKey,i=t.visibleRangeUpdated,r=t.visibleFrom,o=t.visibleTo,s=t.useItemsScopeSelection,c=[],d=void 0;if(Ce.e.matches(a)){var l=Ce.e.deserialize(a),u=e.demandItemFacet(Ie.t,a),f=e.demandItemFacet(xe.n,a);if(u){var p=!1,m=e.demandItemFacet(Ie.e,u.itemKey),_=e.demandItemFacet(Ie.a,u.itemKey),h=e.demandItemFacet(mn.e,u.itemKey);h&&(0===h.itemKeys.length?p=!0:h.itemKeys[0]&&e.demandItemFacet(mn.e,h.itemKeys[0]));var b=void 0,g=void 0;f&&(b=e.demandItemFacet(xe.t,f.itemKey),g=e.demandItemFacet(xe.e,f.itemKey));var v=e.demandItemFacet(Sn.d,yn.e,{suppressGetItems:!0}),y=e.demandItemFacet(Sn.n,yn.e,{suppressGetItems:!0}),S=v?function(e,t,n,a){var i,r=e.demandItemFacet(Dn.e,t)||[],o=e.demandItemFacet(vn.e,t),s=vn.e.evaluate(o)(e,{setItemKey:t}),c=s.getPageKey,d=s.pageSize,l=void 0;if(c&&d){var u=c(n,a);void 0!==u&&(e.demandItemFacet(mn.e,u),On(e,u)&&(l=u),e.demandItemFacet(ve.t,u)&&(i=u))}return{keys:r,pageToReset:l,photoPageKey:i}}(e,a,r,o):function(e,t,n,a,i){var r=[],o=void 0,s=e.demandItemFacet(Ie.e,n),c=e.demandItemFacet(Ie.n,n);if(s&&c&&a>=0&&i>=0)for(var d=!1,l=0===a?0:je(c,function(e,t){if(s){var n=s[t];if(a>=e+n.count)return 1;if(a<e)return-1}return 0});l<s.length;++l){var u=s[l];if(c[l]>i)break;var f=fn.e.serialize({photosRootItemSetKeyPart:t,id:u.id}),p=e.isItemFacetResolved(mn.e,f),m=e.demandItemFacet(mn.e,f);if(p&&m)for(var _=c[l],h=0;h<m.itemKeys.length;++h){var b=m.itemKeys[h];if(Vt.e.matches(b))_>=a&&(r[_]=b),_++;else if(pn.e.matches(b)){var g=pn.e.deserialize(b),v=g.count,y=g.offset;_+=v,d||a<=y+v&&y<=i&&(o=On(e,b)?b:void 0,e.demandItemFacet(mn.e,b),d=!0)}}}return{keys:r,pageToReset:o}}(e,l,u.itemKey,r,o);c=S.keys,d=S.pageToReset,n=S.photoPageKey;var D=l.photosRootKeyPart,I=D.driveId,x=D.endpoint,C="tag"!==l.filterType&&"album"!==l.filterType;if("onthismonth"===l.filterType){var O=l.filter,w=JSON.parse(O).applyUtilityFiltering;C=!w||w&&!0===y}var E="place"!==l.filterType,A=e.demandItemFacet(Sn.i,yn.e,{suppressGetItems:!0});Object(xn.n)(A||Wt.n.isFeatureEnabled(xn.e));var L="onthismonth"===l.filterType||"lastweekpreviousyears"===l.filterType||"onthisday"===l.filterType&&xn.t||"place"===l.filterType&&xn.t;if(m&&b&&g)return{items:c,groupToCount:m,finishedPagingCounts:p,widths:b,targetHeight:g,photoCount:_,visibleRangeUpdated:i,createSelectionItemKey:s?function(e){return Vt.e.serialize({endpoint:x,driveId:I,itemId:e})}:void 0,itemKey:a,showGroupHeaders:C,showLocations:E,showRoundCorners:L,pageKeyToReset:d,photoPageKey:n,dispatch:e.dispatch}}}return{items:[],groupToCount:[],finishedPagingCounts:!1,widths:new Uint16Array,targetHeight:0,photoCount:0,visibleRangeUpdated:i,createSelectionItemKey:function(e){},itemKey:a,showGroupHeaders:!1,showLocations:!1,showRoundCorners:!1,pageKeyToReset:d,photoPageKey:n,dispatch:e.dispatch}});function On(e,t){var n=!1;if(e.isItemFacetResolved(ve.t,t)){var a=e.demandItemFacet(ve.t,t,{suppressGetItems:!0});a&&a instanceof Se.e&&a.innerError instanceof ye.e&&(n=!0)}return n}var wn=function(e){function t(t){var n=e.call(this,t)||this;return n._items=[],n.state={galleryRendered:!1},n}return Object(c.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemKey!==this.props.itemKey&&this.setState({galleryRendered:!1})},t.prototype.componentDidUpdate=function(){var e;void 0!==this.props.pageKeyToReset&&this.props.dispatch(Object(De.e)({items:(e={},e[this.props.pageKeyToReset]=!0,e)}))},t.prototype.render=function(){var e=this;return(this.props.items.length>0||0===this.props.photoCount)&&(this._items=this.props.items),d.createElement(d.Fragment,null,0===this.props.groupToCount.length||this.props.photoPageKey?d.createElement(d.Fragment,null,this.props.photoPageKey&&this.props.galleryFailedtoLoad_NoData&&this.props.galleryFailedtoLoad_NoData(),d.createElement(gn.t,{key:"error",itemKey:this.props.photoPageKey?this.props.photoPageKey:this.props.itemKey}),d.createElement(bn.e,{itemKey:this.props.itemKey})):d.createElement(In.e,{isDataReadyForLayout:this.state.galleryRendered,itemKey:this.props.itemKey},d.createElement(un,Object(c.__assign)({},this.props,{itemKey:this.props.itemKey,items:this._items,onPageLoaded:function(){e.setState({galleryRendered:!0})}}))))},t}(d.PureComponent),En=Object(Oe.n)()(Cn(wn)),An=Object(Oe.n)()(Cn(Object(hn.e)()(Object(_n.e)()(wn)))),Ln=function(e){function t(t){var n=e.call(this,t)||this;return n._updateVisibleRange=function(e,t){n._isMounted&&n.setState({from:e,to:t})},n._isMounted=!1,n.state={from:-1,to:-1},n}return Object(c.__extends)(t,e),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.render=function(){return this.props.selection?d.createElement(En,Object(c.__assign)({visibleRangeUpdated:this._updateVisibleRange,visibleFrom:this.state.from,visibleTo:this.state.to,useItemsScopeSelection:!1},this.props)):d.createElement(An,Object(c.__assign)({visibleRangeUpdated:this._updateVisibleRange,visibleFrom:this.state.from,visibleTo:this.state.to,useItemsScopeSelection:!0},this.props))},t}(d.PureComponent),kn=n(2938),Mn=n(271),Pn=n(24),Tn=n(10),Un=n(1877),Fn=function(e){var t=e.itemKey,n=d.useMemo(function(){var e=Math.floor(3*Math.random())+1;return"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/@fluentui/react-assets/images/error/error".concat(e,".svg")},[]);if(Ce.e.matches(t)){var a=Ce.e.deserialize(t),i=a.photosRootKeyPart.endpoint,r=a.groupBy,o=Ce.e.serialize({photosRootKeyPart:{driveId:Tn.z,endpoint:i},groupBy:r,filter:"root",filterType:"folder"});return d.createElement(gn.e,{error:new Error("CID mismatch error"),title:Un.u,subText:Un.l,errorImageUrl:n,actions:d.createElement(function(e){return e.itemKey?d.createElement(Pn.n,{action:d.createElement(Mn.e,{itemKey:e.itemKey})},function(e){var t=e.execute;return d.createElement(bt.e,{onClick:function(){return t()}},Un.n)}):d.createElement(d.Fragment,null)},{itemKey:o})})}return d.createElement(d.Fragment,null)},Hn=n(1627),Rn=n(2325),Nn=n(70),Bn=n(1885);Object(b.n)([{rawString:".headerTitle_50616513{font-size:14px;text-overflow:ellipsis;overflow:hidden;font-weight:600;white-space:nowrap;margin-bottom:8px;color:#323130}\n"}]),Object(b.n)([{rawString:".header_md_separator_ae988a0d{font-size:14px;color:#e1dfdd;white-space:pre}.header_md_text_ae988a0d{font-size:14px;color:#605e5c}\n"}]);var jn="header_md_separator_ae988a0d",Vn="header_md_text_ae988a0d",zn=n(3783),Gn=s,Kn=function(e){var t=e.count;return d.createElement("span",{className:Gn.header_md_text},t," ",1===t?zn.e:zn.t)},Wn=n(2365),qn=function(e){var t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Object(Wn.n)(t)},Qn=s,Yn=function(e){var t=function(e){var t=qn(e.minDate),n=qn(e.maxDate);return t===n&&(n=""),{minFormattedDate:t,maxFormattedDate:n}}(e.dateRange),n=t.maxFormattedDate,a=t.minFormattedDate;return n?d.createElement("span",{className:Qn.header_md_text},a," ~ ",n):d.createElement("span",{className:Qn.header_md_text},a)},Jn=function(e){var t=e.count?d.createElement(Kn,{count:e.count}):void 0,n=e.dateRange&&d.createElement(Yn,{dateRange:e.dateRange}),a=t&&n&&d.createElement("span",{className:jn},"  |  ");return d.createElement(d.Fragment,null,n,a,t)},Xn=Object(ge.e)(function(e,t){var n=t.itemKey,a=e.demandItemFacet(Gt.u,n),i=e.demandItemFacet(Nn.e,n),r=e.demandItemFacet(Bn.e,n),o=e.demandItemFacet(Rn.e,n),s=Rn.e.evaluate(o)(e,{itemKey:n,label:a,count:i,dateRange:r});return{label:s.label,count:s.count,dateRange:s.dateRange}})(function(e){var t=e.label,n=e.count,a=e.dateRange,i=e.containerStyle,r=e.titleStyle;return d.createElement(d.Fragment,null,t&&d.createElement("div",{style:i},d.createElement("h2",{"aria-label":t,className:"headerTitle_50616513",style:r},t),d.createElement(Jn,{count:n,dateRange:a})))}),Zn=Object(Oe.e)()(Xn);Object(b.n)([{rawString:".mojHeader_98e4f555{display:flex;align-content:center;justify-content:space-between}.mojHeaderTitle_98e4f555{font-family:Segoe UI;text-align:left;font-size:32px;font-weight:600;margin:0 0 .5rem}html[dir=rtl] .mojHeaderTitle_98e4f555{text-align:right}.mojSubtitleParent_98e4f555{position:relative;font-weight:350}.mojHeaderText_98e4f555{height:5rem;text-align:left;color:#000;margin:2.5rem 0 1.25rem}.mojHeaderTextNoGroupHeader_98e4f555{margin:2.5rem 0 3.75rem}html[dir=rtl] .mojHeaderText_98e4f555{text-align:right}.mojSubtitleSeparator_98e4f555{font-size:24px;margin:0 .625rem}.mojSubtitleText_98e4f555{display:flex;align-items:center}.mojSubtitleToggle_98e4f555{position:absolute;top:0;right:0;top:50%;transform:translateY(-50%)}.mojHeaderToggle_98e4f555{display:flex;justify-content:flex-end}.mojToggleAction_98e4f555{color:#0078d4;float:right;overflow:hidden;text-overflow:ellipsis;text-align:right}html[dir=rtl] .mojToggleAction_98e4f555{float:left}.mojToggleAction_98e4f555:hover{color:#004578}.mojToggleAction_98e4f555:hover:active{color:#0078d4}.coachmarkContainer_98e4f555{z-index:1}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555{background-color:#faf9f8}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .ms-TeachingBubble-bodycontent{background-color:#faf9f8}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .ms-TeachingBubble-bodycontent button,.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .ms-TeachingBubble-bodycontent p{color:#000}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .ms-TeachingBubble-bodycontent button:hover{background-color:#e1e1e1}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .teachingBubbleIllustration_98e4f555{border:.125rem solid #faf9f8;border-bottom:none}.coachmarkContainer_98e4f555 .postToPSButtonTeachingBubbleContainer_98e4f555 .teachingBubbleIllustration_98e4f555 img{width:22.75rem;height:19.375rem;-o-object-fit:cover;object-fit:cover}.postToPSButton_98e4f555{border-radius:.25rem;margin-top:2.5rem;padding:0 1.25rem 0 1.25rem;z-index:1;transition:all ease-in-out .3s}[dir=rtl] .postToPSButton_98e4f555{padding:0 1.25rem 0 1.25rem}.postToPSButton_98e4f555 .postToPSButtonIcon_98e4f555{color:#fff}.postToPSButton_98e4f555 .text_98e4f555{font-weight:500;line-height:1.25rem}.layeredPostToPSButton_98e4f555{z-index:1}.layeredPostToPSButton_98e4f555 .postToPSButton_98e4f555{position:absolute;height:3rem;min-width:3rem;border-radius:6.25rem;bottom:1rem}[dir=ltr] .layeredPostToPSButton_98e4f555 .postToPSButton_98e4f555{right:1rem}[dir=rtl] .layeredPostToPSButton_98e4f555 .postToPSButton_98e4f555{left:1rem}.layeredPostToPSButton_98e4f555 .postToPSButton_98e4f555.noPadding_98e4f555{padding:0}[dir=rtl] .layeredPostToPSButton_98e4f555 .postToPSButton_98e4f555.noPadding_98e4f555{padding:0}"}]);var $n=n(818),ea=n(819),ta=n(812),na=n(1719),aa=n(1110),ia=n(1111),ra=n(1109),oa=n(299),sa=n(3400),ca=n(2285),da=n(1587),la=n(138),ua=n(2247),fa=n(1958),pa=n(1552),ma=n(2300),_a=n(1986),ha="mojpbtbs",ba=n(2339),ga=n(91),va=n(33),ya=n(338),Sa=n(1996),Da="All",Ia="Featured",xa=Object(ge.e)(function(e,t){if(Ce.e.matches(t.itemKey)){var n=Ce.e.deserialize(t.itemKey),a=n.photosRootKeyPart,i=n.filter,r=n.filterType,o=n.groupBy,s=e.demandItemFacet(Ie.t,t.itemKey),c=void 0;s&&(c=e.demandItemFacet(Ie.a,s.itemKey));var d=e.dispatch(Object(ca.e)());if("onthismonth"===r){var l=wa(i,r,$n.t,$n.e,aa.e,a,0,o);return{count:c,itemKey:l.itemKey,date:l.date,isNewCarouselEnabled:d}}if("lastweekpreviousyears"===r){var u=wa(i,r,ea.t,ea.e,ia.e,a,0,o);return{count:c,itemKey:u.itemKey,date:u.date,isNewCarouselEnabled:d}}if("onthisday"===r&&d){var f=wa(i,r,ta.t,ta.e,ra.e,a,0,o);return{count:c,itemKey:f.itemKey,date:f.date,isNewCarouselEnabled:d}}}return{date:void 0,itemKey:void 0,count:void 0,isNewCarouselEnabled:void 0}})(function(e){var t=e.itemKey,n=e.count,a=e.date,i=e.isNewCarouselEnabled,r=Object(ma.e)().width,o=1023,s=Object(d.useRef)(null),c=Object(_a.e)(s,{threshold:1})[0],l=Object(d.useState)(!1),u=l[0],f=l[1],p=Object(ba.e)("mojToPSPostButton"),m=window.require.toUrl("odsp-media/images/photostream/introduction.gif"),_=r<=o?la.e.topRightEdge:la.e.bottomRightEdge;if(Object(d.useEffect)(function(){var e=null!==localStorage.getItem(ha),n=Object(ya.n)();!e&&n&&(f(!0),Ce.e.matches(t)&&Aa("PostMOJToPhotoStoryCoachmarkVisible",Ce.e.deserialize(t).filterType,!1)),n&&Ce.e.matches(t)&&Aa("PostMOJToPhotoStoryButtonShown",Ce.e.deserialize(t).filterType,!1,va.t.requiredService)},[]),Ce.e.matches(t)){var h=Ce.e.deserialize(t),b=h.filter,g=h.filterType,v=!1,y="",S=d.createElement(d.Fragment,null),D=d.createElement(d.Fragment,null),I="";if("onthismonth"===g){I=(v=Object($n.e)(b).applyUtilityFiltering)?Da:Ia;var x=null==a?void 0:a.toLocaleDateString("default",{month:"long"}),C=null==a?void 0:a.getFullYear();y=pt.format(oa.u,x),S=d.createElement("span",null,C)}else"lastweekpreviousyears"===g?(I=(v=Object(ea.e)(b).applyUtilityFiltering)?Da:Ia,y=oa.c,S=d.createElement("span",null,oa.s)):"onthisday"===g&&i&&(I=(v=Object(ta.e)(b).applyUtilityFiltering)?Da:Ia,y=oa.l,S=d.createElement("span",null,oa.s));D=d.createElement("span",null,pt.format(sa.i,I,n));var O=function(){var t=Ea(a,g);e.onPost(g,t,"button")},w=function(){return d.createElement(da.e,{"aria-label":sa.c,className:Object(we.e)("postToPSButton_98e4f555",!c&&"noPadding_98e4f555"),id:p,onClick:O,iconProps:{className:"postToPSButtonIcon_98e4f555",iconName:"SingleColumnEdit"}},(c||r>o)&&d.createElement("span",{className:"text_98e4f555"},sa.c))};if(a&&t&&n)return d.createElement(d.Fragment,null,u&&d.createElement(ua.e,{target:"#".concat(p),positioningContainerProps:{directionalHint:_,doNotLayer:!0,className:"coachmarkContainer_98e4f555"},ariaAlertText:sa.t,ariaDescribedByText:sa.n,ariaLabelledByText:sa.a,onAnimationOpenEnd:function(){Aa("PostMOJToPhotoStoryCoachmarkExpanded",g,!0)},styles:function(e){return{entityHost:!e.isCollapsed&&{backgroundColor:"#fff",boxShadow:"rgb(0 0 0 / 13%) 0px 6.4px 14.4px 0px, rgb(0 0 0 / 11%) 0px 1.2px 3.6px 0px",borderRadius:"8px"}}}},d.createElement("div",{className:"postToPSButtonTeachingBubbleContainer_98e4f555"},d.createElement(fa.e,{illustrationImage:{src:m,alt:sa.r,className:"teachingBubbleIllustration_98e4f555"},headline:sa.s,hasCloseButton:!0,closeButtonAriaLabel:sa.e,onDismiss:function(){Aa("PostMOJToPhotoStoryCoachmarkDismissed",g,!0),f(!1),localStorage.setItem(ha,"true")}},sa.o))),d.createElement("div",{className:"mojHeader_98e4f555",ref:s},d.createElement("div",{className:"onthismonth"!==g||v||Object(me.isFeatureEnabled)(me.EnableMojFeedback)?"mojHeaderText_98e4f555":"mojHeaderTextNoGroupHeader_98e4f555"},d.createElement("h2",{className:"mojHeaderTitle_98e4f555"},y),d.createElement("div",{className:"mojSubtitleParent_98e4f555"},d.createElement("div",{className:"mojSubtitleText_98e4f555"},S,d.createElement("span",{className:"mojSubtitleSeparator_98e4f555"},"·"),D),Object(me.isFeatureEnabled)(me.EnableSeeAllSeeFeaturedButton)&&("onthismonth"===g||"lastweekpreviousyears"===g)&&d.createElement("div",{className:"mojSubtitleToggle_98e4f555"},d.createElement(Ca,{itemKey:t,applyUtilityFiltering:v})))),Object(ya.n)()&&(r<=o?d.createElement(pa.e,{className:"layeredPostToPSButton_98e4f555"},w()):w())),Object(me.isFeatureEnabled)(me.EnableMojFeedback)&&d.createElement(Sa.e,{isMomentsOfJoy:!0,context:{pageName:g}}))}return d.createElement(d.Fragment,null)}),Ca=function(e){var t=e.itemKey,n=e.applyUtilityFiltering?Ia:Da;return d.createElement(Pn.n,{action:d.createElement(Mn.e,{itemKey:t})},function(e){var t=e.execute;return d.createElement(na.e,{onClick:function(e){t(),e.stopPropagation()},className:"action"},pt.format(sa.d,n))})},Oa=Object(Oe.e)()(xa);function wa(e,t,n,a,i,r,o,s){var c=a(e),d=c.date,l=n(d,c.resourceId,!c.applyUtilityFiltering);return{itemKey:Ce.e.serialize({photosRootKeyPart:r,groupBy:s,filter:l,filterType:t}),date:d}}function Ea(e,t){var n,a,i=e;switch(t){case"onthismonth":var r=new Date(i.getFullYear(),i.getMonth()+1,1);n=r.getMonth()+1,a=r.getDate();break;case"lastweekpreviousyears":i.setDate(i.getDate()+7),n=i.getMonth()+1,a=i.getDate();break;default:n=i.getMonth()+1,a=i.getDate()}return[i.getFullYear(),(n>9?"":"0")+n,(a>9?"":"0")+a].join("-")}function Aa(e,t,n,a){void 0===a&&(a=va.t.optionalDiagnostic),ga.e.logData({name:"PhotoStream.".concat(e),isIntentional:n,extraData:{location:"MOJLandingPage",type:t},privacyClassification:a,privacyDataTypes:["productAndServiceUsage"]})}Object(b.n)([{rawString:".od-OnThisDayHeader{height:200px;text-align:center;background-position:center;background-repeat:no-repeat}.od-OnThisDayHeader-title{padding-top:24px}.od-OnThisDayHeader-month{padding-top:16px}.od-OnThisDayHeader-day{font-size:28px;font-weight:100;font-size:54px;padding-top:8px}"}]);var La,ka,Ma=n(3401),Pa=n(1743),Ta=function(e){var t=window.require.toUrl("odsp-media/images/onthisday/balloons_24f.gif"),n=Ma.u,a=Fa(e.date),i=e.date.getDate().toString();return d.createElement(d.Fragment,null,d.createElement("div",{className:"od-OnThisDayHeader",style:{backgroundImage:"url('".concat(t,"')")}},d.createElement("div",{className:"od-OnThisDayHeader-title ms-font-l"},n),d.createElement("div",{className:"od-OnThisDayHeader-month ms-font-xxl"},a),d.createElement("div",{className:"od-OnThisDayHeader-day"},i)),Object(me.isFeatureEnabled)(me.EnableMojFeedback)&&d.createElement(Sa.e,{isMomentsOfJoy:!0,context:{pageName:e.type+"Legacy"}}))},Ua=Object(Oe.n)()(function(e){if(Ce.e.matches(e.itemKey)){var t=Ce.e.deserialize(e.itemKey),n=t.filter,a=t.filterType;if("onthisday"===a){var i=Object(ta.e)(n).date;return d.createElement(Ta,{date:i,type:a})}}return d.createElement(d.Fragment,null)}),Fa=Object(Pa.t)({month:"long"}),Ha=n(1267),Ra=Object(Oe.n)()(Object(ge.t)(function(e,t){return Ce.e.matches(t.itemKey)&&"place"===Ce.e.deserialize(t.itemKey).filterType?d.createElement(Ha.e,null):null})),Na=n(101),Ba=n(515),ja=n(439),Va=n(397),za=n(838),Ga=n(821),Ka=n(680),Wa=n(1190),qa=n(541),Qa=n(825),Ya=n(571),Ja=n(1330),Xa=n(441),Za=n(1249),$a=n(1166),ei=n(769),ti=n(1331),ni=n(1359),ai=n(648),ii=n(1379),ri=d.memo(function(e){Object(d.useEffect)(function(){if(e.allItemsResolved){for(var t={},n=0;n<e.items.length;n++)t["availableCard"+n]=e.items[n].folderType;e.logTelemetryFn("AllPhotos.EYPCarouselLength",{count:e.items.length}),e.logTelemetryFn("AllPhotos.EYPCarouselCard",Object(c.__assign)({},t))}},[e.allItemsResolved]);var t=ei.t;return d.createElement(ni.e,{items:e.items,tileMinWidths:ai.t,carouselTitle:ti.e,onRenderCell:oi(e.logTelemetryFn),headerClassName:ei.e,toolbarClassName:ei.a,navButtonClassName:ei.n,carouselListClassName:t,style:e.style,cardsCompletedRendering:e.cardsCompletionRenderingCallback})}),oi=function(e){return function(t,n,a,i,r){return d.createElement(ii.e,{key:n,item:t,size:a,logTelemetryFn:e,cardsCompletedRendering:r})}},si=d.memo(function(e){var t=Object(d.useState)(!1),n=t[0],a=t[1];return d.createElement(In.e,{isDataReadyForLayout:n&&e.allItemsResolved,itemKey:e.currentItemKey},d.createElement(ri,Object(c.__assign)({},Object(c.__assign)(Object(c.__assign)({},e),{cardsCompletionRenderingCallback:function(){a(!0)}}))))}),ci=n(55),di=n(392),li=n(2303),ui=n(2033),fi=n(595),pi=n(5),mi=n(1195),_i=n(52),hi=n(8),bi=n(1496),gi=function(){function e(){this._customerPromises=new Map}return e.prototype.startCustomerPromise=function(e,t,n,a){this._customerPromises.has(t)||this._customerPromises.set(t,new bi.e({scenario:e,perfGoalInMs:null!=n?n:3e4,extraData:null!=a?a:void 0}))},e.prototype.endCustomerPromise=function(e,t,n){this._customerPromises.has(e)&&(this._customerPromises.get(e).end({resultType:t,errorCode:e,extraData:n}),this._customerPromises.delete(e))},e.prototype.endCustomerPromiseVNext=function(e,t,n,a){this._customerPromises.has(e)&&(this._customerPromises.get(e).end({resultType:t,errorCode:n,extraData:a}),this._customerPromises.delete(e))},e.prototype.endAllCustomerPromise=function(e){var t=this;this._customerPromises.forEach(function(n,a){t.endCustomerPromise(a,_i.e.Success,{message:e})})},e}();!function(e){e.PHOTOS_BOOT="photosBoot"}(La||(La={})),function(e){e.CAROUSEL_NOT_LOADED="carouselNotLoaded",e.GALLERY_FAILED_LOADED="galleryFailedToLoad"}(ka||(ka={}));var vi=new hi.t({name:"".concat("PhotosCustomerPromiseHelper",".photosCustomerPromiseHelper"),factory:{dependencies:{},create:function(){return{instance:new gi}}}}),yi=n(157),Si=n(12),Di=n(1185),Ii=n(40),xi=n(1103),Ci=n(833),Oi=function(e){function t(t){var n=e.call(this,t)||this;n.onLoadItemCallback=function(e){return function(t){var n=new Ba.e({controlId:"ExplorePhotosCarousel",startTime:e.startTime,endTime:t.endTime,ignoreForEUPL:!0,needFlatten:!0});Ya.t.getRUMOneLogger().writeControlPerformanceData(n)}};var a=n.props.resources.consume(Ga.e);return n._controlHandlerProvider=Object(qa.n)({defaultClickAction:ja.e,openAction:Va.e,errorThumbnailIcon:Ka.e,storeKeyToUrl:Xa.e},{defaultClickAction:za.e,openAction:a,errorThumbnailIcon:Wa.t,storeKeyToUrl:Ja.e}),n}return Object(c.__extends)(t,e),t.prototype.render=function(){var e=this._controlHandlerProvider;return d.createElement(Qa.e,{qosName:"ExplorePhotos.Load",onLoadItem:this.onLoadItemCallback},d.createElement(e,null,d.createElement(Ei,{itemKey:this.props.currentItemKey,style:this.props.headerStyle,logTelemetryFn:this.props.logTelemetryFn})))},t}(d.Component),wi=!Si.t.isActivated("C8D7C238-3F3E-4A7A-BF73-B6661092EC15","2022-05-24","show dynamic ps cards on photos carousel"),Ei=function(e){var t=d.useState(void 0),n=t[0],a=t[1],i=Object(Ii.n)();d.useLayoutEffect(function(){var e=!0;return i.consumeAsync(Di.e).then(function(t){e&&a(t)}),function(){e=!1}},[i]);var r=mi.e.consume(vi),o=Object(yi.i)(function(t){var a=t.demandItemFacet(Sn.i,yn.e,{suppressGetItems:!0});Object(xn.n)(a||Object(pi.Hr)(xn.e));var i=e.itemKey,o=[],s=!1,l=!1,u=t.demandItemFacet(fi.t,yn.e);if(Ce.e.matches(i)){var f=void 0,p=[],m=[],_=t.demandItemFacet(Ci.e,yn.e,{suppressGetItems:!0});if(wi&&u){var h=null==n?void 0:n.demandPhotoStoryCarouselCards(t);l=void 0!==h,h&&m.push.apply(m,h)}else l=!0;var b=Ce.e.deserialize(i).photosRootKeyPart,g=li.e.serialize(b);s=t.isItemFacetResolved(mn.e,g);var v=t.demandItemFacet(mn.e,g),y=t.isItemFacetResolved(ve.t,g),S=t.demandItemFacet(ve.t,g);y&&S&&r.endCustomerPromise(ka.CAROUSEL_NOT_LOADED,_i.e.Failure,{error:S}),v&&v.itemKeys.forEach(function(e){var n=function(e,t){var n=e.demandItemFacet(di.i,t),a=e.demandItemFacet(Nn.e,t),i=e.demandItemFacet(Gt.u,t),r=e.demandItemFacet(ui.e,t);if(r)return{name:i||"",defaultClickAction:d.createElement(Mn.e,{itemKey:t}),folderType:r,photoCount:a,creationDate:n?new Date(n):new Date,renderThumbnail:function(e,n){return d.createElement($a.e,{alt:"",className:Object(we.e)(Za.e,n),itemKey:t,desiredSize:e})}}}(t,e);n&&n.folderType===ci.e.OnThisDay?f=n:n&&p.push(n)});var D=function(e){return{folderType:ci.e.StaticCards,creationDate:new Date,name:ci.e.StaticCards,url:"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink",isStaticCard:!0,renderThumbnail:function(){return d.createElement(d.Fragment,null)},imagePath:null==e?void 0:e.accessMemoriescardStaticImage}}(_),I=!u||wi&&!l?void 0:function(e,t){var n=Ce.e.deserialize(t).photosRootKeyPart,a=xi.e.serialize(Object(c.__assign)(Object(c.__assign)({},n),{type:ci.e.PhotoStoryStaticCard,resourceId:"root"}));return{folderType:ci.e.PhotoStoryStaticCard,creationDate:new Date,name:ci.e.PhotoStoryStaticCard,subTitle:"",isStaticCard:!0,defaultClickAction:d.createElement(Mn.e,{itemKey:a}),renderThumbnail:function(){return d.createElement(d.Fragment,null)},imagePath:null==e?void 0:e.psIntroCardStaticImage}}(_,i);I&&m.push(I),function(e,t,n,a,i){t.push(e),a.length&&t.push(a[0]),n&&t.push(n),a.length>1&&t.push(a[1]),t.push.apply(t,i)}(D,o,f,m,p)}return(s||l)&&o.forEach(function(t,n){t.logClickEvent=function(){e.logTelemetryFn("AllPhotos.EYPCarouselCardClick",{index:n,type:t.folderType})}}),r.endCustomerPromise(ka.CAROUSEL_NOT_LOADED,_i.e.Success),{items:o,allItemsResolved:s&&l,currentItemKey:i}},[n]);return d.createElement(si,Object(c.__assign)({},e,o))};Object(b.n)([{rawString:".od-photos-forYouFooter{margin-top:32px;margin-bottom:64px;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:0;text-align:center}.od-photos-forYouFooter-title{padding:32px 74px 24px 74px;font-size:18px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-photos-forYouFooter-btnToolbar{padding-bottom:32px}"}]);var Ai=n(1565),Li=n(2158),ki=n(3402),Mi={childrenGap:12},Pi=function(e){return d.createElement(Qe.e,{direction:Ye.e.bidirectional,isCircularNavigation:!0},d.createElement("div",{className:"od-photos-forYouFooter"},d.createElement("div",{className:"od-photos-forYouFooter-title"},ki.e),d.createElement(Li.e,{className:"od-photos-forYouFooter-btnToolbar",horizontalAlign:"center",tokens:Mi},d.createElement(da.e,{text:ki.n,onClick:function(t){e.saveAutoAlbumAction.execute(t)}}),d.createElement(Ai.e,{text:ki.t,onClick:function(t){e.discardAutoAlbumAction.execute(t)}}))))},Ti=n(508),Ui=n(94),Fi=n(1714),Hi=n(459),Ri=n(292),Ni=n(36),Bi=n(1704),ji=n(2078),Vi=n(2190),zi=n(435),Gi=n(1007),Ki=n(336),Wi=n(69),qi=n(6),Qi=new qi.e("selectedPromotedPhotos",{selectedPromotedPhotos:qi.t}),Yi=(Object.keys(ci.e).map(function(e){return ci.e[e]}),n(1154)),Ji=n(2399);Object(b.n)([{rawString:".mojBanner_a5fbcf2b{box-sizing:border-box;display:flex;justify-content:space-between;align-items:center;margin-top:2.5rem;margin-bottom:2.5rem;width:100%;padding:.8125rem 2rem .8125rem .5rem;border:.0625rem solid #edebe9;border-radius:.375rem}[dir=rtl] .mojBanner_a5fbcf2b{padding:.8125rem .5rem .8125rem 2rem}.mojBanner_a5fbcf2b .info_a5fbcf2b{display:flex;align-items:center}.mojBanner_a5fbcf2b .info_a5fbcf2b .image_a5fbcf2b{height:4.625rem}.mojBanner_a5fbcf2b .postButton_a5fbcf2b{border-radius:.25rem}.mojBanner_a5fbcf2b .postButton_a5fbcf2b .postButtonIcon_a5fbcf2b{color:#fff}.mojBanner_a5fbcf2b .postButton_a5fbcf2b .text_a5fbcf2b{font-weight:500;line-height:1.25rem}@media (max-width:63.9375rem){.mojBanner_a5fbcf2b{flex-direction:column;padding:1.375rem 0 3.875rem 0;gap:2.0625rem}[dir=rtl] .mojBanner_a5fbcf2b{padding:1.375rem 0 3.875rem 0}.mojBanner_a5fbcf2b .info_a5fbcf2b{flex-direction:column;gap:1.375rem}.mojBanner_a5fbcf2b .info_a5fbcf2b span{text-align:center}}"}]);var Xi=n(3782),Zi=function(e){var t=Object(d.useState)(!1),n=t[0],a=t[1],i=Object(ma.e)(),r=i.width,o=i.height;return Object(d.useEffect)(function(){a(!1);var e=new et.e,t=e.setTimeout(function(){var e=document.getElementsByClassName("AllPhotosTilesList")[0];e&&e.offsetHeight>o-200&&a(!0)},1e3);return function(){e.clearTimeout(t)}},[o,r]),n&&d.createElement("div",{className:"mojBanner_a5fbcf2b"},d.createElement("div",{className:"info_a5fbcf2b"},d.createElement("img",{src:window.require.toUrl("odsp-media/images/photostream/invitesuggestion.svg"),className:"image_a5fbcf2b"}),d.createElement("span",null,Xi.e)),d.createElement(da.e,{"aria-label":sa.c,className:"postButton_a5fbcf2b",onClick:function(){var t,n=e.viewParams,a=new Date;switch(a=n.startDate?new Date(n.startDate):new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0),e.photoType){case Ri.e.onThisDay:t="onthisday";break;case Ri.e.onThisMonth:t="onthismonth";break;case Ri.e.lastWeekPreviousYears:t="lastweekpreviousyears";break;default:t="onthisday"}var i=Ea(a,t);e.onPost(t,i,"banner")},iconProps:{className:"postButtonIcon_a5fbcf2b",iconName:"SingleColumnEdit"}},d.createElement("span",{className:"text_a5fbcf2b"},sa.c)))},$i=n(41),er=n(2768),tr=n(95),nr=n(1740),ar=n(1504),ir=!Si.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),rr=function(e){function t(t){var n=e.call(this,t)||this;if(n.openItemOverlayAction=function(e,t){if(n.props.openItemOverlay){var a=n._currentItemSet.peek().content.peek().items[t];new n.props.openItemOverlay({item:a,userInvokedItem:!0,sourceEngagement:"ImageTile.Click"}).execute(e).done()}},n._getGalleryPadding=function(){var e={paddingLeft:O,paddingRight:A};switch(n.props.photoType){case Ri.e.singleAlbum:e.paddingLeft=w,e.paddingRight=w;break;case Ri.e.singleTag:e.paddingLeft=E,e.paddingRight=E;break;case Ri.e.onThisMonth:case Ri.e.lastWeekPreviousYears:case Ri.e.onThisDay:if(n.props.photoType===Ri.e.onThisDay&&!n._isNewCarouselDesignEnabled)break;e.paddingLeft=Y,e.paddingRight=J}return e},n._logTelemetryFn=function(e,t){n._logTelemetry(e,t)},n._onBeforeUnload=function(e){n._computeAndLogTelemetryEndOfSession()},n.renderTileListParent=function(e,t){var a=n.shouldUseItemsScopeSelection()?e.selection:n.props.selection,i=n.shouldUseItemsScopeSelection()?e.selectionMode:n.props.selectionMode;return a?d.createElement(Fi.e,{selection:a,onShouldStartSelection:n._onShouldStartSelection,isDraggingConstrainedToRoot:!0},d.createElement(Bi.e,{selection:a,selectionMode:i,onItemInvoked:function(e,t,a){n.openItemOverlayAction(a,t)},enterModalOnTouch:!0,disableAutoSelectOnInputElements:!0},t)):d.createElement(d.Fragment,null)},n._onLocationHeaderClick=function(e){var t=y.n(n._navigation.viewParams),a=[e.country||e.countryOrRegion,e.state,e.city||e.locality||e.locationTag],i=a.join(g.e),r=t+"&locationFilter="+a.join(g.t),o=new Hi.e(r);o.id=i,o.isDropEnabled=!1,o.isPlaceholder=!0,o.properties={},o.type=Ui.e.Folder,o.tagInfo={tagType:ji.e.allPlaces},o.virtualItemType=zi.e.TagsRoot,o.queryType=Ni.e.AllMyPhotos,o.isRootFolder=!0,new kn.e(ji.e[ji.e.allPlaces]).item=fe.observable(o);var s=n._urlDataSource.getDefaultClickUrl(o,{urlType:"existing",itemSet:n._currentItemSet.peek()});n._navigation.navigateTo(s)},n.renderTileAnnotation=function(e,t){var a=n._currentItemSet.peek().content.peek().items[e.imageIndex];if(a&&"function"==typeof a){var i=a().video;if(i&&void 0===i.burstPhotoType)return d.createElement("span",{className:"Tile-playButton"},d.createElement(Ti.e,{iconName:"Play",className:"Tile-playButton"}))}return d.createElement(d.Fragment,null)},n.renderTile=function(e,t){var a=n.shouldUseItemsScopeSelection()?e.selection:n.props.selection;return d.createElement(wt.e,{role:"option",label:e.label,contentSize:e.contentSize,className:e.className,key:e.id,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,style:e.style,tileSize:e.tileSize,selection:a,selectionIndex:e.selectionIndex,id:e.id,"aria-label":e.ariaLabel,ariaLabel:e.ariaLabel,onKeyDown:e.onKeyDown,onFocus:e.onFocus,onBlur:e.onBlur,toggleSelectionAriaLabel:e.toggleSelectionAriaLabel})},n._renderFooter=function(){switch(n.props.photoType){case Ri.e.singleAlbum:if(n.props.footerProps)return d.createElement(Pi,{saveAutoAlbumAction:n.props.footerProps.saveAutoAlbumAction,discardAutoAlbumAction:n.props.footerProps.discardAutoAlbumAction});break;case Ri.e.onThisDay:case Ri.e.onThisMonth:case Ri.e.lastWeekPreviousYears:if(Object(ya.n)())return d.createElement(Zi,{onPost:n._onPostToPhotoStreamClick,photoType:n.props.photoType,viewParams:n._navigation.viewParams});break;default:return d.createElement(d.Fragment,null)}},n._galleryFailedToLoadWithNoData=function(e,t){n.photosCustomerPromiseHelper.endCustomerPromise(ka.GALLERY_FAILED_LOADED,_i.e.Failure,{error:"Gallery Failed With No data- ".concat(e," - ").concat(t)})},n._renderHeader=function(e,t){var a=void 0,i={},r={},o=void 0;return t>=0?(i=Object(c.__assign)(Object(c.__assign)({},n._getHeaderContainerStyle(t)),e),r=n._getHeaderTitleStyle(t)):i=e,Object(he.t)()||!Object(me.isFeatureEnabled)(me.PromotedPhotosContentEnabled)||n.props.photoType!==Ri.e.AllMyPhotos||n.props.isInFilePicker||(n.photosCustomerPromiseHelper.startCustomerPromise(La.PHOTOS_BOOT,ka.CAROUSEL_NOT_LOADED),a=d.createElement(Hn.e,{controlHandlers:Object(c.__assign)({},Qi.pack(function(e,t){return{selectedPromotedPhotos:n._getSelectedPromotedPhotos()}}))},d.createElement(Oi,{requestLoad:!0,resources:n.props.resources,height:280,headerStyle:i,logTelemetryFn:n._logTelemetryFn,currentItemKey:n.props.currentItemSetKey}))),Object(me.isFeatureEnabled)(me.EnableTagsInODC)&&n.props.photoType===Ri.e.singleTag&&(o=d.createElement(Sa.e,{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1})),d.createElement(d.Fragment,null,d.createElement(Ra,null),n._isNewCarouselDesignEnabled?null:d.createElement(Ua,null),d.createElement(Oa,{onPost:n._onPostToPhotoStreamClick}),d.createElement(Zn,{containerStyle:i,titleStyle:r}),o,a)},n._onPostToPhotoStreamClick=function(e,t,a){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(n){switch(n.label){case 0:return[4,this.props.resources.consumeAsync(Di.e)];case 1:return[2,n.sent().onPostToPhotoStreamClick(this.props.selection,e,t,a)]}})})},n._getHeaderContainerStyle=function(e){return n.props.photoType===Ri.e.AllMyPhotos&&n._isNewCarouselDesignEnabled?{marginLeft:ue[e],marginRight:ue[e],marginBottom:le[e],marginTop:de[e]}:n.props.photoType===Ri.e.singleTag?{marginLeft:P[e],marginRight:P[e],marginBottom:H[e],marginTop:F[e]}:{marginLeft:P[e],marginRight:P[e],marginBottom:M[e],marginTop:k[e]}},n._getHeaderTitleStyle=function(e){return n.props.photoType===Ri.e.singleTag?{fontSize:R[e],lineHeight:N[e]+"px"}:{fontSize:T[e],lineHeight:U[e]+"px"}},n.shouldUseItemsScopeSelection=function(){return!1},n.photosCustomerPromiseHelper=$i.e.consume(vi),n.photosCustomerPromiseHelper.startCustomerPromise(La.PHOTOS_BOOT,ka.GALLERY_FAILED_LOADED),n.props.itemCacheStore?n.itemCacheStore=n.props.itemCacheStore:(console.warn("ItemsscopeAllPhotos is building it's own cache store."),n.itemCacheStore=Object(_e.e)({})),!me.isODCLightspeedManifest){n.itemCacheStore.dispatch(Ji.e);var a=n.props.resources.consume(tr._),i=n.props.resources.consume(nr.resourceKey),r=n.props.resources.consume(m.Se);n.itemCacheStore.dispatch(Object(er.e)(a,i,r,void 0,n.props.resources)),n.props.currentItemSetKey&&n.itemCacheStore.dispatch(Object(Gi.e)(function(e){e.demandItemFacet(mn.e,n.props.currentItemSetKey)}))}return n._isNewCarouselDesignEnabled=n.itemCacheStore.dispatch(Object(ca.e)()),n.addPaddingBottom=n._exposeIfNeeded(S.e.addPaddingBottom,fe.observable(!1)),n.isScrollbarHidden=n._exposeIfNeeded(S.e.isScrollbarHidden,fe.observable(!0)),n._urlDataSource=n.props.resources.consume(m.ye),n._navigation=n.props.resources.consume(Wi.e),n._currentItemSet=n.props.resources.consume(f.o),n._viewParams=n.props.resources.consume(f.T),n._imageErrorThumbnailUrl=v.e(n.props.resources,"photo",96),n._videoErrorThumbnailUrl=v.e(n.props.resources,"video",96),n._events=new Na.e(n),n._engagement=n.props.resources.consume(Ki.e),n._logMoJTelemetryEvents(),n._telemetryFileCount=0,n._telemetryFileExtension={},n._telemetryFileAspectRatio={},n._telemetryCallbacks={genericEvent:function(e,t){if(n._logTelemetry(e,t),t.errorCount||t.urlsError){var a={extraCounts:t&&t.errorCount,urlsError:t&&t.urlsError},i=e+".GetThumbnail";Object(pe.logError)("GetThumbnail Unexpected Error",a,{eventName:i,resultCode:"GetThumbnail Error",resultType:_i.e.Failure})}t.errorCount>50?n.photosCustomerPromiseHelper.endCustomerPromise(ka.GALLERY_FAILED_LOADED,_i.e.Failure,{error:"More than 50 Thumbnails Failed to Load- ".concat(t.errorCount)}):n.photosCustomerPromiseHelper.endCustomerPromise(ka.GALLERY_FAILED_LOADED,_i.e.Success)}},n}return Object(c.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.props.itemInvalidator.invalidateCurrentItemSet(),this.addPaddingBottom(!1),this.isScrollbarHidden(!0),this._logTelemetry("AllPhotos.FirstLoadInitializeAllPhotosGallery",void 0)},t.prototype.componentDidMount=function(){this._events.on(window,"beforeunload",this._onBeforeUnload)},t.prototype.componentWillUnmount=function(){this._computeAndLogTelemetryEndOfSession(),this.addPaddingBottom(!0),this.isScrollbarHidden(!1),this._events.dispose()},t.prototype.componentDidUpdate=function(e){if(e.squareTiles!==this.props.squareTiles){var t=this.props.squareTiles?"od-grid-list":"od-river-list";this._logTelemetry("AllPhotos.ToggleListLayout",{toggleListLayout:t})}},t.prototype.render=function(){var e=this._getGalleryPadding(),t=!0,n=this._viewParams.peek(),a=this.props.photoType===Ri.e.onThisMonth||this.props.photoType===Ri.e.lastWeekPreviousYears||this.props.photoType===Ri.e.singlePlace&&this._isNewCarouselDesignEnabled||this.props.photoType===Ri.e.onThisDay&&this._isNewCarouselDesignEnabled;(Object(be.S)(n)||Object(be.D)(n)||Object(be.y)(n))&&n.sc&&(t=Object(Tn.n)(n)),t||this.photosCustomerPromiseHelper.endCustomerPromise(ka.GALLERY_FAILED_LOADED,_i.e.Failure,{error:"Gallery Failed With CID mismatch"});var i=this.props.isMobile?oe:L,r=a?X:e.paddingLeft,o=a?Z:e.paddingRight;return this.props.photoType===Ri.e.AllMyPhotos&&this._isNewCarouselDesignEnabled&&(r=se,o=ce),d.createElement("div",{className:"od-Photos"},t?d.createElement(Ln,{squareTiles:this.props.squareTiles,onRenderTileListParent:this.renderTileListParent,onRenderTile:this.renderTile,onRenderTileAnnotation:this.renderTileAnnotation,onRenderGalleryHeader:this._renderHeader,onRenderGalleryFooter:this._renderFooter,openItemOverlay:this.openItemOverlayAction,selection:this.shouldUseItemsScopeSelection()?void 0:this.props.selection,selectionMode:this.shouldUseItemsScopeSelection()?void 0:this.props.selectionMode,telemetryCallbacks:this._telemetryCallbacks,onLocationHeaderClick:this._onLocationHeaderClick,showDebug:!1,rowHeight_aspect:a?ie:I,midRowGroupGap_aspect:a?ne:x,imagePadding_aspect:a?ae:C,galleryPadding_aspect:r,galleryPaddingRight_aspect:o,maxRowScaleUpFactor:a?re:i,rowHeight_squaretiles:a?ie:B,midRowGroupGap_squaretiles:a?ne:j,imagePadding_squaretiles:a?ae:V,galleryPadding_squaretiles:a?X:z,galleryPaddingRight_squaretiles:a?Z:G,maxRowScaleUpFactor_squaretiles:K,groupHeaderMarginTop:a?$:W,groupHeaderMarginBottom:a?ee:q,groupHeaderLeadingMargin:a?te:Q,lookAheadRowsCount:5,maxParallelRequests:10,thumbnailResizingMode:"exact",thumbnailProgressiveMode:"one",screenResBreakPoints:D,enableScrubber:this.props.photoType===Ri.e.AllMyPhotos||this.props.photoType===Ri.e.singlePlace,enableDateStitching:!0,imageErrorThumbnail:this._imageErrorThumbnailUrl,videoErrorThumbnail:this._videoErrorThumbnailUrl,galleryFailedtoLoad_NoData:this._galleryFailedToLoadWithNoData}):d.createElement(Fn,{itemKey:this.props.currentItemSetKey?this.props.currentItemSetKey:void 0}))},t.prototype._computeAndLogTelemetryEndOfSession=function(){this._computeTelemetryForFiles(),this._logTelemetryEndOfSession()},t.prototype._computeTelemetryForFiles=function(){var e=this._currentItemSet.peek().content.peek().items;if(e){this._telemetryFileCount=e.length;for(var t={},n={},a=0;a<e.length;a++)if(e[a]&&e[a].peek()){var i=e[a]();if(i.extension){var r=(ir?Object(ar.e)(i.extension):i.extension).toLowerCase();t[r]=t[r]?t[r]+1:1}if(i.photo&&i.photo.height&&i.photo.width){var o=Math.floor(i.photo.width/i.photo.height*10)/10;n[o]=n[o]?n[o]+1:1}}this._telemetryFileExtension=t,this._telemetryFileAspectRatio=n}},t.prototype._logTelemetry=function(e,t){if(this._engagement){var n={name:Vi.t[this.props.photoType]+"."+e,extraData:t};this._engagement.logData(n),Object(Yi.n)(n)}},t.prototype._logTelemetryEndOfSession=function(){this._logTelemetry("AllPhotos.SessionEnd",{itemsScopeFileCount:this._telemetryFileCount,itemsScopeFileExtensionCounts:this._telemetryFileExtension,itemsScopeFileAspectRatioCounts:this._telemetryFileAspectRatio})},t.prototype._logMoJTelemetryEvents=function(){var e=this._navigation.viewParams;if(e.sc){var t=Object(he.e)(e.sc);this._logTelemetry("AllPhotos.CIDMismatch",{entryPoint:t,isMatch:Object(Tn.n)(this._navigation.viewParams)}),this._logTelemetry("AllPhotos.EntryPoint",{entryPoint:t});var n=this._navigation.viewParams,a=(n.sc,Object(c.__rest)(n,["sc"]));this._navigation.updateViewParams(a,{ignoreHistory:!0,clearOtherParams:!0})}},t.prototype._onShouldStartSelection=function(e){for(var t=e.target;t&&t!==document.body;){if(null!==t.getAttribute("data-selection-index"))return!1;t=t.parentElement}return!0},t.prototype._getSelectedPromotedPhotos=function(){var e=this;return Object.keys(ci.e).reduce(function(t,n){var a=ci.e[n];return e._isNewCarouselDesignEnabled&&a!==ci.e.OnThisDay&&a!==ci.e.PromotedPlaces&&a!==ci.e.OnThisMonth&&a!==ci.e.LastWeekPreviousYears||t.push(a),t},[])},t.prototype._exposeIfNeeded=function(e,t){return this.props.resources.isExposed(e)?this.props.resources.consume(e):this.props.resources.expose(e,t)},t}(d.PureComponent),or=n(363),sr=n(2029),cr=n(1984),dr=n(514),lr=n(1231),ur=n(2364),fr=n(1720),pr=n(106),mr=n(289),_r=function(e){function t(t,n){var a=e.call(this,t,n)||this;if(a.props.child){var i=a.context.dependencies.actionMap;a.openItemOverlay=a.props.child(i.DefaultClickAction)}return a.state={currentItemSetKey:a.context.dependencies.itemsScopeCurrentItemKey.peek()},a._controlHandlerProvider=Object(qa.n)({openAction:Va.e},{openAction:a.context.dependencies.openActionControlHandler}),a}return Object(c.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.context.dependencies,n=this._controlHandlerProvider,a=this.props.layoutType===h.s,i=t.currentItemsScope,r=d.createElement(rr,{itemCacheStore:t.itemCacheStore,openItemOverlay:this.openItemOverlay,selectionModel:t.selectionModel,resources:t.resources,identityDataSource:t.identityDataSource,vroomDataRequestor:t.vroomDataRequestor,squareTiles:a,selection:t.selection,selectionMode:t.selectionMode,currentItemSetKey:t.itemsScopeCurrentItemKey.peek(),itemInvalidator:t.itemInvalidator,isMobile:this.props.isMobile,photoType:this.props.photoType,footerProps:this.props.footerProps,isInFilePicker:this.props.isInFilePicker}),o=me.isODCLightspeedManifest&&!this.props.isInFilePicker?r:d.createElement(Qa.e,{qosName:"AllPhotosGallery.Load",onLoadItem:function(t){return function(t){var n=e.context.dependencies.resources.consume(or.e),a=e.context.dependencies.resources.consume(dr.e);a&&n.dispatch(Object(pr.s)(a,t))}}},r);return d.createElement(fr.e,null,d.createElement(n,null,!this.props.isInFilePicker&&d.createElement(gr,{currentItemSetKey:this.state.currentItemSetKey}),d.createElement(i,null,o)))},t.contextTypes=l.e,t}(d.PureComponent),hr=(t.default=_r,Object(u.e)("PhotosItemsScopeItemContent",_r,{itemCacheStore:or.e,currentItemsScope:cr.e.local,identityDataSource:m.D,vroomDataRequestor:_.e,actionMap:f.e,selection:p.a,selectionMode:p.i,selectionModel:f.C,resources:hi.r,urlDataSource:m.ye,itemsScopeItemKey:dr.e,itemInvalidator:lr.e,itemsScopeCurrentItemKey:ur.e,openActionControlHandler:Ga.e})),br=Object(sr.e)(hr,{automationName:"ms-items-scope-photos",name:"".concat("PhotosItemsScopeItemContent",".knockout")});function gr(e){var t=Object(yi.t)();return d.useEffect(function(){var e=mi.e.consume(mr.e);t(Object(pr.d)()).then(function(){e.pageLoaded("AllPhotos")})},[e.currentItemSetKey]),null}}}]);