(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[359,443],{2087:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(2697),i=n(2698),r=n(166),o=Object(r.t)({name:"CommandBar",template:a.e,automationName:"ms-command-bar-wrapper",viewModelType:i.e});t.default=o},2535:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(22),i=n(8),r=new i.t({name:"CurrentCommandSet.key",factory:new i.e(a.observable())})},2697:function(e,t,n){"use strict";t.e='<div data-bind="element:rootElement,keyboard:keyboardOptions,react:reactBindingParams"></div>'},2698:function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(509),o=n(792),s=n(1070),c=n(1068),d=n(570),l=n(609),u=n(317),f=n(12),p=n(11),m=Object(u.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(320).then(n.bind(null,3125))];case 1:return[2,e.sent().ReactCommandBar]}})})}),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._responsiveUI=n.responsiveUI,a.addBindingHandlers({react:d.t,element:s.e,keyboard:c.e,interactionScope:o.t});var i=a.observables.create(!0);a._reactCommandManager=a.scope.attach(new n.reactCommandManagerType({commandSet:t.commandSet,isActive:i})),a.rootElement=a.createObservable(),a.shouldBlockEscKey=a.createObservable(!1),a.keyboardOptions={target:Object(p.isFeatureEnabled)(p.shouldTargetWindow)?window:document,isActive:i,mappings:{},allowButtonEvents:!0,eventFilter:a._getEventFilter()},a._initializeKeyboardMappings();var r=a._getCommandBarProps();return a.reactBindingParams={componentType:m,props:r},a}return Object(a.__extends)(t,e),t.prototype._getCommandBarProps=function(){var e=this;return this.observables.pureCompute(function(){var t,n=e._reactCommandManager.commandBarItems(),i=n.items,r=n.farItems,o=i,s=n.overflowItems;if(o.length){var c=o[0];"Small"===e._responsiveUI.formFactorSize()?(s=Object(a.__spreadArray)(Object(a.__spreadArray)([],o.slice(1),!0),s,!0),o=[c]):o=Object(a.__spreadArray)([c],o.slice(1),!0)}if(s=s.map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{renderedInOverflow:!0})}),f.t.isActivated("264FA7B2-B9C5-11EB-8529-0242AC130003","5/20/2021","Suppress command callouts from inactive modals")||e.observables.unwrap(e.keyboardOptions.isActive))for(var d=0,l=s;d<l.length;d++){var u=l[d].data,p=u.payload;if(p&&p.control()&&u.isOpen()&&(!u.action||!u.action.isToggled())){t=u;break}}return{mainCommands:o,farCommands:r,overFlowCommands:s,payloadCommand:t,isActive:e.observables.unwrap(e.keyboardOptions.isActive),shouldBlockEscKey:e.shouldBlockEscKey}}).extend({deferred:!0})},t.prototype._initializeKeyboardMappings=function(){var e=this,t=this._reactCommandManager.allCommands,n=function(t){var n={};h(n,t),e.keyboardOptions.mappings=n};n(t.peek()),this.observables.subscribe(t,n)},t.prototype._getEventFilter=function(){var e=this;return function(t,n,a){var i;if("Left"===t||"Right"===t){var r=e.rootElement.peek();if(a&&r.contains(a.target))return!1}if(!Object(p.isFeatureEnabled)(p.shouldTargetWindow)&&!f.t.isActivated("b1e3b1a3-c4e6-4d4f-a40d-d456de338f8d","07/05/2021","fixing the escape key problem when commandbar is overflown")&&"Esc"===t&&e.shouldBlockEscKey.peek())return e.shouldBlockEscKey(!1),!1;for(var o=0,s=Array.from(document.querySelectorAll("[data-handle-special-keys]"));o<s.length;o++){var c=s[o];if(-1!==((null===(i=c.getAttribute("data-handle-special-keys"))||void 0===i?void 0:i.split(" "))||[]).indexOf(t)&&a&&c.contains(a.target))return!1}return!0}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.t.dependencies),{responsiveUI:r.t,reactCommandManagerType:l.t}),t}(i.t);function h(e,t){for(var n=function(t){if(t.keys)for(var n=function(e,n){t.onClick(t,n),n.preventDefault()},a=0,i=t.keys;a<i.length;a++){var r=i[a];e[r]||(e[r]=[]),e[r].push(n)}var o=t.children.peek();o.length&&h(e,o)},a=0,i=t;a<i.length;a++)n(i[a])}t.e=_},4335:function(e,t,n){"use strict";n.r(t),n.d(t,"KnockoutCommandBar",function(){return g});var a=n(1),i=n(50),r=n(8),o=n(149),s=n(401),c=n(2535),d=n(2087),l=n(166),u=n(40),f=n(317),p=n(56),m=new r.t({name:"".concat("HasItemSelection",".hasItemSelection"),factory:{dependencies:{observablesFactoryType:p.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.createCallback({defaultValue:!1,reducer:function(e,t){return e||t}}),disposable:t}}}}),_=n(180),h=!n(12).e.isActivated("7A83CDD7-903F-4652-BD3B-8B6F0CE40829","02/17/2022","Allow shimmed command bar to render in prior to the page load signal being sent"),b=new r.t({name:"".concat("KnockoutCommandBar",".knockoutScrollableContentBase"),factory:{dependencies:{knockoutResourceScope:o.e,commandSet:c.e},create:function(e){var t=e.commandSet;return{instance:function(e){var n=Object(u.n)(),r=a.useState(function(){return Object(l.a)(d.resourceKey,{commandSet:t})})[0],o=n.consume(m),c=Object(_.n)(o);return a.createElement("div",{className:Object(i.e)("od-TopBar-commandBar",{"od--hasSelection":c})},a.createElement(s.t,{specification:r,resources:n}))}}}}});function g(e){var t=Object(u.n)(),n=a.useState(function(){return Object(f.e)(function(){return h?t.consumeAsync(b.bypass):t.consumeAsync(b)})})[0];return a.createElement(n,null)}}}]);