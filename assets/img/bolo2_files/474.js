(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[474,272,324],Array(1563).concat([function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(1483),i=n(424),r=n(12);function o(e){return decodeURI(e)}function s(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=Object(a.e)(e,!0):(e=e.replace("#","%23"),r.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(a.e)(e,!0))),e}function c(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}}],Array(176),[function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(796),n(56)),r=n(1078),o=n(459),s=n(1071),c=n(60),d=n(25),l=n(61),u=n(1090),f=n(132),p=n(798),m=n(457),_=n(1818),h=n(1815),b=n(1795),g=n(1382),v=n(8),y=n(128),S=n(1763),D=n(210),I=n(1796),x=n(22),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b.e(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(1749),E=n(5),A=n(269),L=n(12),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.Hr)(E.vr))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return t.invalidateItem(e.parentKey),t.resources.consume(A.e)&&t.resources.consumeAsync(l.k).then(function(t){t.invalidateItems(e.parentKey)}),n})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b.e(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b.e(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.ie.optional,itemsStore:s.e,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},,,function(e,t,n){"use strict";n.d(t,"t",function(){return x}),n.d(t,"o",function(){return C}),n.d(t,"i",function(){return O}),n.d(t,"s",function(){return w}),n.d(t,"c",function(){return A}),n.d(t,"a",function(){return L}),n.d(t,"r",function(){return k}),n.d(t,"d",function(){return M}),n.d(t,"n",function(){return P}),n.d(t,"e",function(){return T});var a,i,r,o,s,c,d,l,u,f,p=n(0),m=n(802),_=n(2161),h=n(155),b=n(42),g=n(424),v=n(580),y=n(302),S=n(12),D=void 0,I={ODB:1469,ODC:"ChromiumDateFix"};function x(e){var t;return"undefined"!=typeof Intl&&Intl.DateTimeFormat?function(n){return t||(t=new Intl.DateTimeFormat(P(h.e.language),e)),t.format(n)}:function(t){return t.toLocaleDateString(P(h.e.language),e)}}function C(e,t){return void 0===t&&(t=!1),v.n(e,P(h.e.language),t)}function O(e,t,n,a,i,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!1);var o,s=Date.now()-e.getTime(),c=((o=new Date).setHours(0,0,0,0),o),d=R(c,-1),l=R(c,-6),u=i||{},f=u.displayMinutesToOneHour,p=void 0===f||f,b=u.displayHoursToOneDay,g=void 0===b||b,S=u.displayHoursInDates,D=void 0===S||S,I=u.displayShortenedWeekday,x=void 0===I||I,C=P(r||h.e.language);if(p&&s<-5*y.n)return e.toLocaleDateString(C,B({month:"short",day:"numeric"},a));if(s<y.o)return n?_.n:_.t;if(p&&s<y.t)return N(s,_.i,y.n);if(y.l(c,e))return g?N(s,_.a,y.t):v.t("Today",n);if(e>=d)return t||!D?v.t("Yesterday",n):v.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(C,B({hour:"numeric",minute:"2-digit"},a)));if(e>=l){var O=e.toLocaleDateString(C,B({weekday:"short"},a));return t?O:x||D?m.RelativeDateTime_DayAndTime.replace("{0}",O).replace("{1}",e.toLocaleTimeString(C,B({hour:"numeric",minute:"2-digit"},a))):e.toLocaleDateString(C,B({weekday:"long"},a))}return y.u(c,e)?C.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(C,B({month:"long",day:"numeric"},a)):e.toLocaleDateString(C,B({month:"short",day:"numeric"},a)):e.toLocaleDateString(C,B({month:"short",day:"numeric",year:"numeric"},a))}function w(e){return v.a(e,P(h.e.language))}function E(){var e=a(),t=U();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};r=new Intl.DateTimeFormat(e,n),o=new Intl.DateTimeFormat(e,i),t&&(n.timeZone="UTC",i.timeZone="UTC"),s=new Intl.DateTimeFormat(e,n),c=new Intl.DateTimeFormat(e,i),d=r.format,l=o.format,u=s.format,f=c.format}else d=u=function(t){return t.toLocaleDateString(e)},l=f=function(t){return t.toLocaleTimeString(e)}}function A(e,t){if(!e)return"";d||E();var n=y.l(new Date,e);return(t?n?f:u:n?l:d)(e)}function L(e,t){return e?(d||E(),(t?u:d)(e).replace(/[:\/\\]/g,"-")):""}function k(e,t){d||E();var n=t?u(e):d(e),a=t?f(e):l(e);return Object(b.format)(_.e,n,a)}function M(e,t){return y.p(e,P(h.e.language),t)}function P(e){if(void 0===D)try{D=g.e.isFeatureEnabled(I)}catch(e){D=!1}return D&&function(e){if(void 0===H&&function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=F;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}}(),e)return e=e.toLowerCase(),H[e]}(e)?"en":e}function T(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function U(){if(void 0===i)try{var e=a();(new Date).toLocaleDateString(e,{timeZone:"UTC"}),i=!0}catch(e){i=!1}return i}a=function(){for(var e,t=0,n=S.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,h.e.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,h.e.cultureLCID,h.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i),e=i;break}catch(e){}}return e=P(e),a=function(){return e},e};var F=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"],H=void 0;function R(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function N(e,t,n){var a=Math.round(e/n);return t.replace("{0}",String(a))}function B(e,t){return U()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},,function(e,t,n){"use strict";var a=n(795);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},,function(e,t,n){"use strict";n.d(t,"u",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"p",function(){return S});var a=n(8),i=n(1827),r=n(5),o=n(211),s=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:r.Nr?Object(r.Hr)(r.$i)||Object(r.Hr)(r.sr):Object(r.Hr)(r.dr)}}}}),c=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:r.Nr?Object(r.Hr)(r.$i):Object(r.Hr)(r.dr)}}}}),d=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.Hr)(r.at)}}}}),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.Hr)(r.nr)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!r.Nr&&Object(r.Hr)(r.sr)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:o.e},create:function(e){return{instance:Object(r.Hr)(r.Ki)&&(!e.platformDetection.isIE||Object(r.Hr)(r.Wi))&&(!e.platformDetection.isSafari||Object(r.Hr)(r.Yi))&&(!e.platformDetection.isMobile||Object(r.Hr)(r.Qi))}}}})),f=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.ir)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),p=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.or)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),m=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.rr)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),_=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.qi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),h=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.Ji)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),b=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.er)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),g=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.Hr)(r.Gi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),v=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(i.t)()&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),y=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:p},create:function(e){return{instance:Object(r.Hr)(r.Pr)&&e.isItemsScopeEnabledInSingleTagView}}}}),S=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:m},create:function(e){return{instance:Object(r.Hr)(r.Mr)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return h}),n.d(t,"i",function(){return _}),n.d(t,"t",function(){return b});var a={};n.r(a),n.d(a,"fileNotFound",function(){return o}),n.d(a,"invalidView",function(){return s}),n.d(a,"listNotFound",function(){return c}),n.d(a,"docAlreadyExists",function(){return d}),n.d(a,"queryThrottled",function(){return l}),n.d(a,"newExperieceRenderingNotSupported",function(){return u}),n.d(a,"onePageNavigationViewMismatch",function(){return f}),n.d(a,"onePageNavigationError",function(){return p}),n.d(a,"offline",function(){return m});var i,r,o=-2147024894,s=-2147024809,c=-1,d=-2130575257,l=-2147024860,u=-2,f=-3,p=-4,m=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={}));var _,h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(_||(_={}));var b=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(1076),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.t):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p){void 0===i&&(i="POST");var m=e(),_=a&&a(),h=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:_,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:h,authToken:f,webAbsoluteUrl:p})},e}();t.t=r},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(0),i=n(284),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},,,,,,,function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},,function(e,t,n){"use strict";n.d(t,"s",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return O}),n.d(t,"o",function(){return w}),n(795);var a,i,r,o,s,c=n(283),d=n(23),l=n(1745);n.d(t,"e",function(){return l.e}),n.d(t,"n",function(){return l.t}),n.d(t,"r",function(){return l.n}),n.d(t,"d",function(){return l.a}),n.d(t,"l",function(){return l.i}),n.d(t,"u",function(){return l.r});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project",g=((a={})[u]=d.OpenInWordOnline,a[f]=d.OpenInOneNoteOnline,a[p]=d.OpenInPowerPointOnline,a[m]=d.OpenInExcelOnline,a[_]=d.OpenInVisioOnline,a);function v(e){return g[e]||""}var y=((i={})[u]=d.OpenInWord,i[f]=d.OpenInOneNote,i[p]=d.OpenInPowerPoint,i[m]=d.OpenInExcel,i[_]=d.OpenInVisio,i[h]=d.OpenInPublisher,i[b]=d.OpenInProject,i["ms-infopath"]=d.OpenInInfoPath,i);function S(e){return y[e]}var D=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function I(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":D[e.appMap]||"Word"}function x(e){return D[e]}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page";var C=((s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s),O={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function w(e){var t=C[e];return t&&new c.e(t)}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(398),r=n(1756),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.a.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.__extends)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},,function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"o",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"s",function(){return y}),n.d(t,"c",function(){return S});var a=n(0),i=n(2),r=n(30),o=n(209),s=n(566),c=n(201),d=n(72),l=new r.e("photosConfigurationKeyFacet",{}),u=l.serialize({}),f=new i.e("PhotosAddonSource"),p=new i.e("photosEnableLastWeekPreviousYearsFacet"),m=new i.e("photosEnableNewDesignCarouselExpFacet"),_=new i.e("photosEnableGroupHeaderFacet"),h=new i.e("PhotosMaxPageSize"),b=new i.e("PhotosWidthsMaxPageSize"),g=new i.e("PhotosInitialBurstSize"),v=new i.e("usePhotoPaging"),y=new i.e("PhotosTargetHeight");function S(e){return function(t){var n,i,r;t(Object(o.t)({keyFacet:l,facets:[]}));var p=e.initialBurstSize||0,m=e.widthsPageSize||1e3,_=e.targetHeight||1e3;t(Object(o.e)({items:(n={},n[u]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f.pack(e.addonSource)),h.pack(e.pageSize)),g.pack(p)),b.pack(m)),y.pack(_)),n)})),t(Object(o.e)({items:(i={},i[c.e]=Object(a.__assign)({},d.r.pack({reportRUMOnePerfData:!1,logRenderEndTime:e.logRumOneData,scenarioId:"ODC.AllPhotos-Photos"})),i)})),t(Object(s.t)({items:(r={},r[u]={},r)}))}}},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"UserPhotoSize",function(){return o}),n.d(t,"tryGetAlternativeUrl",function(){return f}),n.d(t,"isAlterantiveUrlFresh",function(){return p}),n.d(t,"updateMap",function(){return m}),n.d(t,"getUrlTable",function(){return _}),n.d(t,"getUserPhotoUrl",function(){return h}),n.d(t,"_testGetCDNUrlExpiryFromCache",function(){return b});var a=n(76),i=n(131),r=n(52),o={Small:1,Medium:2,Large:3},s="_oat_",c="UserPhotoAspx",d={},l={},u="TryGetAlternativeUrlFailure";function f(e){var t,n;function a(e){return p(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var o=d&&d[e];if(o||c!==e||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?o=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(o=a("_spHomePageContext"))),!o)return;return p(o)?o:void delete d[e]}catch(e){new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"Unexpected",extraData:{error:e}})}}function p(e){if(-1===e.indexOf(s))return!0;var t=l[e];if(t)return Date.now()/1e3<t;var n=new a.t(e),o=n.getQueryParameter(s);if(o){var c=o.split("_");if(2===c.length&&(t=Number(c[0])),!t)return new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:o}}),l[e]=Date.now()/1e3+86400,!0;if(t-=30,l[e]=t,Date.now()/1e3>t)return!1}var d=n.getQueryParameter("P1");if(!d)return!0;var f=Number(d);return f-=30,l[e]=Math.min(f,l[e]),!(Date.now()/1e3>f)}function m(e){if(e)for(var t in e)d[t]=e[t]}function _(){return d}function h(e,t,n){var i;switch(n=n||f(c)||"/_layouts/15/userphoto.aspx",t){case o.Medium:i="M";break;case o.Large:i="L";break;default:i="S"}var r=new a.t(n);return r.setQueryParameter("size",i),r.setQueryParameter("accountname",e||""),r.toString()}function b(e){return l[e]}},,,,,,,,,,,,,function(e,t,n){"use strict";function a(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(56),i=new(n(8).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return J}),n.d(t,"n",function(){return X});var a,i,r=n(0),o=n(94),s=n(29),c=n(36),d=n(460),l=n(435),u=n(253),f=n(2042),p=n(11),m=n(116),_=n(42),h=n(284),b=n(1955),g=n(1765),v=n(262),y=n(1956),S=n(395),D=n(120),I=n(8),x=n(128),C=n(101),O=n(69),w=n(365),E=n(10),A=n(581),L=n(35),k=n(437),M=n(689),P=n(991),T=n(690),U=n(90),F=n(148),H=n(338),R=n(269),N=n(12),B=n(1125),j=window.$Config&&window.$Config.isINT,V=window.FilesConfig&&window.FilesConfig.skyApiDomain,z=window.FilesConfig&&window.FilesConfig.storageDomain,G=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(i||(i={}));var K=N.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),W=!N.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive),q=new I.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new I.e(Object(p.isFeatureEnabled)(p.UseOneUpTextEditor))}),Q=new I.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new I.e(!K)}),Y=new I.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new I.e(W)}),J=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(O.e):a,r=t.useOneUpTextEditor,o=void 0===r?this.resources.consume(q):r,s=t.enableFastOneUp,c=void 0===s?this.resources.consume(Y):s,d=t.useRefactoredDefaultClickUrl,l=void 0===d?this.resources.consume(Q):d;this._navigation=i,this._useOneUpTextEditor=o,this._enableFastOneUp=c,this._useRefactoredDefaultClickUrl=l,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?E.s:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new C.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(E.v)(e)},e.getKeyParams=function(e){return Object(E.y)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(E.m)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+m.n({resid:e})},e.encodeSharingUrl=function(e){return Object(L.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,_.format(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,m.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(L.l)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return D.t.signInUrl+"&"+m.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(M.e)()},e.areCidsEqual=function(e,t){return Object(A.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(E.y)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(r,null,!0),s=((i={}).lru=o,i);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(E._)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.E)(e)},e.prototype.getPhotoType=function(e){return Object(E.w)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(E.C)(e,this._mayBeFastOneUp||t)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.f)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.o)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=c.e.Files),Object(E.L)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(L.O)(e):e===c.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!N.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(E.N)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(E.n)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.H)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case c.e.Files:return this.isCurrentQueryFiles();case c.e.Recent:return this.isCurrentQueryRecent();case c.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case c.e.SharedByMe:return this.isCurrentQuerySharedByMe();case c.e.RecycleBin:return this.isCurrentQueryRecycleBin();case c.e.Photos:case c.e.AllMyPhotos:return Object(E.T)(t);case c.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===c.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:s.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(E.z)&&!Object(p.isFeatureEnabled)(p.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:s.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:s.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(r.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:s.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(r.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:s.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,i=Object(r.__assign)({},this._navigation.viewParams);return delete i.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:s.e.PhotoStream,viewParams:i}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:s.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:s.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:s.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:s.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:s.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:s.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:s.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(R.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:s.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(p.isFeatureEnabled)(p.EnableVroomDocFormatSettings)&&Object(U.e)(E.z)){var t=((e={}).v="documentoptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e;if(Object(H.o)()){var t=((e={}).v="NotificationOptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+m.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(E.x)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+m.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+m.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(T.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(T.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=D.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+m.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+m.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+m.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+m.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,r=e.dateFilter,o=e.conversationId,s=e.largestSize,c=e.filter;c||(c=Object(E.T)(this._navigation.viewParams)?b.t.photos:b.t.all);var d=((n={}).qt="search",n.q=a,n.searchsessionid=o,n.ft=E.e[b.t[c]],n);if("number"==typeof r&&r!==b.e.anyDate){var l=new Date,u=this._getDateDuration(r,l);d.df=i[i.DateCreated],d.beginDate=u.toISOString(),d.endDate=l.toISOString()}return s&&(d.sp="size"),this.getItemUrl(this.getKey(d),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(E.e[b.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:b.t[String(E.e[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.r)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(S.e.folder),16==(16&n)&&t.push(S.e.document),8==(8&n)&&t.push(S.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(E.V)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(L.a)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=m.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+m.n(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+m.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=D.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+m.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){void 0===n&&(n=this._navigation.viewParams);var a={cid:e,resid:t,iam:this.getIAmParamValue(n)};return"/versions.aspx?"+m.n(a,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=Object(g.a)(e),l=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+l+m.n({app:d,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r;if(void 0===t&&(t=this._navigation.viewParams),!N.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(e.ownerId)){var o=null!==(i=null===(a=e.properties)||void 0===a?void 0:a.path)&&void 0!==i?i:null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return Object(B.t)(e.appMap,o,e.extension,!0,!1)}var s=this.getAuthKeyParamValue(t),c=this.getIAmParamValue(t),d={cid:n,resid:e.id,authKey:s,iam:c,autoRedirect:"false"};return this.getCurrentPageBaseUrl()+"/openinclient?"+m.n(d,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+m.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=_.format(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+m.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,i;return this.getItemUrl(this.getKey(Object(r.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((i={}).groupId=n,i):{})))},e.prototype.getExternalUrl=function(t){var n=f.e[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?_.format(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+h.e.encodeURIComponent(n):_.format(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+h.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,i,s;void 0===t&&(t={});var c,d=t.viewParams,l=void 0===d?this._navigation.viewParams:d,f=t.itemSet,p=t.urlType,_=void 0===p?"default":p,h=t.preserveAction,b=void 0!==h&&h,g=t.action,v=void 0===g?b&&this.getAutoActionType(l)||void 0:g;if(!e||!e.key)return"";if(l.sb&&(!this.isCurrentQuery(e.queryType,l)||(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(n={},n.sb=l.sb,n.sd=l.sd,n)))}))),l.mcid&&this.getKeyParams(e.key).cid===(l.cid||l.parCid)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(a={},a.mcid=l.mcid,a.mid=l.mid,a)))})),this._useRefactoredDefaultClickUrl){var y=null===(s=null===(i=null==e?void 0:e.properties)||void 0===i?void 0:i.commandsSupported)||void 0===s?void 0:s.defc,S=f&&f.item.peek(),D=S&&S.key!==e.key&&S||e.UNSAFE_parent,I=D&&D.key,x=void 0;y&&(x="1"===y);var C={itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:x},parentItemInfo:D&&{itemKey:I,itemIsAlbum:D.isAlbum,itemIsPlaceholder:D.isPlaceholder,itemIsStub:D.isStub,itemVirtualItemType:D.virtualItemType,itemExtension:D.extension,itemType:D.type,itemOpenUrl:D.openUrl,itemErrorType:D.error&&D.error.type},preserveAction:b,action:v,viewParams:l,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:_};return Object(P.t)(C)}var O=this._getDefaultUrlFormat(e),w=!!N.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==o.e.Media;return l.mid&&w&&(O=P.e.current),c=e.type===o.e.Error?P.e.external:"existing"===_?this._getCurrentUrlFormat(l):"focus"===_||v?v&&v!==u.t.locate&&O===P.e.current?O:P.e.focus:O,this._getItemClickUrl(e,f,c,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:s.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.i)(e);var t=D.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",_.format(t,h.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(E.S)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(E.D)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.P)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.A)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,i=t.item;return Object(E.g)(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:e,itemInfo:i&&{itemKey:i.key,itemIsPlaceholder:i.isPlaceholder,itemVirtualItemType:i.virtualItemType,itemExtension:i.extension,itemType:i.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(F.e)(o,s):delete o.sc,"#"+m.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+m.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return b.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=b.e.oneDay;break;case 30:t=b.e.oneMonth;break;case 7:t=b.e.oneWeek;break;case 365:t=b.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(j?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(E.B)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||D.t.si;if(!n)return"";var a=v.t(n),i=m.e(a),r=i.wreply,o=v.t(r),s=m.e(o);return s.action=u.t[e],i.wreply="".concat(v.n(r),"?").concat(m.n(s)),"".concat(v.n(n),"?").concat(m.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return m.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.a)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(L.i)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Object(P.a)({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:s.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,o=this.getKeyParams(r&&r.key||"");i.parId=o.id;var c=m.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(G,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,i=n.page,o=n.action,s=n.preserveAction,f=void 0!==s&&s,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(r.__assign)({},_),b=this._getPreservedViewParams(m);void 0!==i&&(b.v=this._getPageParamValue(i,m));var g=!1,v=Object(w.a)(a);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===c.e.Search||y===c.e.AllMyPhotos||y===c.e.PhotoStream||(h.v=""),v||!Object(d.e)(y)||"photos"===b.v&&"photoStream"===b.v&&this.getContextualFilter(_)===E.e.photos.toString()||(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(F.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case b.e.oneDay:n.setDate(n.getDate()-1);break;case b.e.oneMonth:n.setDate(n.getDate()-30);break;case b.e.oneWeek:n.setDate(n.getDate()-7);break;case b.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?P.e.focus:P.e.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case o.e.Media:t=P.e.focus;break;case o.e.Folder:case o.e.Error:t=P.e.current;break;default:t=P.e.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,o=a.page,c=void 0===o?this.getPageType(r):o;if(n!==P.e.current&&c===s.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(w.a)(e))n=this._useOneUpTextEditor&&c!==s.e.TextFileEditor?P.e.focus:P.e.external;else if(c===s.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+m.n(r,null,!0);switch(n){case P.e.current:d=this._getCurrentItemUrl(e,a);break;case P.e.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var _=p.action;return _?d&&d.commentId&&"showproperties"===_.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=_):f.o=e.oneUpOverlayValue,l&&Object(F.e)(f,l),"#"+m.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case s.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case s.e.TextFileEditor:n="TextFileEditor";break;case s.e.Photos:n="photos";break;case s.e.RansomwareDetection:n="RansomwareDetection";default:case s.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||0){case 3:return this.getMarketBlockedUrl();case 5:return this.qualifyUrl(this.getItemUrl(t.key));case 2:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case 1:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case 4:var r=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return D.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case 6:return this.getValidatePermissionUrl();case 9:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,r=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,r);if(e.type===o.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(w.a)(e))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,r,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,r,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(E.c)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(E.d)():window.location.pathname},e.prototype._getPreservedViewParams=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t);for(var a in e)0===a.indexOf("EXPExperimentTest_e")&&(n[a]=e[a]);var i=e["WT.mc_id"],r=e.ocid;return i&&(n["WT.mc_id"]=i,n.ocid=r||i),n},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(E.j)(e,t):t||D.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:O.e,useOneUpTextEditor:q,useRefactoredDefaultClickUrl:Q,enableFastOneUp:Y},e.oneUpOverlayValue=k.i,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=V+"/API/2/",e.viewerId=E.z,e.storageBaseUrl=z,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=k.a,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((a={}).photo=y.i,a.list=y.a,a.grid=y.n,a),e.placeholderId=0,e}();t.t=J;var X=Object(x.r)("UrlDataSource",J)},,,,,,,,,,,function(e,t,n){"use strict";var a=n(1907);n.d(t,"e",function(){return a.e})},,,,,function(e,t,n){"use strict";var a=n(1832),i=n(22),r=n(248);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s});var a=n(2),i=new a.e("allGroupToCountsFacet"),r=new a.e("allGroupToCountsPointerFacet"),o=new a.e("AllPhotosTotalCount"),s=new a.e("allGroupToStartFacet")},,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(85).e);t.e=i},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(143),i=n(1833),r=n(1834),o=n(11),s=n(16),c=n(69);function d(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(s.r,s.a)})),n=null==t?void 0:t.consume(c.e);return(null==n?void 0:n.viewParams)||{}}}function l(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}}},,,,,function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(30).e)("photosExperimentHelperKeyFacet",{}).serialize({})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("photosExperimentHelper")}],Array(29),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(137),r=new a.e("allGroupToCountsItemKeyFacet",{photosRootItemSetKeyPart:i.e.subKeyPart})}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isNewAlbum")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("dateRange")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(14),r=n(137),o=new a.e("allPhotosGroup",{photosRootItemSetKeyPart:r.e.subKeyPart,id:i.e})}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(8),i=n(128),r=n(1119),o=n(2011),s=n(1083),c=n(1933),d=n(60),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u="VroomDataRequestor",f=new a.t({name:"".concat(u,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),p=Object(i.r)(u,s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:f})}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a,i=n(372),r=n(1782);function o(e,t){var n;switch(e.size){case a.Large:n=r.UserPhotoSize.Large;break;case a.Medium:n=r.UserPhotoSize.Medium;break;default:n=r.UserPhotoSize.Small}return Object(r.getUserPhotoUrl)(e.userLoginName,n,t)}function s(e,t,n){var a=Object(r.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(8),i=n(1092),r=n(1122),o=n(1120),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={unsupportedCommand:"unsupportedCommand",handlerError:"handlerError",handlerRejection:"handlerRejection",acknowledgeTimeout:"acknowledgeTimeout",resultTimeout:"resultTimeout",setupTimeout:"setupTimeout",canceled:"canceled",disposed:"disposed"}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(1890),o=new a.e("allPhotoGroupPage",{groupKeyPart:r.e.subKeyPart,offset:i.e,count:i.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(137),o=new a.e("photoPageKey",{photosRootItemSetKeyPart:r.e.subKeyPart,offset:i.e,count:i.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(91),i=n(591);function r(e){return function(t){var n=t(i.e);a.e.withManager(n).logData(e)}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(236),i=n(93),r=n(288),o=n(1934),s=0,c=function(){function e(e,t){void 0===t&&(t={});var n=this,s=new Map,c={onCommand:e.onCommand,onNotification:e.onNotification},d=e.initResources,l=e.initTimeoutMs,u=void 0===l?1e4:l,f=e.ackTimeoutMs,p=void 0===f?1e3:f,m=e.resultTimeoutMs,_=void 0===m?1e4:m,h=t.asyncType,b=void 0===h?a.e:h,g=t.eventGroupType,v=void 0===g?i.e:g,y=this._scope=new r.e;y.attach(d);var S,D=this._async=y.attach(new b(this)),I=y.attach(new v(this));this._ackTimeoutMs=p,this._resultTimeoutMs=_,this._invokeCommandHandler=function(e){try{var t=c.onCommand&&c.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:o.e.handlerRejection,isExpected:!1,message:"Unknown error"}).code||e.name||o.e.handlerRejection,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:o.e.unsupportedCommand,message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.handlerError,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{c.onNotification&&c.onNotification(e)}catch(e){}};var x=this._port=new Promise(function(t,a){y.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=o.e.canceled,a(e)}}),S=D.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(u,"ms"));e.code=o.e.setupTimeout,a(e)},u),e.init(function(e){D.clearTimeout(S),y.attach({dispose:function(){e.close()}}),I.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=x.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=s}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:o.e.canceled,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:o.e.disposed,message:"disposed"}});var a=++s,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,c=t.acknowledgeTimeoutMs,l=void 0===c?this._ackTimeoutMs:c;return this._port.then(function(t){var i=n._async,s=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.acknowledgeTimeout))},l),resultTimeout:i.setTimeout(function(){n._onResult(d(a,o.e.resultTimeout))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e}),s})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function d(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}},,,,,,,,function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s});var a="List",i="CompactList",r="Grid",o="Album",s="AllPhotos"},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=new a.e("widthsFacet"),r=new a.e("widthsPointerFacet"),o=new a.e("targetHeightFacet")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notStarted=0]="notStarted",e[e.NotStarted=0]="NotStarted",e[e.inProgress=1]="inProgress",e[e.InProgress=1]="InProgress",e[e.completed=2]="completed",e[e.Completed=2]="Completed",e[e.cancelled=3]="cancelled",e[e.Cancelled=3]="Cancelled",e[e.failed=4]="failed",e[e.Failed=4]="Failed",e[e.unknown=5]="unknown",e[e.Unknown=5]="Unknown"}(a||(a={}))},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(93),i=n(1947),r=n(288);function o(e,t){void 0===t&&(t={});var n=e.channelId,o=e.onReinitialize,s=e.origin,c=e.receiver,d=void 0===c?window:c,l=e.source,u=e.identifyParent,f=t.eventGroupType,p=void 0===f?a.e:f,m=t.messengerType,_=void 0===m?i.e:m,h=new r.e,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var a;if(u&&l){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};l.postMessage(e,s)},100);a=h.attach({dispose:function(){clearInterval(i)}})}var r=!1;b.on(d,"message",function(t){var i=t.data;if(t.origin===s&&(!l||t.source===l)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){if(a&&a.dispose(),o){if(r)return o(),void b.dispose();r=!0}else b.dispose();var c=i.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(366),r=new(n(8).t)("MicroServiceDataSource.key"),o=n(60),s=n(1101),c=n(128),d=n(85),l=n(88);!function(e){e.unauthUser="unauthUser"}(a||(a={}));var u=n(396),f={ODB:n(1121).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===i.e.aad){if(t&&p){var r=new l.e(t).authority;return this._identityDataSource.getSharePointToken(r)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return o.n.resolve()})}else if(n===i.e.msa)return this._identityDataSource.getSessionToken();return o.n.reject(new d.e({code:a.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:s.e,microServiceDataSource:r.optional},e}(),_=Object(c.r)("SessionManagementProvider",m)}],Array(21),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("requestResponseBatchType")},,,,,,,,,function(e,t,n){"use strict";var a;!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={})),t.e=a},function(e,t,n){"use strict";function a(e,t){return{id:e.id||e.labels.join(",")+t.toString(),labels:e.labels,count:e.count,headers:r(e)}}function i(e){return e.labels}function r(e){if(e.headers)return e.headers;var t=i(e);return e.header?[e.header,t[1],t[2]]:t}n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r})},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"n",function(){return f});var a=n(2043),i=n(2365),r=n(2587),o=n(346),s=n(2257);function c(e,t,n,a,c){var d,l=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),u=!1;if("onthismonth"===n&&a){var f=JSON.parse(a).applyUtilityFiltering;u=!f||f&&!0===c}return d="lastweekpreviousyears"===n||"onthisday"===n&&(s.t||o.n.isFeatureEnabled(s.e))?function(e,t){var n=(new Date).getFullYear(),a=t.getFullYear(),i=n-a,o=a.toString(),s=a.toString();switch(i){case 1:s=o=r.n;break;case 2:s=o=r.a;break;case 3:s=o=r.i;break;case 4:s=o=r.r;break;case 5:s=o=r.o}return{labels:[s,s,s],count:e,headers:[o,o,o]}}(t,l):"onthismonth"===n&&u?function(e,t){var n=t.toLocaleDateString("default",{month:"short",day:"numeric"});return{labels:[n,n,n],count:e,headers:[n,n,n]}}(t,l):{labels:[Object(i.n)(l),Object(i.a)(l),e.getUTCFullYear().toString()],count:t,headers:[Object(i.i)(l),Object(i.t)(l),e.getUTCFullYear().toString()]},d}function d(e,t,n,i,r){var o=c(e,t,i,r);return Object(a.e)(o,n)}function l(e,t,n,a){for(var i=[],r=void 0,o=void 0,s=0,c=0;c<e.length;c++){var l=void 0;l=e[c].dateTakenTime?e[c].dateTakenTime:0===c?new Date:e[c-1].dateTakenTime,r=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())),void 0===o&&(o=r),r.getUTCFullYear()===o.getUTCFullYear()&&r.getUTCMonth()===o.getUTCMonth()&&r.getUTCDate()===o.getUTCDate()||(i.push(d(o,s,i.length,t,n)),s=0,o=r),s++}return s>0&&r&&i.push(d(r,s,i.length,t,n)),"lastweekpreviousyears"===t&&f(i),"onthismonth"===t&&n&&JSON.parse(n).applyUtilityFiltering&&!a&&u(i,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),i}function u(e,t,n,a){for(var i=0,r=0;r<e.length;r++)i+=e[r].count;e[0]={header:t,headers:n,labels:a,count:i},e.splice(1,e.length-1)}function f(e){for(var t,n,a=0;a<e.length-1;a++)(null===(t=e[a].headers)||void 0===t?void 0:t[0])===(null===(n=e[a+1].headers)||void 0===n?void 0:n[0])&&(e[a].count+=e[a+1].count,e.splice(a+1,1),a--)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("nextItem")}],Array(24),[function(e,t,n){"use strict";var a;!function(e){e[e.allTags=0]="allTags",e[e.allPlaces=1]="allPlaces",e[e.singleTag=2]="singleTag",e[e.singlePlace=3]="singlePlace"}(a||(a={})),t.e=a}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(30),i=n(14),r=new a.e("recentPlacesKey",{driveId:i.e,endpoint:i.e})},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return D});var a=n(0),i=n(56),r=n(61),o=n(60),s=n(1078),c=n(1740),d=n(95),l=n(132),u=n(798),f=n(457),p=n(1763),m=n(1970),_=n(1963),h=n(1877),b=n(128),g=n(2110),v=n(1087),y=n(1747),S=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._albumDataSource=n.albumDataSource,a._operationProvider=n.operationProvider,a._itemProvider=n.itemProvider,a._urlDataSource=n.urlDataSource,a._tagProvider=n.tagProvider,a._isSingleAlbumItemsScopeEnabled=a.resources.consume(y.c),a}return Object(a.__extends)(t,e),t.prototype.addToAlbum=function(e){for(var t=this,n=new u.e,a=this.observables.createArray(e.items).map(function(a){var i=t._operationProvider.register({name:a.name,type:f.e.addItemsToAlbum,payloads:{addItemsToAlbum:{item:a,album:e.album}},iconName:a.iconName,batch:n});return i.progress.maximum(1),i.progress.current(0),i}),i=0,r=a();i<r.length;i++)r[i].state(l.e.started);return this._albumDataSource.addToAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){t._isSingleAlbumItemsScopeEnabled||(t._itemProvider.invalidateItem(e.album.key),t._itemProvider.invalidateItem(t.getAlbumsParentKey()));for(var i=0,r=a();i<r.length;i++){var o=r[i];o.progress.current(1),o.state(l.e.completed)}return n},function(e){for(var t=0,n=a();t<n.length;t++)n[t].state(l.e.failed);return o.n.wrapError(e)})},t.prototype.createAlbum=function(e,t){var n=this,a=[new p.e("createAlbum="+e.name,e.name)],i=e.keys;return this._albumDataSource.createAlbum(e.name,i).then(function(e){return n._getNewlyCreatedAlbum(e.id)}).then(function(e){a=e?a.map(function(t){return t.succeed(e)}):a.map(function(e){return e.fail(h.i)}),t.update(a)},function(e){return a=a.map(function(t){return t.fail(e.error)}),t.update(a),o.n.wrapError(e)})},t.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],n=0;n<e.length;n++)e[n].photo&&!e[n].video&&t.push(e[n].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)},t.prototype.removeFromAlbum=function(e){var t=this;return this._albumDataSource.removeFromAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){return t._itemProvider.invalidateItem(t.getAlbumsParentKey()),t._itemProvider.invalidateItem(e.album.key),n},function(e){return o.n.wrapError(e)})},t.prototype.createAlbumFromFolder=function(e,n){for(var a=this,i=[new p.e("createAlbumFromFolder="+e.folder.id,e.folder.name)],r=0,s=i;r<s.length;r++)s[r].status=0;return n.update(i),this._albumDataSource.createAlbumFromFolder(e).then(function(e){return a._getNewlyCreatedAlbum(e.id)}).then(function(e){if(!e){var r=h.i;return i=i.map(function(e){return e.fail(r)}),n.update(i),o.n.wrapError(r)}var s=null,c=function(){var r={type:m.e.albumFolderExtraction};s&&(r.workItemIds=s),a._itemProvider.getWorkProgress(r).done(function(r){var o;if(r.progress&&r.progress.length&&(o=r.progress[0]),!o||o.status===_.e[_.e.Completed])return i=i.map(function(t){return t.succeed(e)}),void n.update(i);s||(s=[o.id]),a.async.setTimeout(c,t.ASYNC_DELAY)},function(e){i=i.map(function(e){return e.fail(h.i)}),n.update(i)})};a.async.setTimeout(c,t.ASYNC_DELAY)},function(e){var t=h.i,a=new Error(t);return i=i.map(function(e){return e.fail(a)}),n.update(i),o.n.wrapError(a)})},t.prototype.getAlbumsParentKey=function(e){return void 0===e&&(e={}),this._albumDataSource.getAlbumsParentKey(e)},t.prototype.setCoverPhoto=function(e,t){var n=this,a=this.getAlbumsParentKey(),i=[new p.e(a+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(r){n._itemProvider.invalidateItem(a),n._itemProvider.invalidateItem(e.album.key),i=i.map(function(e){return e.succeed(r.id)}),t.update(i)},function(e){var n=new Error(e);return i=i.map(function(e){return e.fail(n)}),t.update(i),o.n.wrapError(n)})},t.prototype.saveAutoAlbum=function(e,t,n){var a=this,i=e.album,r=i.properties.newTag,s=new p.e(i.key,i);return v.r(i)?(n.update([s]),this._tagProvider.updateTags({items:[i],tagsToDelete:[r],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){s=s.succeed(),n.update([s]),a._itemProvider.invalidateItem(a.getAlbumsParentKey({tagFilter:g.n})),a._itemProvider.invalidateItem(a.getAlbumsParentKey()),a._itemProvider.invalidateItem(i.key)},function(e){var t=new Error(e);return s=s.fail(),n.update([s]),o.n.wrapError(t)})):(s=s.fail(),n.update([s]),o.n.wrap(void 0))},t.prototype.markAutoAlbumAsSeen=function(e,t){var n=e.properties.newTag,a=e.properties.autoAlbumTag;return n&&a?this._tagProvider.updateTags({items:[e],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){return e&&!e.error},function(e){return!1}):o.n.wrap(!1)},t.prototype.convertToAutoAlbum=function(e,t,n){var a=this,i=e.properties.newTag,r=e.properties.autoAlbumTag,s=new p.e(e.key,e);return i?(s=s.fail(),n.update([s]),o.n.wrap(void 0)):(i={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"},r||(r={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"}),this._tagProvider.updateTags({items:[e],tagsToDelete:null,tagsToAdd:[r,i],rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(t){s=s.succeed(),n.update([s]),a._itemProvider.invalidateItem(a.getAlbumsParentKey({tagFilter:g.n})),a._itemProvider.invalidateItem(a.getAlbumsParentKey()),a._itemProvider.invalidateItem(e.key)},function(e){var t=new Error(e);return s=s.fail(),n.update([s]),o.n.wrapError(t)}))},t.prototype._getNewlyCreatedAlbum=function(e){var t=this.getAlbumsParentKey();this._itemProvider.invalidateItem(t);var n={parentKey:t,ownerId:this._urlDataSource.getOwnerId(t),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(n).then(function(t){for(var n=t.content.peek().items,a=n.length,i=0;i<a;i++){var r=n[i].peek();if(r.id===e)return r}})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:s.resourceKey,itemProvider:c.resourceKey,albumDataSource:r.e,urlDataSource:r.ye,tagProvider:d.E}),t.ASYNC_DELAY=5e3,t.ASYNC_RETRY_LIMIT=5,t.ASYNC_RETRY_DELAY=15e3,t}(i.n);t.default=S;var D=Object(b.r)("AlbumProvider",S)},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"t",function(){return h});var a=n(0),i=n(56),r=n(60),o=n(390),s=n(462),c=n(1799),d=n(2670),l=n(116),u=n(1100),f=n(2586),p="__New",m="__Auto",_="__WeekendRecap",h="__EventRecap",b=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(o.n),n}return Object(a.__extends)(t,e),t.prototype.addToAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.removeFromAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.createAlbum=function(e,n){var a=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),c={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new s.e).send({requestType:"POST",postData:JSON.stringify(c),apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(c.action),url:this._getModifyAlbumUrl(),isErrorExpectedCallback:f.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var s={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return a._handleRequest(o,s).then(function(t){return e},function(e){var t={errorType:u.e.other,error:new Error(e.data.message)};return r.n.wrapError(t)})},function(e){var t=u.e.other;1e3===e.data.code&&(t=u.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return r.n.wrapError(n)})},t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new s.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))},t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),a=new s.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return a.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(i.action),url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:f.e})},t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var a=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(a,void 0,!0)},t.prototype.setCoverPhoto=function(e,n){var a=this._getModifyAlbumUrl(),i=new s.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(o.action),url:a,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:f.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return r.n.wrapError(t)})},t.prototype._handleRequest=function(e,n){var a=this._getModifyAlbumUrl();return d.e.start({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(n.action),url:a,batchSize:20,items:e,isErrorExpectedCallback:f.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})},t.prototype._getModifyAlbumUrl=function(){return c.t.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME},t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})},t.ADD_TO_ALBUM_ACTION="Add",t.CREATE_ALBUM_ACTION="Create",t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename",t.REMOVE_FROM_ALBUM_ACTION="Remove",t.SET_COVER_PHOTO_ACTION="SetCoverPhoto",t.MODIFY_ALBUM_API_NAME="ModifyAlbum",t.ALBUMS_ID="albums",t}(i.n);t.i=b},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(2002),r=n(52),o=function(e){function t(t){var n=this,r=t.initTimeoutMs,o=void 0===r?4e4:r,s=Object(a.__rest)(t,["initTimeoutMs"]);return(n=e.call(this)||this)._customerPromiseLogger=s.customerPromiseLogger,n._messenger=Object(i.e)(Object(a.__assign)(Object(a.__assign)({},s),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)})),n}return Object(a.__extends)(t,e),t.prototype.sendShareDestruct=function(){return this._send({command:"shareCommand",name:"share_destruct"})},t.prototype.sendShareRevisible=function(e){return e.command="shareCommand",this._send(e)},t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)},t.prototype.sendNewToken=function(e,t,n){var a={command:"shareCommand",name:"share_newToken"};return e?a.token=e:t&&(a.error=t,a.errorDetails=n),this._send(a)},t.prototype._send=function(e){var t=this;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var a;return null===(a=t._customerPromiseLogger)||void 0===a||a.end({resultType:r.e.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}}),!1})},t}(function(){function e(){this._commandHandlers=[],this._notificationHandlers=[]}return Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0}),e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)},e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)},e.prototype.addCommandHandler=function(e){var t=this;return this._commandHandlers.push(e),{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}},e.prototype.addNotificationHandler=function(e){var t=this;return this._notificationHandlers.push(e),{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}},e.prototype.dispose=function(){this._messenger.dispose()},e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var a=(0,n[t])(e);if(a)return a}},e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++)(0,n[t])(e)},e}())},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("PhotoLocation")},function(e,t,n){"use strict";function a(e){return e.length>0?function(e){return e.large||e.medium||e.small||void 0}(e[0]):void 0}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={sharepoint:0,microservice:1}}],Array(21),[function(e,t,n){"use strict";function a(e){var t=new ArrayBuffer(2*e);return new Uint16Array(t)}function i(e,t){for(var n=a(t),i=Math.min(e.length,t),r=0;r<i;r++)n[r]=e[r];return n}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(9),r=n(137),o=new a.e("photoToGroupKey",{driveItemKeyPart:i.e.subKeyPart,photosRootItemSetKeyPart:r.e.subKeyPart})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(30),i=n(547),r=n(137),o=new a.e("indexedPhotoRecord",{photosRootItemSetKeyPart:r.e.subKeyPart,index:i.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("photoToGroupKey")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("previousItem")}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"r",function(){return y}),n.d(t,"i",function(){return S}),n.d(t,"n",function(){return D}),n.d(t,"a",function(){return I});var a=n(22),i=n(116),r=n(42),o=n(459),s=n(1799),c=n(94),d=n(2078),l=n(36),u=n(2110),f=n(3196),p={"pokmon":!0},m={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},_=[u.n,u.e,u.a,u.t],h=String.fromCharCode(9),b="%09",g="tagHeader",v=0;function y(e,t,n,i,o){var s=e.length,c=0,l=[];if(1!==t){for(var u=0,h=e;u<h.length;u++)w=h[u],(p[w.tag.toLowerCase()]||c<11&&m[w.tag.toLowerCase()]&&-1===_.indexOf(w.tag))&&(n.push(a.observable(D(d.e.allTags,w,null,o))),c++);if(c>0){var b={groupingId:g,startIndex:0,count:c,tagHeader:{title:f.s,countSubtitle:""}};l.push(b)}e.sort(function(e,t){var n=e.localizedTag||e.tag,a=t.localizedTag||t.tag;return n.localeCompare(a)});for(var v=0,y=e;v<y.length;v++)w=y[v],-1===_.indexOf(w.tag)?n.push(a.observable(D(d.e.allTags,w,null,o))):s--;if(s>0){var S=r.pluralSelect(s,f.i,r.format(f.a,s)),I={groupingId:g,startIndex:c,count:s,tagHeader:{title:f.e,countSubtitle:S}};l.push(I)}var x={name:"tagGrouping",itemGroups:l};i.push(x)}else for(var C=0,O=e;C<O.length;C++){var w=O[C];-1===_.indexOf(w.tag)&&n.push(a.observable(D(d.e.allTags,w,null,o)))}}function S(e,t,n,i,r,o){for(var s={},c=0,l=t;c<l.length;c++){var u=l[c];s[u.hierarchyIndex]=!0}e=e.filter(function(e){return s[e]});for(var p=[],m=[],_={name:f.r,places:[],totalPlaces:0},h=0,b=t;h<b.length;h++){var v=b[h],y=v.country;""===y?(_.places.push(v),_.totalPlaces++):m.indexOf(y)<0?(p.push(x(y,v)),m.push(y)):C(y,v,p)}p.sort(function(e,t){return t.totalPlaces-e.totalPlaces}),_.totalPlaces>0&&p.push(_);for(var S={},I=e.length,A=[],L=I,k=0,M=p;k<M.length;k++){var P=M[k],T=P.places;O(T),T.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var U=T.length,F=void 0,H=0,R=T;H<R.length;H++){var N=R[H];F=D(d.e.allPlaces,null,N,r),n.push(a.observable(F)),e.indexOf(N.hierarchyIndex)>-1&&(S[N.hierarchyIndex]=E(F))}A.push(w(L,U,P.name,o(P.name))),L+=U}var B=t.length;if(I>0&&B>=I){for(var j=I-1;j>-1;j--)n.unshift(a.observable(S[e[j]]));var V={groupingId:g,startIndex:0,count:I,tagHeader:{title:f.o,countSubtitle:""}};A.unshift(V)}var z={name:"tagGrouping",itemGroups:A};i.push(z)}function D(e,t,n,a){var i,r=((i={}).qt="allmyphotos",i.v="photos",i.id=a.rootItemId,i);switch(e){case d.e.allTags:var u;u=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag,r.tagFilter=u;break;case d.e.allPlaces:r.locationFilter=n.hierarchyIndex}r.u="".concat(v++);var f=s.t.getKey(r),p=new o.e(f);p.type=c.e.Folder,p.queryType=l.e.AllMyPhotos;var m={tagType:e};switch(p.tagInfo=m,p.folder={photoCount:0,covers:[]},e){case d.e.allTags:p.name="#"+(t.localizedTag||t.tag),p.id=t.tag,p.folder.childCount=t.count,p.childCount=t.count;break;case d.e.allPlaces:p.name=n.displayString,p.id=n.hierarchyIndex,p.folder.childCount=n.count,p.childCount=n.count;break;default:return null}return p.properties.commandsSupported={defc:"1"},p.isDraggable=!1,p}function I(e){var t="";return e.city&&(t+=e.city+", "),e.state&&(t+=e.state+", "),0===t.length?e.country||"":t.slice(0,-2)}function x(e,t){var n=[];return n.push(t),{name:e,places:n,totalPlaces:1}}function C(e,t,n){for(var a,i=n.length,r=0;r<i;r++)if(e===(a=n[r]).name){a.places.push(t),a.totalPlaces++;break}}function O(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a.displayString=I(a)}}function w(e,t,n,a){var i=r.pluralSelect(t,f.n,r.format(f.t,t));return{groupingId:g,startIndex:e,count:t,tagHeader:{title:n,countSubtitle:i,regionUrl:a}}}function E(e){var t=i.e(e.key);t.u=v++;var n=s.t.getKey(t),a=new o.e(n);a.type=e.type,a.queryType=e.queryType;var r={tagType:e.tagInfo.tagType};a.tagInfo=r,a.name=e.name,a.id=e.id;var c={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};return a.folder=c,a.properties.commandsSupported={defc:"1"},a.isDraggable=!1,a}},,function(e,t,n){"use strict";var a=n(0),i=n(60),r=n(179),o=n(424),s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},c=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.getSharesPathFromItemUrl=function(e){var t=btoa(unescape(encodeURIComponent(e)));return"/shares/u!".concat(t.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),"/driveItem")},e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getFamily=function(){var e={};return o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(a.__assign)(Object(a.__assign)({},s),{404:!0})}).then(function(e){return e}).catch(function(e){})},e.prototype.getFamilyMembers=function(){var e={};return o.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only"),this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(a.__assign)(Object(a.__assign)({},s),{404:!0})}).then(function(e){return e}).catch(function(e){})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.createLink=function(e){var t=this,n=e.itemIds,a=e.type,i=e.scope,r=e.preventDownload,o=e.password,s=e.expiration,c=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:a,scope:i,preventDownload:r,password:o,expiration:s}):this.createBundle(n,c).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:a,scope:i,preventDownload:r,password:o,expiration:s})})},e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,a=t.type,i=t.scope,r=t.preventDownload,o=t.password,s=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:a,scope:i,preventDownload:r,password:o,expiration:s})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.id})},e.prototype.getDriveOwner=function(e){var t="/drives/"+e;return this._dataRequestor.send({path:t,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getCurrentUser=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s})},e.prototype.getItemInfo=function(e){var t="".concat(this.getDrivesPathFromItemId(e));return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t));return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t="".concat(this.getDrivesPathFromItemId(e),"/permissions");return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(t){var n="".concat(e.getSharesPathFromItemUrl(t),"/permissions");return this._dataRequestor.send({path:n,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,n=e.itemIds,a=e.recipients,i=e.message,r=e.requireSignIn,o=e.sendInvitation,s=e.roles,c=e.password,d=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),a,i,r,o,s,c,d):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),a,i,r,o,s,c,d)})},e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,a=t.recipients,i=t.message,r=t.requireSignIn,o=t.sendInvitation,s=t.roles,c=t.password,d=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),a,i,r,o,s,c,d)},e.prototype.getDefaultLink=function(t,n,a){return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},a):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:a}).then(function(e){return i.n.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.n.wrap([e])})},e.prototype.updatePermissions=function(e,t,n){var a="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t),o={roles:[n]};return this._dataRequestor.send({path:a,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(o),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value}).catch(function(e){var t=e.message||"Error updating permission",n=e.code||Object(r.i)(e)||"genericPermissionUpdateFailure",a={error:e.error,name:e.name,errorCode:n,debugErrorMessage:JSON.stringify(e),errorMessage:t,rawError:JSON.stringify(e)};return i.n.reject(a)})},e.prototype.updatePermissionsFromItemUrl=function(t,n,a){var i="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n),r={roles:[a]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(r),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var n="".concat(this.getDrivesPathFromItemId(e),"/permissions/").concat(t);return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(t,n){var a="".concat(e.getSharesPathFromItemUrl(t),"/permissions/").concat(n);return this._dataRequestor.send({path:a,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,a=e.scope,i=e.preventDownload,r=e.password,o=e.useMultiPart,c=e.expiration,d="".concat(n,"/createLink"),l=t&&a?{type:t,scope:a,preventDownload:i}:void 0;return(r||""===r)&&(l.password=r),c&&(l.expirationDateTime=c),this._dataRequestor.send({path:d,apiName:"createLink",requestType:"POST",useMultiPart:o,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/".concat(e,"/driveItem")},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/".concat(t[0],"/items/").concat(e):"/drive/items/".concat(e)},e.prototype.inviteSingleItem=function(e,t,n,a,i,r,o,c,d,l){var u="".concat(e,"/invite"),f={recipients:t,message:n,requireSignIn:a,sendInvitation:i,roles:r};return o&&(f.password=o),c&&(f.expirationDateTime=c),this._dataRequestor.send({path:u,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(f),useMultiPart:l,headers:d,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e}();t.e=c}],Array(14),[function(e,t,n){"use strict";n.r(t),n.d(t,"SharePrefetch",function(){return fe});var a,i,r=n(0),o=n(2120),s=n(2162),c=n(1083),d=n(60),l=n(210),u=n(1060),f=n(2327),p=n(428),m=n(1773),_=n(1751),h=n(2425);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(a||(a={})),function(e){e[e.Network=1]="Network",e[e.Embed=3]="Embed",e[e.App=4]="App",e[e.View=5]="View",e[e.Edit=6]="Edit",e[e.Form=7]="Form",e[e.Direct=8]="Direct",e[e.Organization=9]="Organization",e[e.AppAccess=10]="AppAccess",e[e.RequestAccess=11]="RequestAccess",e[e.None=100]="None"}(i||(i={}));var b=n(2426),g=n(2427),v=n(1590),y=n(2428),S=n(2429),D=n(2430),I=n(2191),x=n(510),C=n(161),O=n(1563),w=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var a=this._sharingContextInformation,i=a.isFolder,r=a.isListSharing,o=a.itemUrl,s=a.listId,c=a.listItemId,d=a.listUrl,l=a.resourceId,u=a.serverRelativeItemUrl,f=a.uniqueId,p=a.webAbsoluteUrl;if(r)return e.build().webByUrl({webUrl:p}).method("Lists",s);if(f){if(s)return e.build().webByUrl({webUrl:p}).segment("lists").method("getbyid",s).method("GetItemByUniqueId",f);var m=i?"GetFolderById":"GetFileById",_={guid:f};return e.build().webByUrl({webUrl:p}).method(m,_).segment("ListItemAllFields")}return d?e.build().webByUrl({listUrl:d}).method("GetListItem",u):o?e.build().webByUrl({webUrl:p}).method("GetFileByUrl",O.t(o)).segment("ListItemAllFields"):s&&c?e.build().webByUrl({webUrl:p}).method("Lists",s).method("GetItemById",c):e.build().webByUrl({webUrl:p}).method("GetListItemByResourceId",l)}var h;h=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var b=e.build().webByItemUrl(h).method("Lists",n);return t.isRootFolder||(b=t.properties.ID?b.method("GetItemById",t.properties.ID):b.method("GetItemByUniqueId",t.properties.uniqueId)),b},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}(),E=n(1749),A=n(295),L=n(1921),k=n(12),M=n(1133),P=n(1962),T=n(1099),U=!k.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),F=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new p.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new m.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new w({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(x.r)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(r.__extends)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return h.e.None;default:return h.e.View;case 2:return h.e.Edit;case 6:return h.e.Review}},t.prototype.getSharingInformation=function(e,t,n,i,r,o){var s,c=this,d=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),r&&(l+=",addressBarLinkSettings"),s=d.oDataParameter("$Expand",l).toString(),this.getData(function(){return s},function(t){var n=JSON.parse(t),i=c._parseGetSharingInformationResponse(n,e);return i.getSharingInformationSources=a.api,i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&j(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(o.rawPersonData)}var s={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i};return JSON.stringify(s)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a,r=this,o=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===i.Organization||n.linkType===i.Edit||n.linkType===i.View)return this._shareLink(e,n);if(o){var s=n.items[0],c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));a=c.segment("ShareObject").toString()}else a=this._shareUrl;return this.getData(function(){return a},function(e){var a=JSON.parse(e).d,i=[];Object(T.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],a=0;a<e.length;a++){var i=e[a];t.push(i.rawPersonData)}n.roleValue===h.e.Edit.toString()?n.roleValue=P.e:n.roleValue===h.e.View.toString()&&(n.roleValue=P.a);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return o||(s.url=r._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(T.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case b.e.none:case b.e.view:case b.e.review:case b.e.edit:case b.e.owner:t=n;break;default:t=b.e.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case b.e.none:t=0;break;case b.e.view:t=1;break;case b.e.review:t=6;break;case b.e.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString(),i={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&j(this._sharingContextInformation.listId.slice(1,-1))&&(i["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(i.Prefer="DirectUrlWithShareToken")),this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?(Object(T.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),function(e){if(e.d)return H(e.d.ShareLink.sharingLinkInfo)}(t)):t.error?{error:g.t.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(f.e)(t.expiration.toString()));var a=null;if(e.recipients&&e.recipients.length>0){a=[];for(var i=0,r=e.recipients;i<r.length;i++){var o=r[i];o.rawPersonData&&a.push(o.rawPersonData)}}var s=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){s=[];for(var c=0,d=t.inviteesToRemove;c<d.length;c++){var l=d[c];s.push({id:l.id,loginName:l.loginName,name:l.primaryText,isExternal:l.isExternal,principalType:l.type,email:l.email})}}var u={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};if(s&&(u.request.settings.inviteesToRemove={results:s}),a&&a.length>0){u.request.peoplePickerInput=JSON.stringify(a);var p=e.emailData,m=e.emailSubject;void 0!==p&&void 0===m&&(u.request.emailData={body:e.emailData,subject:""}),void 0===p&&void 0!==m&&(u.request.emailData={body:"",subject:e.emailSubject}),void 0!==p&&void 0!==m&&(u.request.emailData={body:e.emailData,subject:e.emailSubject})}var _=e.settings.shareId;_&&(u.request.settings.shareId=_,u.request.emailData={body:""});var h=JSON.stringify(u);return Object(T.e)()&&window.sessionStorage.setItem("ShareLink_Payload",h),h},"POST",0!==Object.keys(i).length?i:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(U)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:g.t.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?H(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:g.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(U)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:g.t.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(M.e)(this._pageContext))return v.e.sharePoint;switch(e){case A.t.teamSite:case A.t.group:case A.t.subgroup:case A.t.sitePagePublishing:return v.e.sharePoint;case A.t.mySite:return v.e.odb;default:return v.e.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,r=e;i<r.length;i++){var o=r[i];a.push(o.rawPersonData)}var s=null;t.expiration&&(s=Object(f.e)(t.expiration));var c={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:s}};return JSON.stringify(c)})},t.prototype._getSharingLinkKind=function(e,t){var n=y.e.direct;return e===i.Edit?n=y.e.anonymousEdit:e===i.View?n=y.e.anonymousView:e===i.Organization&&(n=t===h.e.Edit.toString()?y.e.organizationEdit:y.e.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:g.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,i=n.permissionsInformation,r=!!i,o=!!n.sharingLinkTemplates,s=r,c=!!n.addressBarLinkSettings,d=r?this._parseSharingLinks(i.links.results,n.directUrl,a):[],l=o?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],u=c?n.addressBarLinkSettings:null,f=[];if(r){var p=i.siteAdmins.results,m=i.principals.results,_=this._parseSharingPrincipals(p,void 0,a);_.forEach(function(e){return e.isSiteAdmin=!0});var h=this._parseSharingPrincipals(m,void 0,a);f=_.concat(h)}var b=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,d,n.sharingAbilities),v={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var I=t.properties,x=I.ItemChildCount?parseInt(I.ItemChildCount,10):0,O=I.FolderChildCount?parseInt(I.FolderChildCount,10):0,w=t.type===C.t.OneNote?0:x+O,A=this._isPolicyTipFlagSet(t.policyTip,E.a.blockSharing);v={name:t.name,childCount:w,hasDlpPolicy:A,extension:t.extension,appmap:t.appMap,itemType:t.type}}var L=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||d.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:L,defaultSharingLink:b,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(d,f),item:v,sharingLinks:d,sharingPrincipals:f,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:S.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:y.e.direct,sharingScope:D.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:l,addressBarLinkSettings:u,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation}},t.prototype._computeIsShared=function(e,t){for(var n=!1,a=0,i=e;a<i.length;a++){var r=i[a];r.isActive&&r.sharingLinkKind!==y.e.direct&&(n=!0)}return n||(n=t.length>0),n},t.prototype._parseSharingLinks=function(e,t,n){var a=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;return t=void 0!==i.Scope&&i.Scope!==D.e.uninitialized?N(i.LinkKind,i.Scope):R(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:B(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:a._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:a._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:a._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});return(i=i.sort(function(e,t){return a._getLinkRanking(t)-a._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:S.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:y.e.direct,sharingScope:D.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),i},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case S.e.anyone:t+=30;break;case S.e.organization:t+=20;break;case S.e.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case I.e.anyone:t+=30;break;case I.e.organization:t+=20;break;case I.e.specificPeople:t+=10}switch(e.role){case b.e.edit:t+=3;break;case b.e.review:t+=2;break;case b.e.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==D.e.uninitialized?N(r.LinkKind,r.Scope):R(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:B(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(L.n)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(L.n)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return w.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:u.e[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(L.n)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===y.e.direct&&(e=y.e.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==y.e.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=y.e.anonymousView),i!==y.e.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=y.e.organizationEdit),r!==D.e.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=D.e.organization)):(i!==y.e.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=y.e.anonymousView),i!==y.e.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=y.e.organizationEdit),r!==D.e.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=D.e.organization)),a.organizationLinkAbilities&&(i!==y.e.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=y.e.organizationView),i!==y.e.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=y.e.direct),r!==D.e.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=D.e.specificPeople)),a.peopleSharingLinkAbilities&&(r!==D.e.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=D.e.existing));var o=void 0;return e===y.e.anonymousEdit||e===y.e.anonymousView?o=S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?o=S.e.organization:e===y.e.direct?o=S.e.specificPeople:e===y.e.flexible&&(o=S.e.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(_.t);function H(e){var t;t=void 0!==e.Scope&&e.Scope!==D.e.uninitialized?N(e.LinkKind,e.Scope):R(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:B(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function R(e,t,n){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t?S.e.anyone:!1===n?S.e.organization:S.e.specificPeopleFlex:void 0}function N(e,t){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t==D.e.anyone?S.e.anyone:t===D.e.organization?S.e.organization:S.e.specificPeopleFlex:void 0}function B(e){return e===y.e.anonymousEdit||e===y.e.organizationEdit||e!==y.e.anonymousView&&e!==y.e.organizationView&&null}function j(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}var V=function(){function e(e){this._dataSource=e.sharingDataSource||new F({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,i)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return t._invalidateItem(e.items[0]),n})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateItem(e.item),n})},e.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,n,a){return this._dataSource.emailWithoutPermissioning(e,t,n,a).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}(),z=n(372),G=n(684),K=n(1137),W=n(291),q=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(Object(K.e)()(function(e){function t(t){var n=t.context,a=void 0===n?{}:n,i=t.accountType,o=void 0===i?"Unknown":i,s=t.clientName,c=void 0===s?"Unknown":s,d=t.cloudType,l=void 0===d?"Unknown":d,u=t.correlationId,f=t.environment,p=void 0===f?t.ariaEnvironment||"prod":f,m=t.isAuthenticated,_=void 0===m?"NA":m,h=t.language,b=void 0===h?a.Market:h,g=t.scenario,v=void 0===g?"Unknown":g,y=t.siteSubscriptionId,S=void 0===y?"Unknown":y,D=t.userId,I=void 0===D?"Unknown":D,x=t.version,C=void 0===x?"Unknown":x,O=t.tenantToken,w=void 0===O?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":O,E=(t.context,Object(r.__rest)(t,["accountType","clientName","cloudType","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,Object(r.__assign)({tenantToken:w,context:Object(r.__assign)({AccountType:o,ClientName:c,CloudType:l,CorrelationId:u,Environment:p,IsAuthenticated:_,IsSharedControl:!0,Market:b,Scenario:v,Session:W.generate(),SiteSubscriptionId:S,UserId:I,Version:C,Workload:"SharedControls"},a)},E))||this}return Object(r.__extends)(t,e),t}(function(e){function t(t){var a=this,i=t.context,o=void 0===i?{}:i,s=t.ariaLoader,c=void 0===s?function(){return Object(r.__awaiter)(a,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,n.e(356).then(n.t.bind(null,3193,7))]})})}:s,d=(t.context,Object(r.__rest)(t,["ariaLoader","context"]));return a=e.call(this,Object(r.__assign)({ariaLoader:c,context:Object(r.__assign)({},o)},d))||this}return Object(r.__extends)(t,e),t}(G.e)))),Q=n(1128),Y=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t}(Object(Q.e)()(q)),J=n(204),X=n(237),Z=n(1076),$=n(179),ee=n(131),te=n(52),ne=n(346),ae=n(314),ie=n(1496),re=n(2111),oe={ECS:1000799},se={ODB:60596},ce=k.t.isActivated("acd90abc-a3c2-4370-a5cd-c49cd5e7850b","02/15/2022","use sharingMessenger for shareprefetch")||ne.n.isFeatureEnabled({ECS:1002676}),de=!k.t.isActivated("d5b8cbb0-c266-4df4-9114-140574fe3794","01/24/2022","use new prefetch for converged share dialog endpoint"),le=!k.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user"),ue=!k.t.isActivated("c877bf24-d915-49e7-8142-4f3051896aad","04/21/2022","crossdomain url"),fe=function(){function e(e){var t,n=this;this._iframe=document.createElement("iframe"),this._form=document.createElement("form"),this._formInput=document.createElement("input"),this._sharingHostMessenger=null,this._channelId=ae.e.generate(),this._signal=new l.e,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._sessionId=ae.e.generate(),this._manager=Object(J.t)(),this._hostOrigin="",this._clientOrigin="",this._sessionQos=new(ee.e.withManager(this._manager).withContext(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{"AppInfo.Session":n._sessionId})}))({name:"SharingSession.".concat(u.e[e.context.mode||u.e.share])}),this._shareCustomerPromiseLogger=new ie.e({scenario:"sharePrefetch.load",perfGoalInMs:3e4});var a,i=void 0===this._props.context.hostMethod?o.e.microservice:this._props.context.hostMethod,s=this._props.isConsumer;if(this._launchNewSharedialog=de&&i===o.e.sharepoint&&!s,!(null===(t=this._context)||void 0===t?void 0:t.authToken))throw new Error("An access token is required for SharePrefetch optimization");var c="";if(le&&ne.n.isFeatureEnabled(se)&&this._context.invitationId&&(c="&invitationId=".concat(this._context.invitationId)),this._launchNewSharedialog){var d=ue&&this._props.sharepointHostUrl?"".concat(this._props.sharepointHostUrl,"&sessionid=").concat(this._sessionId):void 0;this._iframeUrl=d||"".concat(this._context.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?sessionid=").concat(this._sessionId).concat(c,"&crossdomain=true")}else if(i===o.e.sharepoint&&this._props.sharepointHostUrl)this._iframeBaseUrl=this._iframeUrl=this._props.sharepointHostUrl;else switch((a=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0])?"test":e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"ag08":this._iframeBaseUrl="https://odweba.svc.ms.eaglex.ic.gov";break;case"ag09":this._iframeBaseUrl="https://odweba.svc.ms.microsoft.scloud";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}var f={clientName:this._context.clientId,userAuthToken:this._context.authToken,Session:this._sessionId};if(s&&(this._context.userId?f.userId=this._context.userId:f.accountType="ConsumerAnonymous"),new Y(f).attach(this._manager),!this._iframeUrl&&i===o.e.microservice){var p=s?"&consumer=true":"";this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(p,"&sessionid=").concat(this._sessionId).concat(c).concat(a?"&devhost=".concat(encodeURIComponent(a)):"")}if(this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe),s)this._initializeForm(),e.element.appendChild(this._form);else if(this._launchNewSharedialog){this._initializeForm();var m=this._iframe.contentWindow;m&&(m.document.body.appendChild(this._form),this._form.submit())}ce||this._sharingHostMessenger||(this._sharingHostMessenger=this._createSharingHostMessenger())}return e.prototype.initializeUI=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,o,s,c,l=this;return Object(r.__generator)(this,function(f){return e=this._context&&this._context.correlationId,t=this._props.isConsumer,n=this._context.mode===u.e.copy&&"teams"===this._context.clientId&&!this._context.shareId,a=n?this._getDefaultLink():Promise.resolve(void 0),i=t||this._props.disablePrefetchSharingInformation?Promise.resolve(void 0):this._getSharingInformation(),o=t?Promise.resolve(void 0):this._signal.getPromise(),this._isShareReady=!1,Promise.all([this._toTuple(a),this._toTuple(i),this._toTuple(o)]).then(function(n){var a=n[0],i=n[1];n[2];try{var o=!1;if(!t){var s=l._props.options.onError;if(l._isError(a)&&(o=!0,s&&s({name:"SharePrefetchError",message:"",error:a.error,resultCode:d.n.isCanceled(a.error)?"Canceled":Object($.i)(a.error)})),l._isError(i)){o=!0;var c=i.error,u={code:c.code,status:c.status};s&&s({name:"SharePrefetchError",message:"",error:c,resultCode:d.n.isCanceled(i.error)?"Canceled":"[".concat(u.status.toString(),"] ").concat(u.code||"Unknown")})}}var f=l._iframe.contentWindow;if(f&&!t){var p=l._props.options.spRestTokenProvider,m=Object(r.__assign)(Object(r.__assign)({},l._context),{rawInvite:a.value,sharingInformation:i.value,hasTokenProvider:!!p&&!!p.getAuthToken});l._sharingHostMessenger?l._sharingHostMessenger.sendSharingContextInformation(m):f.postMessage(m,l._iframeUrl)}else t?(l._formInput.value=JSON.stringify(l._context),l._form.submit()):o||l._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:l._elementWindow.document.body.contains(l._iframe),messagesReceived:Object.keys(l._messagesReceived).join(","),mode:l._context.mode,correlationId:e}})}catch(t){l._sessionQos.end({resultType:te.e.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}}),this._props.disableIframeDomainCheck||(s=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout,setTimeout(function(){if(!l._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=l._props.options&&l._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach ".concat(l._iframeBaseUrl," domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges"),resultCode:t}),l._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:t,extraData:{mode:l._context.mode,iframeBaseUrl:l._iframeBaseUrl,correlationId:e}}),clearTimeout(l._timeoutId)},t.src="".concat(l._iframeBaseUrl,"/favicon.ico?").concat(Math.random())}},s)),c=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return Object(r.__awaiter)(l,void 0,void 0,function(){var n,o,s,d,l,u,f,p,m,_,h;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i];case 2:return s=r.sent(),o=!!s,[3,4];case 3:return d=r.sent(),n=d,[3,4];case 4:u=!1,r.label=5;case 5:return r.trys.push([5,7,,8]),[4,a];case 6:return f=r.sent(),u=!(!f||!f),[3,8];case 7:return p=r.sent(),l=p,[3,8];case 8:return m=this._elementWindow.document.body.contains(this._props.element),_={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),rootElementInBody:m,messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:o,getSharingError:n,inviteHasData:u,inviteError:l,isConsumer:t,timeout:c,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e},this._showShareUX(),(h=this._props.options&&this._props.options.onTimeout)&&h(_),this._sessionQos.end({resultType:m?te.e.Failure:te.e.ExpectedFailure,resultCode:"timeout",extraData:_}),[2]}})})},c),[2]})})},e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:te.e.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a=this;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return e=new c.t({},{urlDataSource:{getApiBaseUrl:function(){return"".concat(a._context.webAbsoluteUrl,"/_api/v2.0")}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return d.n.resolve({accessToken:a._context.authToken})}},apiEvent:X.e.withManager(this._manager)}),t=new s.e({},{dataRequestor:e}),n=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(n=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",n,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",n,!this._props.disableUseMultiPart)];case 1:return[2,{value:i.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,n=this._manager,a=new F({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(a){function i(i){return a.call(this,i,{pageContext:e,apiEvent:X.e.withManager(n),tokenProvider:t})||this}return Object(r.__extends)(i,a),i}(Z.e),tokenProvider:t}),i=new V({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:a}),o=this._launchNewSharedialog||this._context.mode===u.e.copy||this._context.mode===u.e.linkSettings;return i.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0,void 0,this._context.mode===u.e.manageAccess)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.name="shareFrame",this._iframe.id="shareFrame",this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},!ce&&this._iframeUrl&&(this._hostOrigin=new z.e(window.location.href).authority,this._iframeUrl+="&channelId=".concat(this._channelId,"&origin=").concat(this._hostOrigin)),this._launchNewSharedialog||(this._iframe.src=this._iframeUrl),this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden"},e.prototype._initializeForm=function(){var e;this._form.target="shareFrame",this._form.method="POST",this._form.action=this._iframeUrl,this._form.style.display="none",this._formInput.type="text";var t=null===(e=this._context)||void 0===e?void 0:e.authToken;this._launchNewSharedialog?(this._formInput.value=t,this._formInput.name="access_token"):this._formInput.name="context",this._form.appendChild(this._formInput);var n=document.createElement("input");n.type="submit",this._form.appendChild(n)},e.prototype._showShareUX=function(){var e,t;this._isShareReady=!0;var n=this._props.styles;n&&n.border?this._iframe.style.border=n.border:this._iframe.style.border="0",n&&(n.margin&&(this._iframe.style.margin=n.margin),n.minWidth&&(this._iframe.style.minWidth=n.minWidth),n.minHeight&&(this._iframe.style.minHeight=n.minHeight)),this._iframe.style.visibility="visible",this._iframe.style.height=this._context.fullScreenIframe?"100%":"".concat(this._iframeHeight||400,"px");var a=k.t.isActivated("209e41e5-d804-4aa1-9d59-5209d8d48f2c","02/03/2022","render wider dialog across all endpoints")||ne.n.isFeatureEnabled(oe)||!1===(null===(t=null===(e=this._props.context)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.enableWiderDialog)?320:480;this._iframe.style.width=this._context.fullScreenIframe?"100%":"".concat(a||this._iframeWidth||this._iframe.style.minWidth,"px"),clearTimeout(this._timeoutId)},e.prototype._receiveMessage=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(a){try{t=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,this.dispose(),[2]}catch(e){}return n=t.name,this._messagesReceived[n||""]=!0,this._processEvent(t),[2]})})},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e.prototype._createSharingHostMessenger=function(){var e=this;if(console.log("in sharePrefetch, _createSharingHostMessenger(), host created"),this._clientOrigin=new z.e(this._iframeUrl).authority,this._clientOrigin&&this._iframe.contentWindow){var t=new re.e({origin:this._clientOrigin,channelId:this._channelId,source:this._iframe.contentWindow,customerPromiseLogger:this._shareCustomerPromiseLogger});return t.addCommandHandler(function(t){return console.log("SharingHostMessenger: sharePrefetch, command received: ",t.name),e._processEvent(t),{result:"success"}}),t}return null},e.prototype._processEvent=function(e){var t,n,a,i,r,o,s,c,d,l,u,f=this;switch(e.name){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date,this._signal.complete();var p=this._props.options&&this._props.options.onScriptsLoaded;p&&p();break;case"share_resize":if(!this._context.fullScreenIframe){var m=this._props.options&&this._props.options.onResize;m&&e.width&&e.height&&m(e.width,e.height),this._iframeWidth=e.width||320,this._iframeHeight=e.height||400,this._isShareReady&&(this._iframe.style.height="".concat(this._iframeHeight,"px"),this._iframe.style.width="".concat(this._iframeWidth,"px"))}break;case"share_started":var _=this._props.options&&this._props.options.onStarted;_&&_();break;case"share_ready":this._showShareUX();var h={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:null===(t=this._context)||void 0===t?void 0:t.correlationId};this._sessionQos.end({resultType:te.e.Success,extraData:h}),this._shareCustomerPromiseLogger.end({resultType:te.e.Success});var b=this._props.options&&this._props.options.onReady;b&&b();break;case"share_error":this._showShareUX();var g=this._props.options&&this._props.options.onError,v=JSON.parse(e.data.debugErrorMessage||"{}"),y=v.code||v.status||"ShareError: [".concat(null===(n=e.data)||void 0===n?void 0:n.error,"]");this._sessionQos.end({resultType:te.e.Failure,resultCode:y,extraData:{correlationId:null===(a=this._context)||void 0===a?void 0:a.correlationId}}),this._shareCustomerPromiseLogger.end({resultType:te.e.Failure,errorCode:y,extraData:{clientId:this._context.clientId,mode:null===(i=this._context)||void 0===i?void 0:i.mode,correlationId:null===(r=this._context)||void 0===r?void 0:r.correlationId}}),g&&g({name:"SharePrefetchError",message:(null===(o=e.data)||void 0===o?void 0:o.errorMessage)||"",error:Error(null===(s=e.data)||void 0===s?void 0:s.error),debugErrorMessage:null===(c=e.data)||void 0===c?void 0:c.debugErrorMessage,errorMessage:null===(d=e.data)||void 0===d?void 0:d.errorMessage,resultCode:y});break;case"share_completed":var S=this._props.options&&this._props.options.onCompleted;S&&S({scope:(null===(l=e.data)||void 0===l?void 0:l.scope)||""});break;case"share_dismiss":var D=this._props.options&&this._props.options.onDismiss;D&&D();break;case"share_manageAccessClicked":var I=this._props.options&&this._props.options.openManageAccess;I&&I();break;case"share_linkSettingsCompleted":var x=this._props.options&&this._props.options.onLinkSettingsComplete;x&&x(e.data);break;case"share_grantAccessCompleted":var C=this._props.options&&this._props.options.onGrantAccessComplete;(null===(u=e.data)||void 0===u?void 0:u.successful)&&C&&C();break;case"share_getToken":var O=new ee.e({name:"SharingSession.GetToken"}),w=this._iframe.contentWindow;if(!w){O.end({resultType:te.e.Failure,error:"no_window"});break}this._props.options.spRestTokenProvider&&this._props.options.spRestTokenProvider.getAuthToken?this._props.options.spRestTokenProvider.getAuthToken(e.data).then(function(e){e?(f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(e,void 0):w.postMessage(JSON.stringify({name:"share_newToken",token:e}),f._iframeUrl),O.end({resultType:te.e.Success})):(f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(void 0,"no_token"):w.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),f._iframeUrl),O.end({resultType:te.e.Failure,error:"no_token"}))}).catch(function(e){f._sharingHostMessenger?f._sharingHostMessenger.sendNewToken(void 0,"token_exception",e.toString()):w.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:e}),f._iframeUrl),O.end({resultType:te.e.Failure,error:String(e)})}):(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_handler"):w.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),O.end({resultType:te.e.Failure,error:"no_handler"}))}},e}()},,,,,,function(e,t,n){"use strict";n.d(t,"i",function(){return C}),n.d(t,"n",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"t",function(){return E}),n.d(t,"e",function(){return A});var a=n(571),i=n(515),r=n(226),o=n(411),s=n(687),c=n(30),d=n(14),l=new c.e("playlistPlaybackItem",{currentItemKey:d.e,playbackItemKey:d.e}),u=n(263),f=n(803),p=n(685),m=new c.e("spItemSet",{parentItemKey:f.e.subKeyPart,sortFieldKey:d.e,sortAscending:u.e,filterParams:d.e,groupByFieldKey:d.e,viewKey:p.e.subKeyPart}),_=n(46),h=n(160),b=n(212),g=n(133),v=n(236),y=n(971),S=n(143),D=n(19),I=n(12),x=Object(h.e)(function(e){return a.e.getRUMOneLogger()});function C(e){return function(t){var n=t(x);if(e&&e.keyChanges&&e.keyChanges.currentItemKey!==e.keyChanges.previousItemKey&&b.r(o.e.render.start),!n.isRunning()){var a=L(n,e);e&&a===r.e.none||n.resetLogger()}}}function O(e,t,n,a){return void 0===a&&(a=!1),function(r){n&&n.keyChanges&&n.keyChanges.currentItemKey!==n.keyChanges.previousItemKey&&(b.r(o.e.render.end),b.o("Items-View.Render",o.e.render.start,o.e.render.end));var c=r(x),d=n||{},l=d.itemsScopeItemKey,u=void 0===l?"":l,f=d.itemsScopeInitTime,m=void 0===f?0:f,h="ItemsViewListView".concat(u);c.writeScenarioId("".concat(t||"Unknown",".ItemsViewListView")),c.addExpectedControl(h),I.e.isActivated("5DFC9288-3AE8-41E0-84E4-7A68B2D2E483","06/10/2022","Add W3CPerf timings to Rumone")&&c.collectW3CPerfTimings();var g=L(c,n);c.writePageTransitionType(g);var v=r(function(e){return function(t){return t(Object(S.e)(function(t){var n=(e&&e.keyChanges||{}).currentItemKey,a=t.demandItemFacet(s.e,n),i=a&&a.viewKey,r=i&&p.e.serialize(i);return t.demandItemFacet(_.On,r)}))}}(n)),C=r(function(e){return function(t){return t(Object(S.e)(function(t){var n,a,i,r,o,s=null===(n=null==e?void 0:e.keyChanges)||void 0===n?void 0:n.currentItemKey,c=t.demandItemFacet(D.e,s),d=0;return(null==c?void 0:c.itemKeys)&&(null===(a=null==c?void 0:c.itemKeys)||void 0===a?void 0:a.length)&&c.itemKeys.forEach(function(e){var n=t.demandItemFacet(_.Et,e);n&&n._activity&&d++}),{activityNumber:d,itemNumber:null===(i=null==c?void 0:c.itemKeys)||void 0===i?void 0:i.length,activityPercent:d&&(null==c?void 0:c.itemKeys)&&(null===(r=null==c?void 0:c.itemKeys)||void 0===r?void 0:r.length)?Math.round(d/(null===(o=null==c?void 0:c.itemKeys)||void 0===o?void 0:o.length)*100):0}}))}}(n)),O=c.getMarkerTime(o.e.itemsView.start)||b.i("OnePageNavigation.Start")||m,w=c.getMarkerTime(o.e.authToken.start),E=c.getMarkerTime(o.e.authToken.end),A=c.getMarkerTime(o.e.dataFetch.start),k=c.getMarkerTime(o.e.dataFetch.end),M=c.getMarkerTime(o.e.appStart.start),P=c.getMarkerTime(o.e.processData.start),T=c.getMarkerTime(o.e.processData.end),U=c.getMarkerTime(o.e.resolveData.start),F=c.getMarkerTime(o.e.resolveData.end),H=0;A&&k&&(H=k-A);var R={"itemsView.appStart":{data:M-O>0?M-O:0,needFlatten:!0},"itemsView.render":{data:e-Math.max(m,isNaN(M)?0:M,O)-H,needFlatten:!0}};w&&E&&(R["itemsView.authTokenDuration"]={data:E-w,needFlatten:!0}),A&&k&&(R["itemsView.dataFetch"]={data:H,needFlatten:!0}),P&&T&&(R["itemsView.processData"]={data:T-P,needFlatten:!0}),U&&F&&(R["itemsView.resolveData"]={data:F-U,needFlatten:!0}),v&&(R["listView.viewType"]={data:v,needFlatten:!0}),C&&(R["listView.activityNumber"]={data:JSON.stringify(C),needFlatten:!1});for(var N=Object(y.n)(),B=0,j=Object.keys(N);B<j.length;B++){var V=j[B],z=N[V];z&&(R[V]=z)}a&&Object(y.a)();var G=new i.e({controlId:h,startTime:O,endTime:e});c.writeControlPerformanceData(G),c.writeEUPLBreakdown(JSON.stringify(R))}}function w(e){return void 0===e&&(e=!1),function(t){for(var n=Object(y.n)(),a=t(x),i={},r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],c=n[s];c&&(i[s+".tti"]=c)}e&&Object(y.a)(),a.writeTTIBreakdown(JSON.stringify(i))}}function E(e,t){var n=new v.e(void 0);return function(a){n.setTimeout(function(){var r="Items-View.ContextMenu.Start",o="Items-View.ContextMenu.End";b.r(o);var s=performance.getEntriesByName("".concat(b.t).concat(o),"mark").pop(),c=s?s.startTime:NaN,d="ItemsViewContextMenu",l=0===performance.getEntriesByName("".concat(b.t).concat(d,".FirstRender"),"mark").length,u=performance.getEntriesByName("".concat(b.t).concat(r),"mark").pop(),f=u?u.startTime:NaN;b.o("".concat(d,".").concat(l?"FirstRender":"Render"),r,o);var p=a(x),m=L(p,t);p.writeScenarioId("".concat(e||"Unknown",".").concat(d)),p.addExpectedControl(d),p.writePageTransitionType(m);var _=new i.e({controlId:d,startTime:f,endTime:c});p.writeControlPerformanceData(_),n.dispose()},0)}}function A(e,t,n){return function(a){a(x).addEUPLBreakdown(e,t,n)}}function L(e,t){if(t){if(t.isFullPageLoad)return e.getMarkerTime(g.t)?r.e.onePageAppNavigation:r.e.fullPageLoad;var n=void 0,a=void 0,i=void 0,o=t.keyChanges||{},c=o.previousItemKey,d=void 0===c?void 0:c,u=o.currentItemKey,f=void 0===u?void 0:u;if(s.e.matches(d)&&l.matches(f))return r.e.fullPageLoad;if(d&&s.e.matches(d)&&(n=s.e.deserialize(d)),d&&m.matches(d)&&(a=m.deserialize(d)),f&&s.e.matches(f)&&(i=s.e.deserialize(f)),!n&&!a)return r.e.onePageAppNavigation;if(i){var p=n&&n.listFullUrl||a&&a.parentItemKey&&a.parentItemKey.listFullUrl,_=n&&n.rootFolder||a&&a.parentItemKey&&a.parentItemKey.rootFolder;if(p&&p!==i.listFullUrl)return r.e.onePageAppNavigation;if(_!==i.rootFolder)return r.e.none}}return r.e.none}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(292),r=((a={})[i.e.AllMyPhotos]="Folder",a[i.e.Albums]="Albums",a[i.e.allTags]="Tags",a[i.e.allPlaces]="Places",a[i.e.allPeople]="People",a[i.e.singleAlbum]="Album",a[i.e.singleTag]="Tag",a[i.e.singlePlace]="Place",a[i.e.singlePerson]="Person",a[i.e.onThisDay]="OnThisDay",a[i.e.onThisMonth]="OnThisMonth",a[i.e.lastWeekPreviousYears]="LastWeekPreviousYears",a.folder="Folder",a.tag="Tag",a.album="Album",a.place="Place",a.onthisday="OnThisDay",a.onthismonth="OnThisMonth",a.lastweekpreviousyears="LastWeekPreviousYears",a);t.t=r},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}}],Array(65),[function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r});var a,i={ODC:"EnableNewCarouselDesign"},r=function(e){a=!!e}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(67),i=n(19),r=n(137),o=n(1941),s=new a.e("photosIndexMap",function(e,t){var n=t.itemKey;if(r.e.matches(n)){var a=e.demandItemFacet(i.e,n);if(void 0!==a){var s=[],c=0;return a.itemKeys.forEach(function(e){o.e.matches(e)?c+=o.e.deserialize(e).count:(s[c]=e,c++)}),s}}})}],Array(25),[function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return T}),n.d(t,"n",function(){return R});var a=n(0),i=n(2052),r=n(336),o=n(2160),s=n(2190),c=n(323),d=n(11),l=n(35),u=n(812),f=n(818),p=n(819),m=n(1827),_=n(1833),h=n(1834),b=n(143),g=n(90),v=[1e4,1e3,100],y="landing",S="counts",D=function(){function e(){this._groupToCountData={counts:[],dates:[]}}return e.prototype.clearGroupToCountsData=function(){this._groupToCountData={counts:[],dates:[]},this._filter=void 0},e.prototype.updateGroupToCountsData=function(e,t,n,a){if("folder"===e){var i=n.counts,r=n.dates;a?this._groupToCountData.pageToken===a&&this._filter===t&&(this._groupToCountData={counts:this._groupToCountData.counts.concat(i),dates:this._groupToCountData.dates.concat(r),pageToken:a}):(this._groupToCountData=n,this._filter=t)}},e.prototype.calculateDateAndOffsetOfIndex=function(t,n,a){if("folder"!==t)return e.UnknownDateAndOffset;if(n!==this._filter)return e.UnknownDateAndOffset;for(var i=0,r=-1,o=0,s=this._groupToCountData,c=s.counts,d=s.dates,l=0;l<c.length;l++){if((i+=c[l].count)>a){r=l;break}o=i}return r>=0?{date:d[r],index:o}:e.UnknownDateAndOffset},e.UnknownDateAndOffset={date:void 0,index:-1},e}(),I=function(){function e(e,t){this._vroomDataRequestor=e,this._successfullGroupToCountPageSizeIndex=0,this._indexToDateMapper=new D,this._photosNextLinkSkipToken={},this._itemCacheStore=t}return e.prototype.updateResource=function(e){var t=e;this._engagement=t.consume(r.e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(e=new Date,this._photosNextLinkSkipToken={},r){case"album":return[3,1];case"tag":return[3,3];case"folder":return[3,5];case"onthisday":case"lastweekpreviousyears":case"onthismonth":return[3,7]}return[3,9];case 1:return[4,this._getGroupToCountForSingleAlbum(r,t,n)];case 2:case 8:case 10:return o=a.sent(),[3,11];case 3:case 9:return[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 4:return s=a.sent(),o=this._reduceGroupToCount(s,t,[t,t,t],[t,t,t]),[3,11];case 5:return void 0===i&&this._indexToDateMapper.clearGroupToCountsData(),[4,this._getGroupToCountForAllPhotos(r,t,n,i)];case 6:return s=a.sent(),this._indexToDateMapper.updateGroupToCountsData(r,t,s,i),o=s,[3,11];case 7:return[4,this._getGroupToCountForMOJ(t,n,i,r)];case 11:return this._sendGroupToCountPerfTelemetry(e,o.counts.length,r),[2,{counts:o.counts,pageToken:o.pageToken}]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=new Date,"album"===s?[3,1]:[3,3];case 1:return[4,this._getPhotoRecordsForSingleAlbum(e,t,n)];case 2:return d=a.sent(),[3,5];case 3:return[4,this._getPhotoRecordsForAllPhotos(e,t,s,n,i,r,o)];case 4:d=a.sent(),a.label=5;case 5:return this._sendPerfPhotoRecordsTelemetry(c,1,d.length,e,s),[2,d]}})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,y,"folder")];case 1:return[2,a.sent()]}})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._makeQuery=function(e,t,n,i,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,c,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return s="allPhotos.".concat(t,".").concat(n,".").concat(i),(null==o?void 0:o.indexOf("/_api/v2.1"))>=0&&(s+=".V2"),c={apiName:s,path:e,useAuthorizationHeaders:!0,endpoint:o},u=[],Object(d.isFeatureEnabled)(d.AllowTestPhotoNotification)&&(f=this._itemCacheStore.dispatch(Object(m.e)()),Object(l.k)(f)&&u.push("testphotonotification")),this._shouldEnableUtilityFiltering(t,r)&&u.push("applyRecommendationHeuristics"),u.length>0&&(c.headers={prefer:u.join(", ")}),[4,this._vroomDataRequestor.send(c).catch(function(t){throw new Error("error loading "+e)})];case 1:return[2,a.sent()]}})})},e.prototype._shouldEnableUtilityFiltering=function(e,t){switch(e){case"onthisday":return!0;case"onthismonth":return!t||Object(f.e)(t).applyUtilityFiltering;case"lastweekpreviousyears":return!t||Object(p.e)(t).applyUtilityFiltering;default:return!1}},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfullGroupToCountPageSizeIndex,a.label=1;case 1:if(!(o<v.length))return[3,6];s=T(v[o],e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(s,e,S,y,t)];case 3:return c=a.sent(),this._successfullGroupToCountPageSizeIndex=o,[2,c];case 4:return d=a.sent(),r=d,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=i?parseInt(i,10):1,[4,this._getGroupCountWithVariablePageSize(e,t,n,o)];case 1:return s=a.sent(),c=s.value.length>0&&s["@odata.nextLink"],d=s.value,l=d.length,u=c?(o+l).toString():void 0,[4,R(d,e,t,u,r)];case 2:return(f=a.sent())&&f.dates&&f.dates.length>0&&(p=f.dates[f.dates.length-1])&&this._sendLastMediaDateTelemetry(p,e),[2,f]}})})},e.prototype._reduceGroupToCount=function(e,t,n,a){return Object(i.a)(e.counts,t,n,a),{counts:e.counts}},e.prototype._getGroupToCountForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._makeQuery(U(t,n),e,S,y,t)];case 1:return i=a.sent(),r=i.bundle.childCount,o=[i.name,i.name,i.name],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[],pageToken:void 0}]}})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,u,f,p,m,_,h,b,v,y;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return c=e+1,0===e&&(this._photosNextLinkSkipToken={}),u=this._indexToDateMapper.calculateDateAndOffsetOfIndex(n,i,e),f=u.date,p=u.index,m=new Date("01/01/1900"),f&&void 0!==p&&(c-=p),_=this._getServerSkipToken(e,n,i),h=Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M),[4,this._makeQuery(P(c,t-e,n,i,r,o,f,m,_),n,"records",s,i,h?Object(l.l)({apiVersion:"v2.1",driveId:"me"}):void 0)];case 1:if(!(b=a.sent()))throw new Error("Did not receive a response while requesting photos for the CoreApi");if(b.error)throw new Error("Received an error response from CoreApi, it's likely that the auth data has expired. Please relaunch the proxy server with updated credentials.");return v=b["@odata.nextLink"],this._storeServerSkipToken(t,v,n,i),y=[],b.value.map(function(e){y.push(function(e){var t=[];e.thumbnails&&e.thumbnails[0]&&(t=[F(e.thumbnails[0].small),F(e.thumbnails[0].medium),F(e.thumbnails[0].large)]);var n=e.location;return{id:e.id,thumbnails:t,name:e.name||e.id,location:n?n.address:void 0,dateTakenTime:H(e),isVideo:!1,driveItem:e}}(e))}),[2,y]}})})},e.prototype._storeServerSkipToken=function(e,t,n,a){if(t&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)){var i=t.split("$skiptoken=");if(2===i.length){this._photosNextLinkSkipToken[n+a]||(this._photosNextLinkSkipToken[n+a]={});var r=i[1];Object(d.isFeatureEnabled)(d.UpdateOdcPhotoApiForConvergence)&&Object(g.e)(l.M)&&(r=r.split("&")[0]),this._photosNextLinkSkipToken[n+a][e]=r}}},e.prototype._getServerSkipToken=function(e,t,n){return this._photosNextLinkSkipToken[t+n]&&this._photosNextLinkSkipToken[t+n][e]&&Object(d.isFeatureEnabled)(d.UseSkipTokenForVroom)?this._photosNextLinkSkipToken[t+n][e]:""},e.prototype._getGroupToCountForMOJ=function(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=this._itemCacheStore.dispatch(Object(b.e)(function(e){return e.demandItemFacet(h.e,_.e)})),s=o&&o.isEnableMonthRecapGroupHeaderExpOn(),[4,this._getGroupToCountForAllPhotos(r,e,t,n,s)];case 1:return c=a.sent(),(d=c.counts).forEach(function(e){e.headers&&e.headers.length>=3&&(e.headers=[e.headers[2],e.headers[2],e.headers[2]]),e.labels&&e.labels.length>=3&&(e.labels=[e.labels[2],e.labels[2],e.labels[2]])}),"lastweekpreviousyears"===r&&Object(i.n)(d),"onthismonth"===r&&Object(f.e)(e).applyUtilityFiltering&&!s&&Object(i.a)(d,"onthismonth",["onthismonth","onthismonth","onthismonth"],["onthismonth","onthismonth","onthismonth"]),l=d.reduce(function(e,t){return e+t.count},0),this._logTelemetry("AllPhotos.ElementsCount",{count:l},r),[2,{counts:d,pageToken:c.pageToken}]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){throw new Error("Not implemented")})})},e.prototype._logTelemetry=function(e,t,n){this._engagement&&this._engagement.logData({name:(s.e[n]||"unknown")+"."+e,extraData:t})},e.prototype._sendGroupToCountPerfTelemetry=function(e,t,n){var a=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:a,groups:t,requests:1},n)},e.prototype._sendPerfPhotoRecordsTelemetry=function(e,t,n,a,i){var r=(new Date).getTime()-e.getTime();this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:r,count:n,requests:t,skip:a,api:"vroom"},i)},e.prototype._sendLastMediaDateTelemetry=function(e,t){var n=e.toISOString();this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:n},t)},e}();function x(e,t){var n,a,i,r="/drives/"+t+"/items/root/items?$filter=photo+ne+null",s=e.split(o.e),c=null===(n=s[0])||void 0===n?void 0:n.replace(/'/g,"''"),d=null===(a=s[1])||void 0===a?void 0:a.replace(/'/g,"''"),l=null===(i=s[2])||void 0===i?void 0:i.replace(/'/g,"''");return c&&(r+="+and+location/address/countryOrRegion+eq+'"+c+"'"),d&&(r+="+and+location/address/state+eq+'"+d+"'"),l&&(r+="+and+location/address/city+eq+'"+l+"'"),r}function C(e,t){return"/drives/"+t+"/items/root/items?$filter=photo+ne+null+and+tags/any(tag:tag/name+eq+'"+e+"')"}function O(e,t){var n="",a="";if(e){var i=new Date(e);i.setUTCHours(23,59,59,999),n="+and+photo/takenDateTime+le+"+i.toISOString()}if(t){var r=new Date(t);r.setUTCHours(0,0,0,0),a="+and+photo/takenDateTime+ge+"+r.toISOString()}return n+a}function w(e,t,n,a){return"/drives/"+t+"/items/"+e+"/items?filter=photo+ne+null"+O(n,a)}function E(e,t,n,a){var i=Object(u.e)(e),r=i.date,o=i.resourceId,s=new Date(Date.now()),c=r.getFullYear()%4==0&&r.getFullYear()%100!=0||r.getFullYear()%400==0,d=1===r.getMonth()&&29===r.getDate();if(s.getFullYear()===r.getFullYear()){var l=c&&d?r.getFullYear()-4:r.getFullYear()-1;r.setFullYear(l)}var f=k(r);return"/drives/"+t+"/items/"+o+"/items?filter=photo+ne+null"+O(f,f)+"&interval=R/P1Y"}function A(e,t){var n=Object(f.e)(e),a=n.date,i=n.resourceId,r=new Date(Date.UTC(a.getFullYear(),a.getMonth(),1));return"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(new Date(Date.UTC(a.getFullYear(),a.getMonth()+1,0)),r)+"&interval=R1/P1Y"}function L(e,t){var n=Object(p.e)(e),a=n.date,i=n.resourceId;if(new Date(Date.now()).getFullYear()===a.getFullYear()){var r=a.getFullYear()-1;a.setFullYear(r)}var o=k(a),s=k(a);return s.setDate(s.getDate()+6),"/drives/"+t+"/items/"+i+"/items?filter=photo+ne+null"+O(s,o)+"&interval=R/P1Y"}function k(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0))}function M(e,t){var n="";return e>1&&(n="&skiptoken="+e+"/"+t),n}function P(e,t,n,a,i,r,o,s,c){var d="";switch(n){case"folder":d=w(a,i,o,s);break;case"place":d=x(a,i);break;case"tag":d=C(a,i);break;case"onthisday":d=E(a,i);break;case"onthismonth":d=A(a,i);break;case"lastweekpreviousyears":d=L(a,i)}return(d+="&orderby=photo/takenDateTime+desc&expand=tags,thumbnails&top="+t)+(c?"&skiptoken="+c:M(e,r))}function T(e,t,n,a,i){var r="";switch(t){case"folder":r=w(n,a);break;case"place":r=x(n,a);break;case"tag":r=C(n,a),r+="&expand=tags";break;case"onthisday":r=E(n,a);break;case"onthismonth":r=A(n,a);break;case"lastweekpreviousyears":r=L(n,a)}return(r+="&orderby=photo/takenDateTime+desc&apply=groupby((photo/takenDateTime),aggregate(id+with+countdistinct+as+totalCount))&top="+e)+M(i,i)}function U(e,t){return"/drives/"+t+"/bundles/"+e}function F(e){return e?{url:e.url,width:e.width,height:e.height}:{url:"",width:0,height:0}}function H(e){var t=new Date;if(e.photo&&e.photo.takenDateTime)t=new Date(e.photo.takenDateTime);else if(e.photo&&e.photo.alternateTakenDateTime)t=new Date(e.photo.alternateTakenDateTime);else{var n=[];e.fileSystemInfo&&e.fileSystemInfo.createdDateTime&&n.push(new Date(e.fileSystemInfo.createdDateTime).getTime()),e.fileSystemInfo&&e.fileSystemInfo.lastModifiedDateTime&&n.push(new Date(e.fileSystemInfo.lastModifiedDateTime).getTime()),e.createdDateTime&&n.push(new Date(e.createdDateTime).getTime()),e.lastModifiedDateTime&&n.push(new Date(e.lastModifiedDateTime).getTime()),n.length>0&&(t=new Date(Math.min.apply(Math,n)))}return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function R(e,t,n,r,o){return Object(a.__awaiter)(this,void 0,void 0,function(){var s,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:s={counts:[],dates:[],pageToken:r},d=0,a.label=1;case 1:return d<e.length?(function(e,t,n,a,r,o,s){for(var c=Math.min(t+25,e.length),d=t;d<c;++d){var l=e[d],u=new Date(l.photo.takenDateTime);a.counts.push(Object(i.e)(u,l.totalCount,r,o,s)),a.dates.push(u)}}(e,d,0,s,t,n,o),[4,Object(c.t)(0)]):[3,4];case 2:a.sent(),a.label=3;case 3:return d+=25,[3,1];case 4:return[2,s]}})})}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(143),i=n(1833),r=n(1834),o=n(11);function s(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.EnableNewCarouselDesign)||Boolean(t&&t.isEnableNewCarouselDesignExpOn())}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0),i=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return Object(a.__extends)(t,e),t.prototype.apply=function(e){return void 0===e&&(e=this._value),e},t}(n(68).t)}],Array(20),[function(e,t,n){"use strict";n.d(t,"e",function(){return V});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(1112),c=n(809),d=n(30),l=n(14),u=new d.e("placeSet",{placesRootKeyPart:c.e.subKeyPart,filter:l.e}),f=n(576),p=n(7),m=n(19),_=n(89),h=n(0),b=n(382),g=n(107),v=n(2097),y=n(1007),S=n(137),D=n(286),I=n(983);function x(e){var t=e&&e.address;return[t&&t.countryOrRegion,t&&t.countryOrRegion,t&&t.countryOrRegion].join(I.t)}var C=n(2119),O=n(1942);function w(e,t,n,a,i){var r=[];return e&&r.push(e),t&&r.push(t),n&&r.push(n),a&&r.push(a),r.length>1?r[0]+", "+r[r.length-1]:i||""}var E=n(2791),A=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=c.e.deserialize(n),i=a.driveId,r=a.endpoint,o=v.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,l,v,I,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z,$;return Object(h.__generator)(this,function(ee){switch(ee.label){case 0:return t=Date.now(),s={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/view.listLocations")},[4,e(Object(g.t)(s))];case 1:return c=ee.sent().value,d=Date.now()-t,l=Date.now(),v=function(e){var t=[];if(e&&e.length){for(var n=e[0].location&&e[0].location.address&&e[0].location.address.countryOrRegion||"",a={displayName:n,places:[]},i=0,r=e;i<r.length;i++){var o=r[i],s=o.location&&o.location.address&&o.location.address.countryOrRegion||"";n!==s&&(t.push(a),a={displayName:n=s,places:[]}),a.places.push(o)}t.push(a)}return t}(c),I=new b.e,A=[],[4,e(Object(y.e)(function(e){return e.demandItemFacet(m.e,o)}))];case 2:for((L=ee.sent())&&0===L.itemKeys.length||A.push(o),k=0,M=v;k<M.length;k++){for(P=M[k],T={placesRootKeyPart:{driveId:i,endpoint:r},filter:P.displayName},U=u.serialize(T),F=[],H=0,R=P.places;H<R.length;H++)N=R[H],B=N.location&&N.location.address,j=B&&B.countryOrRegion?B.countryOrRegion:"",V=B&&B.state?B.state:"",z=B&&B.locality?B.locality:"",G=B&&B.city?B.city:"",K=f.e.serialize({placesRootKeyPart:a,countryOrRegion:j,state:V,locality:z,city:G}),W=w(G,z,V,"",null===($=N.location)||void 0===$?void 0:$.displayName),q=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(N.location),filterType:"place"}),Q=N.previewThumbnails&&Object(C.e)(N.previewThumbnails),I.resolveItems({items:(J={},J[K]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(W)),m.t.pack({itemKey:q})),_.h.pack(Q)),J)}),F.push(K);I.resolveItems({items:(X={},X[U]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.displayName)),m.e.pack({itemKeys:F})),X)}),A.push(U)}return I.resolveItems({items:(Z={},Z[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(E.e)),m.e.pack({itemKeys:A})),Z)}),e(I.execute()),Y=Date.now()-l,e(Object(O.e)({name:"Places.GetAllPlaces",extraData:{fetchTimeMs:d,processTimeMs:Y,placesCount:(null==c?void 0:c.length)||0,groupsCount:v.length}})),[2]}})})}}),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=u.deserialize(n).placesRootKeyPart,i=c.e.serialize(a);return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){return Object(h.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(y.e)(function(e){e.demandItemFacet(m.e,i)}))];case 1:return t.sent(),[2]}})})}}),k=n(990),M=Object(a.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,a=f.e.deserialize(n),i=a.placesRootKeyPart,o=a.countryOrRegion,s=a.state,c=a.city,d=i.driveId,l=i.endpoint;return o=null==o?void 0:o.replace(/'/g,"''"),s=null==s?void 0:s.replace(/'/g,"''"),c=null==c?void 0:c.replace(/'/g,"''"),function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,a,i,u,f,p,b,v,y;return Object(h.__generator)(this,function(I){switch(I.label){case 0:return t="photo ne null",t+=o?" and location/address/countryOrRegion eq '".concat(o,"'"):"",t+=s?" and location/address/state eq '".concat(s,"'"):"",t+=c?" and location/address/city eq '".concat(c,"'"):"",a=Object(k.e)({filter:t,orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:1,select:"id,thumbnails,location"}),i={qosName:"allPlaces",endpoint:l,driveId:d,url:"".concat(l,"/drives/").concat(d,"/items/root/items?").concat(a)},[4,e(Object(g.t)(i))];case 1:return u=I.sent().value,f=u&&u.length&&u[0].thumbnails&&u[0].thumbnails[0],p=f&&f.medium?{url:f.medium.url,width:f.medium.width,height:f.medium.height}:void 0,b=u[0]&&u[0].location,v=S.e.serialize({photosRootKeyPart:{driveId:d,endpoint:l},groupBy:D.e.Date,filter:x(b),filterType:"place"}),e(Object(r.e)({items:(y={},y[n]=Object(h.__assign)(Object(h.__assign)({},_.h.pack(p)),m.t.pack({itemKey:v})),y)})),[2]}})})}}),P=n(2792),T=n(440),U=n(55),F=n(369),H=n(1103),R=n(2033),N=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=v.e.deserialize(n),i=a.driveId,r=a.endpoint;return function(e){return Object(h.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,l,u,v,y,I,C,O,E,A,L,M,N,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue;return Object(h.__generator)(this,function(fe){switch(fe.label){case 0:return t=Object(k.e)({filter:"photo ne null",orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium)",top:100,select:"id,thumbnails,location"}),o={qosName:"allPlaces",endpoint:r,driveId:i,url:"".concat(r,"/drives/").concat(i,"/items/root/items?").concat(t)},[4,e(Object(g.t)(o))];case 1:if(s=fe.sent().value,c=[],d=new Map,l=new Map,u=new Map,v=0,s&&s.length)for(y=0;v<2&&y<s.length;y++)(I=s[y])&&I.location&&I.location.displayName&&I.location.latitude&&I.location.longitude&&((C=u.get(I.location.displayName))||u.set(I.location.displayName,I),O=l.get(I.location.displayName),E=O?O+1:1,l.set(I.location.displayName,E),3===E&&(v++,C&&d.set(I.location.displayName,C)),d.has(I.location.displayName)||d.set(I.location.displayName,I));if(A=Array.from(d.values()),L=A[0],M=A.slice(1),L){for(N=0,V=M;N<V.length;N++)if(z=V[N],G=L.location,K=null==z?void 0:z.location,z&&B(G)&&B(K)&&j(G,K,50)){c.push(z);break}c.unshift(L)}for(W=new b.e,q=[],Q=0,Y=c;Q<Y.length;Q++)J=Y[Q],X=J.location&&J.location.address,Z=X&&X.countryOrRegion?X.countryOrRegion:"",$=X&&X.state?X.state:"",ee=X&&X.locality?X.locality:"",te=X&&X.city?X.city:"",ne=f.e.serialize({placesRootKeyPart:a,countryOrRegion:Z,state:$,locality:ee,city:te}),ae=w(te,ee,$,Z,null===(ue=J.location)||void 0===ue?void 0:ue.displayName),ie=J.thumbnails&&J.thumbnails.length&&J.thumbnails[0],re=ie&&ie.medium?{url:ie.medium.url,width:ie.medium.width,height:ie.medium.height}:void 0,oe=S.e.serialize({photosRootKeyPart:{driveId:i,endpoint:r},groupBy:D.e.Date,filter:x(J.location),filterType:"place"}),se=F.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),ce=H.e.serialize({driveId:i,endpoint:r,type:U.e.PromotedPlaces,resourceId:"root",key:ne,filter:[Z,$,te||ee].join(String.fromCharCode(9))}),W.resolveItems({items:(de={},de[ne]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[se]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),T.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de[ce]=Object(h.__assign)(Object(h.__assign)(Object(h.__assign)(Object(h.__assign)({},p.u.pack(ae)),R.e.pack(U.e.PromotedPlaces)),_.h.pack(re)),m.t.pack({itemKey:oe})),de)}),q.push(ne);return W.resolveItems({items:(le={},le[n]=Object(h.__assign)(Object(h.__assign)({},p.u.pack(P.e)),m.e.pack({itemKeys:q})),le)}),e(W.execute()),[2]}})})}});function B(e){return Boolean((null==e?void 0:e.latitude)&&e.longitude)}function j(e,t,n){var a=Math.PI/180,i=(t.latitude-e.latitude)*a,r=(t.longitude-e.longitude)*a,o=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(r/2),2)*Math.cos(e.latitude*a)*Math.cos(t.latitude*a);return 3959*Math.asin(Math.sqrt(o))*2>=n}var V=Object(a.t)(function(){return function(e){e(s.e),e(Object(r.t)({keyFacet:c.e,facets:[m.e]})),e(Object(r.t)({keyFacet:u,facets:[p.u,m.e]})),e(Object(r.t)({keyFacet:f.e,facets:[p.u,_.h]})),e(Object(i.a)(c.e,o.e)(A)),e(Object(i.a)(f.e,o.e)(M)),e(Object(i.a)(u,o.e)(L)),e(Object(i.a)(v.e,o.e)(N))}})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1109),_=n(1885),h=n(1884),b=n(286),g=n(1007),v=n(1816),y=n(1864),S=n(137),D=n(1775),I=n(143),x=n(812),C=n(55),O=n(2033),w=n(1103),E=n(2285),A=n(299),L=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=e.options.demands,i=m.e.deserialize(n),o=new Date(i.date);return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,m,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y;return Object(f.__generator)(this,function(J){switch(J.label){case 0:return M=Object(x.t)(o,i.resourceId),(P=e(Object(I.e)(function(e){return e.demandItemFacet(D.e,D.t)})))?(T=e(Object(I.e)(function(e){return{hasCount:e.isItemFacetResolved(d.e,n),hasThumbnail:e.isItemFacetResolved(l.h,n)}})),U=T.hasCount,F=T.hasThumbnail,H="carousel",F&&U&&(H="carouselDupeCall"),[4,P.getPhotoRecords(0,1,M,i.driveId,1,H,"onthisday")]):[2];case 1:return R=J.sent(),(N=R&&R.length>0?null===(Y=R[0])||void 0===Y?void 0:Y.driveItem:void 0)&&(B=N.thumbnails[0],(j=B.large||B.medium||B.small)&&(t={url:j.url,width:j.width,height:j.height}),m=o.toString(),L=o),void 0!==m&&L?(V=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),z=new p.e,G=i.driveId,K=i.endpoint,W=w.e.serialize({driveId:G,endpoint:K,type:C.e.OnThisDay,resourceId:"root",key:n}),z.resolveItems({items:(q={},q[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:L,maxDate:L})),s.t.pack({itemKey:V})),q[W]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(A.l)),u.i.pack(L.toString())),O.e.pack(C.e.OnThisDay)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:V})),q)}),e(z.execute()),e(Object(E.e)())?[3,3]:a[d.e.id]?[4,e(Object(g.e)(function(e){var t=S.e.serialize({photosRootKeyPart:i,groupBy:b.e.Date,filter:M,filterType:"onthisday"}),n=y.e.serialize({photosRootItemSetKeyPart:S.e.deserialize(t)});return e.demandItemFacet(v.a,n)}))]:[3,3]):[3,3];case 2:k=J.sent(),e(Object(r.e)({items:(Q={},Q[n]=Object(f.__assign)({},d.e.pack(k)),Q)})),J.label=3;case 3:return[2]}})})}}),k=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(L))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1110),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(818),D=n(42),I=n(299),x=n(55),C=n(2033),O=n(1103),w=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(a.date),o=new Date(Date.UTC(r.getFullYear(),r.getMonth()+1,0));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,r,d,m,w,E,A,L,k,M,P,T,U,F,H,R,N;return Object(f.__generator)(this,function(B){switch(B.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),w=new p.e,E=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"onthismonth"}),(A=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,A.getPhotoRecords(0,3,m,a.driveId,3,"carousel","onthismonth")]:[2];case 1:return L=B.sent(),k=L.find(function(e){return e.isVideo}),L.length<3&&!k||((M=L&&L.length>0?null===(N=L[0])||void 0===N?void 0:N.driveItem:void 0)&&(P=M.thumbnails[0],(T=P.large||P.medium||P.small)&&(t={url:T.url,width:T.width,height:T.height}),r=D.format(I.u,i.toLocaleString("default",{month:"long"})),d=i),U=a.driveId,F=a.endpoint,H=O.e.serialize({driveId:U,endpoint:F,type:x.e.OnThisMonth,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==r&&d&&(w.resolveItems({items:(R={},R[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:o})),s.t.pack({itemKey:E})),R[H]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(r)),u.i.pack(d.toString())),C.e.pack(x.e.OnThisMonth)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:E})),R)}),e(w.execute()))),[2]}})})}}),E=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(w))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(28),i=n(311),r=n(209),o=n(379),s=n(19),c=n(7),d=n(70),l=n(89),u=n(392),f=n(0),p=n(382),m=n(1111),_=n(1885),h=n(1884),b=n(286),g=n(137),v=n(1775),y=n(143),S=n(819),D=n(299),I=n(55),x=n(1103),C=n(2033),O=Object(a.i)()(function(e){var t=this,n=e.itemKey,a=m.e.deserialize(n),i=new Date(a.date),r=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()+6));return function(e){return Object(f.__awaiter)(t,void 0,void 0,function(){var t,o,d,m,O,w,E,A,L,k,M,P,T,U,F,H,R;return Object(f.__generator)(this,function(N){switch(N.label){case 0:return m=Object(S.t)(i,a.resourceId,a.applyUtilityFiltering),O=new p.e,w=g.e.serialize({photosRootKeyPart:a,groupBy:b.e.Date,filter:m,filterType:"lastweekpreviousyears"}),(E=e(Object(y.e)(function(e){return e.demandItemFacet(v.e,v.t)})))?[4,E.getPhotoRecords(0,3,m,a.driveId,3,"carousel","lastweekpreviousyears")]:[2];case 1:return A=N.sent(),L=A.find(function(e){return e.isVideo}),A.length<3&&!L||((k=A&&A.length>0?null===(R=A[0])||void 0===R?void 0:R.driveItem:void 0)&&(M=k.thumbnails[0],(P=M.large||M.medium||M.small)&&(t={url:P.url,width:P.width,height:P.height}),o=D.c,d=i),T=a.driveId,U=a.endpoint,F=x.e.serialize({driveId:T,endpoint:U,type:I.e.LastWeekPreviousYears,resourceId:"root",key:n,date:a.date,applyUtilityFiltering:a.applyUtilityFiltering}),void 0!==o&&d&&(O.resolveItems({items:(H={},H[n]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),l.h.pack(t)),c._.pack({})),h.e.pack(!1)),_.e.pack({minDate:d,maxDate:r})),s.t.pack({itemKey:w})),H[F]=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},c.u.pack(o)),u.i.pack(d.toString())),C.e.pack(I.e.LastWeekPreviousYears)),l.h.pack(t)),c._.pack({})),s.t.pack({itemKey:w})),H)}),e(O.execute()))),[2]}})})}}),w=Object(a.t)(function(){return function(e){e(Object(r.t)({keyFacet:m.e,facets:[s.t,c.u,d.e,u.i,l.h,h.e,_.e]})),e(Object(i.a)(m.e,o.e)(O))}})},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("galleryHeader",{label:a.t,count:a.t,dateRange:a.t})},function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return c});var a=n(2),i=n(559),r=n(919),o=new a.e("updateTags"),s=new i.e("updateTags"),c=Object(r.e)({operationTypeFacet:o,progressKeyFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(42);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}}],Array(37),[function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return c});var a=n(1743);function i(e){return Object(a.i)(e,!1,!1,!1,{displayHoursInDates:!1,displayHoursToOneDay:!1,displayMinutesToOneHour:!1,displayShortenedWeekday:!1})}var r=Object(a.t)({month:"short",day:"numeric",year:"numeric"}),o=Object(a.t)({month:"long",year:"numeric"}),s=Object(a.t)({month:"short",year:"numeric"}),c=Object(a.t)({month:"long",day:"numeric"})},function(e,t,n){"use strict";var a=n(0),i=n(22),r=n(56),o=n(2078),s=n(2160),c=n(1799),d=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.extractSharedAlbumsFromItemSet=function(e){for(var t=this,n=[],a=0,i=e.content.peek().items;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);o.isAlbum&&o.ownerId!==c.t.viewerId&&n.push(r)}return n.sort(function(e,n){return t.peekUnwrapObservable(n).dateSharedTime.getTime()-t.peekUnwrapObservable(e).dateSharedTime.getTime()})},t.prototype.getTagsAndPlaces=function(e,t){for(var n=[],a={},i=[],r={},o=0;o<100;o++){var s=e[o];if(!s)break;var c=s.peek(),d=c.tags&&c.tags.length>0,l=c.geoLocation&&c.geoLocation.hierarchyIndex;d&&l?Math.random()<.5?this._makeTagEntry(c,a,n,t):this._makePlaceEntry(c,r,i,t):d?this._makeTagEntry(c,a,n,t):l&&this._makePlaceEntry(c,r,i,t)}return{tags:n,places:i}},t.prototype._makePlaceEntry=function(e,t,n,a){var i=e.geoLocation,r=i&&i.hierarchyIndex;if(r&&e.thumbnail){var o=t[r];if(!o){var s=this._makePlace(i,a);o=t[r]=s,n.push(s)}var c=o.peek();c.folder.covers?c.folder.covers.push(e.thumbnail):c.folder.covers=[e.thumbnail],o(c)}},t.prototype._makeTagEntry=function(e,t,n,a){var i=e.tags[Math.floor(Math.random()*e.tags.length)],r=t[i.tag];if(!r){var o=this._makeTag(i,a);r=t[i.tag]=o,n.push(o)}var s=r.peek();s.folder.covers?s.folder.covers.push(e.thumbnail):s.folder.covers=[e.thumbnail],r(s)},t.prototype._makeTag=function(e,t){var n={count:0,localizedTag:e.localizedTag,tag:e.tag};return i.observable(s.n(o.e.allTags,n,null,t))},t.prototype._makePlace=function(e,t){return i.observable(s.n(o.e.allPlaces,null,e,t))},t}(r.n);t.e=d},function(e,t,n){"use strict";var a=n(0),i=n(60),r=n(56),o=n(61),s=n(95),c=n(2098),d=n(1740),l=n(36),u=n(11),f=n(1087),p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._promotedPhotosDataSource=n.resources.consume(o.Q),n._albumProvider=n.resources.consume(c.resourceKey),n._photoProvider=n.resources.consume(s._),n._itemProvider=n.resources.consume(d.resourceKey),n._urlDataSource=n.resources.consume(o.Se),n}return Object(a.__extends)(t,e),t.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&f.r(t)||!Object(u.isFeatureEnabled)(u.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})},t.prototype.getTagsAndPlaces=function(e){var t=this,n=this._photoProvider.getAllPhotosSync(e);return this._photoProvider.getAllPhotosForPage(e).then(function(){var a=n.content().items;return t._promotedPhotosDataSource.getTagsAndPlaces(a,e)})},t.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var n={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},a=this._photoProvider.getAllPhotosSync(n),r=a.item,o=r.peek();return a.isPlaceholder||a.isExpired||o.isPlaceholder?this._photoProvider.getOnThisDayPhotos(n).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):o.folder.covers.length?i.n.wrap([r]):i.n.wrap([])},t.prototype.getSharedAlbums=function(){var e=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(l.e.SharedWithMe)}).then(function(t){return e._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(t)})},t}(r.n);t.e=p}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return xn});var a=n(0),i=n(28),r=n(201),o=n(209),s=n(311),c=n(379),d=n(654),l=n(9),u=n(274),f=n(137),p=n(1864),m=n(30),_=n(14),h=n(547),b=new m.e("allPhotosGroupToCountItemPageFacet",{groupToCountsItemKeyPart:p.e.subKeyPart,pageToken:_.e,offset:h.e}),g=n(1890),v=n(1940),y=n(1163),S=n(143),D=n(382),I=n(70),x=n(234),C=n(797),O=n(1816),w=n(1957),E=new m.e("widthsItemKeyFacet",{photosRootItemSetKeyPart:f.e.subKeyPart}),A=n(1775),L=n(2142),k=n(2052),M=n(19),P=n(672),T=n(627),U=n(2),F=n(1540),H=n(135),R=n(1271);function N(e,t){var n=0,a=[],i=[],r=Object(x.e)();if(p.e.matches(t))for(var o=p.e.deserialize(t).photosRootItemSetKeyPart,s=0;s<e.length;++s){var c=e[s];a.push(n),n+=c.count;var d=g.e.serialize({photosRootItemSetKeyPart:o,id:c.id});i.push(d),r=r.forFacet(M.e).thenInvalidate(d,M.e)}return{groupKeys:i,totalPhotoCount:n,groupToStart:a,invalidationFacet:r}}function B(e,t,n,i,o){var s,c,d,l,u;void 0===o&&(o=[]);var m=new D.e,_=n.counts;if(p.e.matches(t)){var h=p.e.deserialize(t).photosRootItemSetKeyPart,y=i+_.length,x=o.slice(0,i);if(x=x.concat(_),n.pageToken){var C=_[_.length-1],w=C.id,E=-1;if(C)for(var L=i;L<o.length-1;L++)if(o[L].id===w){E=L+1;break}y=E>=0?E:y,x=x.concat(o.slice(y))}var k=N(x,t),B=k.groupKeys,j=k.totalPhotoCount,V=k.groupToStart,z=k.invalidationFacet;if(n.pageToken){var G=b.serialize({groupToCountsItemKeyPart:{photosRootItemSetKeyPart:h},pageToken:n.pageToken,offset:y});m.merge(Object(P.t)({itemKey:G}).itemResolver),m.resolveItems({items:(s={},s[t]=Object(a.__assign)({},M.e.pack({itemKeys:[G]})),s)})}else m.resolveItems({items:(c={},c[t]=Object(a.__assign)({},M.e.pack({itemKeys:[]})),c)});var K=e(Object(S.e)(function(e){return e.demandItemFacet(A.d,r.e)})),W=f.e.serialize(h);if(m.resolveItems({items:(d={},d[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(x)),O.a.pack(j)),O.n.pack(V)),d[W]=K?Object(a.__assign)({},I.e.pack(j)):Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},I.e.pack(x.length)),M.e.pack({itemKeys:B})),z.pack()),d)}),K){if(_.length>0||n.pageToken){var q=f.e.serialize(h);e(Object(T.e)({items:(l={},l[q]=[O.t],l)}))}}else{var Q=function(e,t,n,a,i){for(var r=[],o=a;o<a+i;++o)Object(R.e)(e[o],t[o])||r.push(n[o]);return r}(x,o,B,i,y-i);m.invalidateItems({items:Object(H.e)(Q,function(){return[M.e]})});var Y=e(Object(S.e)(function(e){return e.demandItemFacet(M.e,f.e.serialize(h))}));if(Y){var J=Y.itemKeys.length-1,X=Y.itemKeys[J],Z=x[J],$=e(Object(S.e)(function(e){if(e.isItemFacetResolved(I.e,X))return e.demandItemFacet(I.e,X)}));if($&&Z&&$<Z.count&&g.e.matches(X)){var ee=g.e.deserialize(X);if(ee.id===Z.id){var te=v.e.serialize({groupKeyPart:ee,offset:$+V[J],count:Z.count-$});m.resolveItems({items:(u={},u[X]=Object(U.t)({childItems:M.e},{childItems:{itemKeys:new F.e([te])}}),u)})}else console.warn("GroupToCount patching groups did not match indicies!")}}}}else console.warn("Key ",t," was not a valid AllPhotosGroupToCountItemKey. Unable to resolve GroupToCount!");return m}var j=n(2118),V=new U.e("PhotoRotation"),z=n(7),G=n(89),K=n(929),W=n(578),q=n(47),Q=n(403),Y=n(2119);function J(e,t,n){return n.driveItem?X(e,t,n.driveItem):Z(e,t,n)}function X(e,t,n){return function(i){var r,o=new D.e({publisher:X});if(l.e.matches(e)){var s=l.e.deserialize(e),c=s.driveId,d=s.endpoint,u=void 0;n.parentReference&&(u=l.e.serialize({itemId:n.parentReference.id,driveId:c,endpoint:d})),o.merge(i(Object(W.e)({itemKey:e,driveItemKey:{endpoint:d,driveId:c,itemId:n.id},driveItem:n,endpoint:d,parentFolderItemKey:u})).itemResolver);var f=n.thumbnails?Object(Y.e)(n.thumbnails):void 0,p=void 0;n.location&&(p=Object(a.__assign)(Object(a.__assign)({},n.location.address?n.location.address:{}),{longitude:n.location.longitude,altitude:n.location.altitude,latitude:n.location.latitude}));var m=n.photo||n.remoteItem&&n.remoteItem.photo,_=n.video||n.remoteItem&&n.remoteItem.video,h=_&&void 0!==_.audioBitsPerSample&&void 0!==_.audioChannels&&_.audioFormat&&void 0!==_.audioSamplesPerSecond,b=function(e){var t=void 0;if(e.photo&&e.photo.takenDateTime)t=new Date(e.photo.takenDateTime).getTime();else{var n=[];e.fileSystemInfo&&e.fileSystemInfo.createdDateTime&&n.push(new Date(e.fileSystemInfo.createdDateTime).getTime()),e.fileSystemInfo&&e.fileSystemInfo.lastModifiedDateTime&&n.push(new Date(e.fileSystemInfo.lastModifiedDateTime).getTime()),e.createdDateTime&&n.push(new Date(e.createdDateTime).getTime()),e.lastModifiedDateTime&&n.push(new Date(e.lastModifiedDateTime).getTime()),n.length>0&&(t=Math.min.apply(Math,n))}return t}(n),g=n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime,v=n.tags;o.resolveItems({items:(r={},r[e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack({itemId:n.id,driveId:c,endpoint:d})),z.u.pack(n.name)),z.p.pack(Object(W.t)(n.name?n.name:"",!1))),V.pack(void 0)),M.t.pack({itemKey:q.e.serialize({driveItemKey:l.e.deserialize(e),sortBy:"",isAscending:!0})})),Q.e.pack(n["@microsoft.graph.downloadUrl"]||n["@content.downloadUrl"])),Object(x.e)().forFacet(M.t).thenInvalidate(e,V).forFacet(M.t).thenInvalidate(e,z.u).forFacet(M.t).thenInvalidate(e,G.h).forFacet(G.h).thenInvalidate(t,M.e).forFacet(V).thenInvalidate(t,M.e).pack()),f?G.h.pack(f):{}),j.e.pack(p)),n.image?G.d.pack({height:n.image.height?n.image.height:0,width:n.image.width?n.image.width:0}):{}),n.video&&!n.image?G.d.pack({height:n.video.height?n.video.height:0,width:n.video.width?n.video.width:0}):{}),m?G.m.pack({}):{}),m&&m.cameraMake?G.o.pack(m.cameraMake):{}),m&&m.cameraModel?G.s.pack(m.cameraModel):{}),m&&m.fNumber?G.a.pack(m.fNumber):{}),m&&m.focalLength?G.i.pack(m.focalLength):{}),m&&m.exposureDenominator&&m.exposureNumerator?G.n.pack({denominator:m.exposureDenominator,numerator:m.exposureNumerator}):{}),m&&m.iso?G.r.pack(m.iso):{}),_?G.g.pack({}):{}),_&&_.bitrate?G.t.pack(_.bitrate):{}),_&&_.duration?G.l.pack(_.duration):{}),_&&_.frameRate?G.f.pack(_.frameRate):{}),_&&_.fourCC?G.u.pack(_.fourCC):{}),_&&h?G.b.pack({bitsPerSample:_.audioBitsPerSample||0,channels:_.audioChannels||0,format:_.audioFormat||"",samplesPerSecond:_.audioSamplesPerSecond||0}):{}),m&&m.livePhoto?G.p.pack({}):{}),m&&m.samsungMotionPhoto?G._.pack({}):{}),b?G.c.pack(b):{}),g?z.c.pack(new Date(g).getTime()):{}),v?K.e.pack(v):{}),r)})}return{itemResolver:o}}}function Z(e,t,n){return function(i){var r,o=new D.e({publisher:Z});if(l.e.matches(e)){var s=n.thumbnails&&n.thumbnails.length>0?n.thumbnails[n.thumbnails.length-1]:void 0,c=l.e.deserialize(e),d=c.driveId,u=c.endpoint;o.resolveItems({items:(r={},r[e]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack({itemId:n.id,driveId:d,endpoint:u})),G.h.pack(s)),z.u.pack(n.name)),z.p.pack({name:n.name,extension:n.extension?n.extension:""})),void 0!==n.isVideo&&n.isVideo?G.g.pack({}):G.m.pack({})),Q.e.pack(n.originalUrl)),j.e.pack(n.location)),V.pack(void 0)),M.t.pack({itemKey:q.e.serialize({driveItemKey:l.e.deserialize(e),sortBy:"",isAscending:!0})})),G.c.pack(n.dateTakenTime.getTime())),Object(x.e)().forFacet(M.t).thenInvalidate(e,V).forFacet(M.t).thenInvalidate(e,z.u).forFacet(M.t).thenInvalidate(e,G.h).forFacet(V).thenInvalidate(t,M.e).pack()),r)})}return{itemResolver:o}}}var $=n(2053),ee=n(2146);function te(e,t,n,i,r){if(f.e.matches(e)&&g.e.matches(t)){var o=g.e.deserialize(t).id,s=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},g.e.pack({photosRootItemSetKeyPart:f.e.deserialize(e),id:o})),z.u.pack(o)),M.e.pack({itemKeys:n})),I.e.pack(n.length)),I.r.pack(!0)),Object(x.e)().forFacet(M.e).thenInvalidate(e,O.t).forFacet(M.e).thenInvalidate(e,M.e).forFacet(M.e).thenInvalidate(t,I.e).pack());return r&&(s=Object(a.__assign)(Object(a.__assign)({},s),$.e.pack({itemKey:r}))),i&&(s=Object(a.__assign)(Object(a.__assign)({},s),ee.e.pack({itemKey:i}))),s}return{}}var ne=n(2145),ae=n(2143),ie=n(2144),re=n(2286),oe=n(577),se=n(1885),ce=n(1941),de=n(2258),le=n(2671),ue=n(983),fe=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=f.e.deserialize(n),o=p.e.serialize({photosRootItemSetKeyPart:i}),s=E.serialize({photosRootItemSetKeyPart:i});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,d,l,u,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return t=e(Object(S.e)(function(e){return{targetHeight:e.demandItemFacet(A.s,A.t),usePhotoPaging:e.demandItemFacet(A.d,r.e)}})),c=t.targetHeight,d=t.usePhotoPaging,(l=new D.e).resolveItems({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},f.e.pack(i)),z.u.pack(le.e)),O.t.pack({itemKey:o})),w.n.pack({itemKey:s})),I.r.pack(!0)),Object(x.e)().forFacet(O.t).thenInvalidate(o,O.e).forFacet(M.e).thenInvalidate(n,O.t).pack()),m[s]=Object(U.t)({widths:w.t,targetHeight:w.e},{widths:new re.e(Object(L.e)(0)),targetHeight:new re.e(c)}),m)}),l.merge(function(e){var t,n,i,r=f.e.deserialize(e),o=r.photosRootKeyPart,s=r.filter,c=r.filterType,d=new D.e,l=void 0;switch(c){case"folder":case"onthisday":case"onthismonth":case"lastweekpreviousyears":break;case"album":l=C.e.serialize({albumsRootKeyPart:o,id:s});break;case"tag":l=oe.e.serialize({tagsRootKeyPart:o,id:s}),d.resolveItems({items:(t={},t[l]=Object(a.__assign)({},z.u.pack(s)),t)});break;case"place":var u=s.split(ue.t).pop();d.resolveItems({items:(n={},n[e]=Object(a.__assign)({},z.u.pack(u)),n)})}return l&&d.resolveItems({items:(i={},i[e]=Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:l})),Object(x.e)().forFacet(M.e).thenInvalidate(l,I.e).forFacet(M.e).thenInvalidate(l,se.e).pack()),i)}),d}(n)),d?(l.merge(function(e,t,n){var i,r=new D.e,o=f.e.deserialize(t),s=e(Object(S.e)(function(e){var a=e.isItemFacetResolved(M.e,t);return{totalCount:e.demandItemFacet(O.a,n),pageSize:e.demandItemFacet(A.r,A.t),currentChildItems:a?e.demandItemFacet(M.e,t):void 0,mappedChildItems:a?e.demandItemFacet(de.e,t):void 0}})),c=s.currentChildItems,d=s.mappedChildItems,l=s.totalCount,u=s.pageSize,p=void 0!==c?c.itemKeys.slice():[];if(void 0===u)throw Error("Page size is not defined, we cannot generate page keys for photos itemset!");var m=0,_=p.length>0&&p[p.length-1];if(_)if(ce.e.matches(_)){var h=ce.e.deserialize(_);m=h.offset+h.count}else void 0!==d&&(m=d.length);if(void 0!==l)for(var b=m;b<l;b+=u){var g=ce.e.serialize({photosRootItemSetKeyPart:o,offset:b,count:Math.min(u,l-b)});p.push(g),r.merge(Object(P.t)({itemKey:g}).itemResolver)}else 0===m&&(g=ce.e.serialize({photosRootItemSetKeyPart:o,offset:0,count:u}),p.push(g),r.merge(Object(P.t)({itemKey:g}).itemResolver));return r.resolveItems({items:(i={},i[t]=Object(a.__assign)({},M.e.pack({itemKeys:p})),i)}),r}(e,n,o)),[3,3]):[3,1];case 1:return p=(u=l).merge,[4,pe(e,n,o,s,c)];case 2:p.apply(u,[_.sent()]),_.label=3;case 3:return e(l.execute()),[2]}})})}});function pe(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,u,p,m,_,h,b;return Object(a.__generator)(this,function(g){switch(g.label){case 0:return o=new D.e,s=f.e.deserialize(t),c=s.photosRootKeyPart,d=s.filter,u=s.filterType,p=e(Object(S.e)(function(e){var n=e.demandItemFacet(M.e,t),a=e.demandItemFacet(A.o,A.t),i=e.demandItemFacet(A.e,A.t);return{hasBurst:n&&n.itemKeys.length>0,burstSize:a,addonSrc:i}})),m=p.burstSize,_=p.addonSrc,h=p.hasBurst,_&&!h&&m&&r&&"folder"===u?[4,_.getPhotoRecordsForBurstMode(m,d,c.driveId)]:[3,2];case 1:(b=g.sent()).length>0&&o.merge(function(e,t,n,i,r,o){var s,c,d,u,p,m=Object(k.t)(n),_=function(e,t){var n=Object(L.e)(t.length);return t.map(function(t,a){var i=t.thumbnails[t.thumbnails.length-1];if(i){var r=Math.round(e*(i.width/i.height));n[a]=r}}),n}(i,n),h=N(m,r),b=h.groupKeys,g=h.totalPhotoCount,v=h.groupToStart,y=h.invalidationFacet,S=new D.e;if(S.resolveItems({items:(s={},s[r]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(m)),O.n.pack(v)),O.a.pack(g)),s[o]=Object(a.__assign)(Object(a.__assign)({},w.t.pack(_)),w.e.pack(i)),s)}),f.e.matches(t)){for(var x=f.e.deserialize(t),C=x.photosRootKeyPart,E=0,A=[{keys:[]}],P=0;P<n.length;++P){var T=n[P],U={itemId:T.id,driveId:C.driveId,endpoint:C.endpoint},F=l.e.serialize(U),H=v[E];P>=H&&P<H+m[E].count?A[E].keys.push(F):A[++E]={keys:[F]};var R=b[E],B=ae.e.serialize({driveItemKeyPart:Object(a.__assign)({},U),photosRootItemSetKeyPart:Object(a.__assign)({},x)}),j=ie.e.serialize({index:P,photosRootItemSetKeyPart:Object(a.__assign)({},x)});R&&(S.merge(e(J(F,R,T)).itemResolver),S.resolveItems({items:(c={},c[B]=Object(a.__assign)({},ne.e.pack({itemKey:R})),c[j]=Object(a.__assign)({},l.e.pack(U)),c)}),T.isVideo&&S.resolveItems({items:(d={},d[F]=Object(a.__assign)({},G.g.pack({})),d)}))}for(var V=0;V<b.length;V++)S.resolveItems({items:(u={},u[b[V]]=Object(a.__assign)({},te(t,b[V],A[V].keys,b[V-1],b[V+1])),u)});S.resolveItems({items:(p={},p[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},I.e.pack(m.length)),M.e.pack({itemKeys:b})),y.pack()),p)})}return S}(e,t,b,r,n,i)),g.label=2;case 2:return[2,o]}})})}var me=n(1007),_e=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=g.e.deserialize(n),r=i.photosRootItemSetKeyPart,o=i.id;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,s,c,d,l,u,p,m,_,h,b,y,S,I,x,C,w,E;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return t=f.e.serialize(r),[4,e(Object(me.e)(function(e){var n,a=e.demandItemFacet(A.r,A.t),i=e.demandItemFacet(O.t,t);return i&&(n=e.demandItemFacet(O.e,i.itemKey),e.demandItemFacet(M.e,i.itemKey)),{maxPageSize:a,groupToCount:n}}))];case 1:if(i=L.sent(),s=i.maxPageSize,(c=i.groupToCount)&&s){for(d=void 0,l=0,u=void 0,p=void 0,m=0;m<c.length;m++){if((_=c[m]).id===o){d=_,c[m+1]&&(u=g.e.serialize({photosRootItemSetKeyPart:r,id:c[m+1].id})),c[m-1]&&(p=g.e.serialize({photosRootItemSetKeyPart:r,id:c[m-1].id}));break}l+=_.count}if(d){for(h=new D.e,b=[],y=d.count,S=l;y>0;)I=y<s?y:s,x=v.e.serialize({groupKeyPart:g.e.deserialize(n),offset:S,count:I}),b.push(x),h.merge(Object(P.t)({itemKey:x}).itemResolver),S+=I,y-=I;h.resolveItems({items:(C={},C[n]=Object(a.__assign)({},te(t,n,b,p,u)),C)}),p&&h.resolveItems({items:(w={},w[p]=Object(a.__assign)({},$.e.pack({itemKey:n})),w)}),u&&h.resolveItems({items:(E={},E[u]=Object(a.__assign)({},ee.e.pack({itemKey:n})),E)}),e(h.execute())}else console.error("photosAddon: Unable to find the groupObject for id: ",o)}else console.error("photosAddon: Failed to get GroupByCount while resolving a GroupItemSet!");return[2]}})})}}),he=n(2043),be=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=b.deserialize(n),r=i.groupToCountsItemKeyPart,o=i.pageToken,s=i.offset;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,c,d,l,u,f,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return t=p.e.serialize(r),[4,e(Object(me.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t)}}))];case 1:return(i=_.sent().addonSrc)?(c=r.photosRootItemSetKeyPart,d=new D.e,[4,i.getGroupToCount(c.groupBy,c.filter,c.photosRootKeyPart.driveId,o,c.filterType)]):[3,4];case 2:return l=_.sent(),u=l.counts.map(function(e,t){return Object(he.e)(e,t)}),[4,e(Object(me.e)(function(e){return e.demandItemFacet(O.e,t)}))];case 3:(f=_.sent())&&(d.merge(B(e,t,{counts:u,pageToken:l.pageToken},s,f)),d.resolveItems({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)({},M.a.pack({})),M.e.pack(void 0)),m)}),e(d.execute())),_.label=4;case 4:return[2]}})})}}),ge=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=p.e.deserialize(n).photosRootItemSetKeyPart;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c,d;return Object(a.__generator)(this,function(l){switch(l.label){case 0:return(t=e(Object(S.e)(function(e){return e.demandItemFacet(A.e,A.t)})))?(r=new D.e,[4,t.getGroupToCount(i.groupBy,i.filter,i.photosRootKeyPart.driveId,void 0,i.filterType)]):[3,2];case 1:o=l.sent(),s=o.counts.map(function(e,t){return Object(he.e)(e,t)}),c=e(Object(S.e)(function(e){return e.demandItemFacet(O.e,n)||[]})),r.merge(B(e,n,{counts:s,pageToken:o.pageToken},0,c)),r.resolveItems({items:(d={},d[n]=Object(a.__assign)({},Object(x.e)().forFacet(O.e).thenInvalidate(n,M.e).forFacet(O.e).thenInvalidate(n,O.a).forFacet(O.e).thenInvalidate(n,O.n).pack()),d)}),e(r.execute()),l.label=2;case 2:return[2]}})})}});function ve(e,t,n,i,r,o,s,c,d){return Object(a.__awaiter)(this,void 0,void 0,function(){var l,u,f,p,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return l=E.serialize({photosRootItemSetKeyPart:{photosRootKeyPart:t,groupBy:n,filter:i,filterType:r}}),[4,e(Object(S.e)(function(e){return{widths:e.demandItemFacet(w.t,l)}}))];case 1:if((u=_.sent().widths)?u.length>=d?u=u.slice(0,d):((f=new Uint16Array(d)).set(u),u=f):u=new Uint16Array(d),u){for(p=0;p<s.length;++p)u[p+c]=s[p];o.resolveItems({items:(m={},m[l]=Object(a.__assign)({},w.t.pack(u)),m)})}return[2]}})})}function ye(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d,u,p,m,_,h,b,y,S,I,x,C,O,w,E,A,L,k,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(c=new D.e,!e.length||!f.e.matches(n))return[3,3];for(d=f.e.deserialize(n),u=d.groupBy,p=d.filter,m=d.photosRootKeyPart,_=d.filterType,h=r,b=new Map,y=new Uint16Array(e.length),S=0,I=0,x=0;x<e.length;++x){for(C=e[x],(O=C.thumbnails[C.thumbnails.length-1])&&O.width&&O.height?(w=Math.round(o*O.width/O.height),y[x]=w):y[x]=0,E={itemId:C.id,driveId:m.driveId,endpoint:m.endpoint},A=l.e.serialize(E),L=ae.e.serialize({driveItemKeyPart:E,photosRootItemSetKeyPart:d}),k=x+h,T=void 0;S<i.length;++S){if(U=i[S],F=I+U.count,k>=I&&k<F){T=g.e.serialize({photosRootItemSetKeyPart:d,id:U.id}),(H=b.get(T))?(H.newChildKeys.push(A),H.newChildIndices.push(k)):b.set(T,{key:T,newChildKeys:[A],newChildIndices:[k],curChildKeysIdx:-1});break}I+=U.count}T&&(R=ie.e.serialize({index:k,photosRootItemSetKeyPart:Object(a.__assign)({},d)}),c.merge(t(J(A,T,C)).itemResolver),c.resolveItems({items:(j={},j[R]=Object(a.__assign)({},l.e.pack(E)),j[L]=Object(a.__assign)({},ne.e.pack({itemKey:T})),j)}))}return[4,ve(t,m,u,p,_,c,y,h,s)];case 1:return V.sent(),N=[],b.forEach(function(e){var n=t(Object(me.e)(function(t){var n=t.demandItemFacet(M.e,e.key);if(n)return n.itemKeys})),a=N.push(n);e.curChildKeysIdx=a-1}),[4,Promise.all(N)];case 2:B=V.sent(),b.forEach(function(e){var t=0;e.totalChildCount=0;var n=new Map;if(e.curChildKeysIdx>=0){var a=B[e.curChildKeysIdx];if(a)for(var i=0,r=a;i<r.length;i++){var o=r[i];if(v.e.matches(o)){var s=v.e.deserialize(o),d=s.offset,l=s.count;if(d<h){e.totalChildCount+=l;continue}e.totalChildCount+=e.newChildKeys.length;for(var u=[],f=Math.min(e.newChildKeys.length-t,l),p=0;p<f;++p){var m=d+p;e.newChildIndices[t]===m&&u.push(e.newChildKeys[t++])}if(u.length>0){if(l>f){var _=g.e.deserialize(e.key),b=v.e.serialize({groupKeyPart:_,offset:d+f,count:l-f});u.push(b),c.merge(Object(P.t)({itemKey:b}).itemResolver)}n.set(o,u)}if(t>=e.newChildKeys.length)break}else e.totalChildCount++}}n.forEach(function(t,n){c.merge(Object(P.e)({itemKey:n,itemSetKey:e.key,childItemKeys:t}).itemResolver)})}),V.label=3;case 3:return[2,c]}})})}var Se=n(266),De=new U.e("doNotFetchResolvedPhotos"),Ie=Object(i.i)({maxQueueSize:2,prioritizeRecent:!0})(function(e){var t=this,n=e.itemKey,i=v.e.deserialize(n),r=i.groupKeyPart,o=i.offset,s=r.photosRootItemSetKeyPart;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,c,d,l,u,p,m,_,h,b,g,v,y,S;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(me.e)(function(e){var t=e.demandItemFacet(A.e,A.t),n=e.demandItemFacet(A.r,A.t),a=e.demandItemFacet(O.t,f.e.serialize(s));return{addonSrc:t,maxPageSize:n,totalPhotoCount:a?e.demandItemFacet(O.a,a.itemKey):void 0,targetHeight:e.demandItemFacet(A.s,A.t)}}))];case 1:return t=a.sent(),i=t.addonSrc,r=t.maxPageSize,c=t.totalPhotoCount,d=t.targetHeight,i&&r&&c&&d?e(Object(Se.e)({doNotFetchResolvedPhotos:De})).doNotFetchResolvedPhotos?(p=(u=Math).min,m=[r],[4,Oe(e,n,r)]):[3,3]:[3,8];case 2:return l=p.apply(u,m.concat([a.sent()])),[3,4];case 3:l=r,a.label=4;case 4:return h=(_=o)+l,[4,i.getPhotoRecords(_,h,s.filter,s.photosRootKeyPart.driveId,c,"landing",s.filterType)];case 5:return b=a.sent(),[4,e(Object(me.e)(function(e){var t=e.demandItemFacet(O.t,f.e.serialize(s));return t?e.demandItemFacet(O.e,t.itemKey):void 0}))];case 6:return(g=a.sent())?(v=new D.e,S=(y=v).merge,[4,ye(b,e,f.e.serialize(s),g,o,d,c)]):[3,8];case 7:S.apply(y,[a.sent()]),e(v.execute()),a.label=8;case 8:return[2]}})})}});function xe(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e(Object(me.e)(function(e){return e.demandItemFacet($.e,t)}))];case 1:return(n=a.sent())&&g.e.matches(n.itemKey)?[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,n.itemKey)}))]:[3,3];case 2:return i=a.sent(),[2,{groupKey:n.itemKey,childrenKeys:i}];case 3:return[2,{groupKey:void 0,childrenKeys:void 0}]}})})}function Ce(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=v.e.deserialize(t).groupKeyPart,i=g.e.serialize(n),[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,i)}))];case 1:return r=a.sent(),[2,{groupKey:i,childrenKeys:r}]}})})}function Oe(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=v.e.deserialize(t).count,[4,Ce(e,t)];case 1:if(r=a.sent(),o=r.groupKey,s=r.childrenKeys,(c=s?s.itemKeys.findIndex(function(e){return e===t}):-1)<0)return[2,i];c+=1,a.label=2;case 2:return o&&s?(d=function(e,t,n){for(var a=0,i=!1,r=e;r<t.length&&a<n;){var o=t[r];if(!v.e.matches(o)){i=!0;break}a+=v.e.deserialize(o).count,r++}return{unresolvedCount:a,foundResolved:i}}(c,s.itemKeys,n-i),l=d.unresolvedCount,u=d.foundResolved,i+=l,u||i>=n?[3,4]:[4,xe(e,o)]):[3,4];case 3:return f=a.sent(),o=f.groupKey,s=f.childrenKeys,c=0,[3,2];case 4:return[2,i]}})})}var we=new m.e("AllPhotosWidthsItemPageKeyFacet",{widthsItemKeyPart:E.subKeyPart,offset:h.e,count:h.e}),Ee=String.fromCharCode(9);function Ae(e,t){return{leafItemKey:t.itemKey,crumbControlHandler:function(e,t){var n=e.demandItemFacet(f.e,t.itemKey);if(n){var i=n.filter;if("place"===n.filterType){var r=i.split(Ee),o=void 0;if(r.length>1){var s=r.slice(0,r.length-1);o=f.e.serialize(Object(a.__assign)(Object(a.__assign)({},n),{filter:s.join(Ee)}))}return{displayName:r[r.length-1],parentItemKey:o}}}return{}}}}var Le=n(325),ke=n(1155),Me=n(1156),Pe=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return t=new D.e,i=!1,[4,e(Object(S.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t)}}))];case 1:return(r=s.sent().addonSrc)?[4,r.getIsSamsungFolderAvailable()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:return t.resolveItems({items:(o={},o[n]=Object(a.__assign)({},Me.e.pack({isAvailable:i})),o)}),e(t.execute()),[2]}})})}}),Te=n(2325);function Ue(e,t){var n=e.demandItemFacet(f.e,t.itemKey);return"album"===(null==n?void 0:n.filterType)?{}:{count:void 0,dateRange:void 0,label:void 0}}var Fe=n(476);function He(e,t){var n=t.setItemKey,a=e.demandItemFacet(A.d,r.e,{suppressGetItems:!0});if(!n||!a)return{};var i=e.demandItemFacet(f.e,n,{suppressGetItems:!0});if(void 0!==i){var o=e.demandItemFacet(M.e,n,{suppressGetItems:!0}),s=e.demandItemFacet(I.e,n)||o&&o.itemKeys.length,c=e.demandItemFacet(A.r,A.t),d=void 0===e.demandItemFacet(M.e,p.e.serialize({photosRootItemSetKeyPart:i}),{suppressGetItems:!0});return{totalItemCount:s,getPageKey:void 0!==o?function(e,t){if(void 0!==o&&o.itemKeys.length>0){d&&t++;for(var n=0;n<o.itemKeys.length;++n){var a=o.itemKeys[n];if(ce.e.matches(a)){var i=ce.e.deserialize(a),r=i.offset;if(e<=r+i.count&&r<=t)return a}}}return""}:void 0,pageSize:c}}return{}}var Re=n(1743),Ne=Object(i.i)({maxQueueSize:2,prioritizeRecent:!0})(function(e){var t=this,n=e.itemKey,i=ce.e.deserialize(n),o=i.photosRootItemSetKeyPart,s=i.offset,c=i.count;if(s<0)throw new Error("Page offset cannot be less than 0");if(c<=0)throw new Error("Page count cannot be 0 or less items");return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,d,u,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(I){switch(I.label){case 0:if(t=new D.e,i=e(Object(S.e)(function(e){return{addonSrc:e.demandItemFacet(A.e,A.t),photoCount:e.demandItemFacet(O.a,p.e.serialize({photosRootItemSetKeyPart:o})),targetHeight:e.demandItemFacet(A.s,A.t)}})),d=i.addonSrc,u=i.photoCount,void 0===(m=i.targetHeight))throw new Error("Target Height for photo resolution has not been defined in config!");return _=f.e.serialize(o),[4,e(Object(me.e)(function(e){return e.demandItemFacet(M.e,_)}))];case 1:return I.sent(),void 0===u&&(u=c),b=(h=s)+c,g=[],void 0===d?[3,3]:[4,d.getPhotoRecords(h,b,o.filter,o.photosRootKeyPart.driveId,Math.max(u,h+1),"landing",o.filterType)];case 2:g=I.sent(),I.label=3;case 3:return t.merge(function(e,t,n,i,r,o,s){var c,d=new D.e,u=n.photosRootKeyPart,m=[],_=p.e.serialize({photosRootItemSetKeyPart:n}),h=e(Object(S.e)(function(e){return{generateNewCounts:void 0===e.demandItemFacet(M.e,_)}})).generateNewCounts;r=Math.max(r,o+i.length);var b=E.serialize({photosRootItemSetKeyPart:n}),g=function(e,t,n){var a=e(Object(S.e)(function(e){return e.demandItemFacet(w.t,t)}));if(a)if(a.length>=n)a="function"==typeof a.slice?a.slice(0,n):new Uint16Array(Array.prototype.slice.call(a,0,n));else{var i=new Uint16Array(n);i.set(a),a=i}else a=new Uint16Array(n);return a}(e,b,r);if(i.forEach(function(t,a){var i=t.thumbnails[t.thumbnails.length-1];if(i&&i.width&&i.height){var r=Math.round(s*i.width/i.height);g[o+a]=r}else g[o+a]=0;var c=l.e.serialize({itemId:t.id,driveId:u.driveId,endpoint:u.endpoint});m.push(c),d.merge(e(J(c,f.e.serialize(n),t)).itemResolver)}),h&&i.length>0){var v=ce.e.serialize({photosRootItemSetKeyPart:n,offset:o+i.length,count:i.length});m.push(v),d.merge(Object(P.t)({itemKey:v}).itemResolver)}var y=f.e.serialize(n);return d.merge(Object(P.e)({itemKey:t,itemSetKey:y,childItemKeys:m}).itemResolver),d.resolveItems({items:(c={},c[b]=Object(a.__assign)({},w.t.pack(g)),c)}),d}(e,n,o,g,u,h,m)),v=f.e.serialize(o),t.resolveItems({items:(y={},y[n]=Object(a.__assign)(Object(a.__assign)({},M.a.pack({})),M.e.pack({itemKeys:[]})),y[v]=Object(a.__assign)({},Object(x.e)().forFacet(M.e).thenInvalidate(n,M.e).pack()),y)}),e(t.execute()),e(function(e,t){var n,i=new D.e,o=p.e.serialize({photosRootItemSetKeyPart:t}),s=f.e.serialize(t),c=e(Object(S.e)(function(e){return{generateNewCounts:void 0===e.demandItemFacet(M.e,o),childItems:e.demandItemFacet(M.e,s),oldGroupToCount:e.demandItemFacet(O.e,o)}})),d=c.generateNewCounts,u=c.childItems,m=c.oldGroupToCount;if(d&&u){var _=function(e){if(!e)return 0;var t=0;return e.forEach(function(e){t+=e.count}),t}(m),h=e(Object(S.e)(function(e){for(var t=[],n=_;n<u.itemKeys.length;n++){var a=u.itemKeys[n];if(l.e.matches(a)){var i=e.demandItemFacet(G.c,a),r=void 0!==i?new Date(i):void 0;if(!r)break;var o=Object(Re.e)(r);t[n-_]={dateTakenTime:o}}}return t})),b=e(Object(S.e)(function(e){return e.demandItemFacet(A.n,r.e)})),g=function(e,t){if(void 0===e)return t;var n=e.slice();return n.length>0&&t.length>0&&t[0].labels.join(",")===n[n.length-1].labels.join(",")&&(n[n.length-1].count+=t[0].count,t.shift()),n.concat(t)}(m,Object(k.t)(h,t.filterType,t.filter,b)),v=_+h.length;i.resolveItems({items:(n={},n[o]=Object(a.__assign)(Object(a.__assign)({},O.e.pack(g)),O.a.pack(v)),n)})}return i}(e,o).execute()),[2]}})})}}),Be=Object(i.t)(function(){return function(e){e(Object(o.t)({keyFacet:u.e,facets:[u.e,M.t]})),e(Object(o.t)({keyFacet:f.e,facets:[f.e,O.t,w.n,M.r,M.e,I.r]})),e(Object(o.t)({keyFacet:g.e,facets:[g.e,z.u,M.e,M.e]})),e(Object(o.t)({keyFacet:v.e,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:l.e,facets:[l.e,z.d,z.u,G.h,j.e]})),e(Object(o.t)({keyFacet:p.e,facets:[O.e,M.e,O.a,O.n]})),e(Object(o.t)({keyFacet:b,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:E,facets:[w.e,w.t,M.e]})),e(Object(o.t)({keyFacet:we,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:ce.e,facets:[M.a,M.e]})),e(y.e),e(Object(s.a)(f.e,c.e)(fe)),e(Object(s.a)(g.e,c.e)(_e)),e(Object(s.a)(v.e,c.e)(Ie)),e(Object(s.a)(ce.e,c.e)(Ne)),e(Object(s.a)(p.e,c.e)(ge)),e(Object(s.a)(b,c.e)(be)),e(Object(s.a)(ke.e,c.e)(Pe)),e(Object(d.e)(f.e,Le.t)(Ae)),e(Object(d.e)(f.e,Te.e)(Ue)),e(Object(d.e)(f.e,Fe.e)(He))}}),je=n(590),Ve=n(822),ze=n(2326),Ge=n(394),Ke=n(525),We=n(699),qe=n(691),Qe=n(696),Ye=n(519),Je=n(1112),Xe=n(339),Ze=n(804),$e=new m.e("albumSetKey",{albumsRootKeyPart:Xe.e.subKeyPart,nextLink:_.e}),et=new m.e("sharedAlbumsKey",{driveId:_.e,endpoint:_.e}),tt=n(392),nt=n(1884),at=n(2672),it=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Xe.e.deserialize(n),r=Ze.e.serialize({albumsRootKeyPart:i,groupType:"all"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(i){return e(Object(o.e)({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(at.e)),M.t.pack({itemKey:r})),t)})),[2]})})}}),rt=n(107),ot=n(990),st=n(1942),ct=n(2673);function dt(e){void 0===e&&(e=[]);var t={type:"auto",items:[],displayName:ct.e},n={type:"all",items:[],displayName:ct.t};return e.forEach(function(e){e.tags&&e.tags.some(function(e){return e.name===ue.e.__New})?t.items.push(e):n.items.push(e)}),{autoAlbums:t,allAlbums:n}}var lt=n(286);function ut(e,t,n,i){var r=[];if(n.items.forEach(function(i){var o=function(e,t,n,i){var r,o=C.e.serialize({albumsRootKeyPart:t,id:n.id}),s=f.e.serialize({photosRootKeyPart:t,groupBy:lt.e.Date,filter:n.id,filterType:"album"});return e.resolveItems({items:(r={},r[o]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(n.name)),I.e.pack(n.bundle&&n.bundle.childCount)),tt.i.pack(n.createdDateTime)),z.A.pack(n.webUrl)),z.m.pack(n.size)),z._.pack({})),nt.e.pack(i)),M.t.pack({itemKey:s})),r)}),o}(e,t,i,"auto"===n.type);r.push(o)}),i){var o=$e.serialize({albumsRootKeyPart:t,nextLink:i});e.merge(Object(P.t)({itemKey:o}).itemResolver),r.push(o)}return r}var ft=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ze.e.deserialize(n).albumsRootKeyPart,r=i.driveId,o=i.endpoint,s=Xe.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,c,d,l,u,f,p,m,_,h,b,g;return Object(a.__generator)(this,function(v){switch(v.label){case 0:return t=Date.now(),n=Object(ot.e)({filter:"bundle/album ne null",orderby:"createdDateTime desc",expand:"tags",select:"bundle,id,name,webUrl,createdDateTime,size,tags"}),c={qosName:"allAlbums",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/bundles?").concat(n)},[4,e(Object(rt.t)(c))];case 1:return d=v.sent(),l=d.value,u=d["@odata.nextLink"],f=Date.now()-t,p=Date.now(),m=dt(l),_=m.autoAlbums,h=m.allAlbums,b=new D.e,[_,h].forEach(function(e){var t,n=Ze.e.serialize({albumsRootKeyPart:i,groupType:e.type}),r=ut(b,i,e,u);b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:s})),M.e.pack({itemKeys:r})),z.u.pack(e.displayName)),t)})}),e(b.execute()),g=Date.now()-p,e(Object(st.e)({name:"Albums.GetAllAlbums",extraData:{fetchTimeMs:f,processTimeMs:g,AutoAlbumsCount:_.items.length,AllAlbumsCount:h.items.length}})),[2]}})})}}),pt=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=Date.now(),i=e.itemKey,r=$e.deserialize(i),o=r.albumsRootKeyPart,s=r.nextLink,c=o.endpoint,d=o.driveId,l={qosName:"allAlbums",endpoint:c,driveId:d,url:s},[4,n(Object(rt.t)(l))];case 1:return u=a.sent(),f=u.value,p=u["@odata.nextLink"],m=Date.now()-t,_=Date.now(),h=dt(f),b=h.autoAlbums,g=h.allAlbums,v=new D.e,[b,g].forEach(function(e){var t=Ze.e.serialize({albumsRootKeyPart:o,groupType:e.type}),n=ut(v,o,e,p);v.merge(Object(P.e)({itemKey:i,itemSetKey:t,childItemKeys:n}).itemResolver)}),n(v.execute()),y=Date.now()-_,function(e,t,n,a){Object(st.e)({name:"Albums.GetAllTags",extraData:{fetchTimeMs:e,processTimeMs:t,AutoAlbumsCount:n,AllAlbumsCount:a}})}(m,y,b.items.length,g.items.length),[2]}})})}}),mt=Object(i.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,i=e.options.demands,r=C.e.deserialize(n),s=r.albumsRootKeyPart,c=s.driveId,d=s.endpoint,l=r.id,u=f.e.serialize({photosRootKeyPart:{driveId:c,endpoint:d},groupBy:lt.e.Date,filter:l,filterType:"album"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,p,m,_;return Object(a.__generator)(this,function(h){switch(h.label){case 0:return t=Object(ot.e)({expand:"thumbnails(select=medium),children",select:"bundle,id,name,webUrl,createdDateTime,size,thumbnails"}),r={qosName:"allAlbums",endpoint:d,driveId:c,url:"".concat(d,"/drives/").concat(c,"/items/").concat(l,"?").concat(t)},[4,e(Object(rt.t)(r))];case 1:return s=h.sent(),f=s.thumbnails&&s.thumbnails[0]&&s.thumbnails[0].medium,e(Object(o.e)({items:(m={},m[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(s.name)),I.e.pack(s.bundle&&s.bundle.childCount)),tt.i.pack(s.createdDateTime)),z.A.pack(s.webUrl)),G.h.pack(f)),z.m.pack(s.size)),z._.pack({})),M.t.pack({itemKey:u})),Object(x.e)().forFacet(M.t).thenInvalidate(u,M.e).pack()),m)})),i[se.e.id]?[4,e(_t(n))]:[3,3];case 2:p=h.sent(),e(Object(o.e)({items:(_={},_[n]=Object(a.__assign)({},se.e.pack(p)),_)})),h.label=3;case 3:return[2]}})})}});function _t(e){var t=this,n=C.e.deserialize(e);return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i(Object(S.e)(function(t){return t.demandItemFacet(I.e,e)}))?[4,Promise.all([i(ht({albumKeyPart:n,pageSize:1,sortBy:"createdDateTime",sortOrder:"asc"})),i(ht({albumKeyPart:n,pageSize:1,sortBy:"createdDateTime",sortOrder:"desc"}))])]:[3,2];case 1:if(t=a.sent(),r=t[0][0],o=t[1][0],r&&r.createdDateTime&&o&&o.createdDateTime&&(s=new Date(r.createdDateTime),c=new Date(o.createdDateTime),bt(s)&&bt(c)))return[2,{minDate:s,maxDate:c}];a.label=2;case 2:return[2]}})})}}function ht(e){var t=this,n=e.albumKeyPart,i=e.pageSize,r=e.sortBy,o=e.sortOrder,s=n.albumsRootKeyPart,c=s.driveId,d=s.endpoint,l=n.id;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=Object(ot.e)({orderby:"".concat(r," ").concat(o),top:i}),n={qosName:"allAlbums",endpoint:d,driveId:c,url:"".concat(d,"/drives/").concat(c,"/items/").concat(l,"/children?").concat(t)},[4,e(Object(rt.t)(n))];case 1:return[2,a.sent().value||[]]}})})}}function bt(e){return e instanceof Date&&!isNaN(e.getTime())}var gt=Object(i.i)()(function(e){var t=e.itemKey,n=C.e.deserialize(t),i=n.albumsRootKeyPart,r=i.driveId,s=i.endpoint,c=n.id;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(d){switch(d.label){case 0:return n={qosName:"allAlbums",method:"DELETE",endpoint:s,driveId:r,url:"".concat(s,"/drives/").concat(r,"/items/").concat(c)},[4,e(Object(rt.t)(n))];case 1:return d.sent(),e(Object(o.e)({items:(i={},i[t]=Object(a.__assign)({},z.d.pack({})),i)})),[2]}})})}}),vt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.names,i=C.e.deserialize(t),r=i.albumsRootKeyPart,s=r.driveId,c=r.endpoint,d=i.id,l=n[Object.keys(n)[0]].newName;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i,r,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=Object(ot.e)({select:"id,name"}),i={qosName:"allAlbums",method:"PATCH",endpoint:c,driveId:s,url:"".concat(c,"/drives/").concat(s,"/items/").concat(d,"?").concat(n),body:{name:l}},[4,e(Object(rt.t)(i))];case 1:return r=f.sent().name,e(Object(o.e)({items:(u={},u[t]=Object(a.__assign)({},z.u.pack(r)),u)})),[2]}})})}}),yt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.tagsToAdd,r=n.tagsToDelete,o=n.keysToInvalidate,s=C.e.deserialize(t),c=s.albumsRootKeyPart,d=c.driveId,l=c.endpoint,u=s.id;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,s,c,f,p,m,_,h,b,g,v;return Object(a.__generator)(this,function(y){switch(y.label){case 0:return n=[],i&&i.forEach(function(e){return n.push({name:e})}),r&&r.forEach(function(e){return n.push({name:e,"@oneDrive.removed":{}})}),s=Object(ot.e)({expand:"tags",select:"id,tags"}),c={qosName:"allAlbums",method:"PATCH",endpoint:l,driveId:d,url:"".concat(l,"/drives/").concat(d,"/items/").concat(u,"?").concat(s),body:{tags:n}},[4,e(Object(rt.t)(c))];case 1:for(f=y.sent(),p=new D.e,m=f.tags&&f.tags.indexOf({name:ue.e.__New})>-1,p.resolveItems({items:(g={},g[t]=Object(a.__assign)({},nt.e.pack(m)),g)}),_=0,h=o;_<h.length;_++)b=h[_],p.invalidateItems({items:(v={},v[b]=[M.e],v)});return e(p.execute()),[2]}})})}}),St=n(2674),Dt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=et.deserialize(n),r=i.driveId,o=i.endpoint,s=Xe.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,d,l,u,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return t=Object(ot.e)({filter:"remoteItem/bundle/album ne null",orderby:"createdDateTime desc"}),c={qosName:"sharedAlbums",endpoint:o,driveId:r,url:"".concat(o,"/drives/").concat(r,"/view.sharedWithMe?").concat(t)},[4,e(Object(rt.t)(c))];case 1:return d=m.sent().value,l=new D.e,u=[],d.forEach(function(e){var t;if(e.remoteItem){var n,r=e.remoteItem;n=r.parentReference?C.e.serialize({albumsRootKeyPart:{driveId:r.parentReference.driveId,endpoint:i.endpoint},id:r.id}):C.e.serialize({albumsRootKeyPart:i,id:e.id});var o=f.e.serialize({photosRootKeyPart:i,groupBy:lt.e.Date,filter:e.id,filterType:"album"});l.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.name)),I.e.pack(r.bundle&&r.bundle.childCount)),tt.i.pack(e.createdDateTime)),z.A.pack(e.webUrl)),z.m.pack(r.size)),z._.pack({})),M.t.pack({itemKey:o})),t)}),u.push(n)}}),l.resolveItems({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},M.r.pack({itemKey:s})),M.e.pack({itemKeys:u})),z.u.pack(St.e)),p)}),e(l.execute()),[2]}})})}}),It=n(1091);function xt(e,t){return{isAvailable:!0}}var Ct=n(824);function Ot(e,t){return{isAvailable:!0,validator:Ct.e}}var wt=n(54),Et=n(686),At=n(579);function Lt(e,t){var n=t.itemKeys;if(1!==n.length)return{};var i=n[0];if(C.e.matches(i)){var r=C.e.deserialize(i).id;return{isAvailable:!0,getSharingInformation:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=n(Object(Se.e)({graphEndpoint:wt.g})).graphEndpoint||"",[4,n(Object(At.e)({endpoint:t}))];case 1:return[2,{authToken:(i=a.sent())&&i.accessToken,shareItemKey:Et.e.serialize({itemId:e})}]}})})}}(r)}}}return{}}var kt=n(38),Mt=n(2177);function Pt(e,t){return{initializeShareFrame:Tt}}function Tt(e){var t=e.parentElement,n=e.calloutProps,a=e.sharingInformation,i=e.onError,r=a.authToken,o=a.shareItemKey,s=a.webAbsoluteUrl;if(o&&Et.e.matches(o)){var c=Et.e.deserialize(o).itemId;new Mt.SharePrefetch({element:t,environment:kt.e.prod,locale:n.locale,disableIframeDomainCheck:!0,isConsumer:!0,context:{authToken:r||"",webAbsoluteUrl:s||"",listItemId:c,itemName:n.itemName,mode:Number(n.mode),defaultRecipients:n.defaultRecipients,theme:n.theme,clientId:n.getClientId()},options:{onError:i,openManageAccess:n.openManageAccess}}).initializeUI()}}var Ut=n(314);function Ft(e,t){var n,i=t.itemKeys.reduce(function(t,a){var i=e.demandItem({albumKeyPart:C.e,name:z.u,photoCount:I.e,size:z.m,folder:z._},a),r=i.albumKeyPart,o=i.name,s=i.photoCount,c=i.size,d=i.folder;if(r&&s&&s>0){var l=r.albumsRootKeyPart,u=l.driveId,f=l.endpoint,p=r.id;n=f,t.push({name:o||"",size:c||0,docId:"".concat(f,"/drives/").concat(u,"/items/").concat(p),isFolder:!!d})}return t},[]);if(0===i.length||!n)return{isAvailable:!1};var r=n;return{isAvailable:!0,getDownloadData:function(){return function(e,t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=1===e.length&&e[0].name?"".concat(e[0].name.replace(" ","_"),".zip"):"OneDrive_".concat((new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,""),".zip"),r=Ut.e.generate(),[4,i(Object(At.e)({endpoint:t}))];case 1:return o=a.sent(),s=o&&o.accessToken,[2,{url:"https://southcentralus1-media".concat(Rt,".svc.ms/transform/zip?cs=V2VifE9EQw=="),method:"POST",postData:{zipFileName:n,guid:r,provider:"url",files:JSON.stringify({items:e}),accessToken:s||"",appId:Nt||""}}]}})})}}(i,r)}}}var Ht=window.FilesConfig,Rt=Ht&&Ht.df?"s":"p",Nt=Ht&&Ht.appId,Bt=n(1107),jt=n(438),Vt=n(585),zt=n(470),Gt=n(583),Kt=[jt.n,Gt.e,Vt.e,zt.e];function Wt(e,t){return{commands:Kt}}var qt=n(680),Qt={name:"Error",size:40},Yt={name:"PhotoCollection",size:40};function Jt(e,t){return{errorThumbnailIcon:Qt,invalidThumbnailIcon:Yt}}var Xt=n(999);function Zt(e,t){return{isAvailable:!1}}var $t=Object(i.t)(function(){return function(e){e(Je.e),e(Object(o.t)({keyFacet:Xe.e,facets:[z.u,M.t]})),e(Object(o.t)({keyFacet:Ze.e,facets:[M.r,M.e,z.u]})),e(Object(o.t)({keyFacet:C.e,facets:[M.t,z.u,I.e,tt.i,z.A,G.h,nt.e,z.m,z._,se.e]})),e(Object(o.t)({keyFacet:$e,facets:[M.a,M.e]})),e(Object(o.t)({keyFacet:et,facets:[M.r,M.e,z.u]})),e(Object(s.a)(Xe.e,c.e)(it)),e(Object(s.a)(Ze.e,c.e)(ft)),e(Object(s.a)($e,c.e)(pt)),e(Object(s.a)(C.e,c.e)(mt)),e(Object(s.a)(C.e,je.e)(gt)),e(Object(s.a)(C.e,Ve.t)(vt)),e(Object(s.a)(C.e,ze.t)(yt)),e(Object(s.a)(et,c.e)(Dt)),e(Object(d.e)(C.e,Ge.e)(It.t)),e(Object(d.e)(C.e,qt.e)(Jt)),e(Object(d.e)(C.e,Ke.e)(xt)),e(Object(d.e)(C.e,We.e)(Ot)),e(Object(d.e)(C.e,qe.e)(Lt)),e(Object(d.e)(C.e,Qe.e)(Pt)),e(Object(d.e)(C.e,Ye.e)(Ft)),e(Object(d.e)(Xe.e,Bt.e)(Wt)),e(Object(d.e)(Ze.e,Xt.e)(Zt))}}),en=n(806),tn=n(556),nn=new m.e("tagSetKey",{tagsRootKeyPart:en.e.subKeyPart,groupType:Object(tn.e)({top:0,all:1,promoted:2})}),an=n(2675),rn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=en.e.deserialize(i),o=r.driveId,s=r.endpoint,c=-1!==s.indexOf("/_api/v2.1");return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,l,u,p,m,_,h,b,g,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return n=Date.now(),d=Object(ot.e)({expand:"tag($select=*,localizedName),previewThumbnails"}),l="".concat(s,"/drives/").concat(o,"/view.listTags"),c||(l+="?".concat(d)),u={qosName:"allTags",endpoint:s,driveId:o,url:l},[4,t(Object(rt.t)(u))];case 1:return p=S.sent().value,m=Date.now()-n,_=Date.now(),h=function(e){if(!e||0===e.length)return[];var t={type:"top",name:an.n,tags:[]},n={type:"all",name:an.e,tags:[]};return e.forEach(function(e){var a=e.tag;if(a&&a.name&&!(a.name in ue.e)){var i={name:a.name,displayName:a.localizedName||a.name,thumbnail:e.previewThumbnails&&Object(Y.e)(e.previewThumbnails)};t.tags.length<11&&a.name.toLocaleLowerCase()in ue.a&&t.tags.push(i),n.tags.push(i)}}),n.tags.sort(function(e,t){return e.displayName.localeCompare(t.displayName)}),[t,n]}(p),b=new D.e({publisher:e}),g=[],h.forEach(function(e){var t,n=nn.serialize({tagsRootKeyPart:r,groupType:e.type}),i=[];e.tags.forEach(function(e){var t,n=oe.e.serialize({tagsRootKeyPart:r,id:e.name}),c=f.e.serialize({photosRootKeyPart:{driveId:o,endpoint:s},groupBy:lt.e.Date,filter:e.name,filterType:"tag"});b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.displayName)),M.t.pack({itemKey:c})),G.h.pack(e.thumbnail)),t)}),i.push(n)}),b.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(e.name)),M.e.pack({itemKeys:i})),t)}),g.push(n)}),b.resolveItems({items:(y={},y[i]=Object(a.__assign)(Object(a.__assign)({},z.u.pack(an.t)),M.e.pack({itemKeys:g})),y)}),t(b.execute()),v=Date.now()-_,t(Object(st.e)({name:"Tags.GetAllTags",extraData:{fetchTimeMs:m,processTimeMs:v,tagsCount:(null==p?void 0:p.length)||0}})),[2]}})})}}),on=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=nn.deserialize(n).tagsRootKeyPart,r=en.e.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(me.e)(function(e){e.demandItemFacet(M.e,r)}))];case 1:return t.sent(),[2]}})})}}),sn=Object(i.i)({maxParallelOperationCount:10})(function(e){var t=this,n=e.itemKey,i=oe.e.deserialize(n),r=i.tagsRootKeyPart,s=r.driveId,c=r.endpoint,d=i.id,l=f.e.serialize({photosRootKeyPart:{driveId:s,endpoint:c},groupBy:lt.e.Date,filter:d,filterType:"tag"});return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,u,f,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return t=Object(ot.e)({filter:"photo ne null and tags/any(t:t/name eq '".concat(d,"')"),orderby:"photo/takenDateTime desc",expand:"thumbnails(select=medium),tags",top:1,select:"id,thumbnails,tags"}),i={qosName:"allTags",endpoint:c,driveId:s,url:"".concat(c,"/drives/").concat(s,"/items/root/items?").concat(t)},[4,e(Object(rt.t)(i))];case 1:return r=m.sent().value,u=r&&r.length&&r[0].thumbnails&&r[0].thumbnails[0],f=u&&u.medium?{url:u.medium.url,width:u.medium.width,height:u.medium.height}:void 0,e(Object(o.e)({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)({},G.h.pack(f)),M.t.pack({itemKey:l})),p)})),[2]}})})}}),cn=Object(i.t)(function(){return function(e){e(Je.e),e(Object(o.t)({keyFacet:en.e,facets:[M.e]})),e(Object(o.t)({keyFacet:nn,facets:[z.u,M.e]})),e(Object(o.t)({keyFacet:oe.e,facets:[z.u,G.h]})),e(Object(s.a)(en.e,c.e)(rn)),e(Object(s.a)(nn,c.e)(on)),e(Object(s.a)(oe.e,c.e)(sn)),e(Object(d.e)(oe.e,Ge.e)(It.t)),e(Object(d.e)(oe.e,qt.e)(Jt))}}),dn=n(576),ln=n(2307),un=Object(i.t)(function(){return function(e){e(ln.e),e(Object(d.e)(dn.e,Ge.e)(It.t)),e(Object(d.e)(dn.e,qt.e)(Jt))}}),fn=n(1109),pn=n(2313),mn=Object(i.t)(function(){return function(e){e(pn.e),e(Object(d.e)(fn.e,Ge.e)(It.t))}}),_n=n(1110),hn=n(2314),bn=Object(i.t)(function(){return function(e){e(hn.e),e(Object(d.e)(_n.e,Ge.e)(It.t))}}),gn=n(1111),vn=n(2315),yn=Object(i.t)(function(){return function(e){e(vn.e),e(Object(d.e)(gn.e,Ge.e)(It.t))}}),Sn=n(11),Dn=n(1827),In=n(1165),xn=Object(i.t)(function(){return function(e){var t;e(Be),e($t),e(cn),e(un),Object(Sn.isFeatureEnabled)({ODC:"EnableRecommendationApi"})?e(In.e):(e(mn),e(bn),e(yn)),e(Object(o.e)({items:(t={},t[r.e]=Object(a.__assign)(Object(a.__assign)({},De.pack(e(Object(Dn.t)()))),A.d.pack(Object(Sn.isFeatureEnabled)(Sn.UseItemsScopeInAllPhotosForwardPaging))),t)}))}})}],Array(25),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Owner=0]="Owner",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Submitter=3]="Submitter",e[e.CoOwner=4]="CoOwner",e[e.None=5]="None",e[e.Review=6]="Review",e[e.Custom=7]="Custom"}(a||(a={}))},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.t={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))},function(e,t,n){"use strict";var a;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}}],Array(73),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(118),i=n(11),r=function(){function e(e){this._identityDataSource=e}return e.prototype.isExperimentOn=function(e,t,n){var i=this._identityDataSource.getIdentity().email;a.t.init({userLoginName:i});var r={name:e,startDate:t,version:a.e.v2};return new a.t(r,n).isOn()},e.prototype.isUseVroomInItemsScopeAllPhotosOtdExpOn=function(){return this.isExperimentOn("useVroomInItemsScopeAllPhotosOtdExp","2021/01/11",i.UseVroomInItemsScopeAllPhotosOtdExp)},e.prototype.isEnableLastWeekPreviousYearsExpOn=function(){return this.isExperimentOn("EnableLastWeekPreviousYearsExp","2021/06/04",i.EnableLastWeekPreviousYearsExp)},e.prototype.isEnableMonthRecapGroupHeaderExpOn=function(){return this.isExperimentOn("EnableMonthRecapGroupHeaderExp","2021/06/04",i.EnableMonthRecapGroupHeaderExp)},e.prototype.isEnableNewCarouselDesignExpOn=function(){return this.isExperimentOn("EnableNewCarouselDesignExp","2021/08/24",i.EnableNewCarouselDesignExp)},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(2284),r=n(11),o=n(35),s=n(90),c=n(1827),d=function(){function e(e,t,n){this._photoProviderAddonSource=n,this._vroomAddonSource=new i.e(e,t),this._itemCacheStore=t}return e.prototype.updateResource=function(e){this._photoProviderAddonSource.updateResource(e),this._vroomAddonSource.updateResource(e)},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(r).getGroupToCount(e,t,n,i,r)]})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource(s).getPhotoRecords(e,t,n,i,r,o,s)]})})},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){return[2,this.getAddonSource("folder").getPhotoRecordsForBurstMode(e,t,n)]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomAddonSource.getIsSamsungFolderAvailable()]})})},e.prototype.getAddonSource=function(e){switch(e){case"folder":case"onthisday":return this._itemCacheStore.dispatch(Object(c.t)())?this._vroomAddonSource:this._photoProviderAddonSource;case"place":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSinglePlace)?this._vroomAddonSource:this._photoProviderAddonSource;case"tag":return Object(r.isFeatureEnabled)(r.UseVroomInItemsScopeSingleTag)||Object(r.isFeatureEnabled)(r.UpdateOdcPhotoApiForConvergence)&&Object(s.e)(o.M)?this._vroomAddonSource:this._photoProviderAddonSource;case"onthismonth":case"lastweekpreviousyears":return this._vroomAddonSource}return this._photoProviderAddonSource},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(2),r=n(209),o=n(28),s=n(201),c=n(95),d=n(8),l=new i.e("promotedPhotosDataSource"),u=new i.e("PhotosDataSource"),f=new d.t({name:"PromotedPhotosDataSourceConfig",factory:{dependencies:{photosProvider:c._,promotedPhotosProvider:c.v},create:function(e){return{instance:Object(o.t)(function(){return function(t){var n;t(Object(r.e)({items:(n={},n[s.e]=Object(a.__assign)(Object(a.__assign)({},l.pack(e.promotedPhotosProvider)),u.pack(e.photosProvider)),n)}))}})}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(2043),r=n(292),o=n(42),s=n(2284),c=n(36),d=n(151),l=n(2190),u=n(812),f=n(10),p=[1e4,1e3,100],m="root",_=function(){function e(e,t,n,a,i){this._groupToCount=[],this._groupToCountDate=[],this._vroomDataRequestor=e,this._successfulPageSizeIndex=0,this._photoProvider=t,this._itemProvider=n,this._urlDataSource=a,this._engagement=i}return e.prototype.updateResource=function(e){},e.prototype.getPhotoRecordsForBurstMode=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getPhotoRecords(0,e,t,n,e,"landing","folder")];case 1:return[2,a.sent()]}})})},e.prototype.getGroupToCount=function(e,t,n,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(r){case"album":return[3,1];case"tag":return[3,3];case"onthisday":return[3,5]}return[3,7];case 1:return[4,this._getGroupToCountForSingleAlbum(t,n)];case 2:return e=a.sent(),[3,9];case 3:return[4,this._getGroupToCountForSingleTag(t)];case 4:return e=a.sent(),[3,9];case 5:return[4,this._getGroupToCountForOnThisDay(t)];case 6:return e=a.sent(),[3,9];case 7:return[4,this._getGroupToCountForAllPhotos(t,n,i,r)];case 8:e=a.sent(),a.label=9;case 9:return[2,e]}})})},e.prototype.getPhotoRecords=function(e,t,n,i,r,o,s){return Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(s){case"album":i=this._getPhotoRecordsForSingleAlbum(e,t,n);break;case"tag":i=this._getPhotoRecordsForSingleTag(e,t,n);break;case"onthisday":i=this._getPhotoRecordsForOnThisDay(e,t,n);break;default:i=this._getPhotoRecordsForAllPhotos(e,t,n,s)}return[2,i]})})},e.prototype.getIsSamsungFolderAvailable=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this._vroomDataRequestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){return!0}).catch(function(){return!1})]})})},e.prototype._getPhotoRecordsForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,u,f,p,m,_,h,b;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=void 0,o=0,0!==e&&(s=this._getStartDate(e,n),c=s.date,d=s.index,void 0!==c&&d>=0?(r=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),24,0,0,-1)),o=d):o=e),l=e-o,u=t-o,f=this._photoProvider.getAllPhotosSettings(),p=r?r.toISOString():void 0,m=new Date,[4,this._getPhotoRecords(o,t,l,p,f.peek().rootId,void 0,void 0)];case 1:return _=a.sent(),h=new Date,b=h.getTime()-m.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:b,count:u,requests:_.requestsCount,skip:e-o,api:"skyapi"},i),[2,_.photos]}})})},e.prototype._getPhotoRecords=function(e,t,n,i,o,s,c){return Object(a.__awaiter)(this,void 0,void 0,function(){var d,l,u,f,p,m,_,h,b,g,v;return Object(a.__generator)(this,function(a){switch(a.label){case 0:d=[],l=200,u=0,f=t-e,p=0,a.label=1;case 1:return f>0?(p++,m=Math.min(l,f),h=(_=e+u)+m,[4,this._photoProvider.getAllPhotosForPage({rootItemId:o,parentKey:null,startIndex:_,endIndex:h-1,jumpToStartDate:i,photoType:r.e.AllMyPhotos,ascending:!1,locationFilter:c,pageSize:l,revision:0,skipInMemoryCache:!1,tagFilter:s})]):[3,5];case 2:return b=a.sent(),g=void 0,Array.isArray(b)?(g=b[0].content(),console.warn("Invalid result from getAllPhotosForPage (array)")):b&&b.content&&(g=b.content()),g&&g.items?(v=Math.min(g.items.length,h),[4,this._transformIOneDriveItemsToIPhotoRecords(g.items,_+n,v,d)]):[3,4];case 3:a.sent(),a.label=4;case 4:return u+=m,n=n>m?n-m:0,f-=m,[3,1];case 5:return[2,{photos:d,requestsCount:p}]}})})},e.prototype._getPhotoRecordsForOnThisDay=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(i=Object(u.e)(n).date).setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),[4,this._urlDataSource.getCurrentItemKey()];case 1:return r=a.sent(),o={parentKey:r,startDate:i.toISOString(),onThisDay:!0,highlights:!1,pageSize:100,ascending:!1,rootItemId:m,startIndex:0,endIndex:0},[4,this._photoProvider.getOnThisDayPhotos(o)];case 2:return s=a.sent(),c=[],d=s.content(),l=d.items,f=t>0?Math.min(t,l.length):l.length,[4,this._transformIOneDriveItemsToIPhotoRecords(d.items,e,f,c)];case 3:return a.sent(),[2,c]}})})},e.prototype._getPhotoRecordsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,r=1,[4,this._getItemsForSingleAlbum(e,t,n)];case 1:return o=a.sent(),s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r,api:"skyapi"},"album"),[2,o]}})})},e.prototype._getPhotoRecordsForSingleTag=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=new Date,[4,this._getPhotoRecords(e,t,0,void 0,m,n,void 0)];case 1:return r=a.sent(),o=r.photos,s=new Date,c=s.getTime()-i.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPIMetadata",{time:c,count:t-e,requests:r.requestsCount,api:"skyapi"},"tag"),[2,o]}})})},e.prototype.getOwnerId=function(e){return this._urlDataSource.getKeyParams(e).cid||f.z},e.prototype._getItemsForSingleAlbum=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=[],[4,this._urlDataSource.getCurrentItemKey()];case 1:r=a.sent(),o=t-e,s=e,a.label=2;case 2:return o>0?[4,this._itemProvider.getItem({parentKey:r,ownerId:this.getOwnerId(r),id:n,startIndex:s,endIndex:t-1,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})]:[3,6];case 3:if(d=a.sent(),Array.isArray(d))throw new Error("Invalid result from getAllPhotosForPage (array)");return d&&d.content&&(l=d.content())&&l.items?[4,this._transformIOneDriveItemsToIPhotoRecords(l.items,e,t,i)]:[3,5];case 4:a.sent(),a.label=5;case 5:return o=t-i.length-e,s=e+i.length,[3,2];case 6:return[2,i]}})})},e.prototype._getGroupCountWithVariablePageSize=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u;return Object(a.__generator)(this,function(a){switch(a.label){case 0:r=void 0,o=this._successfulPageSizeIndex,a.label=1;case 1:if(!(o<p.length))return[3,6];c=p[o],d=Object(s.t)(c,e,t,n,i),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this._makeQuery(d)];case 3:return l=a.sent(),this._successfulPageSizeIndex=o,[2,l];case 4:return u=a.sent(),r=u,[3,5];case 5:return o++,[3,1];case 6:throw r}})})},e.prototype._getGroupToCountForAllPhotos=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,c,d,l,u,f,p,m,_;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new Date,o=n?parseInt(n,10):1,[4,this._getGroupCountWithVariablePageSize(i,e,t,o)];case 1:return c=a.sent(),d=c.value.length>0&&c["@odata.nextLink"],l=c.value,u=l.length,[4,Object(s.n)(l,i,e)];case 2:return f=a.sent(),n?this._mergeGroupToCounts(f.counts,f.dates):(this._groupToCount=f.counts,this._groupToCountDate=f.dates),this._groupToCountDate.length>0&&(p=this._groupToCountDate[this._groupToCountDate.length-1].toISOString(),this._logTelemetry("AllPhotos.OldestMediaDate",{oldestMediaDate:p},i)),m=new Date,_=m.getTime()-r.getTime(),this._logTelemetry("AllPhotos.FirstLoadAPICountbyday",{time:_,groups:f.counts.length,requests:1},i),[2,{counts:f.counts,pageToken:d?(o+u).toString():void 0}]}})})},e.prototype._getGroupToCountForSingleAlbum=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._urlDataSource.getCurrentItemKey()];case 1:return t=a.sent(),[4,this._itemProvider.getItem({parentKey:t,ownerId:this.getOwnerId(t),id:e,queryType:c.e.AllMyPhotos,revision:0,skipInMemoryCache:!1,skipCache:!0})];case 2:return n=a.sent(),i=n.item(),r=i&&i.folder&&i.folder.photoCount?i.folder.photoCount:0,o=[e,e,e],[2,{counts:0!==r?[{labels:o,count:r,headers:o}]:[]}]}})})},e.prototype._getGroupToCountForSingleTag=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=this._urlDataSource.getKey(((i={}).id=m,i.qt="allmyphotos",i.tagFilter=e,i)),n=this._urlDataSource.getKeyParams(t),[4,this._itemProvider.getItem({avoidSeamSnapping:!0,parentKey:t,ownerId:this.getOwnerId(),skipCache:!0,pageSize:0,filters:{tagFilter:n.tagFilter,locationFilter:n.locationFilter}})];case 1:return[2,{counts:[{count:a.sent().content().items.length,headers:[e,e,e],labels:[e,e,e]}]}]}})})},e.prototype._getGroupToCountForOnThisDay=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._getPhotoRecordsForOnThisDay(0,0,e)];case 1:if(0===(t=a.sent()).length)return[2,{counts:[]}];if(!t[0].dateTakenTime)throw new Error("Invalid date object");for(n=t[0].dateTakenTime.getUTCFullYear(),i=[],r=0,o=0;o<t.length;o++)(s=t[o]).dateTakenTime&&((c=s.dateTakenTime.getUTCFullYear())!==n&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]}),n=c,r=0),r++);return r>0&&(d=n.toString(),i.push({count:r,labels:[d,d,d],headers:[d,d,d]})),[2,{counts:i}]}})})},e.prototype._getStartDate=function(e,t){for(var n=0,a=-1,i=0,r=0;r<this._groupToCount.length;r++){if((n+=this._groupToCount[r].count)>e){a=r;break}i=n}return a>=0?{date:this._groupToCountDate[a],index:i}:{date:void 0,index:-1}},e.prototype._makeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._vroomDataRequestor.send({apiName:"allPhotos",path:e,useAuthorizationHeaders:!0})];case 1:return t=n.sent(),[3,3];case 2:throw n.sent(),new Error("error loading "+e);case 3:return[2,t]}})})},e.prototype._timeStampToDate=function(e){var t=e;return null==t&&(t="0000-00-00 12:00:00 AM"),/[A,P]M/.test(t)&&(t=t.replace(/-/g,"/")),new Date(t)},e.prototype._transformIOneDriveItemsToIPhotoRecords=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:o=t,a.label=1;case 1:return o<n?e[o]?(s=e[o](),[4,this._transformPhoto(s)]):[3,3]:[3,5];case 2:return r=a.sent(),i.push(r),[3,4];case 3:i.push({id:"",thumbnails:[],name:o.toString(),dateTakenTime:r?r.dateTakenTime:new Date,isVideo:!1}),a.label=4;case 4:return++o,[3,1];case 5:return[2]}})})},e.prototype._transformPhoto=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,s,c,d,l,u,f,p,m,_,h;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return".gif"!==t.extension||t.photo&&t.photo.originalUrl?[3,2]:[4,this._itemProvider.getItem({parentKey:t.key})];case 1:n=a.sent(),(i=n.item()).photo&&i.photo.originalUrl?t=i:console.warn("Retrieved getItems for Gif did not have an Open URL"),a.label=2;case 2:return r=t.thumbnail&&t.thumbnail.width?t.thumbnail.width:t.photo&&t.photo.width,s=t.thumbnail&&t.thumbnail.height?t.thumbnail.height:t.photo&&t.photo.height,r&&s||(r=600,s=600,console.warn("Image doesn't have width and height, using default instead")),c=0!==s?r/s:1,d=Math.min(32,s),l=Math.floor(d*c),u=Math.min(352,s),f=Math.floor(u*c),p=void 0,t.dateTakenTime&&!e._platform.isSafari?p=t.dateTakenTime:t.dateTaken?p=this._timeStampToDate(t.dateTaken):t.dateCreatedTime&&(m=t.dateCreatedTime,_=t.dateModifiedTime,p=m&&_&&m>_?t.dateModifiedTime:t.dateCreatedTime),h=t.thumbnail?o.format(t.thumbnail.url,r,s):"",[2,{id:t.id||t.key,thumbnails:r&&s&&t.thumbnail?[{url:o.format(t.thumbnail.url,l,d),width:l,height:d},{url:o.format(t.thumbnail.url,f,u),width:f,height:u},{url:h,width:r,height:s}]:[{url:"",width:0,height:0}],name:t.name||"No Name",dateTakenTime:p,location:t.geoLocation,extension:t.extension,originalUrl:t.photo&&".gif"===t.extension?t.photo.originalUrl:h,isVideo:!!t.video}]}})})},e.prototype._mergeGroupToCounts=function(e,t){if(this._groupToCount.length>0&&e.length>0){var n=this._groupToCount.length-1;Object(i.n)(this._groupToCount[n]).join(";")===Object(i.n)(e[0]).join(";")?(this._groupToCount[n].count+=e[0].count,e.length>1&&(this._groupToCount=this._groupToCount.concat(e.slice(1)),this._groupToCountDate=this._groupToCountDate.concat(t.slice(1)))):(this._groupToCount=this._groupToCount.concat(e),this._groupToCountDate=this._groupToCountDate.concat(t))}else console.warn("Tried to add empty group to count into local groupToCount variables!")},e.prototype._logTelemetry=function(e,t,n){if(this._engagement)try{this._engagement.logData({name:(l.e[n]||"unknown")+"."+e,extraData:t})}catch(e){console.warn("Exception while logging! ResourceScope may have been disposed.")}},e._platform=new d.e,e}()}],Array(78),[function(e,t,n){"use strict";function a(e){var t=!1;if(e)switch(e.errorCode){case 2:case 101:case 102:case 103:case 152:case 161:case 162:case 200:case 201:case 202:case 209:case 1e3:case 1006:case 1007:case 2006:case 3e3:case 3403:case 9017:case 10001:case 10002:case 10004:case 10006:case 10009:case 10011:case 10012:case 10013:case 10027:t=!0}return t}n.d(t,"e",function(){return a})}],Array(83),[function(e,t,n){"use strict";var a=n(210),i=n(462),r=function(){function e(){}return e.start=function(e){var t=new a.e(function(){for(var e=0,t=o;e<t.length;e++)t[e].cancel()}),n=e.items.slice(),r=e.parallelRequests||1,o=[];function s(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function c(){var a=new i.e,r=n.splice(0,e.batchSize),d=JSON.stringify(e.getPostData(r)),l=a.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:d,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){s(l),e.onBatchComplete&&e.onBatchComplete(r),n.length?c():t.complete()},function(e){s(l),function(e){t.error(e)}(e)});o.push(l)}for(var d=0;n.length>0&&d<r;d++)c();return t.getPromise()},e}();t.e=r}],Array(1312),[function(e,t,n){"use strict";n.r(t),n.d(t,"photosAddon",function(){return E});var a=n(0),i=n(28),r=n(382),o=n(2504),s=n(1833),c=n(2505),d=n(1834),l=n(2399),u=n(1775),f=n(363),p=n(41),m=n(1810),_=n(2506),h=n(61),b=n(149),g=n(2366),v=n(95),y=n(8),S=n(2367),D=n(524),I=n(2183),x=n(1740),C=n(2507),O=n(336),w=new y.t({name:"PhotosAddon",factory:{dependencies:{identityDataSource:h.D},create:function(e){var t=e.identityDataSource;return{instance:new o.e(t)}}}}),E=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,o,E,A,L,k,M,P,T,U,F;return Object(a.__generator)(this,function(H){switch(H.label){case 0:return e(l.e),[4,(t=p.e).consumeAsync(b.e.bypass)];case 1:return H.sent(),t.expose(h.Q,new(t.injected(g.e))),t.expose(v.v,new(t.injected(S.e))),n=t.consume(w),(i=new r.e).resolveItems({items:(F={},F[s.e]=Object(a.__assign)({},d.e.pack(n)),F)}),e(i.execute()),o=t.consume(v._),E=t.consume(x.resourceKey),A=t.consume(h.Se),L=new y.t({name:"PhotosAddon",factory:{dependencies:{vroomDataRequestor:m.e,store:f.e},create:function(e){var n=e.vroomDataRequestor,a=e.store,i=t.consume(O.e),r=new C.e(n,o,E,A,i);return{instance:new c.e(n,a,r)}}}}),k=t.consume(L),M=t.consume(D.t),T={addonSource:k,logRumOneData:function(e,t){M&&M.logRUMOneForItemsScopeListView(e,t,P)},logTTI:P=function(){e(Object(I.a)())},pageSize:100,initialBurstSize:100,widthsPageSize:250,targetHeight:1e3},e(Object(u.c)(T)),k.updateResource(t),U=t.consume(_.e),e(U),[2]}})})}})}])]);