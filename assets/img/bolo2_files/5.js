(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[5],{1745:function(e,t,n){"use strict";var a=n(795);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},1758:function(e,t,n){"use strict";n.d(t,"T",function(){return d}),n.d(t,"P",function(){return l}),n.d(t,"F",function(){return u}),n.d(t,"R",function(){return f}),n.d(t,"c",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"f",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"K",function(){return b}),n.d(t,"z",function(){return g}),n.d(t,"g",function(){return v}),n.d(t,"h",function(){return y}),n.d(t,"b",function(){return S}),n.d(t,"W",function(){return D}),n.d(t,"U",function(){return I}),n.d(t,"s",function(){return x}),n.d(t,"o",function(){return C}),n.d(t,"H",function(){return O}),n.d(t,"_",function(){return w}),n.d(t,"m",function(){return E}),n.d(t,"O",function(){return A}),n.d(t,"C",function(){return L}),n.d(t,"i",function(){return k}),n.d(t,"r",function(){return M}),n.d(t,"E",function(){return P}),n.d(t,"S",function(){return T}),n.d(t,"D",function(){return U}),n.d(t,"L",function(){return F}),n.d(t,"A",function(){return H}),n.d(t,"x",function(){return R}),n.d(t,"I",function(){return N}),n.d(t,"w",function(){return B}),n.d(t,"M",function(){return j}),n.d(t,"k",function(){return V}),n.d(t,"u",function(){return z}),n.d(t,"N",function(){return G}),n.d(t,"v",function(){return K}),n.d(t,"y",function(){return W}),n.d(t,"e",function(){return q}),n.d(t,"G",function(){return Q}),n.d(t,"d",function(){return Y}),n.d(t,"B",function(){return J}),n.d(t,"j",function(){return X}),n.d(t,"l",function(){return Z}),n.d(t,"V",function(){return $}),n.d(t,"p",function(){return ee});var a=n(30),i=n(14),r=n(263),o=n(547),s=n(2343),c=n(679);n.d(t,"a",function(){return c.e});var d=new a.e("photoStreamPerformanceConfigurationKeyFacet",{}),l=d.serialize({}),u=new a.e("photoStreamRootFeedKeyFacet",{}).serialize({}),f=new a.e("photoStreamRootMyStreamKeyFacet",{}).serialize({}),p=new a.e("photoStreamDataRequestorKeyFacet",{}).serialize({}),m=new a.e("graphDataRequestorKeyFacet",{}).serialize({}),_=new a.e("photoStreamKey",{skipToken:i.e,streamId:i.e,userId:i.e,showSizeInfo:r.e}),h=new a.e("photoKey",{photoId:i.e}),b=new a.e("singlePostKey",{streamId:i.e,postId:i.e}),g=new a.e("postKey",{postId:i.e}),v=new a.e("photoStreamListRootKey",{}).serialize({}),y=new a.e("photoStreamListKey",{pageSize:o.e,skipToken:i.e,streamId:i.e}),S=y.serialize({pageSize:250,skipToken:""}),D=new a.e("streamKey",{streamId:i.e}),I=new a.e("photoStreamRootCommentsKey",{postId:i.e}),x=new a.e("photoStreamCommentsKey",{streamId:i.e,postId:i.e,skipToken:i.e}),C=new a.e("photoStreamCommentKey",{commentId:i.e}),O=new a.e("photoStreamRootLikesKey",{postId:i.e}),w=new a.e("photoStreamLikesKey",{streamId:i.e,postId:i.e,skipToken:i.e}),E=new a.e("photoStreamLikeKey",{likeId:i.e}),A=new a.e("photoStreamMyAlbumsKey",{pageSize:o.e,skipToken:i.e}),L=A.serialize({pageSize:10}),k=new a.e("photoStreamAlbumKey",{albumId:i.e}),M=new a.e("photoStreamAlbumPhotosKey",{albumId:i.e,pageSize:o.e,skipToken:i.e}),P=new a.e("photoStreamMyMemoriesKey",{targetDate:i.e}),T=new a.e("photoStreamMemoryKey",{memoryId:i.e}),U=new a.e("photoStreamMemoryPhotosKey",{memoryId:i.e,pageSize:o.e,skipToken:i.e}),F=(new a.e("mojLandingPageKey",{}).serialize({}),new a.e("photoStreamMyPhotosKey",{pageSize:o.e,skipToken:i.e})),H=F.serialize({pageSize:100}),R=new a.e("photoStreamMyActivitiesKey",{pageSize:o.e,skipToken:i.e,type:i.e,numDaysAgo:o.e,origin:i.e}),N=R.serialize({pageSize:20,numDaysAgo:30,origin:"photoStream"}),B=R.serialize({pageSize:20,type:s.e.invite,origin:"photoStream"}),j=R.serialize({pageSize:20,type:s.e.accessRequest,origin:"photoStream"}),V=new a.e("photoStreamMyRecommendedInviteeKey",{streamId:i.e}),z=new a.e("photoStreamInviteeKey",{inviteeId:i.e}),G=new a.e("photoStreamSentInvitesKey",{streamId:i.e}),K=new a.e("photoStreamMembersKey",{pageSize:o.e,skipToken:i.e,streamId:i.e,userId:i.e}),W=new a.e("photoStreamMembersKey",{membershipId:i.e}),q=new a.e("anonymousShareIdKey",{streamId:i.e}),Q=new a.e("shareIdKey",{shareId:i.e}),Y=new a.e("photoStreamDriveItemsKey",{driveId:i.e}),J=new a.e("photoStreamThumbnailKey",{resourceId:i.e}),X=new a.e("photoStreamUserActionHistoryKeyFacet",{}).serialize({}),Z=new a.e("photoStreamInitialLoadKeyFacet",{}).serialize({}),$=new a.e("photoStreamUserActionKey",{postId:i.e}),ee=new a.e("photoStreamLastAuthTicketcRefreshKeyFacet",{}).serialize({})},1765:function(e,t,n){"use strict";n.d(t,"s",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return O}),n.d(t,"o",function(){return w}),n(795);var a,i,r,o,s,c=n(283),d=n(23),l=n(1745);n.d(t,"e",function(){return l.e}),n.d(t,"n",function(){return l.t}),n.d(t,"r",function(){return l.n}),n.d(t,"d",function(){return l.a}),n.d(t,"l",function(){return l.i}),n.d(t,"u",function(){return l.r});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project",g=((a={})[u]=d.OpenInWordOnline,a[f]=d.OpenInOneNoteOnline,a[p]=d.OpenInPowerPointOnline,a[m]=d.OpenInExcelOnline,a[_]=d.OpenInVisioOnline,a);function v(e){return g[e]||""}var y=((i={})[u]=d.OpenInWord,i[f]=d.OpenInOneNote,i[p]=d.OpenInPowerPoint,i[m]=d.OpenInExcel,i[_]=d.OpenInVisio,i[h]=d.OpenInPublisher,i[b]=d.OpenInProject,i["ms-infopath"]=d.OpenInInfoPath,i);function S(e){return y[e]}var D=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function I(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":D[e.appMap]||"Word"}function x(e){return D[e]}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page";var C=((s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s),O={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function w(e){var t=C[e];return t&&new c.e(t)}},1771:function(e,t,n){"use strict";n.d(t,"A",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"l",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"j",function(){return f}),n.d(t,"le",function(){return p}),n.d(t,"re",function(){return m}),n.d(t,"ie",function(){return _}),n.d(t,"$",function(){return h}),n.d(t,"Z",function(){return b}),n.d(t,"ne",function(){return g}),n.d(t,"ee",function(){return v}),n.d(t,"te",function(){return y}),n.d(t,"se",function(){return S}),n.d(t,"de",function(){return D}),n.d(t,"ce",function(){return I}),n.d(t,"ae",function(){return x}),n.d(t,"oe",function(){return C}),n.d(t,"Q",function(){return O}),n.d(t,"K",function(){return w}),n.d(t,"q",function(){return E}),n.d(t,"W",function(){return A}),n.d(t,"Y",function(){return L}),n.d(t,"X",function(){return k}),n.d(t,"u",function(){return M}),n.d(t,"m",function(){return P}),n.d(t,"p",function(){return T}),n.d(t,"f",function(){return U}),n.d(t,"J",function(){return F}),n.d(t,"a",function(){return H}),n.d(t,"P",function(){return R}),n.d(t,"E",function(){return N}),n.d(t,"w",function(){return B}),n.d(t,"F",function(){return j}),n.d(t,"R",function(){return V}),n.d(t,"H",function(){return z}),n.d(t,"L",function(){return G}),n.d(t,"B",function(){return K}),n.d(t,"fe",function(){return W}),n.d(t,"ue",function(){return q}),n.d(t,"s",function(){return Q}),n.d(t,"o",function(){return Y}),n.d(t,"n",function(){return J}),n.d(t,"i",function(){return X}),n.d(t,"O",function(){return Z}),n.d(t,"U",function(){return $}),n.d(t,"N",function(){return ee}),n.d(t,"M",function(){return te}),n.d(t,"G",function(){return ne}),n.d(t,"z",function(){return ae}),n.d(t,"V",function(){return ie}),n.d(t,"T",function(){return re}),n.d(t,"h",function(){return oe}),n.d(t,"S",function(){return se}),n.d(t,"_",function(){return ce}),n.d(t,"C",function(){return de}),n.d(t,"D",function(){return le}),n.d(t,"v",function(){return ue}),n.d(t,"I",function(){return fe}),n.d(t,"y",function(){return pe}),n.d(t,"g",function(){return me});var a=n(2),i=n(679);n.d(t,"b",function(){return i.t}),n.d(t,"x",function(){return i.n}),n.d(t,"k",function(){return i.i});var r=new a.e("VroomDataRequestor"),o=new a.e("GraphDataRequestor"),s=new a.e("albumName"),c=new a.e("albumItemsCount"),d=new a.e("memoryName"),l=new a.e("memoryType"),u=new a.e("memoryItemsCount"),f=new a.e("photoStreamSkipToken"),p=new a.e("postUploadDateTime"),m=new a.e("postOwnerName"),_=new a.e("postOwnerId"),h=new a.e("postDescription"),b=new a.e("postCommentsCount"),g=new a.e("postLikesCount"),v=new a.e("postIsLiked"),y=new a.e("postLikeId"),S=new a.e("postStreamId"),D=new a.e("postStreamName"),I=new a.e("postStreamMemberCount"),x=new a.e("postLocation"),C=new a.e("postQuota"),O=new a.e("photoThumbnails"),w=new a.e("photoThumbnail"),E=new a.e("photoThumbnailWidth"),A=new a.e("photoThumbnailHeight"),L=new a.e("photoUrl"),k=new a.e("photoWidth"),M=new a.e("photoHeight"),P=new a.e("photoSmallUrl"),T=new a.e("photoResourceId"),U=new a.e("photoIsVideo"),F=new a.e("photoVideoData"),H=new a.e("itemIsBlocked"),R=new a.e("photoStreamItemCreatedDateTime"),N=new a.e("photoStreamCoverPhotoShareId"),B=new a.e("photoStreamCoverPhotoResourceId"),j=new a.e("photoStreamName"),V=new a.e("photoStreamOwnerName"),z=new a.e("photoStreamOwnerId"),G=new a.e("photoStreamDescription"),K=new a.e("photoStreamRequireApproval"),W=new a.e("shareIdStreamRecord"),q=new a.e("sentInvites"),Q=new a.e("memberId"),Y=new a.e("memberDisplayName"),J=new a.e("anonymousShareId"),X=new a.e("downloadUrl"),Z=new a.e("photoStreamComment"),$=new a.e("photoStreamLikeId"),ee=new a.e("photoStreamRelationship"),te=new a.e("photoStreamIsPendingInitialLoad"),ne=new a.e("photoStreamUserLikeAction"),ae=new a.e("photoStreamUserLikeActionCountDelta"),ie=new a.e("photoStreamUserCommentActionCountDelta"),re=new a.e("photoStreamLastAuthTicketRefresh"),oe=new a.e("photoStreamActivityMessage"),se=new a.e("photoStreamActivityRequestId"),ce=new a.e("photoStreamActivityActionStatus"),de=new a.e("photoStreamActivityIsRecipient"),le=new a.e("photoStreamActivitySenderId"),ue=new a.e("photoStreamActivityReceiverId"),fe=new a.e("photoStreamActivitySenderName"),pe=new a.e("photoStreamActivityReceiverName"),me=new a.e("photoStreamActivityProfileThumbnailFacet")},1774:function(e,t,n){"use strict";var a,i,r;n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(a||(a={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(i||(i={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(r||(r={}))},1781:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"n",function(){return d});var a,i,r,o=n(1774);!function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(i||(i={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(r||(r={}));var s=function(e){return{isSize8:e===o.n.size8,isSize10:e===o.n.size10||e===o.n.tiny,isSize16:e===o.n.size16,isSize24:e===o.n.size24||e===o.n.extraExtraSmall,isSize28:e===o.n.size28||e===o.n.extraSmall,isSize32:e===o.n.size32,isSize40:e===o.n.size40||e===o.n.small,isSize48:e===o.n.size48||e===o.n.regular,isSize56:e===o.n.size56,isSize72:e===o.n.size72||e===o.n.large,isSize100:e===o.n.size100||e===o.n.extraLarge,isSize120:e===o.n.size120}},c=((a={})[o.n.tiny]=10,a[o.n.extraExtraSmall]=24,a[o.n.extraSmall]=28,a[o.n.small]=40,a[o.n.regular]=48,a[o.n.large]=72,a[o.n.extraLarge]=100,a[o.n.size8]=8,a[o.n.size10]=10,a[o.n.size16]=16,a[o.n.size24]=24,a[o.n.size28]=28,a[o.n.size32]=32,a[o.n.size40]=40,a[o.n.size48]=48,a[o.n.size56]=56,a[o.n.size72]=72,a[o.n.size100]=100,a[o.n.size120]=120,a),d=function(e){return{isAvailable:e===o.t.online,isAway:e===o.t.away,isBlocked:e===o.t.blocked,isBusy:e===o.t.busy,isDoNotDisturb:e===o.t.dnd,isOffline:e===o.t.offline}}},1799:function(e,t,n){"use strict";n.d(t,"e",function(){return J}),n.d(t,"n",function(){return X});var a,i,r=n(0),o=n(94),s=n(29),c=n(36),d=n(460),l=n(435),u=n(253),f=n(2042),p=n(11),m=n(116),_=n(42),h=n(284),b=n(1955),g=n(1765),v=n(262),y=n(1956),S=n(395),D=n(120),I=n(8),x=n(128),C=n(101),O=n(69),w=n(365),E=n(10),A=n(581),L=n(35),k=n(437),M=n(689),P=n(991),T=n(690),U=n(90),F=n(148),H=n(338),R=n(269),N=n(12),B=n(1125),j=window.$Config&&window.$Config.isINT,V=window.FilesConfig&&window.FilesConfig.skyApiDomain,z=window.FilesConfig&&window.FilesConfig.storageDomain,G=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(i||(i={}));var K=N.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),W=!N.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive),q=new I.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new I.e(Object(p.isFeatureEnabled)(p.UseOneUpTextEditor))}),Q=new I.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new I.e(!K)}),Y=new I.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new I.e(W)}),J=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(O.e):a,r=t.useOneUpTextEditor,o=void 0===r?this.resources.consume(q):r,s=t.enableFastOneUp,c=void 0===s?this.resources.consume(Y):s,d=t.useRefactoredDefaultClickUrl,l=void 0===d?this.resources.consume(Q):d;this._navigation=i,this._useOneUpTextEditor=o,this._enableFastOneUp=c,this._useRefactoredDefaultClickUrl=l,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?E.s:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new C.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(E.v)(e)},e.getKeyParams=function(e){return Object(E.y)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(E.m)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+m.n({resid:e})},e.encodeSharingUrl=function(e){return Object(L.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,_.format(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,m.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(L.l)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return D.t.signInUrl+"&"+m.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(M.e)()},e.areCidsEqual=function(e,t){return Object(A.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(E.y)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(r,null,!0),s=((i={}).lru=o,i);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(E._)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.E)(e)},e.prototype.getPhotoType=function(e){return Object(E.w)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(E.C)(e,this._mayBeFastOneUp||t)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.f)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.o)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=c.e.Files),Object(E.L)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(L.O)(e):e===c.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!N.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(E.N)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(E.n)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.H)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case c.e.Files:return this.isCurrentQueryFiles();case c.e.Recent:return this.isCurrentQueryRecent();case c.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case c.e.SharedByMe:return this.isCurrentQuerySharedByMe();case c.e.RecycleBin:return this.isCurrentQueryRecycleBin();case c.e.Photos:case c.e.AllMyPhotos:return Object(E.T)(t);case c.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===c.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:s.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(E.z)&&!Object(p.isFeatureEnabled)(p.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:s.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:s.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(r.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:s.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(r.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:s.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,i=Object(r.__assign)({},this._navigation.viewParams);return delete i.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:s.e.PhotoStream,viewParams:i}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:s.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:s.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:s.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:s.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:s.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:s.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:s.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(R.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:s.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(p.isFeatureEnabled)(p.EnableVroomDocFormatSettings)&&Object(U.e)(E.z)){var t=((e={}).v="documentoptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e;if(Object(H.o)()){var t=((e={}).v="NotificationOptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+m.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(E.x)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+m.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+m.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(T.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(T.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=D.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+m.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+m.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+m.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+m.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,r=e.dateFilter,o=e.conversationId,s=e.largestSize,c=e.filter;c||(c=Object(E.T)(this._navigation.viewParams)?b.t.photos:b.t.all);var d=((n={}).qt="search",n.q=a,n.searchsessionid=o,n.ft=E.e[b.t[c]],n);if("number"==typeof r&&r!==b.e.anyDate){var l=new Date,u=this._getDateDuration(r,l);d.df=i[i.DateCreated],d.beginDate=u.toISOString(),d.endDate=l.toISOString()}return s&&(d.sp="size"),this.getItemUrl(this.getKey(d),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(E.e[b.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:b.t[String(E.e[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.r)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(S.e.folder),16==(16&n)&&t.push(S.e.document),8==(8&n)&&t.push(S.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(E.V)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(L.a)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=m.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+m.n(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+m.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=D.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+m.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){void 0===n&&(n=this._navigation.viewParams);var a={cid:e,resid:t,iam:this.getIAmParamValue(n)};return"/versions.aspx?"+m.n(a,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=Object(g.a)(e),l=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+l+m.n({app:d,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r;if(void 0===t&&(t=this._navigation.viewParams),!N.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(p.isFeatureEnabled)(p.ConvergenceEnabled)&&Object(U.e)(e.ownerId)){var o=null!==(i=null===(a=e.properties)||void 0===a?void 0:a.path)&&void 0!==i?i:null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return Object(B.t)(e.appMap,o,e.extension,!0,!1)}var s=this.getAuthKeyParamValue(t),c=this.getIAmParamValue(t),d={cid:n,resid:e.id,authKey:s,iam:c,autoRedirect:"false"};return this.getCurrentPageBaseUrl()+"/openinclient?"+m.n(d,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+m.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=_.format(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+m.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,i;return this.getItemUrl(this.getKey(Object(r.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((i={}).groupId=n,i):{})))},e.prototype.getExternalUrl=function(t){var n=f.e[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?_.format(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+h.e.encodeURIComponent(n):_.format(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+h.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,i,s;void 0===t&&(t={});var c,d=t.viewParams,l=void 0===d?this._navigation.viewParams:d,f=t.itemSet,p=t.urlType,_=void 0===p?"default":p,h=t.preserveAction,b=void 0!==h&&h,g=t.action,v=void 0===g?b&&this.getAutoActionType(l)||void 0:g;if(!e||!e.key)return"";if(l.sb&&(!this.isCurrentQuery(e.queryType,l)||(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(n={},n.sb=l.sb,n.sd=l.sd,n)))}))),l.mcid&&this.getKeyParams(e.key).cid===(l.cid||l.parCid)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(a={},a.mcid=l.mcid,a.mid=l.mid,a)))})),this._useRefactoredDefaultClickUrl){var y=null===(s=null===(i=null==e?void 0:e.properties)||void 0===i?void 0:i.commandsSupported)||void 0===s?void 0:s.defc,S=f&&f.item.peek(),D=S&&S.key!==e.key&&S||e.UNSAFE_parent,I=D&&D.key,x=void 0;y&&(x="1"===y);var C={itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:x},parentItemInfo:D&&{itemKey:I,itemIsAlbum:D.isAlbum,itemIsPlaceholder:D.isPlaceholder,itemIsStub:D.isStub,itemVirtualItemType:D.virtualItemType,itemExtension:D.extension,itemType:D.type,itemOpenUrl:D.openUrl,itemErrorType:D.error&&D.error.type},preserveAction:b,action:v,viewParams:l,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:_};return Object(P.t)(C)}var O=this._getDefaultUrlFormat(e),w=!!N.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==o.e.Media;return l.mid&&w&&(O=P.e.current),c=e.type===o.e.Error?P.e.external:"existing"===_?this._getCurrentUrlFormat(l):"focus"===_||v?v&&v!==u.t.locate&&O===P.e.current?O:P.e.focus:O,this._getItemClickUrl(e,f,c,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:s.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.i)(e);var t=D.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",_.format(t,h.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(E.S)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(E.D)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.P)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.A)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,i=t.item;return Object(E.g)(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:e,itemInfo:i&&{itemKey:i.key,itemIsPlaceholder:i.isPlaceholder,itemVirtualItemType:i.virtualItemType,itemExtension:i.extension,itemType:i.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(F.e)(o,s):delete o.sc,"#"+m.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+m.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return b.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=b.e.oneDay;break;case 30:t=b.e.oneMonth;break;case 7:t=b.e.oneWeek;break;case 365:t=b.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(j?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(E.B)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||D.t.si;if(!n)return"";var a=v.t(n),i=m.e(a),r=i.wreply,o=v.t(r),s=m.e(o);return s.action=u.t[e],i.wreply="".concat(v.n(r),"?").concat(m.n(s)),"".concat(v.n(n),"?").concat(m.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return m.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.a)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(L.i)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Object(P.a)({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:s.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,o=this.getKeyParams(r&&r.key||"");i.parId=o.id;var c=m.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(G,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,i=n.page,o=n.action,s=n.preserveAction,f=void 0!==s&&s,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(r.__assign)({},_),b=this._getPreservedViewParams(m);void 0!==i&&(b.v=this._getPageParamValue(i,m));var g=!1,v=Object(w.a)(a);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===c.e.Search||y===c.e.AllMyPhotos||y===c.e.PhotoStream||(h.v=""),v||!Object(d.e)(y)||"photos"===b.v&&"photoStream"===b.v&&this.getContextualFilter(_)===E.e.photos.toString()||(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(F.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case b.e.oneDay:n.setDate(n.getDate()-1);break;case b.e.oneMonth:n.setDate(n.getDate()-30);break;case b.e.oneWeek:n.setDate(n.getDate()-7);break;case b.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?P.e.focus:P.e.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case o.e.Media:t=P.e.focus;break;case o.e.Folder:case o.e.Error:t=P.e.current;break;default:t=P.e.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,o=a.page,c=void 0===o?this.getPageType(r):o;if(n!==P.e.current&&c===s.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(w.a)(e))n=this._useOneUpTextEditor&&c!==s.e.TextFileEditor?P.e.focus:P.e.external;else if(c===s.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+m.n(r,null,!0);switch(n){case P.e.current:d=this._getCurrentItemUrl(e,a);break;case P.e.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var _=p.action;return _?d&&d.commentId&&"showproperties"===_.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=_):f.o=e.oneUpOverlayValue,l&&Object(F.e)(f,l),"#"+m.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case s.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case s.e.TextFileEditor:n="TextFileEditor";break;case s.e.Photos:n="photos";break;case s.e.RansomwareDetection:n="RansomwareDetection";default:case s.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||0){case 3:return this.getMarketBlockedUrl();case 5:return this.qualifyUrl(this.getItemUrl(t.key));case 2:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case 1:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case 4:var r=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return D.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case 6:return this.getValidatePermissionUrl();case 9:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,r=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,r);if(e.type===o.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(w.a)(e))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,r,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,r,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(E.c)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(E.d)():window.location.pathname},e.prototype._getPreservedViewParams=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t);for(var a in e)0===a.indexOf("EXPExperimentTest_e")&&(n[a]=e[a]);var i=e["WT.mc_id"],r=e.ocid;return i&&(n["WT.mc_id"]=i,n.ocid=r||i),n},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(E.j)(e,t):t||D.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:O.e,useOneUpTextEditor:q,useRefactoredDefaultClickUrl:Q,enableFastOneUp:Y},e.oneUpOverlayValue=k.i,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=V+"/API/2/",e.viewerId=E.z,e.storageBaseUrl=z,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=k.a,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((a={}).photo=y.i,a.list=y.a,a.grid=y.n,a),e.placeholderId=0,e}();t.t=J;var X=Object(x.r)("UrlDataSource",J)},1805:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"c",function(){return g}),n.d(t,"s",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"n",function(){return S}),n.d(t,"o",function(){return D}),n.d(t,"r",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return C});var a=n(143),i=n(627),r=n(1771),o=n(1758),s=n(1856),c=n(2283),d=n(209),l=n(19),u=n(1755),f=n(9),p=n(153),m=n(35),_=function(){return _=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_.apply(this,arguments)};function h(){return function(e){var t=e(function(e){return e(Object(a.e)(function(e){return e.demandItemFacet(r.A,o.c)}))}),n=e(function(e){return e(Object(a.e)(function(e){return e.demandItemFacet(r.r,o.t)}))});if(!t)throw new Error("Could not get vroom data requestor");if(!n)throw new Error("Could not get graph data requestor");return new c.e(t,n)}}function b(){return function(e){return e(Object(a.e)(function(e){return e.demandItemFacet(r.M,o.l)}))}}function g(e,t,n){return function(a){var i;a(b())||a(Object(d.e)({items:(i={},i[e]=_({},t.pack(n)),i)}))}}function v(e,t,n){return function(i){var r,s;if(i(b())){var c=o.V.serialize({postId:e});i(Object(d.e)({items:(r={},r[c]=_({},t.pack(n)),r)}));var u=i(Object(a.e)(function(e){var t=e.demandItemFacet(l.e,o.j);return t&&t.itemKeys||[]}));u.indexOf(c)<0&&(u.push(c),i(Object(d.e)({items:(s={},s[o.j]=_({},l.e.pack({itemKeys:u})),s)})))}}}function y(e,t){var n=e.demandItemFacet(l.e,t);return{activities:(n&&n.itemKeys||[]).map(function(t){var n=e.demandItemFacet(r.x,t)||"",a=e.demandItemFacet(r.k,t)||"",i=e.demandItemFacet(r.b,t)||"",o=e.demandItemFacet(r.P,t)||new Date,s=e.demandItemFacet(r.S,t)||"",c=e.demandItemFacet(r.h,t)||"",d=e.demandItemFacet(r.K,t)||"",l=e.demandItemFacet(r._,t)||"",u=e.demandItemFacet(r.C,t)||!1,f={id:e.demandItemFacet(r.D,t)||"",name:e.demandItemFacet(r.I,t)||""},p={id:e.demandItemFacet(r.v,t)||"",name:e.demandItemFacet(r.y,t)||""};return{type:n,createTime:o,streamId:a,postId:i,ownerName:u?p.name:f.name,ownerId:u?p.id:f.id,requestId:s,message:c,thumbnail:d,actionStatus:l,isRecipient:u}}),skipToken:e.demandItemFacet(r.j,t)||""}}function S(e,t){var n,a=(null===(n=t.demandItemFacet(o.z,e))||void 0===n?void 0:n.postId)||"",i=t.demandItemFacet(r.le,e)||new Date,s=t.demandItemFacet(r.re,e)||u.ve,c=t.demandItemFacet(r.ie,e)||"",d=t.demandItemFacet(r.$,e)||"",f=t.demandItemFacet(r.ae,e)||"",p=t.demandItemFacet(r.se,e)||"",m=t.demandItemFacet(r.de,e)||"",_=t.demandItemFacet(r.ce,e)||0,h=t.demandItemFacet(r.Z,e)||0,b=t.demandItemFacet(r.ne,e)||0,g=t.demandItemFacet(r.ee,e)||!1,v=t.demandItemFacet(r.te,e)||"",y=t.demandItemFacet(r.oe,e),S=t.demandItemFacet(l.e,e),D=S&&S.itemKeys||[],I=[];return D.forEach(function(e){var n,a=(null===(n=t.demandItemFacet(o.n,e))||void 0===n?void 0:n.photoId)||"",i=t.demandItemFacet(r.K,e)||"",s=t.demandItemFacet(r.X,e),c={itemKey:e,id:a,thumbnail:i,isLiked:!1,likesCount:0,commentsCount:0,height:t.demandItemFacet(r.u,e),width:s,photoUrl:t.demandItemFacet(r.Y,e),smallPhotoUrl:t.demandItemFacet(r.m,e),resourceId:t.demandItemFacet(r.p,e),isVideo:t.demandItemFacet(r.f,e),isBlocked:t.demandItemFacet(r.a,e)};I.push(c)}),{itemKey:e,id:a,uploadDate:i,ownerName:s,ownerId:c,description:d,location:f,commentsCount:h,likesCount:b,isLiked:g,likeId:v,streamId:p,streamName:m,streamMemberCount:_,photos:I,quota:y}}function D(e,t){var n,a=e.id,i=new Date(e.createdDateTime),c=e.createdBy.user,d=c.displayName,u=c.id,f=e.description,p=e.location?e.location.displayName:"",m=e.reactions,h=m.commentCount?m.commentCount:0,b=m.likeCount?m.likeCount:0,g=e.photoStreamPostReactionByCaller,v=!!g,y=g?g.id:"",S=e.photoStreamPost,D=S.photoStreamId,I=S.photoStreamName,x=S.memberCount,C=S.quota?S.quota.used:null,O=o.z.serialize({postId:a}),w=[],E=S.items||[];return 0===E.length?null:(E.forEach(function(e){var n,a,i=e.id,c=e.photoStreamPostItem.resourceId,d=null!==(a=e.image)&&void 0!==a?a:{width:800,height:800},l=!!e.video,u=Boolean(e.restricted&&"None"!==e.restricted.restrictionType),f=Object(s.o)(c,d.width,d.height,l),p=3*d.width,m=3*d.height,h=Object(s.n)(c,p,m),b=Math.round(.1*d.width),g=Math.round(.1*d.height),v=Object(s.n)(c,b,g),y=o.n.serialize({photoId:i});t.resolveItems({items:(n={},n[y]=_(_(_(_(_(_(_(_({},r.K.pack(f)),r.X.pack(p)),r.u.pack(m)),r.Y.pack(h)),r.m.pack(v)),r.p.pack(c)),r.f.pack(l)),r.a.pack(u)),n)}),w.push(y)}),t.resolveItems({items:(n={},n[O]=_(_(_(_(_(_(_(_(_(_(_(_(_(_({},r.le.pack(i)),r.re.pack(d)),r.ie.pack(u)),r.$.pack(f)),r.ae.pack(p)),r.Z.pack(h)),r.ne.pack(b)),r.ee.pack(v)),r.se.pack(D)),r.de.pack(I)),r.ce.pack(x)),r.te.pack(y)),r.oe.pack(C)),l.e.pack({itemKeys:w})),n)}),O)}function I(e){return function(t){var n,a,s=o.N.serialize({streamId:"me"}),c=o.k.serialize({streamId:e});if(t(Object(i.e)({items:(n={},n[s]=[r.ue],n[c]=[l.e],n)})),e){var d=o.N.serialize({streamId:e});t(Object(i.e)({items:(a={},a[d]=[r.ue],a)}))}}}function x(){return function(e){var t;e(Object(i.e)({items:(t={},t[o.M]=[l.e],t[o.I]=[l.e],t)}))}}function C(e){return f.e.serialize({driveId:Object(p.e)(m.M),endpoint:Object(m.l)({apiVersion:"v1.0",driveId:Object(p.e)(m.M)}),itemId:e})}},1810:function(e,t,n){"use strict";var a=n(1907);n.d(t,"e",function(){return a.e})},1856:function(e,t,n){"use strict";n.d(t,"i",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"e",function(){return a}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(1799),r=n(35);function o(e){var t=i.t.storageBaseUrl;return"".concat(t,"/users/0x").concat(e,"/myprofile/expressionprofile/profilephoto:UserTileStatic")}function s(e,t,n,a){var r=i.t.storageBaseUrl,o="",s="";t&&n&&(o="width=".concat(t,"&height=").concat(n)),a&&(s="cropmode=".concat(a));var c=[o,s].filter(function(e){return""!==e});return c.length>0?"".concat(r,"/items/").concat(e,"?").concat(c.join("&")):"".concat(r,"/items/").concat(e)}function c(e,t,n,a){void 0===a&&(a=!1);var i=s(e,800,800,"center");return a?i=s(e,2*t,2*n,"center"):t>n?i=s(e,t,n):n>t&&(i=s(e,600,800,"center")),i}function d(e,t){var n=Object(r.l)({apiVersion:"v1.0",driveId:"me"});return"".concat(n,"/shares/").concat(e,"/driveitem/thumbnails/0/").concat(t,"/content?prefer=noredirect")}function l(e){var t="",n=null==e?void 0:e.split("?");if(n&&2===n.length){var a=n[1],i=new URLSearchParams(a);i.has("$skiptoken")&&(t=i.get("$skiptoken"))}return t}function u(){return"https://go.microsoft.com/fwlink/?linkid=2189105"}!function(e){e.small="small",e.medium="medium",e.large="large"}(a||(a={}))},1907:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(8),i=n(128),r=n(1119),o=n(2011),s=n(1083),c=n(1933),d=n(60),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u="VroomDataRequestor",f=new a.t({name:"".concat(u,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),p=Object(i.r)(u,s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:f})},1933:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(8),i=n(1092),r=n(1122),o=n(1120),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},1955:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))},1956:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s});var a="List",i="CompactList",r="Grid",o="Album",s="AllPhotos"},1967:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1774),i=[a.e.lightBlue,a.e.blue,a.e.darkBlue,a.e.teal,a.e.green,a.e.darkGreen,a.e.lightPink,a.e.pink,a.e.magenta,a.e.purple,a.e.orange,a.e.lightRed,a.e.darkRed,a.e.violet,a.e.gold,a.e.burgundy,a.e.warmGray,a.e.cyan,a.e.rust,a.e.coolGray],r=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case a.e.lightBlue:return"#4F6BED";case a.e.blue:return"#0078D4";case a.e.darkBlue:return"#004E8C";case a.e.teal:return"#038387";case a.e.lightGreen:case a.e.green:return"#498205";case a.e.darkGreen:return"#0B6A0B";case a.e.lightPink:return"#C239B3";case a.e.pink:return"#E3008C";case a.e.magenta:return"#881798";case a.e.purple:return"#5C2E91";case a.e.orange:return"#CA5010";case a.e.red:return"#EE1111";case a.e.lightRed:return"#D13438";case a.e.darkRed:return"#A4262C";case a.e.transparent:return"transparent";case a.e.violet:return"#8764B8";case a.e.gold:return"#986F0B";case a.e.burgundy:return"#750B1C";case a.e.warmGray:return"#7A7574";case a.e.cyan:return"#005B70";case a.e.rust:return"#8E562E";case a.e.coolGray:return"#69797E";case a.e.black:return"#1D1D1D";case a.e.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=a.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var s=e.charCodeAt(o),c=o%8;n^=(s<<c)+(s>>8-c)}return i[n%r]}(n||t))}},1988:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(128),i=n(2115),r=n(2116),o=n(1083),s=Object(a.r)("GraphDataRequestor",o.e,{sessionManagementProvider:i.resourceKey,urlDataSource:r.resourceKey});o.e},2011:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(366),r=new(n(8).t)("MicroServiceDataSource.key"),o=n(60),s=n(1101),c=n(128),d=n(85),l=n(88);!function(e){e.unauthUser="unauthUser"}(a||(a={}));var u=n(396),f={ODB:n(1121).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===i.e.aad){if(t&&p){var r=new l.e(t).authority;return this._identityDataSource.getSharePointToken(r)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return o.n.resolve()})}else if(n===i.e.msa)return this._identityDataSource.getSessionToken();return o.n.reject(new d.e({code:a.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:s.e,microServiceDataSource:r.optional},e}(),_=Object(c.r)("SessionManagementProvider",m)},2026:function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(1469),i=n(3),r=n(1),o=n(786),s=n(103),c=n(425),d=n(2231),l=n(100),u=n(31),f=n(508),p=n(1774),m=n(1781),_=Object(o.e)({cacheSize:100}),h=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e,t){return r.createElement(f.e,{className:e,iconName:b(n.props.presence,n.props.isOutOfOffice),style:t})},n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,a=e.styles,i=e.presence,o=e.theme,s=e.presenceTitle,c=e.presenceColors,d=Object(m.a)(this.props.size),l=!(d.isSize8||d.isSize10||d.isSize16||d.isSize24||d.isSize28||d.isSize32)&&(!t||t>32),u=t?t/3<40?t/3+"px":"40px":"",f=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:u}:void 0,h=t?{width:u,height:u}:void 0,b=_(a,{theme:o,presence:i,size:this.props.size,isOutOfOffice:n,presenceColors:c});return i===p.t.none?null:r.createElement("div",{role:"presentation",className:b.presence,style:h,title:s},l&&this._onRenderIcon(b.presenceIcon,f))},t}(r.Component);function b(e,t){if(e){var n="SkypeArrow";switch(p.t[e]){case"online":return"SkypeCheck";case"away":return t?n:"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?n:""}return""}}var g={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function v(e){return{color:e,borderColor:e}}function y(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function S(e){return{height:e,width:e}}function D(e){return{backgroundColor:e}}var I=Object(a.e)(h,function(e){var t,n,a,r,o,s,c=e.theme,d=e.presenceColors,l=c.semanticColors,f=c.fonts,p=Object(u.I)(g,c),_=Object(m.a)(e.size),h=Object(m.n)(e.presence),b=d&&d.available||"#6BB700",I=d&&d.away||"#FFAA44",x=d&&d.busy||"#C43148",C=d&&d.dnd||"#C50F1F",O=d&&d.offline||"#8A8886",w=d&&d.oof||"#B4009E",E=d&&d.background||l.bodyBackground,A=h.isOffline||e.isOutOfOffice&&(h.isAvailable||h.isBusy||h.isAway||h.isDoNotDisturb),L=_.isSize72||_.isSize100?"2px":"1px";return{presence:[p.presence,Object(i.e)(Object(i.e)({position:"absolute",height:m.e.size12,width:m.e.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+E,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box"},Object(u.x)()),{selectors:(t={},t[u.r]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(_.isSize8||_.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[u.r]={top:"9px",border:"1px solid WindowText"},n)},(_.isSize8||_.isSize10||_.isSize24||_.isSize28||_.isSize32)&&S(m.e.size8),(_.isSize40||_.isSize48)&&S(m.e.size12),_.isSize16&&{height:m.e.size6,width:m.e.size6,borderWidth:"1.5px"},_.isSize56&&S(m.e.size16),_.isSize72&&S(m.e.size20),_.isSize100&&S(m.e.size28),_.isSize120&&S(m.e.size32),h.isAvailable&&{backgroundColor:b,selectors:(a={},a[u.r]=D("Highlight"),a)},h.isAway&&D(I),h.isBlocked&&[{selectors:(r={":after":_.isSize40||_.isSize48||_.isSize72||_.isSize100?{content:'""',width:"100%",height:L,backgroundColor:x,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},r[u.r]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},r)}],h.isBusy&&D(x),h.isDoNotDisturb&&D(C),h.isOffline&&D(O),(A||h.isBlocked)&&[{backgroundColor:E,selectors:(o={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:L+" solid "+x,borderRadius:"50%",boxSizing:"border-box"}},o[u.r]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},o)}],A&&h.isAvailable&&y(L,b),A&&h.isBusy&&y(L,x),A&&h.isAway&&y(L,w),A&&h.isDoNotDisturb&&y(L,C),A&&h.isOffline&&y(L,O),A&&h.isOffline&&e.isOutOfOffice&&y(L,w)],presenceIcon:[p.presenceIcon,{color:E,fontSize:"6px",lineHeight:m.e.size12,verticalAlign:"top",selectors:(s={},s[u.r]={color:"Window"},s)},_.isSize56&&{fontSize:"8px",lineHeight:m.e.size16},_.isSize72&&{fontSize:f.small.fontSize,lineHeight:m.e.size20},_.isSize100&&{fontSize:f.medium.fontSize,lineHeight:m.e.size28},_.isSize120&&{fontSize:f.medium.fontSize,lineHeight:m.e.size32},h.isAway&&{position:"relative",left:A?void 0:"1px"},A&&h.isAvailable&&v(b),A&&h.isBusy&&v(x),A&&h.isAway&&v(w),A&&h.isDoNotDisturb&&v(C),A&&h.isOffline&&v(O),A&&h.isOffline&&e.isOutOfOffice&&v(w)]}},void 0,{scope:"PersonaPresence"}),x=n(953),C=n(144),O=n(1967),w=Object(o.e)({cacheSize:100}),E=Object(s.t)(function(e,t,n,a,i,r){return Object(u.U)(e,!r&&{backgroundColor:Object(O.e)({text:a,initialsColor:t,primaryText:i}),color:n})}),A=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCoin=function(e){var t=n.props,a=t.coinSize,i=t.styles,o=t.imageUrl,s=t.imageAlt,c=t.imageShouldFadeIn,d=t.imageShouldStartVisible,l=t.theme,u=t.showUnknownPersonaCoin;if(!o)return null;var f=n.props.size,p=w(i,{theme:l,size:f,showUnknownPersonaCoin:u}),_=a||m.i[f];return r.createElement(x.e,{className:p.image,imageFit:C.t.cover,src:o,width:_,height:_,alt:s,shouldFadeIn:c,shouldStartVisible:d,onLoadingStateChange:n._onPhotoLoadingStateChange})},n._onRenderInitials=function(e){var t=e.imageInitials,a=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return r.createElement(f.e,{iconName:"Help"});var i=Object(c.e)(n.props.theme);return""!==(t=t||Object(d.e)(n._getText(),i,a))?r.createElement("span",null,t):r.createElement(f.e,{iconName:"Contact"})},n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===C.n.loaded,isImageError:e===C.n.error}),n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)},n.state={isImageLoaded:!1,isImageError:!1},n}return Object(i.a)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.coinProps,a=e.showUnknownPersonaCoin,o=e.coinSize,s=e.styles,c=e.imageUrl,d=e.initialsColor,u=e.initialsTextColor,m=e.isOutOfOffice,_=e.onRenderCoin,h=void 0===_?this._onRenderCoin:_,b=e.onRenderPersonaCoin,g=void 0===b?h:b,v=e.onRenderInitials,y=void 0===v?this._onRenderInitials:v,S=e.presence,D=e.presenceTitle,x=e.presenceColors,C=e.primaryText,O=e.showInitialsUntilImageLoads,A=e.text,L=e.theme,k=this.props.size,M=Object(l.s)(this.props,l.r),P=Object(l.s)(n||{},l.r),T=o?{width:o,height:o}:void 0,U=a,F={coinSize:o,isOutOfOffice:m,presence:S,presenceTitle:D,presenceColors:x,size:k,theme:L},H=w(s,{theme:L,className:n&&n.className?n.className:t,size:k,coinSize:o,showUnknownPersonaCoin:a}),R=Boolean(!this.state.isImageLoaded&&(O&&c||!c||this.state.isImageError||U));return r.createElement("div",Object(i.e)({role:"presentation"},M,{className:H.coin}),k!==p.n.size8&&k!==p.n.size10&&k!==p.n.tiny?r.createElement("div",Object(i.e)({role:"presentation"},P,{className:H.imageArea,style:T}),R&&r.createElement("div",{className:E(H.initials,d,u,A,C,a),style:T,"aria-hidden":"true"},y(this.props,this._onRenderInitials)),!U&&g(this.props,this._onRenderCoin),r.createElement(I,Object(i.e)({},F))):this.props.presence?r.createElement(I,Object(i.e)({},F)):r.createElement(f.e,{iconName:"Contact",className:H.size10WithoutPresenceIcon}),this.props.children)},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.defaultProps={size:p.n.size48,presence:p.t.none,imageAlt:""},t}(r.Component),L={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},k=Object(a.e)(A,function(e){var t,n=e.className,a=e.theme,r=e.coinSize,o=a.palette,s=a.fonts,c=Object(m.a)(e.size),d=Object(u.I)(L,a),l=r||e.size&&m.i[e.size]||48;return{coin:[d.coin,s.medium,c.isSize8&&d.size8,c.isSize10&&d.size10,c.isSize16&&d.size16,c.isSize24&&d.size24,c.isSize28&&d.size28,c.isSize32&&d.size32,c.isSize40&&d.size40,c.isSize48&&d.size48,c.isSize56&&d.size56,c.isSize72&&d.size72,c.isSize100&&d.size100,c.isSize120&&d.size120,n],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[d.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:l,width:l},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[d.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0},l>10&&{height:l,width:l}],initials:[d.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":o.white,fontSize:s.large.fontSize,fontWeight:u.i.semibold,lineHeight:48===l?46:l,height:l,selectors:(t={},t[u.r]=Object(i.e)(Object(i.e)({border:"1px solid WindowText"},Object(u.x)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:u.i.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},l<32&&{fontSize:s.xSmall.fontSize},l>=32&&l<40&&{fontSize:s.medium.fontSize},l>=40&&l<56&&{fontSize:s.mediumPlus.fontSize},l>=56&&l<72&&{fontSize:s.xLarge.fontSize},l>=72&&l<100&&{fontSize:s.xxLarge.fontSize},l>=100&&{fontSize:s.superLarge.fontSize}]}},void 0,{scope:"PersonaCoin"})},2042:function(e,t,n){"use strict";var a;!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={})),t.e=a},2095:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return s}),n.d(t,"n",function(){return d}),n.d(t,"a",function(){return l});var a,i,r,o=n(1755);!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.UNEXPECTED_FAILURE=1]="UNEXPECTED_FAILURE",e[e.COMMENT_NOT_FOUND=2]="COMMENT_NOT_FOUND",e[e.CREATE_COMMENT_FAILURE=3]="CREATE_COMMENT_FAILURE",e[e.CREATE_POST_FAILURE=4]="CREATE_POST_FAILURE",e[e.CREATE_REACTION_FAILURE=5]="CREATE_REACTION_FAILURE",e[e.CREATE_PHOTOSTORY_FAILURE=6]="CREATE_PHOTOSTORY_FAILURE",e[e.DUPLICATE_REACTION=7]="DUPLICATE_REACTION",e[e.EXCEEDED_COMMENT_COTNTENT_LENGTH=8]="EXCEEDED_COMMENT_COTNTENT_LENGTH",e[e.EXCEEDED_LOCATION_LENGTH=9]="EXCEEDED_LOCATION_LENGTH",e[e.EXCEEDED_PHOTOSTORY_NAME_LENGTH=10]="EXCEEDED_PHOTOSTORY_NAME_LENGTH",e[e.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH=11]="EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH",e[e.EXCEEDED_POST_DESCRIPTION_LENGTH=12]="EXCEEDED_POST_DESCRIPTION_LENGTH",e[e.EXCEEDED_COMMENTS_PER_POST=13]="EXCEEDED_COMMENTS_PER_POST",e[e.EXCEEDED_ITEMS_PER_POST=14]="EXCEEDED_ITEMS_PER_POST",e[e.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER=15]="EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER",e[e.EXCEEDED_MEMBERS_PER_PHOTOSTORY=16]="EXCEEDED_MEMBERS_PER_PHOTOSTORY",e[e.EXCEEDED_POSTS_PER_PHOTOSTORY=17]="EXCEEDED_POSTS_PER_PHOTOSTORY",e[e.INVITATION_NOT_FOUND=18]="INVITATION_NOT_FOUND",e[e.ACCESS_REQUEST_NOT_FOUND=19]="ACCESS_REQUEST_NOT_FOUND",e[e.MEMBERSHIP_NOT_FOUND=20]="MEMBERSHIP_NOT_FOUND",e[e.POST_NOT_FOUND=21]="POST_NOT_FOUND",e[e.PHOTOSTORY_ALREADY_EXIST=22]="PHOTOSTORY_ALREADY_EXIST",e[e.PHOTOSTORY_NOT_FOUND=23]="PHOTOSTORY_NOT_FOUND",e[e.REACTION_NOT_FOUND=24]="REACTION_NOT_FOUND",e[e.SHAREID_NOT_FOUND=25]="SHAREID_NOT_FOUND",e[e.SOUTH_KOREA_LAW=26]="SOUTH_KOREA_LAW",e[e.VIDEO_CONTENT_NOT_AVAILABLE=27]="VIDEO_CONTENT_NOT_AVAILABLE",e[e.USER_NOT_ACTIVE=28]="USER_NOT_ACTIVE",e[e.UNDER_AGE=29]="UNDER_AGE",e[e.INVALID_SHARE_KEY=30]="INVALID_SHARE_KEY"}(r||(r={}));var s=((a={})[r.UNKNOWN]=o.Fr,a[r.UNEXPECTED_FAILURE]=o.Rr,a[r.COMMENT_NOT_FOUND]=o.W,a[r.CREATE_COMMENT_FAILURE]=o.$,a[r.CREATE_POST_FAILURE]=o.se,a[r.CREATE_REACTION_FAILURE]=o.me,a[r.CREATE_PHOTOSTORY_FAILURE]=o.ee,a[r.EXCEEDED_COMMENT_COTNTENT_LENGTH]=o.Ft,a[r.EXCEEDED_LOCATION_LENGTH]=o.Nt,a[r.EXCEEDED_PHOTOSTORY_NAME_LENGTH]=o.zt,a[r.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH]=o.Vt,a[r.EXCEEDED_POST_DESCRIPTION_LENGTH]=o.Gt,a[r.EXCEEDED_COMMENTS_PER_POST]=o.Ht,a[r.EXCEEDED_ITEMS_PER_POST]=o.Rt,a[r.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER]=o.Bt,a[r.EXCEEDED_MEMBERS_PER_PHOTOSTORY]=o.jt,a[r.EXCEEDED_POSTS_PER_PHOTOSTORY]=o.Kt,a[r.INVITATION_NOT_FOUND]=o.Sn,a[r.ACCESS_REQUEST_NOT_FOUND]=o.i,a[r.MEMBERSHIP_NOT_FOUND]=o.qn,a[r.POST_NOT_FOUND]=o.ti,a[r.PHOTOSTORY_ALREADY_EXIST]=o.Ka,a[r.PHOTOSTORY_NOT_FOUND]=o.Wa,a[r.REACTION_NOT_FOUND]=o.oi,a[r.SHAREID_NOT_FOUND]=o.qi,a[r.SOUTH_KOREA_LAW]=o.rr,a[r.VIDEO_CONTENT_NOT_AVAILABLE]=o.qa,a[r.INVALID_SHARE_KEY]=o.yn,a),c=((i={}).unexpectedfailure=r.UNKNOWN,i.commentnotfound=r.COMMENT_NOT_FOUND,i.createcommentfailure=r.CREATE_COMMENT_FAILURE,i.createpostfailure=r.CREATE_POST_FAILURE,i.createreactionfailure=r.CREATE_REACTION_FAILURE,i.createphotostoryfailure=r.CREATE_PHOTOSTORY_FAILURE,i.duplicatereaction=r.DUPLICATE_REACTION,i.exceededcommentcontentlength=r.EXCEEDED_COMMENT_COTNTENT_LENGTH,i.exceededlocationlength=r.EXCEEDED_LOCATION_LENGTH,i.exceededphotostorynamelength=r.EXCEEDED_PHOTOSTORY_NAME_LENGTH,i.exceededphotostorydescriptionlength=r.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH,i.exceededpostdescriptionlength=r.EXCEEDED_POST_DESCRIPTION_LENGTH,i.exceededcommentsperpost=r.EXCEEDED_COMMENTS_PER_POST,i.exceededitemsperpost=r.EXCEEDED_ITEMS_PER_POST,i.exceededmemberphotostoriesperuser=r.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER,i.exceededmembersperphotostory=r.EXCEEDED_MEMBERS_PER_PHOTOSTORY,i.exceededpostsperphotostory=r.EXCEEDED_POSTS_PER_PHOTOSTORY,i.invitationnotfound=r.INVITATION_NOT_FOUND,i.accessrequestnotfound=r.ACCESS_REQUEST_NOT_FOUND,i.membershipnotfound=r.MEMBERSHIP_NOT_FOUND,i.postnotfound=r.POST_NOT_FOUND,i.photostoryalreadyexist=r.PHOTOSTORY_ALREADY_EXIST,i.photostorynotfound=r.PHOTOSTORY_NOT_FOUND,i.reactionnotfound=r.REACTION_NOT_FOUND,i.shareidnotfound=r.SHAREID_NOT_FOUND,i.usernotactive=r.USER_NOT_ACTIVE,i.geolocinvalidrequest=r.SOUTH_KOREA_LAW,i.underageaccessdenied=r.UNDER_AGE,i.photostoryunderageaccessdenied=r.UNDER_AGE,i.invalidshareskey=r.INVALID_SHARE_KEY,i);function d(e){var t,n,a;return(null===(t=e.response)||void 0===t?void 0:t.error["@error.photoStreamErrorCode"])||(null===(a=null===(n=e.innerError)||void 0===n?void 0:n.response)||void 0===a?void 0:a.error["@error.photoStreamErrorCode"])||e.code||"UnexpectedFailure"}function l(e){var t=e?e.toLowerCase():"";return c[t]||r.UNKNOWN}},2115:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return c});var a=n(0),i=n(235),r=n(128),o=n(61),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(a.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{identityDataSource:o.D}),t}(i.e);t.default=s;var c=Object(r.r)("GraphTokenProvider",s)},2116:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphUrlDataSource",function(){return r}),n.d(t,"resourceKey",function(){return o});var a=n(8),i=n(128),r=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),o=new a.t({name:"GraphUrlDataSource",factory:new i.i(r)})},2231:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,i=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,o=/\s+/g,s=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function c(e,t,n){return e?(e=function(e){return(e=(e=(e=e.replace(a,"")).replace(i,"")).replace(o," ")).trim()}(e),s.test(e)||!n&&r.test(e)?"":function(e,t){var n="",a=e.split(" ");return 2===a.length?(n+=a[0].charAt(0).toUpperCase(),n+=a[1].charAt(0).toUpperCase()):3===a.length?(n+=a[0].charAt(0).toUpperCase(),n+=a[2].charAt(0).toUpperCase()):0!==a.length&&(n+=a[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},2283:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(35),i=n(155),r=n(462),o=n(1799),s=n(52),c=n(2095),d=n(10),l=n(153),u=n(338),f=function(){return f=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)},p=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},m=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},_=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},h=function(){function e(e,t){this.apiName="PhotoStream",this.defaultRequestorHeaders={"Accept-Language":i.e.language},this.vroomDataRequestor=e,this.endpoint=Object(a.l)({apiVersion:"v2.1",driveId:"me"}),this.driveId=d.z?Object(l.e)(d.z):"me"}return e.prototype.getPhotoStreamQuota=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){return e=new r.e,t=o.t.skyApiBaseUrl+"GetStorageInfo",[2,e.send({apiName:"".concat(this.apiName,".get.quota"),url:t})]})})},e.prototype.getDriveId=function(){return this.driveId},e.prototype.getEndpoint=function(){return this.endpoint},e.prototype.getDriveItemDetails=function(e){return p(this,void 0,void 0,function(){var t,n;return m(this,function(i){return t=e.split("!")[0],n="/drives/".concat(t,"/items/").concat(e,"?expand=thumbnails&select=id,@content.downloadUrl,thumbnails,video"),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.itemDetails"),headers:this.defaultRequestorHeaders,path:n,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.createPhotoStream=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n={name:e,description:t||""},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.stream"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n)})]})})},e.prototype.deletePhotoStream=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.stream"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.updatePhotoStreamProperties=function(e,t,n,a,i){return void 0===n&&(n=""),void 0===a&&(a=""),void 0===i&&(i=""),p(this,void 0,void 0,function(){return m(this,function(r){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".update.properties"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e),requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({description:a,name:i,photoStream:{coverPhotoResourceId:n,requireApproval:t}})})]})})},e.prototype.getPhotoStreamList=function(e,t,n){return void 0===e&&(e=20),p(this,void 0,void 0,function(){function a(e,t){if(t){var n=Object(c.n)(t),a=Object(c.a)(n);a!==c.t.USER_NOT_ACTIVE&&a!==c.t.UNDER_AGE||(e.resultType=s.e.ExpectedFailure)}return e}var i,r;return m(this,function(o){return i=t?"/drives/".concat(this.driveId,"/photostreams/").concat(t):"/drives/".concat(this.driveId,"/photostreams?$top=").concat(e),r=n?"&$skiptoken=".concat(n):"",i="".concat(i).concat(r),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.streamList"),headers:this.defaultRequestorHeaders,path:i,requestType:"GET",postProcessQos:a,useAuthorizationHeaders:!0})]})})},e.prototype.createPost=function(e,t){return p(this,void 0,void 0,function(){var n,a;return m(this,function(i){return n=null==e?void 0:e.photos.map(function(e){return{photoStreamPostItem:{resourceId:e.id}}}),a={description:null==e?void 0:e.description,location:{displayName:null==e?void 0:e.location},photoStreamPost:{items:n}},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.createPost"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(t,"/posts"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a)})]})})},e.prototype.editPost=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n={description:null==e?void 0:e.description,location:{displayName:null==e?void 0:e.location}},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.editPost"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(t,"/posts/").concat(e.id),requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n)})]})})},e.prototype.deletePost=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.post"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.getFeed=function(e,t,n,a){return p(this,void 0,void 0,function(){var i,r,o;return m(this,function(s){return i=t?"&$skiptoken=".concat(t):"",r=f({},this.defaultRequestorHeaders),a&&(r.Prefer="Include-PhotoStory-Quota"),o=n?"/drives/".concat(this.driveId,"/photostreams/").concat(n,"/posts?$top=").concat(e,"&$expand=photoStreamPost,photoStreamPostReactionByCaller"):"/drives/".concat(this.driveId,"/oneDrive.mediaFeed?$top=").concat(e,"&$expand=photoStreamPost,photoStreamPostReactionByCaller"),o+=i,[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,n?".get.story":".get.feed"),path:o,requestType:"GET",headers:r,useAuthorizationHeaders:!0})]})})},e.prototype.getThumbnail=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(i){return n="/drives/".concat(e,"/items/").concat(t,"/thumbnails/0/large"),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.videoThumbnail"),path:n,requestType:"GET",headers:this.defaultRequestorHeaders,useAuthorizationHeaders:!0})]})})},e.prototype.getAlbumPhotos=function(e,t,n){return p(this,void 0,void 0,function(){var i,r;return m(this,function(o){return i=null!=t?t:100,r="/drives/".concat(this.driveId,"/items/").concat(e,"/children?orderby=createdDateTime+asc&top=").concat(i,"&select=id,name,thumbnails,video&expand=thumbnails"),n&&(r="".concat(r,"&skiptoken=").concat(n)),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.album"),headers:this.defaultRequestorHeaders,path:r,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getAlbumCoverPhoto=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.albumCoverPhoto"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/items/").concat(e,"?select=id,name,thumbnails&expand=thumbnails"),requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyAlbums=function(e,t){return p(this,void 0,void 0,function(){var n,i;return m(this,function(r){return n=null!=e?e:6,i="/drives/".concat(this.driveId,"/bundles?filter=bundle/album+ne+null&orderby=createdDateTime+desc&top=").concat(n,"&select=bundle,id,name"),t&&(i="".concat(i,"&skiptoken=").concat(t)),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myAlbums"),headers:this.defaultRequestorHeaders,path:i,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyPhotos=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(i){return e=e||100,n="/drives/".concat(this.driveId,"/items/root/items?filter=photo+ne+null&orderby=photo/takenDateTime+desc&expand=thumbnails&top=").concat(e),t&&(n+="&skiptoken=".concat(t)),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myPhotos"),headers:this.defaultRequestorHeaders,path:n,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyMemories=function(e){return p(this,void 0,void 0,function(){var t,n,i,r,o;return m(this,function(s){return t="/drives/".concat(this.driveId,"/recommendedItems?expand=thumbnails"),e?t="".concat(t,"&targetDate=").concat(e):(n=new Date,i=n.getMonth()+1,r=n.getDate(),o=[n.getFullYear(),(i>9?"":"0")+i,(r>9?"":"0")+r].join("-"),t="".concat(t,"&targetDate=").concat(o)),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myMemories"),headers:this.defaultRequestorHeaders,path:t,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMemoryPhotos=function(e,t,n){return p(this,void 0,void 0,function(){var i,r;return m(this,function(o){return i=null!=t?t:100,r="/drives/".concat(this.driveId,"/recommendedItems/").concat(e,"/children?expand=thumbnails&top=").concat(i),n&&(r+="&skiptoken=".concat(n)),[2,this.vroomDataRequestor.send({endpoint:Object(a.l)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.memory"),headers:this.defaultRequestorHeaders,path:r,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.createComment=function(e,t,n){return p(this,void 0,void 0,function(){var a;return m(this,function(i){return a={text:n},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.comment"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a)})]})})},e.prototype.getComments=function(e,t,n){return p(this,void 0,void 0,function(){var a;return m(this,function(i){return a=n?"&$skiptoken=".concat(n):"",[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.comments"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments?").concat(a),requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.deleteComment=function(e,t,n){return p(this,void 0,void 0,function(){return m(this,function(a){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.comment"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments/").concat(n),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.createLikeReaction=function(e,t){return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify({type:"Like"})})},e.prototype.deleteLikeReaction=function(e,t,n){return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions/").concat(n),requestType:"DELETE",useAuthorizationHeaders:!0})},e.prototype.getReactions=function(e,t,n){var a=n?"&$skiptoken=".concat(n):"";return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions?").concat(a),requestType:"GET",useAuthorizationHeaders:!0})},e.prototype.getActivities=function(e,t,n,a,i,r){var o;return void 0===e&&(e=20),p(this,void 0,void 0,function(){var s,c,d,l,f,p,_,h;return m(this,function(m){return s="invite($expand=photoStream),accessRequest($expand=photoStream),post($expand=photoStreamPost)",c=[],n&&(s="".concat(n,"($expand=photoStream)"),c.push("Type in ('".concat(n,"')"))),i&&a?c.push("(activityDateTime ge ".concat(a," and activityDateTime le ").concat(i,")")):i?c.push("(activityDateTime le ".concat(i,")")):a&&c.push("(activityDateTime ge ".concat(a,")")),d="/drives/".concat(this.driveId,"/photostreams/oneDrive.psActivities?$expand=").concat(s,"&$top=").concat(e),l=c.join(" and "),d+=l&&"&$filter=".concat(l),f=t?"&$skiptoken=".concat(t):"",d="".concat(d).concat(f),p=r?"".concat(this.apiName,".get.activities.").concat(r):"".concat(this.apiName,".get.activities"),_=Object(u.t)()?Object(u.t)().toDateString():"",h=null!==(o=Object(u.e)())&&void 0!==o?o:"",[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:p,headers:this.defaultRequestorHeaders,path:d,requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{lastProvisionCheck:_,hasProvisionCheck:h}})]})})},e.prototype.acceptInvite=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.acceptInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamInvitation/oneDrive.psAccept?$expand=photoStream"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.getSentInvites=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.sentInvites"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamInvitations"),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.cancelPendingInvite=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.pendingInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamInvitations/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.dismissInvite=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.invite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamInvitation"),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.followByShareId=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.psFollow"),headers:this.defaultRequestorHeaders,path:"/shares/".concat(e,"/photoStream/myPhotoStreamInvitation/oneDrive.psAccept"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.getRecommendedInvitees=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.recommendedInvitees"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.recommendedInvitees?$top=50"),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.deleteMyMembership=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.myMembership"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamMembership"),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.deleteMembership=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.membership"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesByEmail=function(e,t,n){return p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a=t.map(function(e){return{email:e}}),i=JSON.stringify({message:null!=n?n:"",recipients:a}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:i,useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesById=function(e,t,n){return p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a=t.map(function(e){return{objectId:e}}),i=JSON.stringify({message:null!=n?n:"",recipients:a}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:i,useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesByIdAndEmail=function(e,t,n,a){return p(this,void 0,void 0,function(){var i,r,o,s;return m(this,function(c){return i=t.map(function(e){return{objectId:e}}),r=n.map(function(e){return{email:e}}),o=_(_([],i,!0),r,!0),s=JSON.stringify({message:null!=a?a:"",recipients:o}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:s,useAuthorizationHeaders:!0})]})})},e.prototype.getPhotoStreamMembers=function(e,t,n){return void 0===t&&(t=100),p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a="/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships?$filter=state eq 'active'&$top=").concat(t),i=n?"&$skiptoken=".concat(n):"",a="".concat(a).concat(i),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.members"),headers:this.defaultRequestorHeaders,path:a,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMembersStatus=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n=t.map(function(e){return"'".concat(e,"'")}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.members"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships?$filter=member/id in (").concat(n,") "),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.getAnonymousShareId=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.anonymousShareId"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psGetAnonymousSharingBaseUri"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.revokeAnonymousShareLink=function(e){return p(this,void 0,void 0,function(){var t;return m(this,function(n){return t=JSON.stringify({regenerateLink:!0}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.anonymousShareId"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psGetAnonymousSharingBaseUri"),requestType:"POST",postData:t,useAuthorizationHeaders:!0})]})})},e.prototype.getPhotoStreamDataFromShareId=function(e,t){return void 0===t&&(t=!0),p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.streamDataFromShareId"),headers:this.defaultRequestorHeaders,path:"/shares/".concat(e,"/photoStream"),requestType:"GET",useAuthorizationHeaders:!0,needsAuthorization:t})]})})},e.prototype.acceptJoinRequest=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.acceptJoinRequest"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamAccessRequests/").concat(t,"/oneDrive.psApprove"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.declineJoinRequest=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.joinRequest"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamAccessRequests/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.getPost=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.post"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/posts/").concat(t,"?expand=photoStreamPost,photoStreamPostReactionByCaller"),requestType:"GET",useAuthorizationHeaders:!0})]})})},e}()},2299:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.INVALID="invalid",e.INVITED="invited",e.ACTIVE="active",e.ACCESSREQUEST="accessRequested",e.NONE="none"}(a||(a={}))},2343:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={invite:"Invite",accessRequest:"AccessRequest",like:"Reaction",comment:"Comment",inviteAccepted:"InviteAccepted",accessGranted:"AccessGranted",newPost:"NewPost"}},2344:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return o});var a=n(1755);function i(e){if(e){var t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),a=Math.floor(e/36e5),i=t<10?"0".concat(t):t;return a>0&&0===n&&0===t?"".concat(a,":00:00"):a>0&&n>0&&0===t?"".concat(a,":").concat(n,":00"):a>0&&0===n&&t>0?"".concat(a,":00:").concat(t):a>0&&n>0&&t>0?"".concat(a,":").concat(n,":").concat(t):0===a&&n>0&&0===t?"".concat(n,":00"):0===a&&n>0&&t>0?"".concat(n,":").concat(i):0===a&&0===n&&t>0?"0:".concat(i):"0:00"}}function r(e,t){return e>0?e+t:""}function o(e,t){return r(s.inYears(e,t),a.kr)||r(s.inWeeks(e,t),a.Lr)||r(s.inDays(e,t),a.Or)||r(s.inHours(e,t),a.wr)||r(s.inMinutes(e,t),a.Er)||r(s.inSeconds(e,t),a.Ar)}var s={inSeconds:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/1e3)},inMinutes:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/6e4)},inHours:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/36e5)},inDays:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/864e5)},inWeeks:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/6048e5)},inYears:function(e,t){var n=t.getTime(),a=e.getTime();return Math.floor(Math.abs(n-a)/31536e6)}}},2356:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a=n(1469),i=n(3),r=n(1),o=n(786),s=n(100),c=n(1622),d=n(1018),l=n(138),u=n(2026),f=n(1774),p=Object(o.e)(),m=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderPersonaCoin=function(e){return r.createElement(u.e,Object(i.e)({},e))},n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this._onRenderText(this._getText(),this.props.showOverflowTooltip),t=this._onRenderText(this.props.secondaryText,this.props.showOverflowTooltip),n=this._onRenderText(this.props.tertiaryText,this.props.showOverflowTooltip),a=this._onRenderText(this.props.optionalText,this.props.showOverflowTooltip),o=this.props,c=o.hidePersonaDetails,d=o.onRenderOptionalText,l=void 0===d?a:d,u=o.onRenderPrimaryText,m=void 0===u?e:u,_=o.onRenderSecondaryText,h=void 0===_?t:_,b=o.onRenderTertiaryText,g=void 0===b?n:b,v=o.onRenderPersonaCoin,y=void 0===v?this._onRenderPersonaCoin:v,S=this.props.size,D=this.props,I=D.allowPhoneInitials,x=D.className,C=D.coinProps,O=D.showUnknownPersonaCoin,w=D.coinSize,E=D.styles,A=D.imageAlt,L=D.imageInitials,k=D.imageShouldFadeIn,M=D.imageShouldStartVisible,P=D.imageUrl,T=D.initialsColor,U=D.initialsTextColor,F=D.isOutOfOffice,H=D.onPhotoLoadingStateChange,R=D.onRenderCoin,N=D.onRenderInitials,B=D.presence,j=D.presenceTitle,V=D.presenceColors,z=D.showInitialsUntilImageLoads,G=D.showSecondaryText,K=D.theme,W=Object(i.e)({allowPhoneInitials:I,showUnknownPersonaCoin:O,coinSize:w,imageAlt:A,imageInitials:L,imageShouldFadeIn:k,imageShouldStartVisible:M,imageUrl:P,initialsColor:T,initialsTextColor:U,onPhotoLoadingStateChange:H,onRenderCoin:R,onRenderInitials:N,presence:B,presenceTitle:j,showInitialsUntilImageLoads:z,size:S,text:this._getText(),isOutOfOffice:F,presenceColors:V},C),q=p(E,{theme:K,className:x,showSecondaryText:G,presence:B,size:S}),Q=Object(s.s)(this.props,s.r),Y=r.createElement("div",{className:q.details},this._renderElement(q.primaryText,m,e),this._renderElement(q.secondaryText,h,t),this._renderElement(q.tertiaryText,g,n),this._renderElement(q.optionalText,l,a),this.props.children);return r.createElement("div",Object(i.e)({},Q,{className:q.root,style:w?{height:w,minWidth:w}:void 0}),y(W,this._onRenderPersonaCoin),(!c||S===f.n.size8||S===f.n.size10||S===f.n.tiny)&&Y)},t.prototype._renderElement=function(e,t,n){return r.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.prototype._onRenderText=function(e,t){return void 0===t&&(t=!0),e?t?function(){return r.createElement(c.e,{content:e,overflowMode:d.e.Parent,directionalHint:l.e.topLeftEdge},e)}:function(){return r.createElement(r.Fragment,null,e)}:void 0},t.defaultProps={size:f.n.size48,presence:f.t.none,imageAlt:"",showOverflowTooltip:!0},t}(r.Component),_=n(31),h=n(1781),b={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"},g=Object(a.e)(m,function(e){var t=e.className,n=e.showSecondaryText,a=e.theme,i=a.semanticColors,r=a.fonts,o=Object(_.I)(b,a),s=Object(h.a)(e.size),c=Object(h.n)(e.presence),d="16px",l={color:i.bodySubtext,fontWeight:_.i.regular,fontSize:r.small.fontSize};return{root:[o.root,a.fonts.medium,_.H,{color:i.bodyText,position:"relative",height:h.t.size48,minWidth:h.t.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},s.isSize8&&[o.size8,{height:h.t.size8,minWidth:h.t.size8}],s.isSize10&&[o.size10,{height:h.t.size10,minWidth:h.t.size10}],s.isSize16&&[o.size16,{height:h.t.size16,minWidth:h.t.size16}],s.isSize24&&[o.size24,{height:h.t.size24,minWidth:h.t.size24}],s.isSize24&&n&&{height:"36px"},s.isSize28&&[o.size28,{height:h.t.size28,minWidth:h.t.size28}],s.isSize28&&n&&{height:"32px"},s.isSize32&&[o.size32,{height:h.t.size32,minWidth:h.t.size32}],s.isSize40&&[o.size40,{height:h.t.size40,minWidth:h.t.size40}],s.isSize48&&o.size48,s.isSize56&&[o.size56,{height:h.t.size56,minWidth:h.t.size56}],s.isSize72&&[o.size72,{height:h.t.size72,minWidth:h.t.size72}],s.isSize100&&[o.size100,{height:h.t.size100,minWidth:h.t.size100}],s.isSize120&&[o.size120,{height:h.t.size120,minWidth:h.t.size120}],c.isAvailable&&o.available,c.isAway&&o.away,c.isBlocked&&o.blocked,c.isBusy&&o.busy,c.isDoNotDisturb&&o.doNotDisturb,c.isOffline&&o.offline,t],details:[o.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(s.isSize8||s.isSize10)&&{paddingLeft:17},(s.isSize24||s.isSize28||s.isSize32)&&{padding:"0 8px"},(s.isSize40||s.isSize48)&&{padding:"0 12px"}],primaryText:[o.primaryText,_.F,{color:i.bodyText,fontWeight:_.i.regular,fontSize:r.medium.fontSize,selectors:{":hover":{color:i.inputTextHovered}}},n&&{height:d,lineHeight:d,overflowX:"hidden"},(s.isSize8||s.isSize10)&&{fontSize:r.small.fontSize,lineHeight:h.t.size8},s.isSize16&&{lineHeight:h.t.size28},(s.isSize24||s.isSize28||s.isSize32||s.isSize40||s.isSize48)&&n&&{height:18},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&{fontSize:r.xLarge.fontSize},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&n&&{height:22}],secondaryText:[o.secondaryText,_.F,l,(s.isSize8||s.isSize10||s.isSize16||s.isSize24||s.isSize28||s.isSize32)&&{display:"none"},n&&{display:"block",height:d,lineHeight:d,overflowX:"hidden"},s.isSize24&&n&&{height:18},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&{fontSize:r.medium.fontSize},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&n&&{height:18}],tertiaryText:[o.tertiaryText,_.F,l,{display:"none",fontSize:r.medium.fontSize},(s.isSize72||s.isSize100||s.isSize120)&&{display:"block"}],optionalText:[o.optionalText,_.F,l,{display:"none",fontSize:r.medium.fontSize},(s.isSize100||s.isSize120)&&{display:"block"}],textContent:[o.textContent,_.F]}},void 0,{scope:"Persona"})},2711:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(28),i=n(1540),r=n(1468),o=n(1771),s=n(1758),c=n(234),d=n(382),l=n(19),u=n(1805),f=n(2),p=n(1856),m=function(){return m=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},m.apply(this,arguments)},_=Object(a.i)()(function(e){var t=this;return function(n){return a=t,void 0,h=function(){var t,a,_,h,b,g;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(v){switch(v.label){case 0:return t=n(Object(u.a)()),a=s.h.deserialize(e.itemKey),_=a.pageSize,h=a.skipToken,b=a.streamId,[4,t.getPhotoStreamList(_,"me"===b?void 0:b,h)];case 1:return g=v.sent(),n(function(e,t,n){return function(a){var u,_,h;if(e){var b=e.value||[e],g=new d.e,v=[];b.forEach(function(e){var t,n,a,i=s.W.serialize({streamId:e.id}),r=e.createdBy.user,c=r.displayName;g.resolveItems({items:(t={},t[i]=m(m(m(m(m(m(m({},o.E.pack(null!==(n=e.photoStream.coverPhotoShareId)&&void 0!==n?n:"")),o.w.pack(e.photoStream.coverPhotoResourceId)),o.B.pack(null!==(a=e.photoStream.requireApproval)&&void 0!==a&&a)),o.F.pack(e.name)),o.R.pack(c)),o.H.pack(r.id)),o.L.pack(e.description)),t)}),v.push(i)});var y=e["@odata.nextLink"],S=Object(p.r)(y);g.resolveItems({items:(u={},u[t]=m(m({},l.e.pack({itemKeys:v})),o.j.pack(S)),u)}),g.resolveItems({items:(_={},_[s.g]=Object(f.t)({newChildItems:l.e},{newChildItems:{itemKeys:n?new i.e([t]):new r.e([t])}}),_)}),g.resolveItems({items:(h={},h[s.g]=m({},Object(c.e)().forFacet(l.e).thenInvalidate(t,l.e).pack()),h)}),a(g.execute())}}}(g,e.itemKey,h)),[2]}})},new((_=void 0)||(_=Promise))(function(e,t){function n(e){try{r(h.next(e))}catch(e){t(e)}}function i(e){try{r(h.throw(e))}catch(e){t(e)}}function r(t){var a;t.done?e(t.value):(a=t.value,a instanceof _?a:new _(function(e){e(a)})).then(n,i)}r((h=h.apply(a,[])).next())});var a,_,h}})},2712:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a=n(28),i=n(1771),r=n(1758),o=n(382),s=n(19),c=n(1805),d=n(1007),l=n(2343),u=n(1856),f=n(7),p=n(1755),m=n(2299),_=function(){return _=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_.apply(this,arguments)},h=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},b=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},g=Object(a.i)()(function(e){var t=this;return function(n){return h(t,void 0,void 0,function(){var t,a,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F;return b(this,function(H){switch(H.label){case 0:return t=n(Object(c.a)()),a=r.x.deserialize(e.itemKey),g=a.pageSize,v=a.skipToken,y=a.type,S=a.numDaysAgo,D=a.origin,I="",S>0&&(x=new Date,C=new Date(x.setDate(x.getDate()-S)),I=C.toISOString()),[4,t.getActivities(g,v,y,I,null,D)];case 1:return(null==(O=H.sent())?void 0:O.value)?(w=null==O?void 0:O.value,E=r.h.serialize({}),[4,n(Object(d.e)(function(e){var t,n=e.demandItemFacet(s.e,E),a=n&&n.itemKeys||[];return{streamId:(null===(t=e.demandItemFacet(r.W,a[0]))||void 0===t?void 0:t.streamId)||"",ownerId:e.demandItemFacet(i.H,a[0])||"",ownerName:e.demandItemFacet(i.R,a[0])||""}}))]):[3,5];case 2:return A=H.sent(),L=A.streamId,k=A.ownerId,M=A.ownerName,P={displayName:M,id:k},T=w.reduce(function(e,t){var n,a,i=null===(a=null===(n=t.invite)||void 0===n?void 0:n.photoStream)||void 0===a?void 0:a.createdBy.user.id;return t.type===l.e.inviteAccepted&&i!==P.id&&e.push(i),e},[]),U={},T.length>0?[4,n(Object(c.a)()).getMembersStatus(L,T)]:[3,4];case 3:F=H.sent(),U=T.reduce(function(e,t){var n=F.find(function(e){return e.member.id===t});return e[t]=(null==n?void 0:n.state)||m.e.NONE,e},{}),H.label=4;case 4:n(function(e,t,n,a){var c=this;return function(d){return h(c,void 0,void 0,function(){var c,m,h,g,v,y;return b(this,function(b){return c=e.value,m=new o.e,h=[],c.forEach(function(e){var a,o,s,c,d,b,g,v,y,S,D,I,x,C=function(e,t){return e.type===l.e.inviteAccepted?e.invite.invitee.id!==t:e.type===l.e.accessGranted&&e.accessRequest.requester.id===t}(e,t.id),O=function(e,t){var n,a;return e.type===l.e.invite||e.type===l.e.inviteAccepted?{sender:null===(n=e.invite.photoStream.createdBy)||void 0===n?void 0:n.user,receiver:e.invite.invitee}:e.type===l.e.accessRequest||e.type===l.e.accessGranted?{sender:e.accessRequest.requester,receiver:null===(a=e.accessRequest.photoStream.createdBy)||void 0===a?void 0:a.user}:{sender:e.actor.user,receiver:t}}(e,t),w=O.sender,E=O.receiver,A=(null===(s=e.comment)||void 0===s?void 0:s.photoStreamId)||(null===(c=e.reaction)||void 0===c?void 0:c.photoStreamId)||(null===(b=null===(d=e.invite)||void 0===d?void 0:d.photoStream)||void 0===b?void 0:b.id)||(null===(v=null===(g=e.accessRequest)||void 0===g?void 0:g.photoStream)||void 0===v?void 0:v.id)||"",L=new Date(e.activityDateTime),k=r.a.serialize({activityId:e.id}),M="";if(null===(S=null===(y=e.post)||void 0===y?void 0:y.photoStreamPost)||void 0===S?void 0:S.items){var P=e.post.photoStreamPost.items[0];M=Object(u.n)(P.photoStreamPostItem.resourceId,P.image.width,P.image.height)}if(m.resolveItems({items:(a={},a[k]=_(_(_(_(_(_(_(_(_(_(_(_(_(_({},i.k.pack(A)),i.b.pack(null===(D=e.post)||void 0===D?void 0:D.id)),i.x.pack(e.type)),i.P.pack(L)),i.S.pack(null===(I=e.accessRequest)||void 0===I?void 0:I.id)),i.h.pack(null===(x=e.comment)||void 0===x?void 0:x.text)),i.K.pack(M)),i.C.pack(C)),i.D.pack(w.id)),i.v.pack(E.id)),i.I.pack(w.displayName||p.ve)),i.y.pack(E.displayName||p.ve)),i.g.pack(Object(u.i)(w.id))),f._.pack({})),a)}),e.type===l.e.inviteAccepted){var T=n[C?E.id:w.id];m.resolveItems({items:(o={},o[k]=_({},i._.pack(T)),o)})}h.push(k)}),g=e["@odata.nextLink"],v=Object(u.r)(g),m.resolveItems({items:(y={},y[a]=_(_({},s.e.pack({itemKeys:h})),i.j.pack(v)),y)}),d(m.execute()),[2]})})}}(O,P,U,e.itemKey)),H.label=5;case 5:return[2]}})})}})},2755:function(e,t,n){"use strict";n.d(t,"e",function(){return H});var a=n(28),i=n(311),r=n(1771),o=n(1758),s=n(209),c=n(379),d=n(19),l=n(382),u=n(1805),f=n(1856),p=n(97),m=n(9),_=n(7),h=n(578),b=function(){return b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},g=Object(a.i)()(function(e){var t=this;return function(n){return a=t,void 0,s=function(){var t,a,i,s,c,g,v,y,S,D,I,x,C,O;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(w){switch(w.label){case 0:return t=o.r.deserialize(e.itemKey),a=t.albumId,i=t.pageSize,s=t.skipToken,[4,(c=n(Object(u.a)())).getAlbumPhotos(a,i,s)];case 1:return(g=w.sent())&&g.value&&(v=g["@odata.nextLink"],y=Object(f.r)(v),S=g.value,D=[],I=new l.e,S.forEach(function(e){var t,n=o.n.serialize({photoId:e.id}),a={driveId:c.getDriveId(),endpoint:Object(p.o)({apiVersion:"v1.0",driveId:c.getDriveId()}),itemId:e.id},i=m.e.serialize(a),s=e.thumbnails[0].small,d=e.thumbnails[0].medium,l=e.thumbnails[0].large;I.resolveItems({items:(t={},t[i]=b({},_.p.pack(Object(h.t)(e.name,!1))),t[n]=b(b(b(b({},m.e.pack(a)),r.Q.pack({small:{height:s.height,width:s.width,url:s.url},medium:{height:d.height,width:d.width,url:d.url},large:{height:l.height,width:l.width,url:l.url}})),r.f.pack(Boolean(e.video))),r.J.pack(e.video)),t)}),D.push(n)}),I.resolveItems({items:(C={},C[e.itemKey]=b(b({},r.j.pack(y)),d.e.pack({itemKeys:D})),C)}),y&&(x=o.r.serialize({albumId:a,pageSize:i,skipToken:y}),I.invalidateItems({items:(O={},O[x]=[d.e],O)})),n(I.execute())),[2]}})},new((i=void 0)||(i=Promise))(function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i(function(e){e(a)})).then(n,r)}o((s=s.apply(a,[])).next())});var a,i,s}}),v=n(234),y=function(){return y=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},y.apply(this,arguments)},S=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},D=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},I=Object(a.i)()(function(e){var t=this;return function(n){return S(t,void 0,void 0,function(){var t,a,i,s,c,p,m,_,h,b,g,I,x=this;return D(this,function(C){switch(C.label){case 0:return t=o.O.deserialize(e.itemKey),a=t.pageSize,i=t.skipToken,[4,(s=n(Object(u.a)())).getMyAlbums(a,i)];case 1:return c=C.sent(),p=new l.e,c&&c.value?[4,Promise.all(c.value.filter(function(e){return e.bundle.childCount>0}).map(function(t){return S(x,void 0,void 0,function(){var n,a,i,c,l,u,f,m;return D(this,function(_){switch(_.label){case 0:return[4,s.getAlbumCoverPhoto(t.id)];case 1:return(n=_.sent())?(a=o.i.serialize({albumId:t.id}),i=n.thumbnails[0].small,c=n.thumbnails[0].medium,l=n.thumbnails[0].large,p.resolveItems({items:(f={},f[a]=y(y(y({},r.t.pack(t.name)),r.e.pack(t.bundle.childCount)),r.Q.pack({small:{height:i.height,width:i.width,url:i.url},medium:{height:c.height,width:c.width,url:c.url},large:{height:l.height,width:l.width,url:l.url}})),f)}),u=o.r.serialize({albumId:t.id,pageSize:100}),p.resolveItems({items:(m={},m[e.itemKey]=y({},Object(v.e)().forFacet(d.e).thenInvalidate(u,d.e).pack()),m)}),[2,a]):[2,""]}})})}))]:[3,3];case 2:m=C.sent(),_=c["@odata.nextLink"],h=Object(f.r)(_),p.resolveItems({items:(g={},g[e.itemKey]=y(y({},r.j.pack(h)),d.e.pack({itemKeys:m.filter(Boolean)})),g)}),h&&(b=o.O.serialize({pageSize:a,skipToken:h}),p.invalidateItems({items:(I={},I[b]=[d.e],I)})),n(p.execute()),C.label=3;case 3:return[2]}})})}}),x=function(){return x=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},x.apply(this,arguments)},C=Object(a.i)()(function(e){var t=this;return function(n){return a=t,void 0,s=function(){var t,a,i,s,c,b,g,v,y,S,D,I,C;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(O){switch(O.label){case 0:return t=o.L.deserialize(e.itemKey),a=t.skipToken,i=t.pageSize,[4,(s=n(Object(u.a)())).getMyPhotos(i,a).then(function(e){return e})];case 1:return(c=O.sent())&&c.value&&(b=c["@odata.nextLink"],g=Object(f.r)(b),v=c.value,y=[],S=new l.e,v.forEach(function(e){var t,n=o.n.serialize({photoId:e.id}),a={driveId:s.getDriveId(),endpoint:Object(p.o)({apiVersion:"v1.0",driveId:s.getDriveId()}),itemId:e.id},i=m.e.serialize(a),c=e.thumbnails[0].small,d=e.thumbnails[0].medium,l=e.thumbnails[0].large,u=!!e.video,f=e.video;S.resolveItems({items:(t={},t[i]=x({},_.p.pack(Object(h.t)(e.name,!1))),t[n]=x(x(x(x({},m.e.pack(a)),r.Q.pack({small:{height:c.height,width:c.width,url:c.url},medium:{height:d.height,width:d.width,url:d.url},large:{height:l.height,width:l.width,url:l.url}})),r.f.pack(u)),r.J.pack(f)),t)}),y.push(n)}),S.resolveItems({items:(I={},I[e.itemKey]=x(x({},r.j.pack(g)),d.e.pack({itemKeys:y})),I)}),g&&(D=o.L.serialize({pageSize:i,skipToken:g}),S.invalidateItems({items:(C={},C[D]=[d.e],C)})),n(S.execute())),[2]}})},new((i=void 0)||(i=Promise))(function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i(function(e){e(a)})).then(n,r)}o((s=s.apply(a,[])).next())});var a,i,s}}),O=function(){return O=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O.apply(this,arguments)},w=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},E=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},A=Object(a.i)()(function(e){var t=this;return function(n){return w(t,void 0,void 0,function(){var t,a,i,s,c,f,p=this;return E(this,function(m){switch(m.label){case 0:return t=n(Object(u.a)()),a=o.E.deserialize(e.itemKey).targetDate,[4,t.getMyMemories(a)];case 1:return i=m.sent(),s=new l.e,i&&i.value?[4,Promise.all(i.value.filter(function(e){return(!e.recommendation.count||e.recommendation.count>0)&&"RecentPhotos"!==e.recommendation.recommendationType}).map(function(e){return w(p,void 0,void 0,function(){var t,n,a,i,c,d;return E(this,function(l){return t=o.S.serialize({memoryId:e.id}),n=e.thumbnails[0],a=n.small,i=n.medium,c=n.large,s.resolveItems({items:(d={},d[t]=O(O(O(O({},r.d.pack(e.recommendation.title)),r.l.pack(e.recommendation.recommendationType)),r.c.pack(e.recommendation.count)),r.Q.pack({small:{height:a.height,width:a.width,url:a.url},medium:{height:i.height,width:i.width,url:i.url},large:{height:c.height,width:c.width,url:c.url}})),d)}),[2,t]})})}))]:[3,3];case 2:c=m.sent(),s.resolveItems({items:(f={},f[e.itemKey]=O({},d.e.pack({itemKeys:c})),f)}),n(s.execute()),m.label=3;case 3:return[2]}})})}}),L=function(){return L=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},L.apply(this,arguments)},k=Object(a.i)()(function(e){var t=this;return function(n){return a=t,void 0,s=function(){var t,a,i,s,c,b,g,v,y,S,D,I;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(x){switch(x.label){case 0:return t=o.D.deserialize(e.itemKey),a=t.memoryId,i=t.pageSize,s=t.skipToken,[4,(c=n(Object(u.a)())).getMemoryPhotos(a,i,s)];case 1:return(b=x.sent())&&b.value&&(g=b["@odata.nextLink"],v=Object(f.r)(g),y=b.value,S=[],D=new l.e,y.forEach(function(e){var t,n=o.n.serialize({photoId:e.id}),a={driveId:c.getDriveId(),endpoint:Object(p.o)({apiVersion:"v1.0",driveId:c.getDriveId()}),itemId:e.id},i=m.e.serialize(a),s=e.thumbnails[0].small,d=e.thumbnails[0].medium,l=e.thumbnails[0].large;D.resolveItems({items:(t={},t[i]=L({},_.p.pack(Object(h.t)(e.name,!1))),t[n]=L(L(L(L({},m.e.pack(a)),r.Q.pack({small:{height:s.height,width:s.width,url:s.url},medium:{height:d.height,width:d.width,url:d.url},large:{height:l.height,width:l.width,url:l.url}})),r.f.pack(Boolean(e.file.mimeType.startsWith("video")))),r.J.pack(e.video)),t)}),S.push(n)}),D.resolveItems({items:(I={},I[e.itemKey]=L(L({},r.j.pack(v)),d.e.pack({itemKeys:S})),I)}),n(D.execute())),[2]}})},new((i=void 0)||(i=Promise))(function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i(function(e){e(a)})).then(n,r)}o((s=s.apply(a,[])).next())});var a,i,s}}),M=n(143),P=n(16),T=n(1810),U=n(1988),F=function(){return F=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},F.apply(this,arguments)},H=Object(a.t)(function(){return function(e){var t,n=e(Object(M.e)(function(e){return e.demandItemFacet(P.r,P.a)})),a=n.consume(T.e),l=n.consume(U.e);e(Object(s.e)({items:(t={},t[o.c]=F({},r.A.pack(a)),t[o.t]=F({},r.r.pack(l)),t)})),e(Object(s.t)({keyFacet:o.O,facets:[r.j,d.e]})),e(Object(s.t)({keyFacet:o.r,facets:[r.j,d.e]})),e(Object(s.t)({keyFacet:o.L,facets:[r.j,d.e,r.t,r.K,r.q,r.W,r.f,r.J]})),e(Object(i.a)(o.O,c.e)(I)),e(Object(i.a)(o.r,c.e)(g)),e(Object(i.a)(o.E,c.e)(A)),e(Object(i.a)(o.D,c.e)(k)),e(Object(i.a)(o.L,c.e)(C))}})},4298:function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyCarouselPhotoStoryExtensions",function(){return R}),n.d(t,"resourceKey",function(){return N});var a=n(1),i=n(91),r=n(33),o=n(561),s=n(1758),c=n(1771),d=n(2356),l=n(1774),u=n(299),f=n(2344),p=n(104),m=n(64),_=n(42),h=n(12),b=n(271),g=n(28),v=n(311),y=n(209),S=n(379),D=n(19),I=n(2712),x=n(1007),C=n(2755),O=n(2711),w=Object(g.t)(function(){return function(e){return void 0,void 0,n=function(){var t;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(n){switch(n.label){case 0:return e(C.e),e(Object(y.t)({keyFacet:s.h,facets:[D.e]})),e(Object(y.t)({keyFacet:s.x,facets:[D.e]})),e(Object(v.a)(s.h,S.e)(O.e)),e(Object(v.a)(s.x,S.e)(I.e)),t=s.x.serialize({pageSize:100,numDaysAgo:30,origin:"photosCarousel"}),[4,e(Object(x.e)(function(e){e.demandItemFacet(D.e,t)}))];case 1:return n.sent(),[2]}})},new((t=void 0)||(t=Promise))(function(e,a){function i(e){try{o(n.next(e))}catch(e){a(e)}}function r(e){try{o(n.throw(e))}catch(e){a(e)}}function o(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t(function(e){e(a)})).then(i,r)}o((n=n.apply(undefined,[])).next())});var t,n}}),E=n(128),A=n(61),L=n(69),k=n(55),M=n(17);Object(M.n)([{rawString:".container{width:100%;border-radius:6px}.inviteBackground{background:linear-gradient(#50d8ff,#103f90);display:flex;justify-content:center}.newPostBackground{background:linear-gradient(#35c1ca,#036c70);display:flex;justify-content:center}.postThumbnail{border-radius:6px;background-size:cover!important;background-position-y:center!important;height:100%;width:100%}.singleAvatar{justify-content:center}.inviteSvg{height:90px;width:200px;position:absolute;margin:16px 20px 50px 20px}@media screen and (min-width:553px){.inviteSvg{margin:32px 36px 64px 36px}}.inviteCard{width:200px;height:90px;margin:16px 20px 50px 20px;position:relative}@media screen and (min-width:553px){.inviteCard{margin:32px 36px 64px 36px}}.overlayIcon{position:relative;width:1rem;height:1rem;right:-.5rem;top:1.5625rem;border:.125rem solid;border-radius:50%;background-color:#fff;border-width:1px;z-index:4}html[dir=ltr] .overlayIcon{right:auto;left:-.5rem}.secondaryOverlayIcon{position:relative;width:1rem;height:1rem;right:-1.9375rem;top:2.625rem;border:.125rem solid;border-radius:50%;background-color:#fff;border-width:1px;z-index:3}html[dir=ltr] .secondaryOverlayIcon{right:auto;left:-1.9375rem}.primaryPersona{z-index:2;border-style:solid;border-radius:100%;border-color:#fff;border-width:1px;width:fit-content;height:fit-content}.secondaryPersona{z-index:1;border-style:solid;border-radius:100%;border-color:#fff;border-width:1px;width:fit-content;height:fit-content}.secondaryPersona.inviteFormat{top:-5.625rem;right:1.25rem;justify-content:center}html[dir=ltr] .secondaryPersona.inviteFormat{right:auto;left:1.25rem}.secondaryPersona:not(.inviteFormat){right:1rem}html[dir=ltr] .secondaryPersona:not(.inviteFormat){right:auto;left:1rem}.personaOneContainer{display:flex}.centerImage{position:relative;top:19%;right:5%;height:fit-content}html[dir=ltr] .centerImage{right:auto;left:5%}@media screen and (min-width:553px){.centerImage{top:12%}}.centerImage.multiImage .personaOneContainer{position:relative;right:60px}html[dir=ltr] .centerImage.multiImage .personaOneContainer{right:auto;left:60px}.multiImage{right:12%}html[dir=ltr] .multiImage{right:auto;left:12%}.newPostImage{height:fit-content;position:absolute;top:2rem;left:50px;display:flex;flex-direction:row-reverse}.bottomRightImage{height:fit-content;position:absolute;bottom:16px;left:10px;display:flex;flex-direction:row-reverse}html[dir=ltr] .bottomRightImage{right:10px}.reactionIcon{height:fit-content;position:absolute;bottom:45px;left:20px;display:flex;flex-direction:row-reverse}html[dir=ltr] .reactionIcon{left:auto;right:20px}"}]);var P=function(){return P=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},P.apply(this,arguments)},T=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},U=h.t.isActivated("C8D7C238-3F3E-4A7A-BF73-B6661092EC15","2022-05-24","show dynamic ps cards on photos carousel")?0:2,F="odsp-media/images/psdynamiccards/",H="odsp-media/images/photostream/",R=function(){function e(e,t){var n=this;this.addon=w,this.onPostToPhotoStreamClick=function(e,t,a,o){i.e.logData({name:"PhotoStream.PostMOJToPhotoStoryClicked",usageType:"Click",isIntentional:!0,extraData:{location:"MOJLandingPage",component:o,type:t},privacyClassification:r.t.requiredService,privacyDataTypes:["productAndServiceUsage"]});var s=e.getSelection().filter(function(e){return e.hasOwnProperty("id")}).map(function(e){return e.id}),c=null;switch(t){case"onthisday":c="onthisday";break;case"onthismonth":c="previousmonth";break;case"lastweekpreviousyears":c="onlastweek"}var d=n._urlDataSource.getPhotoStreamForMojsQueryUrl(a,null!=c?c:t,s);n._navigation.navigateTo(d)};var a=t.navigation,o=t.urlDataSource;this._navigation=a,this._urlDataSource=o}return e.prototype.demandPhotoStoryCarouselCards=function(e){var t,n,a=s.x.serialize({pageSize:100,numDaysAgo:30,origin:"photosCarousel"});if(e.isItemFacetResolved(D.e,a)){var i=e.demandItemFacet(D.e,a),r={Invite:[],AccessRequest:[],Joint:[],NewPost:[],Comment:void 0,Reaction:void 0},d=0;if(i){var l=[],u=new p.e(o.n,m.e.local),f=null!==(t=u.getValue(o.a))&&void 0!==t?t:"";Object(o.i)({});var _=f.split(o.e).filter(function(e){var t;return(null===(t=i.itemKeys)||void 0===t?void 0:t.indexOf(e))>-1});u.setValue(o.a,_.join(o.e)),null===(n=i.itemKeys)||void 0===n||n.forEach(function(t){if(!(_.indexOf(t)>=0)){var n=e.demandItemFacet(c.x,t);if(n)if("Comment"===n||"Reaction"===n){var a=e.demandItemFacet(c.b,t),i=r[n],o=null==i?void 0:i.postId,s=o?i.activityIds:[t];r[n]={postId:null!=o?o:a,activityIds:o&&o===a?T(T([],s,!0),[t],!1):s}}else r[n]&&r[n].push(t),"Invite"!==n&&"AccessRequest"!==n||r.Joint.push(t)}});var h=K(e,r);d<U&&h&&(l.push(h),d++);var b=d<U&&W(e,r,"Comment");b&&(l.push(b),d++);var g=d<U&&W(e,r,"Reaction");g&&(l.push(g),d++);var v=d<U&&q(e,r);return v&&(l.push(v),d++),l}}},e.dependencies={navigation:L.e,urlDataSource:A.ye},e}(),N=Object(E.r)("LegacyCarouselPhotoStoryExtensions",R),B=function(e){switch(e){case"Invite":return k.e.DynamicPhotoStoryCardInvite;case"AccessRequest":return k.e.DynamicPhotoStoryCardAccessRequest;case"Comment":return k.e.DynamicPhotoStoryCardComment;case"Reaction":return k.e.DynamicPhotoStoryCardReaction;default:return k.e.NewAutoAlbums}},j=function(e,t){return"Invite"===e?u.a:"AccessRequest"===e?u.t:Object(f.t)(t,new Date)},V=function(e,t,n,i,r,o,s){var c=e?"centerImage":t?"newPostImage":"bottomRightImage",l=o?"multiImage":"";return a.createElement("div",{id:"profile",className:"".concat(c," ").concat(l)},a.createElement("div",{className:r||l||!e?"personaOneContainer":"personaOneContainer singleAvatar"},"Reaction"===s&&a.createElement("img",{src:window.require.toUrl("".concat(F,"heart.svg")),className:"reactionIcon"}),a.createElement(d.e,P({},i)),n&&a.createElement("img",{src:window.require.toUrl(n),className:"overlayIcon"}),r&&a.createElement("img",{src:window.require.toUrl(r),className:"secondaryOverlayIcon"})),o&&a.createElement(d.e,P({},o)))},z=function(e,t,n){return"Joint"===e||"Invite"===e||"AccessRequest"===e?1===t.length?window.require.toUrl("".concat(F,"inviterequestsingular.svg")):window.require.toUrl("".concat(F,"inviterequestplural.svg")):"NewPost"===e?window.require.toUrl("".concat(F,"newpost.svg")):window.require.toUrl(n.demandItemFacet(c.K,t[0]))},G=function(e,t,n,a){if("Joint"===a)return u.r;var i=e,r=e.split(" ")[0];return 2===n.length&&(i="".concat(r," + ").concat(t.split(" ")[0]," ")),n.length>2&&(i="".concat(r," + ").concat(n.length-1," ").concat(u.e," ")),"NewPost"===a?_.format(u.i,r):"Comment"===a?_.format(u.n,i):"Reaction"===a?_.format(u.o,i):i},K=function(e,t){var n,a;if(t.Invite.length&&t.AccessRequest.length)n=t.Joint,a="Joint";else if(t.Invite.length)n=t.Invite,a="Invite";else{if(!t.AccessRequest.length)return null;n=t.AccessRequest,a="AccessRequest"}return Q(e,n,a)},W=function(e,t,n){var a;if(null===(a=t[n])||void 0===a?void 0:a.postId)return Q(e,t[n].activityIds,n)},q=function(e,t){if(t.NewPost.length)return Q(e,[t.NewPost[0]],"NewPost")},Q=function(e,t,n){var i=void 0,r=void 0;switch(n){case"Joint":i="".concat(H,"mail.svg"),r="".concat(H,"reaction.svg");break;case"Invite":i="".concat(H,"mail.svg");break;case"AccessRequest":i="".concat(H,"follower.svg");break;case"Comment":i="".concat(H,"comment.svg");break;case"Reaction":i="".concat(H,"reaction.svg");break;case"NewPost":i="".concat(H,"newpost.svg");break;default:i=void 0}var s,d,u=t.length,f="Joint"===n||"Invite"===n||"AccessRequest"===n,p="NewPost"===n,m=t[0],_=e.demandItemFacet(c.P,m),h=e.demandItemFacet(c.I,m);d=G(h,"",t,n);var g={imageUrl:e.demandItemFacet(c.g,m),text:h,size:f?l.n.size72:p?l.n.size48:l.n.size40,hidePersonaDetails:!0,imageAlt:h,className:"primaryPersona"};if(u>1){var v=t[1],y=e.demandItemFacet(c.I,v),S=e.demandItemFacet(c.g,v);s={imageUrl:S,text:y,size:f?l.n.size56:l.n.size40,hidePersonaDetails:!0,imageAlt:y,className:"secondaryPersona ".concat(f?"inviteFormat":"")},d=G(h,y,t,n)}var D={background:"url(".concat(z(n,t,e),") no-repeat")},I=f?"inviteBackground":p?"newPostBackground":"",x=!f&&!p||"Joint"===n,C=Object(o.t)();return C[m]=(C[m]?C[m]:[]).concat(t),Object(o.i)(C),{name:d||"",subTitle:j(n,_)||"",defaultClickAction:a.createElement(b.e,{itemKey:m}),folderType:B(n),creationDate:_?new Date(_):new Date,isDynamicPSCard:x,renderThumbnail:function(e,t){return a.createElement("div",{className:"".concat(I," container")},p?a.createElement("div",{className:"inviteCard",style:D},V(f,p,i,g,void 0,void 0,n)):a.createElement("div",{style:D,className:f?"backgroundImage inviteSvg":"backgroundImage postThumbnail"},V(f,p,i,g,r,s,n)))}}}}}]);